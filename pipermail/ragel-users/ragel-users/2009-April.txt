From chrsan at gmail.com  Fri Apr  3 07:55:12 2009
From: chrsan at gmail.com (Christer Sandberg)
Date: Fri, 3 Apr 2009 09:55:12 +0200
Subject: [ragel-users] A new project using Ragel
Message-ID: <13f6d2440904030055m511db405y5b289b03329e42e4@mail.gmail.com>

Hi!

I just wanted to inform you that I've just released a new open source
project using Ragel.
It's a Java implementation of the W3C Selectors Level 3 specification.
Have a look if it sounds
interesting. I'm kind of new to Ragel so tips and enhancement ideas
are most welcome.

Christer



From ribs at acm.org  Fri Apr  3 17:32:33 2009
From: ribs at acm.org (Larry Edelstein)
Date: Fri, 3 Apr 2009 10:32:33 -0700
Subject: [ragel-users] A new project using Ragel
In-Reply-To: <13f6d2440904030055m511db405y5b289b03329e42e4@mail.gmail.com>
References: <13f6d2440904030055m511db405y5b289b03329e42e4@mail.gmail.com>
Message-ID: <2021f8b20904031032v7ce2986eh2f8ffd3ba8fceaac@mail.gmail.com>

That does sound interesting - where can it be found?
-Larry

On Fri, Apr 3, 2009 at 12:55 AM, Christer Sandberg <chrsan at gmail.com> wrote:

> Hi!
>
> I just wanted to inform you that I've just released a new open source
> project using Ragel.
> It's a Java implementation of the W3C Selectors Level 3 specification.
> Have a look if it sounds
> interesting. I'm kind of new to Ragel so tips and enhancement ideas
> are most welcome.
>
> Christer
>
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.colm.net/pipermail/ragel/attachments/20090403/5886bd5e/attachment.html>

From chrsan at gmail.com  Fri Apr  3 19:06:55 2009
From: chrsan at gmail.com (Christer Sandberg)
Date: Fri, 3 Apr 2009 21:06:55 +0200
Subject: [ragel-users] A new project using Ragel
In-Reply-To: <2021f8b20904031032v7ce2986eh2f8ffd3ba8fceaac@mail.gmail.com>
References: <13f6d2440904030055m511db405y5b289b03329e42e4@mail.gmail.com>
	<2021f8b20904031032v7ce2986eh2f8ffd3ba8fceaac@mail.gmail.com>
Message-ID: <13f6d2440904031206u43f7279et7874c2f721a95b9f@mail.gmail.com>

Oh sorry! I forgot the link to the project ;)

Here's the wiki page for the project and the source can be found there as well.

http://wiki.github.com/chrsan/css-selectors

/Christer

On Fri, Apr 3, 2009 at 7:32 PM, Larry Edelstein <ribs at acm.org> wrote:
> That does sound interesting - where can it be found?
> -Larry
>
> On Fri, Apr 3, 2009 at 12:55 AM, Christer Sandberg <chrsan at gmail.com> wrote:
>>
>> Hi!
>>
>> I just wanted to inform you that I've just released a new open source
>> project using Ragel.
>> It's a Java implementation of the W3C Selectors Level 3 specification.
>> Have a look if it sounds
>> interesting. I'm kind of new to Ragel so tips and enhancement ideas
>> are most welcome.
>>
>> Christer
>>
>> _______________________________________________
>> ragel-users mailing list
>> ragel-users at complang.org
>> http://www.complang.org/mailman/listinfo/ragel-users
>
>
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users
>
>



From thurston at complang.org  Sat Apr  4 21:34:09 2009
From: thurston at complang.org (Adrian Thurston)
Date: Sat, 04 Apr 2009 17:34:09 -0400
Subject: [ragel-users] ragel and automake
Message-ID: <49D7D251.4060805@complang.org>

So I managed to convert Ragel to automake. If there are any automake 
experts out there (Diego?) could you have a look at it for me to see if 
I munged anything up.

There's one thing I'm not too certain about. When I configure and make a 
tarball that has been created with 'make dist', the 'make' command 
causes the project to be reconfigured. The -d option to make reveals 
that it's because aclocal.m4 is out of date. If I touch aclocal.m4 then 
the reconfigure still happens because something becomes out of date with 
respect to aclocal.m4. There seems to be a circular dependency in the 
generated files. Anyone know if I'm doing something wrong?

-Adrian



From thurston at complang.org  Sat Apr  4 22:04:12 2009
From: thurston at complang.org (Adrian Thurston)
Date: Sat, 04 Apr 2009 18:04:12 -0400
Subject: [ragel-users] Autoconf/automake spport for Ragel
In-Reply-To: <1236856299.11830.61.camel@localhost>
References: <1236856299.11830.61.camel@localhost>
Message-ID: <49D7D95C.6020300@complang.org>

These are now in a new directory in ragel called 'contrib'.

-Adrian

Diego E. 'Flameeyes' PettenÃ² wrote:
> Hi everybody,
> 
> since I wrote these for a project I'm working on, I thought they might
> be useful to others too; they should be pretty generic and well suited
> for being integrated in other projects.
> 
> There are two macros, CHECK_RAGEL and CHECK_RAGEL_AM, the latter will
> enable the HAVE_RAGEL conditional, while the former will just do the
> autoconf check.
> 
> The macros both accept a single parameter, the relative path to a source
> file generated by Ragel (i.e.: the .c file not the .rl file) that can be
> checked to be present or not.
> 
> The make rule uses RAGELFLAGS to pass extra options to Ragel so the user
> is able to choose a different FSM implementation rather than the default
> -T0.
> 
> HTH,
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From thurston at complang.org  Sat Apr  4 22:15:48 2009
From: thurston at complang.org (Adrian Thurston)
Date: Sat, 04 Apr 2009 18:15:48 -0400
Subject: [ragel-users] A new project using Ragel
In-Reply-To: <13f6d2440904031206u43f7279et7874c2f721a95b9f@mail.gmail.com>
References: <13f6d2440904030055m511db405y5b289b03329e42e4@mail.gmail.com>	<2021f8b20904031032v7ce2986eh2f8ffd3ba8fceaac@mail.gmail.com>
	<13f6d2440904031206u43f7279et7874c2f721a95b9f@mail.gmail.com>
Message-ID: <49D7DC14.7080500@complang.org>

I just added a link. Thanks for the heads up :)

-Adrian

Christer Sandberg wrote:
> Oh sorry! I forgot the link to the project ;)
> 
> Here's the wiki page for the project and the source can be found there as well.
> 
> http://wiki.github.com/chrsan/css-selectors
> 
> /Christer
> 
> On Fri, Apr 3, 2009 at 7:32 PM, Larry Edelstein <ribs at acm.org> wrote:
>> That does sound interesting - where can it be found?
>> -Larry
>>
>> On Fri, Apr 3, 2009 at 12:55 AM, Christer Sandberg <chrsan at gmail.com> wrote:
>>> Hi!
>>>
>>> I just wanted to inform you that I've just released a new open source
>>> project using Ragel.
>>> It's a Java implementation of the W3C Selectors Level 3 specification.
>>> Have a look if it sounds
>>> interesting. I'm kind of new to Ragel so tips and enhancement ideas
>>> are most welcome.
>>>
>>> Christer
>>>
>>> _______________________________________________
>>> ragel-users mailing list
>>> ragel-users at complang.org
>>> http://www.complang.org/mailman/listinfo/ragel-users
>>
>> _______________________________________________
>> ragel-users mailing list
>> ragel-users at complang.org
>> http://www.complang.org/mailman/listinfo/ragel-users
>>
>>
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From chrsan at gmail.com  Sat Apr  4 22:32:35 2009
From: chrsan at gmail.com (Christer Sandberg)
Date: Sun, 5 Apr 2009 00:32:35 +0200
Subject: [ragel-users] A new project using Ragel
In-Reply-To: <49D7DC14.7080500@complang.org>
References: <13f6d2440904030055m511db405y5b289b03329e42e4@mail.gmail.com>
	<2021f8b20904031032v7ce2986eh2f8ffd3ba8fceaac@mail.gmail.com>
	<13f6d2440904031206u43f7279et7874c2f721a95b9f@mail.gmail.com>
	<49D7DC14.7080500@complang.org>
Message-ID: <13f6d2440904041532h554835fgdd8d166364a20c1e@mail.gmail.com>

No problem! My pleasure really :)

/Christer

On Sun, Apr 5, 2009 at 12:15 AM, Adrian Thurston <thurston at complang.org> wrote:
> I just added a link. Thanks for the heads up :)
>
> -Adrian
>
> Christer Sandberg wrote:
>> Oh sorry! I forgot the link to the project ;)
>>
>> Here's the wiki page for the project and the source can be found there as well.
>>
>> http://wiki.github.com/chrsan/css-selectors
>>
>> /Christer
>>
>> On Fri, Apr 3, 2009 at 7:32 PM, Larry Edelstein <ribs at acm.org> wrote:
>>> That does sound interesting - where can it be found?
>>> -Larry
>>>
>>> On Fri, Apr 3, 2009 at 12:55 AM, Christer Sandberg <chrsan at gmail.com> wrote:
>>>> Hi!
>>>>
>>>> I just wanted to inform you that I've just released a new open source
>>>> project using Ragel.
>>>> It's a Java implementation of the W3C Selectors Level 3 specification.
>>>> Have a look if it sounds
>>>> interesting. I'm kind of new to Ragel so tips and enhancement ideas
>>>> are most welcome.
>>>>
>>>> Christer
>>>>
>>>> _______________________________________________
>>>> ragel-users mailing list
>>>> ragel-users at complang.org
>>>> http://www.complang.org/mailman/listinfo/ragel-users
>>>
>>> _______________________________________________
>>> ragel-users mailing list
>>> ragel-users at complang.org
>>> http://www.complang.org/mailman/listinfo/ragel-users
>>>
>>>
>>
>> _______________________________________________
>> ragel-users mailing list
>> ragel-users at complang.org
>> http://www.complang.org/mailman/listinfo/ragel-users
>
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users
>



From ibc at aliax.net  Mon Apr  6 19:08:48 2009
From: ibc at aliax.net (=?utf-8?q?I=C3=B1aki_Baz_Castillo?=)
Date: Mon, 6 Apr 2009 21:08:48 +0200
Subject: [ragel-users] terminate called after throwing an instance of
	'std::bad_alloc'
Message-ID: <200904062108.49010.ibc@aliax.net>

I've changed nothing, except the fact that now I use Linux 64 bits.

Using Ragel 6.3.1 (Ubuntu Jaunty package) I get this error:

---------------
terminate called after throwing an instance of 'std::bad_alloc'
  what():  std::bad_alloc
ragel: rlgen-ruby did not exit normally
---------------

What does it mean?

-- 
IÃ±aki Baz Castillo <ibc at aliax.net>



From flameeyes at gmail.com  Mon Apr  6 23:59:29 2009
From: flameeyes at gmail.com (Diego E. =?UTF-8?Q?=E2=80=9CFlameeyes=E2=80=9D_?= =?ISO-8859-1?Q?Petten=F2?=)
Date: Tue, 07 Apr 2009 01:59:29 +0200
Subject: [ragel-users] ragel and automake
In-Reply-To: <49D7D251.4060805@complang.org>
References: <49D7D251.4060805@complang.org>
Message-ID: <1239062369.13660.239.camel@localhost>

On Sat, 2009-04-04 at 17:34 -0400, Adrian Thurston wrote:
> So I managed to convert Ragel to automake. If there are any automake 
> experts out there (Diego?) could you have a look at it for me to see
> if 
> I munged anything up.
> 
I've updated my local copy and will see to provide some patches for a
couple of side cases; I _think_ the reconfigure problem is the changes
in the dist-hook to change the configure script, so I'll try to provide
a different method to achieve the same, similarly to what I've done in
the ragel-checking macro.

The other day I was stopped in my steps because my semi-automatic
scripts failed, out-of-tree builds don't work and aren't easy to fix
because kelbt lacks a "-I" option to tell it where to find the included
files.

-- 
Diego Elio PettenÃ² â âFlameeyesâ
http://blog.flameeyes.eu/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 198 bytes
Desc: This is a digitally signed message part
URL: <http://www.colm.net/pipermail/ragel/attachments/20090407/d66b2927/attachment.sig>

From thurston at complang.org  Thu Apr  9 02:27:52 2009
From: thurston at complang.org (Adrian Thurston)
Date: Wed, 08 Apr 2009 22:27:52 -0400
Subject: [ragel-users] terminate called after throwing an instance of
 'std::bad_alloc'
In-Reply-To: <200904062108.49010.ibc@aliax.net>
References: <200904062108.49010.ibc@aliax.net>
Message-ID: <49DD5D28.20100@complang.org>

That's a memory allocation error. My guess is that some allocation size 
is wrong due to some bad code with respect to 64bit. Could you provide 
the runtime options and a backtrace with gdb? First run ragel -x and 
then run the backend program manually with gdb.

Thanks,
  Adrian

IÃ±aki Baz Castillo wrote:
> I've changed nothing, except the fact that now I use Linux 64 bits.
> 
> Using Ragel 6.3.1 (Ubuntu Jaunty package) I get this error:
> 
> ---------------
> terminate called after throwing an instance of 'std::bad_alloc'
>   what():  std::bad_alloc
> ragel: rlgen-ruby did not exit normally
> ---------------
> 
> What does it mean?
> 



From thurston at complang.org  Thu Apr  9 02:30:52 2009
From: thurston at complang.org (Adrian Thurston)
Date: Wed, 08 Apr 2009 22:30:52 -0400
Subject: [ragel-users] ragel and automake
In-Reply-To: <1239062369.13660.239.camel@localhost>
References: <49D7D251.4060805@complang.org>
	<1239062369.13660.239.camel@localhost>
Message-ID: <49DD5DDC.8040805@complang.org>

The kelbt -I problem is noted.

In regards to the dist-hook, that seems to be it. I think I'll just 
modify the configure.in before running "make dist" in my release script. 
I was thinking I could get rid of the release script due to make dist, 
but I just realized I need it anyways to make the manual, sign the files 
and do a few other things.

-Adrian


Diego E. âFlameeyesâ PettenÃ² wrote:
> On Sat, 2009-04-04 at 17:34 -0400, Adrian Thurston wrote:
>> So I managed to convert Ragel to automake. If there are any automake 
>> experts out there (Diego?) could you have a look at it for me to see
>> if 
>> I munged anything up.
>>
> I've updated my local copy and will see to provide some patches for a
> couple of side cases; I _think_ the reconfigure problem is the changes
> in the dist-hook to change the configure script, so I'll try to provide
> a different method to achieve the same, similarly to what I've done in
> the ragel-checking macro.
> 
> The other day I was stopped in my steps because my semi-automatic
> scripts failed, out-of-tree builds don't work and aren't easy to fix
> because kelbt lacks a "-I" option to tell it where to find the included
> files.
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From ibc at aliax.net  Thu Apr  9 11:07:47 2009
From: ibc at aliax.net (=?UTF-8?Q?I=C3=B1aki_Baz_Castillo?=)
Date: Thu, 9 Apr 2009 13:07:47 +0200
Subject: [ragel-users] terminate called after throwing an instance of
	'std::bad_alloc'
In-Reply-To: <49DD5D28.20100@complang.org>
References: <200904062108.49010.ibc@aliax.net> <49DD5D28.20100@complang.org>
Message-ID: <cc1f582e0904090407h696b5cd5wba0f700d4f1f65e6@mail.gmail.com>

2009/4/9 Adrian Thurston <thurston at complang.org>:
> That's a memory allocation error. My guess is that some allocation size
> is wrong due to some bad code with respect to 64bit. Could you provide
> the runtime options and a backtrace with gdb? First run ragel -x and
> then run the backend program manually with gdb.

Thanks Adrian, but I'm not sure how to check it.

I've a Ragel grammar file in Ruby (sip_parser.rl). I compile it in
Debian Etch 64 bits with Ragel 6.4 installed from sources:

# ragel -F1 -R sip_parser.rl
terminate called after throwing an instance of 'std::bad_alloc'
  what():  St9bad_alloc
Aborted


# ragel -F1 -R sip_parser.rl -x
(I( get the internal XML)


But I don't know what you mean with "run the backend program manually
with gdb". I use gdb to debug coredumps in other programms, but have
no idea of what to do with it in this case.

Could you please indicate the steps I must perform? Thanks a lot.


PD: I've tryed this issue in two different Linux hosts both of 64 bits.


-- 
IÃ±aki Baz Castillo
<ibc at aliax.net>



From flameeyes at gmail.com  Fri Apr 10 12:55:59 2009
From: flameeyes at gmail.com (Diego E. =?UTF-8?Q?=E2=80=9CFlameeyes=E2=80=9D_?= =?ISO-8859-1?Q?Petten=F2?=)
Date: Fri, 10 Apr 2009 14:55:59 +0200
Subject: [ragel-users] Patches to avoid build_parsers=yes/no change at dist
Message-ID: <1239368159.13660.365.camel@localhost>

Just as a proof of concept now, I haven't converted the manual to the
same effect, just the parsers regeneration.

The two attached patches (from git-svn) use the same technique I used
for feng to make ragel an optional dependency for users but a mandatory
one for developers: if the generated files are missing, and either ragel
or kelbt cannot be found, the configure is aborted; if both are found,
whether the generated files exist or not, parsers regeneration is
enabled.

If this is acceptable I can make the same change to the manual
regeneration; otherwise I can add a ./configure option so that the
rebuild only happens if the files don't exist _or_ if an option is
provided to the ./configure call.

-- 
Diego Elio PettenÃ² â âFlameeyesâ
http://blog.flameeyes.eu/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-Don-t-refer-to-GIT-checkouts-directly.patch
Type: text/x-patch
Size: 786 bytes
Desc: not available
URL: <http://www.colm.net/pipermail/ragel/attachments/20090410/f181ca4e/attachment.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0002-Don-t-use-a-static-switched-variable-to-regenerate-t.patch
Type: text/x-patch
Size: 4955 bytes
Desc: not available
URL: <http://www.colm.net/pipermail/ragel/attachments/20090410/f181ca4e/attachment-0001.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 198 bytes
Desc: This is a digitally signed message part
URL: <http://www.colm.net/pipermail/ragel/attachments/20090410/f181ca4e/attachment.sig>

From max at darim.com  Mon Apr 13 10:04:19 2009
From: max at darim.com (Max Suraev)
Date: Mon, 13 Apr 2009 17:04:19 +0700
Subject: [ragel-users] eof error
Message-ID: <1239617059.8940.9.camel@x-desk>

Hello.

I'm trying to implement simple FSM describing protocol logic.

ragel gave me no errors and successfully compiled machine but I got
error from gcc while trying to compile resuls:
eof not defined.

Since I do not use such variable in .rl file I guess there is something
wrong with the way I use code generated by ragel.

Could you please take a look and point towards possible error?

Machine is quite simple (3 states, actions are just stubs doing nothing
but printing) so I'm pretty much stuck at this point.

Any general critics\recommendations are more than welcome.

best regards,
Max.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: enum_fsm.rl
Type: text/x-csrc
Size: 2004 bytes
Desc: not available
URL: <http://www.colm.net/pipermail/ragel/attachments/20090413/ae211600/attachment.c>

From thurston at complang.org  Tue Apr 14 02:12:56 2009
From: thurston at complang.org (Adrian Thurston)
Date: Mon, 13 Apr 2009 22:12:56 -0400
Subject: [ragel-users] terminate called after throwing an instance of
 'std::bad_alloc'
In-Reply-To: <cc1f582e0904090407h696b5cd5wba0f700d4f1f65e6@mail.gmail.com>
References: <200904062108.49010.ibc@aliax.net> <49DD5D28.20100@complang.org>
	<cc1f582e0904090407h696b5cd5wba0f700d4f1f65e6@mail.gmail.com>
Message-ID: <49E3F128.8080008@complang.org>

Try using -T0. My guess is that the alphabet size is large and the 
allocation of tables is eating up too much memory.

To confirm you can run:

ragel -F -R -x sip_parser.rl > out.xml
rlgen-ruby out.xml

-Adrian



IÃ±aki Baz Castillo wrote:
> 2009/4/9 Adrian Thurston <thurston at complang.org>:
>> That's a memory allocation error. My guess is that some allocation size
>> is wrong due to some bad code with respect to 64bit. Could you provide
>> the runtime options and a backtrace with gdb? First run ragel -x and
>> then run the backend program manually with gdb.
> 
> Thanks Adrian, but I'm not sure how to check it.
> 
> I've a Ragel grammar file in Ruby (sip_parser.rl). I compile it in
> Debian Etch 64 bits with Ragel 6.4 installed from sources:
> 
> # ragel -F1 -R sip_parser.rl
> terminate called after throwing an instance of 'std::bad_alloc'
>   what():  St9bad_alloc
> Aborted
> 
> 
> # ragel -F1 -R sip_parser.rl -x
> (I( get the internal XML)
> 
> 
> But I don't know what you mean with "run the backend program manually
> with gdb". I use gdb to debug coredumps in other programms, but have
> no idea of what to do with it in this case.
> 
> Could you please indicate the steps I must perform? Thanks a lot.
> 
> 
> PD: I've tryed this issue in two different Linux hosts both of 64 bits.
> 
> 



From thurston at complang.org  Tue Apr 14 02:31:45 2009
From: thurston at complang.org (Adrian Thurston)
Date: Mon, 13 Apr 2009 22:31:45 -0400
Subject: [ragel-users] Patches to avoid build_parsers=yes/no change at
 dist
In-Reply-To: <1239368159.13660.365.camel@localhost>
References: <1239368159.13660.365.camel@localhost>
Message-ID: <49E3F591.5030607@complang.org>

Hmmm, I'd rather it never rebuild in the dist unless asked for. Since 
there are many different incompatible versions of Ragel, successful 
compilation will depend on what previous version you have installed. Say 
you have version four installed and you want to upgrade to version six 
then your build will fail because six's parsers can't be built with 
version four of Ragel.

-Adrian

Diego E. âFlameeyesâ PettenÃ² wrote:
> Just as a proof of concept now, I haven't converted the manual to the
> same effect, just the parsers regeneration.
> 
> The two attached patches (from git-svn) use the same technique I used
> for feng to make ragel an optional dependency for users but a mandatory
> one for developers: if the generated files are missing, and either ragel
> or kelbt cannot be found, the configure is aborted; if both are found,
> whether the generated files exist or not, parsers regeneration is
> enabled.
> 
> If this is acceptable I can make the same change to the manual
> regeneration; otherwise I can add a ./configure option so that the
> rebuild only happens if the files don't exist _or_ if an option is
> provided to the ./configure call.
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From thurston at complang.org  Tue Apr 14 03:00:05 2009
From: thurston at complang.org (Adrian Thurston)
Date: Mon, 13 Apr 2009 23:00:05 -0400
Subject: [ragel-users] eof error
In-Reply-To: <1239617059.8940.9.camel@x-desk>
References: <1239617059.8940.9.camel@x-desk>
Message-ID: <49E3FC35.1080308@complang.org>

Hi Max,

No error, you just need to supply eof since there is a final state with 
an action to execute on the EOF event. In this case it's caused by the 
error action in the Enumerator machine and would also be caused by the 
leaving action applied to Enumerator if Enumerator had any final states. 
You just need to tell Ragel when it's got to the end of the input by 
setting char *eof = pe.

-Adrian

Max Suraev wrote:
> Hello.
> 
> I'm trying to implement simple FSM describing protocol logic.
> 
> ragel gave me no errors and successfully compiled machine but I got
> error from gcc while trying to compile resuls:
> eof not defined.
> 
> Since I do not use such variable in .rl file I guess there is something
> wrong with the way I use code generated by ragel.
> 
> Could you please take a look and point towards possible error?
> 
> Machine is quite simple (3 states, actions are just stubs doing nothing
> but printing) so I'm pretty much stuck at this point.
> 
> Any general critics\recommendations are more than welcome.
> 
> best regards,
> Max.
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From ibc at aliax.net  Tue Apr 14 08:42:05 2009
From: ibc at aliax.net (=?UTF-8?Q?I=C3=B1aki_Baz_Castillo?=)
Date: Tue, 14 Apr 2009 10:42:05 +0200
Subject: [ragel-users] terminate called after throwing an instance of
	'std::bad_alloc'
In-Reply-To: <49E3F128.8080008@complang.org>
References: <200904062108.49010.ibc@aliax.net> <49DD5D28.20100@complang.org>
	<cc1f582e0904090407h696b5cd5wba0f700d4f1f65e6@mail.gmail.com>
	<49E3F128.8080008@complang.org>
Message-ID: <cc1f582e0904140142n73c264aelb98ce4a0c6dc1a89@mail.gmail.com>

2009/4/14 Adrian Thurston <thurston at complang.org>:
> Try using -T0. My guess is that the alphabet size is large and the
> allocation of tables is eating up too much memory.

If so, is it a bug or a problem in my grammar?

~# ragel -T0 -R sip_parser.rl -o sip_parser.rb
ragel: rubycodegen.cpp:372: std::string RubyCodeGen::WIDE_ALPH_TYPE():
Assertion `wideType != 0' failed.


> To confirm you can run:
>
> ragel -F -R -x sip_parser.rl > out.xml
> rlgen-ruby out.xml

After compiling Ragel 6.4 I have no rlgen-XXXX command.

-- 
IÃ±aki Baz Castillo
<ibc at aliax.net>



From ibc at aliax.net  Tue Apr 14 08:47:51 2009
From: ibc at aliax.net (=?UTF-8?Q?I=C3=B1aki_Baz_Castillo?=)
Date: Tue, 14 Apr 2009 10:47:51 +0200
Subject: [ragel-users] terminate called after throwing an instance of
	'std::bad_alloc'
In-Reply-To: <cc1f582e0904140142n73c264aelb98ce4a0c6dc1a89@mail.gmail.com>
References: <200904062108.49010.ibc@aliax.net> <49DD5D28.20100@complang.org>
	<cc1f582e0904090407h696b5cd5wba0f700d4f1f65e6@mail.gmail.com>
	<49E3F128.8080008@complang.org>
	<cc1f582e0904140142n73c264aelb98ce4a0c6dc1a89@mail.gmail.com>
Message-ID: <cc1f582e0904140147k5f049961r2ba9948dc972ad32@mail.gmail.com>

2009/4/14 IÃ±aki Baz Castillo <ibc at aliax.net>:
> 2009/4/14 Adrian Thurston <thurston at complang.org>:
>> Try using -T0. My guess is that the alphabet size is large and the
>> allocation of tables is eating up too much memory.
>
> If so, is it a bug or a problem in my grammar?
>
> ~# ragel -T0 -R sip_parser.rl -o sip_parser.rb
> ragel: rubycodegen.cpp:372: std::string RubyCodeGen::WIDE_ALPH_TYPE():
> Assertion `wideType != 0' failed.

PD: Note that it worked fine in 32 bits (same grammar, some Ragel version).



-- 
IÃ±aki Baz Castillo
<ibc at aliax.net>



From graceindustries at gmail.com  Tue Apr 14 11:50:47 2009
From: graceindustries at gmail.com (Bob Paddock)
Date: Tue, 14 Apr 2009 07:50:47 -0400
Subject: [ragel-users] terminate called after throwing an instance of
	'std::bad_alloc'
In-Reply-To: <cc1f582e0904140147k5f049961r2ba9948dc972ad32@mail.gmail.com>
References: <200904062108.49010.ibc@aliax.net> <49DD5D28.20100@complang.org>
	<cc1f582e0904090407h696b5cd5wba0f700d4f1f65e6@mail.gmail.com>
	<49E3F128.8080008@complang.org>
	<cc1f582e0904140142n73c264aelb98ce4a0c6dc1a89@mail.gmail.com>
	<cc1f582e0904140147k5f049961r2ba9948dc972ad32@mail.gmail.com>
Message-ID: <a3aee9a50904140450s3621442ara9ac427fa2f284b7@mail.gmail.com>

> PD: Note that it worked fine in 32 bits (same grammar, some Ragel version).

The most common cause for this is a cast to a long or unsigned long,
where size_t should be used.



From graceindustries at gmail.com  Tue Apr 14 11:57:29 2009
From: graceindustries at gmail.com (Bob Paddock)
Date: Tue, 14 Apr 2009 07:57:29 -0400
Subject: [ragel-users] Patches to avoid build_parsers=yes/no change at
	dist
In-Reply-To: <49E3F591.5030607@complang.org>
References: <1239368159.13660.365.camel@localhost>
	<49E3F591.5030607@complang.org>
Message-ID: <a3aee9a50904140457g41de7ab8jfe4829eebd9276fb@mail.gmail.com>

On Mon, Apr 13, 2009 at 10:31 PM, Adrian Thurston <thurston at complang.org> wrote:
> Hmmm, I'd rather it never rebuild in the dist unless asked for. Since
> there are many different incompatible versions of Ragel, successful
> compilation will depend on what previous version you have installed. Say
> you have version four installed

I still have version 1.52, from 2003, installed for one application.
Once our software has going through
a validation cycle the tools don't change, unless there is a compleing
reason to do so.  Obviously new applications get the new versions.

Using NTFS Junctions can help with the differing version issue on Windows,
like sym-links on other systems.



From ragel at zevv.nl  Fri Apr 17 14:24:46 2009
From: ragel at zevv.nl (Ico)
Date: Fri, 17 Apr 2009 16:24:46 +0200
Subject: [ragel-users] Reading from stream instead of buffer
Message-ID: <20090417142446.GD32208@pruts.nl>


Hello List,

Tody I discoverd Ragel, and I'm trying to create a small parser for
reading a binary protocol. The databytes are read from a serial port,
and only the parser will know when packets are complete. This makes it
hard to read data into a buffer first, since the underlying code does
not have any protocol knowledge.

Is there a way to make ragel read bytes from a stream, e.g. instead of
using the *p and *pe pointers, I'd like to have a function called by
ragel to receive data from the serial drivere, similar to the ANSI C
getchar() function.

Regards,

Ico

-- 
:wq
^X^Cy^K^X^C^C^C^C



From thurston at complang.org  Sat Apr 18 17:03:51 2009
From: thurston at complang.org (Adrian Thurston)
Date: Sat, 18 Apr 2009 13:03:51 -0400
Subject: [ragel-users] terminate called after throwing an instance of
 'std::bad_alloc'
In-Reply-To: <cc1f582e0904140147k5f049961r2ba9948dc972ad32@mail.gmail.com>
References: <200904062108.49010.ibc@aliax.net>
	<49DD5D28.20100@complang.org>	<cc1f582e0904090407h696b5cd5wba0f700d4f1f65e6@mail.gmail.com>	<49E3F128.8080008@complang.org>	<cc1f582e0904140142n73c264aelb98ce4a0c6dc1a89@mail.gmail.com>
	<cc1f582e0904140147k5f049961r2ba9948dc972ad32@mail.gmail.com>
Message-ID: <49EA07F7.7040404@complang.org>

Do you mind sharing the grammar with me off list? I'd like to track down 
the issue.

-Adrian

IÃ±aki Baz Castillo wrote:
> 2009/4/14 IÃ±aki Baz Castillo <ibc at aliax.net>:
>> 2009/4/14 Adrian Thurston <thurston at complang.org>:
>>> Try using -T0. My guess is that the alphabet size is large and the
>>> allocation of tables is eating up too much memory.
>> If so, is it a bug or a problem in my grammar?
>>
>> ~# ragel -T0 -R sip_parser.rl -o sip_parser.rb
>> ragel: rubycodegen.cpp:372: std::string RubyCodeGen::WIDE_ALPH_TYPE():
>> Assertion `wideType != 0' failed.
> 
> PD: Note that it worked fine in 32 bits (same grammar, some Ragel version).
> 
> 
> 



From thurston at complang.org  Sat Apr 18 17:13:14 2009
From: thurston at complang.org (Adrian Thurston)
Date: Sat, 18 Apr 2009 13:13:14 -0400
Subject: [ragel-users] Reading from stream instead of buffer
In-Reply-To: <20090417142446.GD32208@pruts.nl>
References: <20090417142446.GD32208@pruts.nl>
Message-ID: <49EA0A2A.7050104@complang.org>

You can execute on one character at a time.

while (true)
{
     int c = getchar();
     if ( c == EOF )
         break;

     char cv = c;
     char *p = &cv;
     char *pe = p + 1;

     %%write exec;
}

-Adrian

Ico wrote:
> Hello List,
> 
> Tody I discoverd Ragel, and I'm trying to create a small parser for
> reading a binary protocol. The databytes are read from a serial port,
> and only the parser will know when packets are complete. This makes it
> hard to read data into a buffer first, since the underlying code does
> not have any protocol knowledge.
> 
> Is there a way to make ragel read bytes from a stream, e.g. instead of
> using the *p and *pe pointers, I'd like to have a function called by
> ragel to receive data from the serial drivere, similar to the ANSI C
> getchar() function.
> 
> Regards,
> 
> Ico
> 



From thurston at complang.org  Sat Apr 18 18:19:34 2009
From: thurston at complang.org (Adrian Thurston)
Date: Sat, 18 Apr 2009 14:19:34 -0400
Subject: [ragel-users] Patches to avoid build_parsers=yes/no change at
 dist
In-Reply-To: <1239368159.13660.365.camel@localhost>
References: <1239368159.13660.365.camel@localhost>
Message-ID: <49EA19B6.7090604@complang.org>

I have a new solution: use the dist-hook like before but this time use 
"cp -p" and "touch -r" to reset the modified times of the configure.in 
and configure files after they are modified. This fixes the reconfigure 
on make issue from before.

I don't think these options are portable to older UNIX systems but my 
rationale is that "make dist" is a maintainer command anyways, and it 
isn't necessary to use it just to get ragel built and working on an 
older system.

-Adrian

Diego E. âFlameeyesâ PettenÃ² wrote:
> Just as a proof of concept now, I haven't converted the manual to the
> same effect, just the parsers regeneration.
> 
> The two attached patches (from git-svn) use the same technique I used
> for feng to make ragel an optional dependency for users but a mandatory
> one for developers: if the generated files are missing, and either ragel
> or kelbt cannot be found, the configure is aborted; if both are found,
> whether the generated files exist or not, parsers regeneration is
> enabled.
> 
> If this is acceptable I can make the same change to the manual
> regeneration; otherwise I can add a ./configure option so that the
> rebuild only happens if the files don't exist _or_ if an option is
> provided to the ./configure call.
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From ibc at aliax.net  Sat Apr 18 19:55:24 2009
From: ibc at aliax.net (=?utf-8?q?I=C3=B1aki_Baz_Castillo?=)
Date: Sat, 18 Apr 2009 21:55:24 +0200
Subject: [ragel-users] terminate called after throwing an instance of
	'std::bad_alloc'
In-Reply-To: <49EA07F7.7040404@complang.org>
References: <200904062108.49010.ibc@aliax.net>
	<cc1f582e0904140147k5f049961r2ba9948dc972ad32@mail.gmail.com>
	<49EA07F7.7040404@complang.org>
Message-ID: <200904182155.24663.ibc@aliax.net>

El SÃ¡bado, 18 de Abril de 2009, Adrian Thurston escribiÃ³:
> Do you mind sharing the grammar with me off list? I'd like to track down
> the issue.

Sure, sent to your private mail.

Thanks.


-- 
IÃ±aki Baz Castillo <ibc at aliax.net>



From ragel at zevv.nl  Sat Apr 18 20:16:59 2009
From: ragel at zevv.nl (Ico)
Date: Sat, 18 Apr 2009 22:16:59 +0200
Subject: [ragel-users] Reading from stream instead of buffer
In-Reply-To: <49EA0A2A.7050104@complang.org>
References: <20090417142446.GD32208@pruts.nl> <49EA0A2A.7050104@complang.org>
Message-ID: <20090418201659.GH32208@pruts.nl>


* On 2009-04-18 Adrian Thurston <thurston at complang.org> wrote  :

> You can execute on one character at a time.
> 
> while (true)
> {
>      int c = getchar();
>      if ( c == EOF )
>          break;
> 
>      char cv = c;
>      char *p = &cv;
>      char *pe = p + 1;
> 
>      %%write exec;
> }

Ah yes, I figured this out eventually, but I was bitten by using the
wrong alphtype which caused me other troubles.

Thank you,

Ico

-- 
:wq
^X^Cy^K^X^C^C^C^C



From ragel at zevv.nl  Sun Apr 19 17:46:48 2009
From: ragel at zevv.nl (Ico)
Date: Sun, 19 Apr 2009 19:46:48 +0200
Subject: [ragel-users] Thank you!
Message-ID: <20090419174648.GK32208@pruts.nl>


Just a short note to thank you for this great tool. I was able to learn
enough about Ragel in just a day to fit it into a few ongoing projects
and efficiently solve a few nasty old problems. I'm sure this wonderful
utility will be saving me a lot of time and headaches in the future as
well. Thanks for making this available !

Ico

-- 
:wq
^X^Cy^K^X^C^C^C^C



From plop at redbrick.dcu.ie  Mon Apr 20 21:45:22 2009
From: plop at redbrick.dcu.ie (Smelly Pooh)
Date: Mon, 20 Apr 2009 22:45:22 +0100
Subject: [ragel-users] Searching a buffer
Message-ID: <3703f4460904201445n1b3b8a36g4603dc29c91561c3@mail.gmail.com>

Hi,

What's the best way to search a buffer for a list of patterns using ragel?

I've tried:

search = A | B | C;

main := any* search;

which works ok but generates a lot of states.

I've also tried using a scanner like:

main := |*
    A;
    B;
    C;
    any;
*|;

which also works and generates much fewer states, but I'm not interested in
writing extra code to handle te, ts, eof etc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.colm.net/pipermail/ragel/attachments/20090420/03e278c4/attachment.html>

From prak at mac.com  Mon Apr 20 22:26:11 2009
From: prak at mac.com (Pramukta Kumar)
Date: Mon, 20 Apr 2009 18:26:11 -0400
Subject: [ragel-users] ragel scanner construct question
Message-ID: <7237ED89-02DB-4E89-9D1D-5644AA7473F5@mac.com>

I am experimenting with ragel to validate and tokenize an algebraic  
expression in one step.  Basically convert something like "3 + A * 2 /  
( 1 - 5 )" to "[3.0, 'A' , 2.0, :*, 1.0, 5.0, :-, :/, :+]" if it's  
valid, and throw an error otherwise. I'm using the ruby target, and  
the standard "shunting yard" algorithm or whatever.

I have the thing working (I think, still testing) by using the scanner  
construct and making an "allowed transition" table by hand.  Each of  
the tokenizing actions validates against this table to see whether it  
should continue.  It seems to me that there is probably a nice way to  
do this within ragel itself but I can't seem to figure it out.  Can  
somebody point me in the right direction?

the files are up on github: http://github.com/prakatmac/expression-parser/tree/master

Sorry if this is a dumb question.  I'm pretty new at this stuff.   
Thanks.

~pramukta



From thurston at complang.org  Mon Apr 20 23:06:35 2009
From: thurston at complang.org (Adrian Thurston)
Date: Mon, 20 Apr 2009 19:06:35 -0400
Subject: [ragel-users] Thank you!
In-Reply-To: <20090419174648.GK32208@pruts.nl>
References: <20090419174648.GK32208@pruts.nl>
Message-ID: <49ECFFFB.2050901@complang.org>

My Pleasure!

Cheers,
  Adrian

Ico wrote:
> Just a short note to thank you for this great tool. I was able to learn
> enough about Ragel in just a day to fit it into a few ongoing projects
> and efficiently solve a few nasty old problems. I'm sure this wonderful
> utility will be saving me a lot of time and headaches in the future as
> well. Thanks for making this available !
> 
> Ico
> 



From thurston at complang.org  Mon Apr 20 23:10:17 2009
From: thurston at complang.org (Adrian Thurston)
Date: Mon, 20 Apr 2009 19:10:17 -0400
Subject: [ragel-users] Searching a buffer
In-Reply-To: <3703f4460904201445n1b3b8a36g4603dc29c91561c3@mail.gmail.com>
References: <3703f4460904201445n1b3b8a36g4603dc29c91561c3@mail.gmail.com>
Message-ID: <49ED00D9.2080901@complang.org>

There's no best way, you just have to choose one that works for you. The 
alternative to the two methods you tried is to manually run the machine 
( A | B | C ) at every position in the input. As soon as it fails it 
will stop so you won't get N^2 running time. This is very much like 
using a scanner. You'll have to keep data around though. You can't do 
that on one pass of the data for the same reason you need to do some 
management of ts, te, etc. for a scanner.

-Adrian

Smelly Pooh wrote:
> Hi,
> 
> What's the best way to search a buffer for a list of patterns using ragel?
> 
> I've tried:
> 
> search = A | B | C;
> 
> main := any* search;
> 
> which works ok but generates a lot of states.
> 
> I've also tried using a scanner like:
> 
> main := |*
>     A;
>     B;
>     C;
>     any;
> *|;
> 
> which also works and generates much fewer states, but I'm not interested 
> in writing extra code to handle te, ts, eof etc.
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From thurston at complang.org  Mon Apr 20 23:16:32 2009
From: thurston at complang.org (Adrian Thurston)
Date: Mon, 20 Apr 2009 19:16:32 -0400
Subject: [ragel-users] ragel scanner construct question
In-Reply-To: <7237ED89-02DB-4E89-9D1D-5644AA7473F5@mac.com>
References: <7237ED89-02DB-4E89-9D1D-5644AA7473F5@mac.com>
Message-ID: <49ED0250.90202@complang.org>

You can't do that in Ragel. To understand why you'll have to do some 
reading on context-free VS regular languages. Pick up a compiler book. 
It's a big topic.

-Adrian

Pramukta Kumar wrote:
> I am experimenting with ragel to validate and tokenize an algebraic  
> expression in one step.  Basically convert something like "3 + A * 2 /  
> ( 1 - 5 )" to "[3.0, 'A' , 2.0, :*, 1.0, 5.0, :-, :/, :+]" if it's  
> valid, and throw an error otherwise. I'm using the ruby target, and  
> the standard "shunting yard" algorithm or whatever.
> 
> I have the thing working (I think, still testing) by using the scanner  
> construct and making an "allowed transition" table by hand.  Each of  
> the tokenizing actions validates against this table to see whether it  
> should continue.  It seems to me that there is probably a nice way to  
> do this within ragel itself but I can't seem to figure it out.  Can  
> somebody point me in the right direction?
> 
> the files are up on github: http://github.com/prakatmac/expression-parser/tree/master
> 
> Sorry if this is a dumb question.  I'm pretty new at this stuff.   
> Thanks.
> 
> ~pramukta
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From prak at mac.com  Tue Apr 21 01:48:45 2009
From: prak at mac.com (Pramukta Kumar)
Date: Mon, 20 Apr 2009 21:48:45 -0400
Subject: [ragel-users] ragel scanner construct question
In-Reply-To: <49ED0250.90202@complang.org>
References: <7237ED89-02DB-4E89-9D1D-5644AA7473F5@mac.com>
	<49ED0250.90202@complang.org>
Message-ID: <A963245A-BA39-4BF2-87D0-61E03A0CB1E7@mac.com>

I understand that an algebraic expression can be described by a  
context free grammar and not by a regular grammar (I thought due to  
the recursive requirement).  However, i'm only referring to the  
validation of the next symbol.  All I want to express within ragel is  
that within the buffer, "2 3" shouldn't match since it doesn't make  
sense for a number to be directly followed by another number whereas  
"2 +" or "2 )" would make sense.  I can see doing this via the  
lookahead strategy you talk about in the manual, but that seems to be  
a little excessive.  It just seems like all I am making use of to  
implement this portion is a next-state table so it can't be so off the  
wall.  Am I still totally off the mark?

~pramukta

also, is the dragon book still the best place to look for this stuff?


On Apr 20, 2009, at 7:16 PM, Adrian Thurston wrote:

> You can't do that in Ragel. To understand why you'll have to do some
> reading on context-free VS regular languages. Pick up a compiler book.
> It's a big topic.
>
> -Adrian
>
> Pramukta Kumar wrote:
>> I am experimenting with ragel to validate and tokenize an algebraic
>> expression in one step.  Basically convert something like "3 + A *  
>> 2 /
>> ( 1 - 5 )" to "[3.0, 'A' , 2.0, :*, 1.0, 5.0, :-, :/, :+]" if it's
>> valid, and throw an error otherwise. I'm using the ruby target, and
>> the standard "shunting yard" algorithm or whatever.
>>
>> I have the thing working (I think, still testing) by using the  
>> scanner
>> construct and making an "allowed transition" table by hand.  Each of
>> the tokenizing actions validates against this table to see whether it
>> should continue.  It seems to me that there is probably a nice way to
>> do this within ragel itself but I can't seem to figure it out.  Can
>> somebody point me in the right direction?
>>
>> the files are up on github: http://github.com/prakatmac/expression-parser/tree/master
>>
>> Sorry if this is a dumb question.  I'm pretty new at this stuff.
>> Thanks.
>>
>> ~pramukta
>>
>> _______________________________________________
>> ragel-users mailing list
>> ragel-users at complang.org
>> http://www.complang.org/mailman/listinfo/ragel-users
>
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users




From thurston at complang.org  Tue Apr 21 02:10:52 2009
From: thurston at complang.org (Adrian Thurston)
Date: Mon, 20 Apr 2009 22:10:52 -0400
Subject: [ragel-users] ragel scanner construct question
In-Reply-To: <A963245A-BA39-4BF2-87D0-61E03A0CB1E7@mac.com>
References: <7237ED89-02DB-4E89-9D1D-5644AA7473F5@mac.com>	<49ED0250.90202@complang.org>
	<A963245A-BA39-4BF2-87D0-61E03A0CB1E7@mac.com>
Message-ID: <49ED2B2C.70304@complang.org>

Oh, my bad. In that case yes! You can do something like this.

word = [a-z];
number = [0-9];

token = word | number;
op = '+' | '-' | '*' | '\\';

OWS = [ \t\r\n]*;

main := OWS token OWS ( op OWS token OWS )*;

Pramukta Kumar wrote:
> I understand that an algebraic expression can be described by a  
> context free grammar and not by a regular grammar (I thought due to  
> the recursive requirement).  However, i'm only referring to the  
> validation of the next symbol.  All I want to express within ragel is  
> that within the buffer, "2 3" shouldn't match since it doesn't make  
> sense for a number to be directly followed by another number whereas  
> "2 +" or "2 )" would make sense.  I can see doing this via the  
> lookahead strategy you talk about in the manual, but that seems to be  
> a little excessive.  It just seems like all I am making use of to  
> implement this portion is a next-state table so it can't be so off the  
> wall.  Am I still totally off the mark?
> 
> ~pramukta
> 
> also, is the dragon book still the best place to look for this stuff?
> 
> 
> On Apr 20, 2009, at 7:16 PM, Adrian Thurston wrote:
> 
>> You can't do that in Ragel. To understand why you'll have to do some
>> reading on context-free VS regular languages. Pick up a compiler book.
>> It's a big topic.
>>
>> -Adrian
>>
>> Pramukta Kumar wrote:
>>> I am experimenting with ragel to validate and tokenize an algebraic
>>> expression in one step.  Basically convert something like "3 + A *  
>>> 2 /
>>> ( 1 - 5 )" to "[3.0, 'A' , 2.0, :*, 1.0, 5.0, :-, :/, :+]" if it's
>>> valid, and throw an error otherwise. I'm using the ruby target, and
>>> the standard "shunting yard" algorithm or whatever.
>>>
>>> I have the thing working (I think, still testing) by using the  
>>> scanner
>>> construct and making an "allowed transition" table by hand.  Each of
>>> the tokenizing actions validates against this table to see whether it
>>> should continue.  It seems to me that there is probably a nice way to
>>> do this within ragel itself but I can't seem to figure it out.  Can
>>> somebody point me in the right direction?
>>>
>>> the files are up on github: http://github.com/prakatmac/expression-parser/tree/master
>>>
>>> Sorry if this is a dumb question.  I'm pretty new at this stuff.
>>> Thanks.
>>>
>>> ~pramukta
>>>
>>> _______________________________________________
>>> ragel-users mailing list
>>> ragel-users at complang.org
>>> http://www.complang.org/mailman/listinfo/ragel-users
>> _______________________________________________
>> ragel-users mailing list
>> ragel-users at complang.org
>> http://www.complang.org/mailman/listinfo/ragel-users
> 
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From ich+lists at slashhome.de  Tue Apr 28 19:49:03 2009
From: ich+lists at slashhome.de (Jan Sporbeck)
Date: Tue, 28 Apr 2009 21:49:03 +0200
Subject: [ragel-users] Best practice: using ragel for bit-based state
	machines on	microcontroller?
Message-ID: <1240948143.28562.12.camel@my.sporbeck-family.de>

Hello there!

I'd like to use ragel to design the state machine for a microcontroller
project (avr atmega8535) written in C.

I think I understand how to use it for streams of char, int, etc. But
what's the best practice to use for bit based decisions?

I could use union..struct to pack all bits in one datatype and process
that. But I doubt that'll yield a performant implementation.

I read messages on this list that ragel is used for uC projects, but no
details how.

So any hints or example code to get me started is appreciated.

Thanks in advance,
/Jan.




From graceindustries at gmail.com  Wed Apr 29 17:51:18 2009
From: graceindustries at gmail.com (Bob Paddock)
Date: Wed, 29 Apr 2009 13:51:18 -0400
Subject: [ragel-users] Best practice: using ragel for bit-based state
	machines on microcontroller?
In-Reply-To: <1240948143.28562.12.camel@my.sporbeck-family.de>
References: <1240948143.28562.12.camel@my.sporbeck-family.de>
Message-ID: <a3aee9a50904291051yf384dre1bb56a8b6ef8858@mail.gmail.com>

On Tue, Apr 28, 2009 at 3:49 PM, Jan Sporbeck <ich+lists at slashhome.de> wrote:
> Hello there!
>
> I'd like to use ragel to design the state machine for a microcontroller
> project (avr atmega8535) written in C.
>
> I think I understand how to use it for streams of char, int, etc. But
> what's the best practice to use for bit based decisions?
>
> I could use union..struct to pack all bits in one datatype and process
> that. But I doubt that'll yield a performant implementation.

You don't have enough space in 8535 to do all of that.  Set each
byte as  bool in the struct.

> I read messages on this list that ragel is used for uC projects, but no
> details how.

Depends on the compiler.  If you are using GCC you have to use Ragel
in 'goto' format.  The tables will not work without futher processing.
This does make the code a lot larger.  It would be better to write the software
before you pick the processor, something with more memory is usually a better
choice, than the old 8535 parts.

If you are using the IAR compiler tables probably will work ok, don't
know for sure as I try to avoid IAR when I can.  Don't know the state
of Imagecraft's table handling today, been long time since I used them.

> So any hints or example code to get me started is appreciated.

Sorry, boss would not like me giveing out our code.



From chrsan at gmail.com  Fri Apr  3 07:55:12 2009
From: chrsan at gmail.com (Christer Sandberg)
Date: Fri, 3 Apr 2009 09:55:12 +0200
Subject: [ragel-users] A new project using Ragel
Message-ID: <13f6d2440904030055m511db405y5b289b03329e42e4@mail.gmail.com>

Hi!

I just wanted to inform you that I've just released a new open source
project using Ragel.
It's a Java implementation of the W3C Selectors Level 3 specification.
Have a look if it sounds
interesting. I'm kind of new to Ragel so tips and enhancement ideas
are most welcome.

Christer



From ribs at acm.org  Fri Apr  3 17:32:33 2009
From: ribs at acm.org (Larry Edelstein)
Date: Fri, 3 Apr 2009 10:32:33 -0700
Subject: [ragel-users] A new project using Ragel
In-Reply-To: <13f6d2440904030055m511db405y5b289b03329e42e4@mail.gmail.com>
References: <13f6d2440904030055m511db405y5b289b03329e42e4@mail.gmail.com>
Message-ID: <2021f8b20904031032v7ce2986eh2f8ffd3ba8fceaac@mail.gmail.com>

That does sound interesting - where can it be found?
-Larry

On Fri, Apr 3, 2009 at 12:55 AM, Christer Sandberg <chrsan at gmail.com> wrote:

> Hi!
>
> I just wanted to inform you that I've just released a new open source
> project using Ragel.
> It's a Java implementation of the W3C Selectors Level 3 specification.
> Have a look if it sounds
> interesting. I'm kind of new to Ragel so tips and enhancement ideas
> are most welcome.
>
> Christer
>
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.colm.net/pipermail/ragel-users/attachments/20090403/5886bd5e/attachment-0001.html>

From chrsan at gmail.com  Fri Apr  3 19:06:55 2009
From: chrsan at gmail.com (Christer Sandberg)
Date: Fri, 3 Apr 2009 21:06:55 +0200
Subject: [ragel-users] A new project using Ragel
In-Reply-To: <2021f8b20904031032v7ce2986eh2f8ffd3ba8fceaac@mail.gmail.com>
References: <13f6d2440904030055m511db405y5b289b03329e42e4@mail.gmail.com>
	<2021f8b20904031032v7ce2986eh2f8ffd3ba8fceaac@mail.gmail.com>
Message-ID: <13f6d2440904031206u43f7279et7874c2f721a95b9f@mail.gmail.com>

Oh sorry! I forgot the link to the project ;)

Here's the wiki page for the project and the source can be found there as well.

http://wiki.github.com/chrsan/css-selectors

/Christer

On Fri, Apr 3, 2009 at 7:32 PM, Larry Edelstein <ribs at acm.org> wrote:
> That does sound interesting - where can it be found?
> -Larry
>
> On Fri, Apr 3, 2009 at 12:55 AM, Christer Sandberg <chrsan at gmail.com> wrote:
>>
>> Hi!
>>
>> I just wanted to inform you that I've just released a new open source
>> project using Ragel.
>> It's a Java implementation of the W3C Selectors Level 3 specification.
>> Have a look if it sounds
>> interesting. I'm kind of new to Ragel so tips and enhancement ideas
>> are most welcome.
>>
>> Christer
>>
>> _______________________________________________
>> ragel-users mailing list
>> ragel-users at complang.org
>> http://www.complang.org/mailman/listinfo/ragel-users
>
>
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users
>
>



From thurston at complang.org  Sat Apr  4 21:34:09 2009
From: thurston at complang.org (Adrian Thurston)
Date: Sat, 04 Apr 2009 17:34:09 -0400
Subject: [ragel-users] ragel and automake
Message-ID: <49D7D251.4060805@complang.org>

So I managed to convert Ragel to automake. If there are any automake 
experts out there (Diego?) could you have a look at it for me to see if 
I munged anything up.

There's one thing I'm not too certain about. When I configure and make a 
tarball that has been created with 'make dist', the 'make' command 
causes the project to be reconfigured. The -d option to make reveals 
that it's because aclocal.m4 is out of date. If I touch aclocal.m4 then 
the reconfigure still happens because something becomes out of date with 
respect to aclocal.m4. There seems to be a circular dependency in the 
generated files. Anyone know if I'm doing something wrong?

-Adrian



From thurston at complang.org  Sat Apr  4 22:04:12 2009
From: thurston at complang.org (Adrian Thurston)
Date: Sat, 04 Apr 2009 18:04:12 -0400
Subject: [ragel-users] Autoconf/automake spport for Ragel
In-Reply-To: <1236856299.11830.61.camel@localhost>
References: <1236856299.11830.61.camel@localhost>
Message-ID: <49D7D95C.6020300@complang.org>

These are now in a new directory in ragel called 'contrib'.

-Adrian

Diego E. 'Flameeyes' PettenÃ² wrote:
> Hi everybody,
> 
> since I wrote these for a project I'm working on, I thought they might
> be useful to others too; they should be pretty generic and well suited
> for being integrated in other projects.
> 
> There are two macros, CHECK_RAGEL and CHECK_RAGEL_AM, the latter will
> enable the HAVE_RAGEL conditional, while the former will just do the
> autoconf check.
> 
> The macros both accept a single parameter, the relative path to a source
> file generated by Ragel (i.e.: the .c file not the .rl file) that can be
> checked to be present or not.
> 
> The make rule uses RAGELFLAGS to pass extra options to Ragel so the user
> is able to choose a different FSM implementation rather than the default
> -T0.
> 
> HTH,
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From thurston at complang.org  Sat Apr  4 22:15:48 2009
From: thurston at complang.org (Adrian Thurston)
Date: Sat, 04 Apr 2009 18:15:48 -0400
Subject: [ragel-users] A new project using Ragel
In-Reply-To: <13f6d2440904031206u43f7279et7874c2f721a95b9f@mail.gmail.com>
References: <13f6d2440904030055m511db405y5b289b03329e42e4@mail.gmail.com>	<2021f8b20904031032v7ce2986eh2f8ffd3ba8fceaac@mail.gmail.com>
	<13f6d2440904031206u43f7279et7874c2f721a95b9f@mail.gmail.com>
Message-ID: <49D7DC14.7080500@complang.org>

I just added a link. Thanks for the heads up :)

-Adrian

Christer Sandberg wrote:
> Oh sorry! I forgot the link to the project ;)
> 
> Here's the wiki page for the project and the source can be found there as well.
> 
> http://wiki.github.com/chrsan/css-selectors
> 
> /Christer
> 
> On Fri, Apr 3, 2009 at 7:32 PM, Larry Edelstein <ribs at acm.org> wrote:
>> That does sound interesting - where can it be found?
>> -Larry
>>
>> On Fri, Apr 3, 2009 at 12:55 AM, Christer Sandberg <chrsan at gmail.com> wrote:
>>> Hi!
>>>
>>> I just wanted to inform you that I've just released a new open source
>>> project using Ragel.
>>> It's a Java implementation of the W3C Selectors Level 3 specification.
>>> Have a look if it sounds
>>> interesting. I'm kind of new to Ragel so tips and enhancement ideas
>>> are most welcome.
>>>
>>> Christer
>>>
>>> _______________________________________________
>>> ragel-users mailing list
>>> ragel-users at complang.org
>>> http://www.complang.org/mailman/listinfo/ragel-users
>>
>> _______________________________________________
>> ragel-users mailing list
>> ragel-users at complang.org
>> http://www.complang.org/mailman/listinfo/ragel-users
>>
>>
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From chrsan at gmail.com  Sat Apr  4 22:32:35 2009
From: chrsan at gmail.com (Christer Sandberg)
Date: Sun, 5 Apr 2009 00:32:35 +0200
Subject: [ragel-users] A new project using Ragel
In-Reply-To: <49D7DC14.7080500@complang.org>
References: <13f6d2440904030055m511db405y5b289b03329e42e4@mail.gmail.com>
	<2021f8b20904031032v7ce2986eh2f8ffd3ba8fceaac@mail.gmail.com>
	<13f6d2440904031206u43f7279et7874c2f721a95b9f@mail.gmail.com>
	<49D7DC14.7080500@complang.org>
Message-ID: <13f6d2440904041532h554835fgdd8d166364a20c1e@mail.gmail.com>

No problem! My pleasure really :)

/Christer

On Sun, Apr 5, 2009 at 12:15 AM, Adrian Thurston <thurston at complang.org> wrote:
> I just added a link. Thanks for the heads up :)
>
> -Adrian
>
> Christer Sandberg wrote:
>> Oh sorry! I forgot the link to the project ;)
>>
>> Here's the wiki page for the project and the source can be found there as well.
>>
>> http://wiki.github.com/chrsan/css-selectors
>>
>> /Christer
>>
>> On Fri, Apr 3, 2009 at 7:32 PM, Larry Edelstein <ribs at acm.org> wrote:
>>> That does sound interesting - where can it be found?
>>> -Larry
>>>
>>> On Fri, Apr 3, 2009 at 12:55 AM, Christer Sandberg <chrsan at gmail.com> wrote:
>>>> Hi!
>>>>
>>>> I just wanted to inform you that I've just released a new open source
>>>> project using Ragel.
>>>> It's a Java implementation of the W3C Selectors Level 3 specification.
>>>> Have a look if it sounds
>>>> interesting. I'm kind of new to Ragel so tips and enhancement ideas
>>>> are most welcome.
>>>>
>>>> Christer
>>>>
>>>> _______________________________________________
>>>> ragel-users mailing list
>>>> ragel-users at complang.org
>>>> http://www.complang.org/mailman/listinfo/ragel-users
>>>
>>> _______________________________________________
>>> ragel-users mailing list
>>> ragel-users at complang.org
>>> http://www.complang.org/mailman/listinfo/ragel-users
>>>
>>>
>>
>> _______________________________________________
>> ragel-users mailing list
>> ragel-users at complang.org
>> http://www.complang.org/mailman/listinfo/ragel-users
>
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users
>



From ibc at aliax.net  Mon Apr  6 19:08:48 2009
From: ibc at aliax.net (=?utf-8?q?I=C3=B1aki_Baz_Castillo?=)
Date: Mon, 6 Apr 2009 21:08:48 +0200
Subject: [ragel-users] terminate called after throwing an instance of
	'std::bad_alloc'
Message-ID: <200904062108.49010.ibc@aliax.net>

I've changed nothing, except the fact that now I use Linux 64 bits.

Using Ragel 6.3.1 (Ubuntu Jaunty package) I get this error:

---------------
terminate called after throwing an instance of 'std::bad_alloc'
  what():  std::bad_alloc
ragel: rlgen-ruby did not exit normally
---------------

What does it mean?

-- 
IÃ±aki Baz Castillo <ibc at aliax.net>



From flameeyes at gmail.com  Mon Apr  6 23:59:29 2009
From: flameeyes at gmail.com (Diego E. =?UTF-8?Q?=E2=80=9CFlameeyes=E2=80=9D_?= =?ISO-8859-1?Q?Petten=F2?=)
Date: Tue, 07 Apr 2009 01:59:29 +0200
Subject: [ragel-users] ragel and automake
In-Reply-To: <49D7D251.4060805@complang.org>
References: <49D7D251.4060805@complang.org>
Message-ID: <1239062369.13660.239.camel@localhost>

On Sat, 2009-04-04 at 17:34 -0400, Adrian Thurston wrote:
> So I managed to convert Ragel to automake. If there are any automake 
> experts out there (Diego?) could you have a look at it for me to see
> if 
> I munged anything up.
> 
I've updated my local copy and will see to provide some patches for a
couple of side cases; I _think_ the reconfigure problem is the changes
in the dist-hook to change the configure script, so I'll try to provide
a different method to achieve the same, similarly to what I've done in
the ragel-checking macro.

The other day I was stopped in my steps because my semi-automatic
scripts failed, out-of-tree builds don't work and aren't easy to fix
because kelbt lacks a "-I" option to tell it where to find the included
files.

-- 
Diego Elio PettenÃ² â âFlameeyesâ
http://blog.flameeyes.eu/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 198 bytes
Desc: This is a digitally signed message part
URL: <http://www.colm.net/pipermail/ragel-users/attachments/20090407/d66b2927/attachment-0001.sig>

From thurston at complang.org  Thu Apr  9 02:27:52 2009
From: thurston at complang.org (Adrian Thurston)
Date: Wed, 08 Apr 2009 22:27:52 -0400
Subject: [ragel-users] terminate called after throwing an instance of
 'std::bad_alloc'
In-Reply-To: <200904062108.49010.ibc@aliax.net>
References: <200904062108.49010.ibc@aliax.net>
Message-ID: <49DD5D28.20100@complang.org>

That's a memory allocation error. My guess is that some allocation size 
is wrong due to some bad code with respect to 64bit. Could you provide 
the runtime options and a backtrace with gdb? First run ragel -x and 
then run the backend program manually with gdb.

Thanks,
  Adrian

IÃ±aki Baz Castillo wrote:
> I've changed nothing, except the fact that now I use Linux 64 bits.
> 
> Using Ragel 6.3.1 (Ubuntu Jaunty package) I get this error:
> 
> ---------------
> terminate called after throwing an instance of 'std::bad_alloc'
>   what():  std::bad_alloc
> ragel: rlgen-ruby did not exit normally
> ---------------
> 
> What does it mean?
> 



From thurston at complang.org  Thu Apr  9 02:30:52 2009
From: thurston at complang.org (Adrian Thurston)
Date: Wed, 08 Apr 2009 22:30:52 -0400
Subject: [ragel-users] ragel and automake
In-Reply-To: <1239062369.13660.239.camel@localhost>
References: <49D7D251.4060805@complang.org>
	<1239062369.13660.239.camel@localhost>
Message-ID: <49DD5DDC.8040805@complang.org>

The kelbt -I problem is noted.

In regards to the dist-hook, that seems to be it. I think I'll just 
modify the configure.in before running "make dist" in my release script. 
I was thinking I could get rid of the release script due to make dist, 
but I just realized I need it anyways to make the manual, sign the files 
and do a few other things.

-Adrian


Diego E. âFlameeyesâ PettenÃ² wrote:
> On Sat, 2009-04-04 at 17:34 -0400, Adrian Thurston wrote:
>> So I managed to convert Ragel to automake. If there are any automake 
>> experts out there (Diego?) could you have a look at it for me to see
>> if 
>> I munged anything up.
>>
> I've updated my local copy and will see to provide some patches for a
> couple of side cases; I _think_ the reconfigure problem is the changes
> in the dist-hook to change the configure script, so I'll try to provide
> a different method to achieve the same, similarly to what I've done in
> the ragel-checking macro.
> 
> The other day I was stopped in my steps because my semi-automatic
> scripts failed, out-of-tree builds don't work and aren't easy to fix
> because kelbt lacks a "-I" option to tell it where to find the included
> files.
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From ibc at aliax.net  Thu Apr  9 11:07:47 2009
From: ibc at aliax.net (=?UTF-8?Q?I=C3=B1aki_Baz_Castillo?=)
Date: Thu, 9 Apr 2009 13:07:47 +0200
Subject: [ragel-users] terminate called after throwing an instance of
	'std::bad_alloc'
In-Reply-To: <49DD5D28.20100@complang.org>
References: <200904062108.49010.ibc@aliax.net> <49DD5D28.20100@complang.org>
Message-ID: <cc1f582e0904090407h696b5cd5wba0f700d4f1f65e6@mail.gmail.com>

2009/4/9 Adrian Thurston <thurston at complang.org>:
> That's a memory allocation error. My guess is that some allocation size
> is wrong due to some bad code with respect to 64bit. Could you provide
> the runtime options and a backtrace with gdb? First run ragel -x and
> then run the backend program manually with gdb.

Thanks Adrian, but I'm not sure how to check it.

I've a Ragel grammar file in Ruby (sip_parser.rl). I compile it in
Debian Etch 64 bits with Ragel 6.4 installed from sources:

# ragel -F1 -R sip_parser.rl
terminate called after throwing an instance of 'std::bad_alloc'
  what():  St9bad_alloc
Aborted


# ragel -F1 -R sip_parser.rl -x
(I( get the internal XML)


But I don't know what you mean with "run the backend program manually
with gdb". I use gdb to debug coredumps in other programms, but have
no idea of what to do with it in this case.

Could you please indicate the steps I must perform? Thanks a lot.


PD: I've tryed this issue in two different Linux hosts both of 64 bits.


-- 
IÃ±aki Baz Castillo
<ibc at aliax.net>



From flameeyes at gmail.com  Fri Apr 10 12:55:59 2009
From: flameeyes at gmail.com (Diego E. =?UTF-8?Q?=E2=80=9CFlameeyes=E2=80=9D_?= =?ISO-8859-1?Q?Petten=F2?=)
Date: Fri, 10 Apr 2009 14:55:59 +0200
Subject: [ragel-users] Patches to avoid build_parsers=yes/no change at dist
Message-ID: <1239368159.13660.365.camel@localhost>

Just as a proof of concept now, I haven't converted the manual to the
same effect, just the parsers regeneration.

The two attached patches (from git-svn) use the same technique I used
for feng to make ragel an optional dependency for users but a mandatory
one for developers: if the generated files are missing, and either ragel
or kelbt cannot be found, the configure is aborted; if both are found,
whether the generated files exist or not, parsers regeneration is
enabled.

If this is acceptable I can make the same change to the manual
regeneration; otherwise I can add a ./configure option so that the
rebuild only happens if the files don't exist _or_ if an option is
provided to the ./configure call.

-- 
Diego Elio PettenÃ² â âFlameeyesâ
http://blog.flameeyes.eu/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-Don-t-refer-to-GIT-checkouts-directly.patch
Type: text/x-patch
Size: 786 bytes
Desc: not available
URL: <http://www.colm.net/pipermail/ragel-users/attachments/20090410/f181ca4e/attachment-0002.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0002-Don-t-use-a-static-switched-variable-to-regenerate-t.patch
Type: text/x-patch
Size: 4955 bytes
Desc: not available
URL: <http://www.colm.net/pipermail/ragel-users/attachments/20090410/f181ca4e/attachment-0003.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 198 bytes
Desc: This is a digitally signed message part
URL: <http://www.colm.net/pipermail/ragel-users/attachments/20090410/f181ca4e/attachment-0001.sig>

From max at darim.com  Mon Apr 13 10:04:19 2009
From: max at darim.com (Max Suraev)
Date: Mon, 13 Apr 2009 17:04:19 +0700
Subject: [ragel-users] eof error
Message-ID: <1239617059.8940.9.camel@x-desk>

Hello.

I'm trying to implement simple FSM describing protocol logic.

ragel gave me no errors and successfully compiled machine but I got
error from gcc while trying to compile resuls:
eof not defined.

Since I do not use such variable in .rl file I guess there is something
wrong with the way I use code generated by ragel.

Could you please take a look and point towards possible error?

Machine is quite simple (3 states, actions are just stubs doing nothing
but printing) so I'm pretty much stuck at this point.

Any general critics\recommendations are more than welcome.

best regards,
Max.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: enum_fsm.rl
Type: text/x-csrc
Size: 2004 bytes
Desc: not available
URL: <http://www.colm.net/pipermail/ragel-users/attachments/20090413/ae211600/attachment-0001.c>

From thurston at complang.org  Tue Apr 14 02:12:56 2009
From: thurston at complang.org (Adrian Thurston)
Date: Mon, 13 Apr 2009 22:12:56 -0400
Subject: [ragel-users] terminate called after throwing an instance of
 'std::bad_alloc'
In-Reply-To: <cc1f582e0904090407h696b5cd5wba0f700d4f1f65e6@mail.gmail.com>
References: <200904062108.49010.ibc@aliax.net> <49DD5D28.20100@complang.org>
	<cc1f582e0904090407h696b5cd5wba0f700d4f1f65e6@mail.gmail.com>
Message-ID: <49E3F128.8080008@complang.org>

Try using -T0. My guess is that the alphabet size is large and the 
allocation of tables is eating up too much memory.

To confirm you can run:

ragel -F -R -x sip_parser.rl > out.xml
rlgen-ruby out.xml

-Adrian



IÃ±aki Baz Castillo wrote:
> 2009/4/9 Adrian Thurston <thurston at complang.org>:
>> That's a memory allocation error. My guess is that some allocation size
>> is wrong due to some bad code with respect to 64bit. Could you provide
>> the runtime options and a backtrace with gdb? First run ragel -x and
>> then run the backend program manually with gdb.
> 
> Thanks Adrian, but I'm not sure how to check it.
> 
> I've a Ragel grammar file in Ruby (sip_parser.rl). I compile it in
> Debian Etch 64 bits with Ragel 6.4 installed from sources:
> 
> # ragel -F1 -R sip_parser.rl
> terminate called after throwing an instance of 'std::bad_alloc'
>   what():  St9bad_alloc
> Aborted
> 
> 
> # ragel -F1 -R sip_parser.rl -x
> (I( get the internal XML)
> 
> 
> But I don't know what you mean with "run the backend program manually
> with gdb". I use gdb to debug coredumps in other programms, but have
> no idea of what to do with it in this case.
> 
> Could you please indicate the steps I must perform? Thanks a lot.
> 
> 
> PD: I've tryed this issue in two different Linux hosts both of 64 bits.
> 
> 



From thurston at complang.org  Tue Apr 14 02:31:45 2009
From: thurston at complang.org (Adrian Thurston)
Date: Mon, 13 Apr 2009 22:31:45 -0400
Subject: [ragel-users] Patches to avoid build_parsers=yes/no change at
 dist
In-Reply-To: <1239368159.13660.365.camel@localhost>
References: <1239368159.13660.365.camel@localhost>
Message-ID: <49E3F591.5030607@complang.org>

Hmmm, I'd rather it never rebuild in the dist unless asked for. Since 
there are many different incompatible versions of Ragel, successful 
compilation will depend on what previous version you have installed. Say 
you have version four installed and you want to upgrade to version six 
then your build will fail because six's parsers can't be built with 
version four of Ragel.

-Adrian

Diego E. âFlameeyesâ PettenÃ² wrote:
> Just as a proof of concept now, I haven't converted the manual to the
> same effect, just the parsers regeneration.
> 
> The two attached patches (from git-svn) use the same technique I used
> for feng to make ragel an optional dependency for users but a mandatory
> one for developers: if the generated files are missing, and either ragel
> or kelbt cannot be found, the configure is aborted; if both are found,
> whether the generated files exist or not, parsers regeneration is
> enabled.
> 
> If this is acceptable I can make the same change to the manual
> regeneration; otherwise I can add a ./configure option so that the
> rebuild only happens if the files don't exist _or_ if an option is
> provided to the ./configure call.
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From thurston at complang.org  Tue Apr 14 03:00:05 2009
From: thurston at complang.org (Adrian Thurston)
Date: Mon, 13 Apr 2009 23:00:05 -0400
Subject: [ragel-users] eof error
In-Reply-To: <1239617059.8940.9.camel@x-desk>
References: <1239617059.8940.9.camel@x-desk>
Message-ID: <49E3FC35.1080308@complang.org>

Hi Max,

No error, you just need to supply eof since there is a final state with 
an action to execute on the EOF event. In this case it's caused by the 
error action in the Enumerator machine and would also be caused by the 
leaving action applied to Enumerator if Enumerator had any final states. 
You just need to tell Ragel when it's got to the end of the input by 
setting char *eof = pe.

-Adrian

Max Suraev wrote:
> Hello.
> 
> I'm trying to implement simple FSM describing protocol logic.
> 
> ragel gave me no errors and successfully compiled machine but I got
> error from gcc while trying to compile resuls:
> eof not defined.
> 
> Since I do not use such variable in .rl file I guess there is something
> wrong with the way I use code generated by ragel.
> 
> Could you please take a look and point towards possible error?
> 
> Machine is quite simple (3 states, actions are just stubs doing nothing
> but printing) so I'm pretty much stuck at this point.
> 
> Any general critics\recommendations are more than welcome.
> 
> best regards,
> Max.
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From ibc at aliax.net  Tue Apr 14 08:42:05 2009
From: ibc at aliax.net (=?UTF-8?Q?I=C3=B1aki_Baz_Castillo?=)
Date: Tue, 14 Apr 2009 10:42:05 +0200
Subject: [ragel-users] terminate called after throwing an instance of
	'std::bad_alloc'
In-Reply-To: <49E3F128.8080008@complang.org>
References: <200904062108.49010.ibc@aliax.net> <49DD5D28.20100@complang.org>
	<cc1f582e0904090407h696b5cd5wba0f700d4f1f65e6@mail.gmail.com>
	<49E3F128.8080008@complang.org>
Message-ID: <cc1f582e0904140142n73c264aelb98ce4a0c6dc1a89@mail.gmail.com>

2009/4/14 Adrian Thurston <thurston at complang.org>:
> Try using -T0. My guess is that the alphabet size is large and the
> allocation of tables is eating up too much memory.

If so, is it a bug or a problem in my grammar?

~# ragel -T0 -R sip_parser.rl -o sip_parser.rb
ragel: rubycodegen.cpp:372: std::string RubyCodeGen::WIDE_ALPH_TYPE():
Assertion `wideType != 0' failed.


> To confirm you can run:
>
> ragel -F -R -x sip_parser.rl > out.xml
> rlgen-ruby out.xml

After compiling Ragel 6.4 I have no rlgen-XXXX command.

-- 
IÃ±aki Baz Castillo
<ibc at aliax.net>



From ibc at aliax.net  Tue Apr 14 08:47:51 2009
From: ibc at aliax.net (=?UTF-8?Q?I=C3=B1aki_Baz_Castillo?=)
Date: Tue, 14 Apr 2009 10:47:51 +0200
Subject: [ragel-users] terminate called after throwing an instance of
	'std::bad_alloc'
In-Reply-To: <cc1f582e0904140142n73c264aelb98ce4a0c6dc1a89@mail.gmail.com>
References: <200904062108.49010.ibc@aliax.net> <49DD5D28.20100@complang.org>
	<cc1f582e0904090407h696b5cd5wba0f700d4f1f65e6@mail.gmail.com>
	<49E3F128.8080008@complang.org>
	<cc1f582e0904140142n73c264aelb98ce4a0c6dc1a89@mail.gmail.com>
Message-ID: <cc1f582e0904140147k5f049961r2ba9948dc972ad32@mail.gmail.com>

2009/4/14 IÃ±aki Baz Castillo <ibc at aliax.net>:
> 2009/4/14 Adrian Thurston <thurston at complang.org>:
>> Try using -T0. My guess is that the alphabet size is large and the
>> allocation of tables is eating up too much memory.
>
> If so, is it a bug or a problem in my grammar?
>
> ~# ragel -T0 -R sip_parser.rl -o sip_parser.rb
> ragel: rubycodegen.cpp:372: std::string RubyCodeGen::WIDE_ALPH_TYPE():
> Assertion `wideType != 0' failed.

PD: Note that it worked fine in 32 bits (same grammar, some Ragel version).



-- 
IÃ±aki Baz Castillo
<ibc at aliax.net>



From graceindustries at gmail.com  Tue Apr 14 11:50:47 2009
From: graceindustries at gmail.com (Bob Paddock)
Date: Tue, 14 Apr 2009 07:50:47 -0400
Subject: [ragel-users] terminate called after throwing an instance of
	'std::bad_alloc'
In-Reply-To: <cc1f582e0904140147k5f049961r2ba9948dc972ad32@mail.gmail.com>
References: <200904062108.49010.ibc@aliax.net> <49DD5D28.20100@complang.org>
	<cc1f582e0904090407h696b5cd5wba0f700d4f1f65e6@mail.gmail.com>
	<49E3F128.8080008@complang.org>
	<cc1f582e0904140142n73c264aelb98ce4a0c6dc1a89@mail.gmail.com>
	<cc1f582e0904140147k5f049961r2ba9948dc972ad32@mail.gmail.com>
Message-ID: <a3aee9a50904140450s3621442ara9ac427fa2f284b7@mail.gmail.com>

> PD: Note that it worked fine in 32 bits (same grammar, some Ragel version).

The most common cause for this is a cast to a long or unsigned long,
where size_t should be used.



From graceindustries at gmail.com  Tue Apr 14 11:57:29 2009
From: graceindustries at gmail.com (Bob Paddock)
Date: Tue, 14 Apr 2009 07:57:29 -0400
Subject: [ragel-users] Patches to avoid build_parsers=yes/no change at
	dist
In-Reply-To: <49E3F591.5030607@complang.org>
References: <1239368159.13660.365.camel@localhost>
	<49E3F591.5030607@complang.org>
Message-ID: <a3aee9a50904140457g41de7ab8jfe4829eebd9276fb@mail.gmail.com>

On Mon, Apr 13, 2009 at 10:31 PM, Adrian Thurston <thurston at complang.org> wrote:
> Hmmm, I'd rather it never rebuild in the dist unless asked for. Since
> there are many different incompatible versions of Ragel, successful
> compilation will depend on what previous version you have installed. Say
> you have version four installed

I still have version 1.52, from 2003, installed for one application.
Once our software has going through
a validation cycle the tools don't change, unless there is a compleing
reason to do so.  Obviously new applications get the new versions.

Using NTFS Junctions can help with the differing version issue on Windows,
like sym-links on other systems.



From ragel at zevv.nl  Fri Apr 17 14:24:46 2009
From: ragel at zevv.nl (Ico)
Date: Fri, 17 Apr 2009 16:24:46 +0200
Subject: [ragel-users] Reading from stream instead of buffer
Message-ID: <20090417142446.GD32208@pruts.nl>


Hello List,

Tody I discoverd Ragel, and I'm trying to create a small parser for
reading a binary protocol. The databytes are read from a serial port,
and only the parser will know when packets are complete. This makes it
hard to read data into a buffer first, since the underlying code does
not have any protocol knowledge.

Is there a way to make ragel read bytes from a stream, e.g. instead of
using the *p and *pe pointers, I'd like to have a function called by
ragel to receive data from the serial drivere, similar to the ANSI C
getchar() function.

Regards,

Ico

-- 
:wq
^X^Cy^K^X^C^C^C^C



From thurston at complang.org  Sat Apr 18 17:03:51 2009
From: thurston at complang.org (Adrian Thurston)
Date: Sat, 18 Apr 2009 13:03:51 -0400
Subject: [ragel-users] terminate called after throwing an instance of
 'std::bad_alloc'
In-Reply-To: <cc1f582e0904140147k5f049961r2ba9948dc972ad32@mail.gmail.com>
References: <200904062108.49010.ibc@aliax.net>
	<49DD5D28.20100@complang.org>	<cc1f582e0904090407h696b5cd5wba0f700d4f1f65e6@mail.gmail.com>	<49E3F128.8080008@complang.org>	<cc1f582e0904140142n73c264aelb98ce4a0c6dc1a89@mail.gmail.com>
	<cc1f582e0904140147k5f049961r2ba9948dc972ad32@mail.gmail.com>
Message-ID: <49EA07F7.7040404@complang.org>

Do you mind sharing the grammar with me off list? I'd like to track down 
the issue.

-Adrian

IÃ±aki Baz Castillo wrote:
> 2009/4/14 IÃ±aki Baz Castillo <ibc at aliax.net>:
>> 2009/4/14 Adrian Thurston <thurston at complang.org>:
>>> Try using -T0. My guess is that the alphabet size is large and the
>>> allocation of tables is eating up too much memory.
>> If so, is it a bug or a problem in my grammar?
>>
>> ~# ragel -T0 -R sip_parser.rl -o sip_parser.rb
>> ragel: rubycodegen.cpp:372: std::string RubyCodeGen::WIDE_ALPH_TYPE():
>> Assertion `wideType != 0' failed.
> 
> PD: Note that it worked fine in 32 bits (same grammar, some Ragel version).
> 
> 
> 



From thurston at complang.org  Sat Apr 18 17:13:14 2009
From: thurston at complang.org (Adrian Thurston)
Date: Sat, 18 Apr 2009 13:13:14 -0400
Subject: [ragel-users] Reading from stream instead of buffer
In-Reply-To: <20090417142446.GD32208@pruts.nl>
References: <20090417142446.GD32208@pruts.nl>
Message-ID: <49EA0A2A.7050104@complang.org>

You can execute on one character at a time.

while (true)
{
     int c = getchar();
     if ( c == EOF )
         break;

     char cv = c;
     char *p = &cv;
     char *pe = p + 1;

     %%write exec;
}

-Adrian

Ico wrote:
> Hello List,
> 
> Tody I discoverd Ragel, and I'm trying to create a small parser for
> reading a binary protocol. The databytes are read from a serial port,
> and only the parser will know when packets are complete. This makes it
> hard to read data into a buffer first, since the underlying code does
> not have any protocol knowledge.
> 
> Is there a way to make ragel read bytes from a stream, e.g. instead of
> using the *p and *pe pointers, I'd like to have a function called by
> ragel to receive data from the serial drivere, similar to the ANSI C
> getchar() function.
> 
> Regards,
> 
> Ico
> 



From thurston at complang.org  Sat Apr 18 18:19:34 2009
From: thurston at complang.org (Adrian Thurston)
Date: Sat, 18 Apr 2009 14:19:34 -0400
Subject: [ragel-users] Patches to avoid build_parsers=yes/no change at
 dist
In-Reply-To: <1239368159.13660.365.camel@localhost>
References: <1239368159.13660.365.camel@localhost>
Message-ID: <49EA19B6.7090604@complang.org>

I have a new solution: use the dist-hook like before but this time use 
"cp -p" and "touch -r" to reset the modified times of the configure.in 
and configure files after they are modified. This fixes the reconfigure 
on make issue from before.

I don't think these options are portable to older UNIX systems but my 
rationale is that "make dist" is a maintainer command anyways, and it 
isn't necessary to use it just to get ragel built and working on an 
older system.

-Adrian

Diego E. âFlameeyesâ PettenÃ² wrote:
> Just as a proof of concept now, I haven't converted the manual to the
> same effect, just the parsers regeneration.
> 
> The two attached patches (from git-svn) use the same technique I used
> for feng to make ragel an optional dependency for users but a mandatory
> one for developers: if the generated files are missing, and either ragel
> or kelbt cannot be found, the configure is aborted; if both are found,
> whether the generated files exist or not, parsers regeneration is
> enabled.
> 
> If this is acceptable I can make the same change to the manual
> regeneration; otherwise I can add a ./configure option so that the
> rebuild only happens if the files don't exist _or_ if an option is
> provided to the ./configure call.
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From ibc at aliax.net  Sat Apr 18 19:55:24 2009
From: ibc at aliax.net (=?utf-8?q?I=C3=B1aki_Baz_Castillo?=)
Date: Sat, 18 Apr 2009 21:55:24 +0200
Subject: [ragel-users] terminate called after throwing an instance of
	'std::bad_alloc'
In-Reply-To: <49EA07F7.7040404@complang.org>
References: <200904062108.49010.ibc@aliax.net>
	<cc1f582e0904140147k5f049961r2ba9948dc972ad32@mail.gmail.com>
	<49EA07F7.7040404@complang.org>
Message-ID: <200904182155.24663.ibc@aliax.net>

El SÃ¡bado, 18 de Abril de 2009, Adrian Thurston escribiÃ³:
> Do you mind sharing the grammar with me off list? I'd like to track down
> the issue.

Sure, sent to your private mail.

Thanks.


-- 
IÃ±aki Baz Castillo <ibc at aliax.net>



From ragel at zevv.nl  Sat Apr 18 20:16:59 2009
From: ragel at zevv.nl (Ico)
Date: Sat, 18 Apr 2009 22:16:59 +0200
Subject: [ragel-users] Reading from stream instead of buffer
In-Reply-To: <49EA0A2A.7050104@complang.org>
References: <20090417142446.GD32208@pruts.nl> <49EA0A2A.7050104@complang.org>
Message-ID: <20090418201659.GH32208@pruts.nl>


* On 2009-04-18 Adrian Thurston <thurston at complang.org> wrote  :

> You can execute on one character at a time.
> 
> while (true)
> {
>      int c = getchar();
>      if ( c == EOF )
>          break;
> 
>      char cv = c;
>      char *p = &cv;
>      char *pe = p + 1;
> 
>      %%write exec;
> }

Ah yes, I figured this out eventually, but I was bitten by using the
wrong alphtype which caused me other troubles.

Thank you,

Ico

-- 
:wq
^X^Cy^K^X^C^C^C^C



From ragel at zevv.nl  Sun Apr 19 17:46:48 2009
From: ragel at zevv.nl (Ico)
Date: Sun, 19 Apr 2009 19:46:48 +0200
Subject: [ragel-users] Thank you!
Message-ID: <20090419174648.GK32208@pruts.nl>


Just a short note to thank you for this great tool. I was able to learn
enough about Ragel in just a day to fit it into a few ongoing projects
and efficiently solve a few nasty old problems. I'm sure this wonderful
utility will be saving me a lot of time and headaches in the future as
well. Thanks for making this available !

Ico

-- 
:wq
^X^Cy^K^X^C^C^C^C



From plop at redbrick.dcu.ie  Mon Apr 20 21:45:22 2009
From: plop at redbrick.dcu.ie (Smelly Pooh)
Date: Mon, 20 Apr 2009 22:45:22 +0100
Subject: [ragel-users] Searching a buffer
Message-ID: <3703f4460904201445n1b3b8a36g4603dc29c91561c3@mail.gmail.com>

Hi,

What's the best way to search a buffer for a list of patterns using ragel?

I've tried:

search = A | B | C;

main := any* search;

which works ok but generates a lot of states.

I've also tried using a scanner like:

main := |*
    A;
    B;
    C;
    any;
*|;

which also works and generates much fewer states, but I'm not interested in
writing extra code to handle te, ts, eof etc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.colm.net/pipermail/ragel-users/attachments/20090420/03e278c4/attachment-0001.html>

From prak at mac.com  Mon Apr 20 22:26:11 2009
From: prak at mac.com (Pramukta Kumar)
Date: Mon, 20 Apr 2009 18:26:11 -0400
Subject: [ragel-users] ragel scanner construct question
Message-ID: <7237ED89-02DB-4E89-9D1D-5644AA7473F5@mac.com>

I am experimenting with ragel to validate and tokenize an algebraic  
expression in one step.  Basically convert something like "3 + A * 2 /  
( 1 - 5 )" to "[3.0, 'A' , 2.0, :*, 1.0, 5.0, :-, :/, :+]" if it's  
valid, and throw an error otherwise. I'm using the ruby target, and  
the standard "shunting yard" algorithm or whatever.

I have the thing working (I think, still testing) by using the scanner  
construct and making an "allowed transition" table by hand.  Each of  
the tokenizing actions validates against this table to see whether it  
should continue.  It seems to me that there is probably a nice way to  
do this within ragel itself but I can't seem to figure it out.  Can  
somebody point me in the right direction?

the files are up on github: http://github.com/prakatmac/expression-parser/tree/master

Sorry if this is a dumb question.  I'm pretty new at this stuff.   
Thanks.

~pramukta



From thurston at complang.org  Mon Apr 20 23:06:35 2009
From: thurston at complang.org (Adrian Thurston)
Date: Mon, 20 Apr 2009 19:06:35 -0400
Subject: [ragel-users] Thank you!
In-Reply-To: <20090419174648.GK32208@pruts.nl>
References: <20090419174648.GK32208@pruts.nl>
Message-ID: <49ECFFFB.2050901@complang.org>

My Pleasure!

Cheers,
  Adrian

Ico wrote:
> Just a short note to thank you for this great tool. I was able to learn
> enough about Ragel in just a day to fit it into a few ongoing projects
> and efficiently solve a few nasty old problems. I'm sure this wonderful
> utility will be saving me a lot of time and headaches in the future as
> well. Thanks for making this available !
> 
> Ico
> 



From thurston at complang.org  Mon Apr 20 23:10:17 2009
From: thurston at complang.org (Adrian Thurston)
Date: Mon, 20 Apr 2009 19:10:17 -0400
Subject: [ragel-users] Searching a buffer
In-Reply-To: <3703f4460904201445n1b3b8a36g4603dc29c91561c3@mail.gmail.com>
References: <3703f4460904201445n1b3b8a36g4603dc29c91561c3@mail.gmail.com>
Message-ID: <49ED00D9.2080901@complang.org>

There's no best way, you just have to choose one that works for you. The 
alternative to the two methods you tried is to manually run the machine 
( A | B | C ) at every position in the input. As soon as it fails it 
will stop so you won't get N^2 running time. This is very much like 
using a scanner. You'll have to keep data around though. You can't do 
that on one pass of the data for the same reason you need to do some 
management of ts, te, etc. for a scanner.

-Adrian

Smelly Pooh wrote:
> Hi,
> 
> What's the best way to search a buffer for a list of patterns using ragel?
> 
> I've tried:
> 
> search = A | B | C;
> 
> main := any* search;
> 
> which works ok but generates a lot of states.
> 
> I've also tried using a scanner like:
> 
> main := |*
>     A;
>     B;
>     C;
>     any;
> *|;
> 
> which also works and generates much fewer states, but I'm not interested 
> in writing extra code to handle te, ts, eof etc.
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From thurston at complang.org  Mon Apr 20 23:16:32 2009
From: thurston at complang.org (Adrian Thurston)
Date: Mon, 20 Apr 2009 19:16:32 -0400
Subject: [ragel-users] ragel scanner construct question
In-Reply-To: <7237ED89-02DB-4E89-9D1D-5644AA7473F5@mac.com>
References: <7237ED89-02DB-4E89-9D1D-5644AA7473F5@mac.com>
Message-ID: <49ED0250.90202@complang.org>

You can't do that in Ragel. To understand why you'll have to do some 
reading on context-free VS regular languages. Pick up a compiler book. 
It's a big topic.

-Adrian

Pramukta Kumar wrote:
> I am experimenting with ragel to validate and tokenize an algebraic  
> expression in one step.  Basically convert something like "3 + A * 2 /  
> ( 1 - 5 )" to "[3.0, 'A' , 2.0, :*, 1.0, 5.0, :-, :/, :+]" if it's  
> valid, and throw an error otherwise. I'm using the ruby target, and  
> the standard "shunting yard" algorithm or whatever.
> 
> I have the thing working (I think, still testing) by using the scanner  
> construct and making an "allowed transition" table by hand.  Each of  
> the tokenizing actions validates against this table to see whether it  
> should continue.  It seems to me that there is probably a nice way to  
> do this within ragel itself but I can't seem to figure it out.  Can  
> somebody point me in the right direction?
> 
> the files are up on github: http://github.com/prakatmac/expression-parser/tree/master
> 
> Sorry if this is a dumb question.  I'm pretty new at this stuff.   
> Thanks.
> 
> ~pramukta
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From prak at mac.com  Tue Apr 21 01:48:45 2009
From: prak at mac.com (Pramukta Kumar)
Date: Mon, 20 Apr 2009 21:48:45 -0400
Subject: [ragel-users] ragel scanner construct question
In-Reply-To: <49ED0250.90202@complang.org>
References: <7237ED89-02DB-4E89-9D1D-5644AA7473F5@mac.com>
	<49ED0250.90202@complang.org>
Message-ID: <A963245A-BA39-4BF2-87D0-61E03A0CB1E7@mac.com>

I understand that an algebraic expression can be described by a  
context free grammar and not by a regular grammar (I thought due to  
the recursive requirement).  However, i'm only referring to the  
validation of the next symbol.  All I want to express within ragel is  
that within the buffer, "2 3" shouldn't match since it doesn't make  
sense for a number to be directly followed by another number whereas  
"2 +" or "2 )" would make sense.  I can see doing this via the  
lookahead strategy you talk about in the manual, but that seems to be  
a little excessive.  It just seems like all I am making use of to  
implement this portion is a next-state table so it can't be so off the  
wall.  Am I still totally off the mark?

~pramukta

also, is the dragon book still the best place to look for this stuff?


On Apr 20, 2009, at 7:16 PM, Adrian Thurston wrote:

> You can't do that in Ragel. To understand why you'll have to do some
> reading on context-free VS regular languages. Pick up a compiler book.
> It's a big topic.
>
> -Adrian
>
> Pramukta Kumar wrote:
>> I am experimenting with ragel to validate and tokenize an algebraic
>> expression in one step.  Basically convert something like "3 + A *  
>> 2 /
>> ( 1 - 5 )" to "[3.0, 'A' , 2.0, :*, 1.0, 5.0, :-, :/, :+]" if it's
>> valid, and throw an error otherwise. I'm using the ruby target, and
>> the standard "shunting yard" algorithm or whatever.
>>
>> I have the thing working (I think, still testing) by using the  
>> scanner
>> construct and making an "allowed transition" table by hand.  Each of
>> the tokenizing actions validates against this table to see whether it
>> should continue.  It seems to me that there is probably a nice way to
>> do this within ragel itself but I can't seem to figure it out.  Can
>> somebody point me in the right direction?
>>
>> the files are up on github: http://github.com/prakatmac/expression-parser/tree/master
>>
>> Sorry if this is a dumb question.  I'm pretty new at this stuff.
>> Thanks.
>>
>> ~pramukta
>>
>> _______________________________________________
>> ragel-users mailing list
>> ragel-users at complang.org
>> http://www.complang.org/mailman/listinfo/ragel-users
>
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users




From thurston at complang.org  Tue Apr 21 02:10:52 2009
From: thurston at complang.org (Adrian Thurston)
Date: Mon, 20 Apr 2009 22:10:52 -0400
Subject: [ragel-users] ragel scanner construct question
In-Reply-To: <A963245A-BA39-4BF2-87D0-61E03A0CB1E7@mac.com>
References: <7237ED89-02DB-4E89-9D1D-5644AA7473F5@mac.com>	<49ED0250.90202@complang.org>
	<A963245A-BA39-4BF2-87D0-61E03A0CB1E7@mac.com>
Message-ID: <49ED2B2C.70304@complang.org>

Oh, my bad. In that case yes! You can do something like this.

word = [a-z];
number = [0-9];

token = word | number;
op = '+' | '-' | '*' | '\\';

OWS = [ \t\r\n]*;

main := OWS token OWS ( op OWS token OWS )*;

Pramukta Kumar wrote:
> I understand that an algebraic expression can be described by a  
> context free grammar and not by a regular grammar (I thought due to  
> the recursive requirement).  However, i'm only referring to the  
> validation of the next symbol.  All I want to express within ragel is  
> that within the buffer, "2 3" shouldn't match since it doesn't make  
> sense for a number to be directly followed by another number whereas  
> "2 +" or "2 )" would make sense.  I can see doing this via the  
> lookahead strategy you talk about in the manual, but that seems to be  
> a little excessive.  It just seems like all I am making use of to  
> implement this portion is a next-state table so it can't be so off the  
> wall.  Am I still totally off the mark?
> 
> ~pramukta
> 
> also, is the dragon book still the best place to look for this stuff?
> 
> 
> On Apr 20, 2009, at 7:16 PM, Adrian Thurston wrote:
> 
>> You can't do that in Ragel. To understand why you'll have to do some
>> reading on context-free VS regular languages. Pick up a compiler book.
>> It's a big topic.
>>
>> -Adrian
>>
>> Pramukta Kumar wrote:
>>> I am experimenting with ragel to validate and tokenize an algebraic
>>> expression in one step.  Basically convert something like "3 + A *  
>>> 2 /
>>> ( 1 - 5 )" to "[3.0, 'A' , 2.0, :*, 1.0, 5.0, :-, :/, :+]" if it's
>>> valid, and throw an error otherwise. I'm using the ruby target, and
>>> the standard "shunting yard" algorithm or whatever.
>>>
>>> I have the thing working (I think, still testing) by using the  
>>> scanner
>>> construct and making an "allowed transition" table by hand.  Each of
>>> the tokenizing actions validates against this table to see whether it
>>> should continue.  It seems to me that there is probably a nice way to
>>> do this within ragel itself but I can't seem to figure it out.  Can
>>> somebody point me in the right direction?
>>>
>>> the files are up on github: http://github.com/prakatmac/expression-parser/tree/master
>>>
>>> Sorry if this is a dumb question.  I'm pretty new at this stuff.
>>> Thanks.
>>>
>>> ~pramukta
>>>
>>> _______________________________________________
>>> ragel-users mailing list
>>> ragel-users at complang.org
>>> http://www.complang.org/mailman/listinfo/ragel-users
>> _______________________________________________
>> ragel-users mailing list
>> ragel-users at complang.org
>> http://www.complang.org/mailman/listinfo/ragel-users
> 
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From ich+lists at slashhome.de  Tue Apr 28 19:49:03 2009
From: ich+lists at slashhome.de (Jan Sporbeck)
Date: Tue, 28 Apr 2009 21:49:03 +0200
Subject: [ragel-users] Best practice: using ragel for bit-based state
	machines on	microcontroller?
Message-ID: <1240948143.28562.12.camel@my.sporbeck-family.de>

Hello there!

I'd like to use ragel to design the state machine for a microcontroller
project (avr atmega8535) written in C.

I think I understand how to use it for streams of char, int, etc. But
what's the best practice to use for bit based decisions?

I could use union..struct to pack all bits in one datatype and process
that. But I doubt that'll yield a performant implementation.

I read messages on this list that ragel is used for uC projects, but no
details how.

So any hints or example code to get me started is appreciated.

Thanks in advance,
/Jan.




From graceindustries at gmail.com  Wed Apr 29 17:51:18 2009
From: graceindustries at gmail.com (Bob Paddock)
Date: Wed, 29 Apr 2009 13:51:18 -0400
Subject: [ragel-users] Best practice: using ragel for bit-based state
	machines on microcontroller?
In-Reply-To: <1240948143.28562.12.camel@my.sporbeck-family.de>
References: <1240948143.28562.12.camel@my.sporbeck-family.de>
Message-ID: <a3aee9a50904291051yf384dre1bb56a8b6ef8858@mail.gmail.com>

On Tue, Apr 28, 2009 at 3:49 PM, Jan Sporbeck <ich+lists at slashhome.de> wrote:
> Hello there!
>
> I'd like to use ragel to design the state machine for a microcontroller
> project (avr atmega8535) written in C.
>
> I think I understand how to use it for streams of char, int, etc. But
> what's the best practice to use for bit based decisions?
>
> I could use union..struct to pack all bits in one datatype and process
> that. But I doubt that'll yield a performant implementation.

You don't have enough space in 8535 to do all of that.  Set each
byte as  bool in the struct.

> I read messages on this list that ragel is used for uC projects, but no
> details how.

Depends on the compiler.  If you are using GCC you have to use Ragel
in 'goto' format.  The tables will not work without futher processing.
This does make the code a lot larger.  It would be better to write the software
before you pick the processor, something with more memory is usually a better
choice, than the old 8535 parts.

If you are using the IAR compiler tables probably will work ok, don't
know for sure as I try to avoid IAR when I can.  Don't know the state
of Imagecraft's table handling today, been long time since I used them.

> So any hints or example code to get me started is appreciated.

Sorry, boss would not like me giveing out our code.



