<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [ragel-users] [PATCH 1/6] Don't use AC_DEFINE to pass the commands for the compilers to the runtest script.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:ragel%40colm.net?Subject=Re%3A%20%5Bragel-users%5D%20%5BPATCH%201/6%5D%20Don%27t%20use%20AC_DEFINE%20to%20pass%20the%20commands%0A%20for%20the%20compilers%20to%20the%20runtest%20script.&In-Reply-To=%3C48EA4BD3.5010604%40cs.queensu.ca%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="000754.html">
   <LINK REL="Next"  HREF="000738.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[ragel-users] [PATCH 1/6] Don't use AC_DEFINE to pass the commands for the compilers to the runtest script.</H1>
    <B>Adrian Thurston</B> 
    <A HREF="mailto:ragel%40colm.net?Subject=Re%3A%20%5Bragel-users%5D%20%5BPATCH%201/6%5D%20Don%27t%20use%20AC_DEFINE%20to%20pass%20the%20commands%0A%20for%20the%20compilers%20to%20the%20runtest%20script.&In-Reply-To=%3C48EA4BD3.5010604%40cs.queensu.ca%3E"
       TITLE="[ragel-users] [PATCH 1/6] Don't use AC_DEFINE to pass the commands for the compilers to the runtest script.">thurs... at cs.queensu.ca
       </A><BR>
    <I>Mon Oct  6 17:33:07 UTC 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000754.html">[PATCH 1/6] Don't use AC_DEFINE to pass the commands for the	compilers to the runtest script.
</A></li>
        <LI>Next message: <A HREF="000738.html">[PATCH 2/6] Remove files generated by autotools.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#755">[ date ]</a>
              <a href="thread.html#755">[ thread ]</a>
              <a href="subject.html#755">[ subject ]</a>
              <a href="author.html#755">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Any reason? The effect of both approaches seems to be the same.

-Adrian

Diego 'Flameeyes' Petten√≤ wrote:
&gt;<i> Instead of parsing the config.h header from runtest, make it use
</I>&gt;<i> proper autoconf by generating it at the end of the configure run.
</I>&gt;<i> ---
</I>&gt;<i> 
</I>&gt;<i>  configure.in     |   28 +----
</I>&gt;<i>  test/runtests    |  320 ------------------------------------------------------
</I>&gt;<i>  test/runtests.in |  320 ++++++++++++++++++++++++++++++++++++++++++++++++++++++
</I>&gt;<i>  3 files changed, 327 insertions(+), 341 deletions(-)
</I>&gt;<i>  delete mode 100755 test/runtests
</I>&gt;<i>  create mode 100755 test/runtests.in
</I>&gt;<i> 
</I>&gt;<i> diff --git a/configure.in b/configure.in
</I>&gt;<i> index a257a70..cc25f2e 100644
</I>&gt;<i> --- a/configure.in
</I>&gt;<i> +++ b/configure.in
</I>&gt;<i> @@ -31,10 +31,6 @@ AC_PROG_CC
</I>&gt;<i>  AC_PROG_CXX
</I>&gt;<i>  AC_CHECK_TOOL(AR, ar)
</I>&gt;<i>  AC_PROG_RANLIB
</I>&gt;<i> -AC_DEFINE_UNQUOTED(CC,$CC)
</I>&gt;<i> -AC_DEFINE_UNQUOTED(CXX,$CXX)
</I>&gt;<i> -AC_DEFINE_UNQUOTED(AR,$AR)
</I>&gt;<i> -AC_DEFINE_UNQUOTED(RANLIB,$RANLIB)
</I>&gt;<i>  
</I>&gt;<i>  dnl Set test on c++ compiler.
</I>&gt;<i>  AC_LANG_CPLUSPLUS
</I>&gt;<i> @@ -75,9 +71,7 @@ fi # BUILD_PARSERS
</I>&gt;<i>  
</I>&gt;<i>  dnl Check for the D compiler
</I>&gt;<i>  AC_CHECK_PROG(GDC, gdc, gdc)
</I>&gt;<i> -if test -n &quot;$GDC&quot;; then
</I>&gt;<i> -	AC_DEFINE_UNQUOTED(GDC,$GDC)
</I>&gt;<i> -fi
</I>&gt;<i> +AC_SUBST(GDC)
</I>&gt;<i>  
</I>&gt;<i>  dnl Check for the Objective-C compiler
</I>&gt;<i>  AC_MSG_CHECKING([for the Objective-C compiler])
</I>&gt;<i> @@ -88,7 +82,7 @@ GOBJC=&quot;&quot;
</I>&gt;<i>  if gcc -x objective-c conftest.m -o conftest.bin 2&gt;/dev/null; then
</I>&gt;<i>  	GOBJC=&quot;gcc -x objective-c&quot;
</I>&gt;<i>  	AC_MSG_RESULT([yes])
</I>&gt;<i> -	AC_DEFINE_UNQUOTED(GOBJC,$GOBJC)
</I>&gt;<i> +	AC_SUBST(GOBJC)
</I>&gt;<i>  else
</I>&gt;<i>  	AC_MSG_RESULT([no])
</I>&gt;<i>  fi
</I>&gt;<i> @@ -96,29 +90,21 @@ AC_SUBST(GOBJC)
</I>&gt;<i>  
</I>&gt;<i>  dnl Check for the Java compiler.
</I>&gt;<i>  AC_CHECK_PROG(JAVAC, javac, javac)
</I>&gt;<i> -if test -n &quot;$JAVAC&quot;; then
</I>&gt;<i> -	AC_DEFINE_UNQUOTED(JAVAC,$JAVAC)
</I>&gt;<i> -fi
</I>&gt;<i> +AC_SUBST(JAVAC)
</I>&gt;<i>  
</I>&gt;<i>  dnl Check for TXL.
</I>&gt;<i>  AC_CHECK_PROG(TXL, txl, txl)
</I>&gt;<i> -if test -n &quot;$TXL&quot;; then
</I>&gt;<i> -	AC_DEFINE_UNQUOTED(TXL,$TXL)
</I>&gt;<i> -fi
</I>&gt;<i> +AC_SUBST(TXL)
</I>&gt;<i>  
</I>&gt;<i>  dnl Check for Ruby.
</I>&gt;<i>  AC_CHECK_PROG(RUBY, ruby, ruby)
</I>&gt;<i> -if test -n &quot;$RUBY&quot;; then
</I>&gt;<i> -	AC_DEFINE_UNQUOTED(RUBY,$RUBY)
</I>&gt;<i> -fi
</I>&gt;<i> +AC_SUBST(RUBY)
</I>&gt;<i>  
</I>&gt;<i>  dnl Check for the C# compiler.
</I>&gt;<i>  AC_CHECK_PROG(GMCS, gmcs, gmcs)
</I>&gt;<i> -if test -n &quot;$GMCS&quot;; then
</I>&gt;<i> -	AC_DEFINE_UNQUOTED(GMCS,$GMCS)
</I>&gt;<i> -fi
</I>&gt;<i> +AC_SUBST(GMCS)
</I>&gt;<i>  
</I>&gt;<i>  dnl write output files
</I>&gt;<i> -AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile)
</I>&gt;<i> +AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile test/runtests)
</I>&gt;<i>  
</I>&gt;<i>  echo &quot;configuration of ragel complete&quot;
</I>&gt;<i> diff --git a/test/runtests b/test/runtests
</I>&gt;<i> deleted file mode 100755
</I>&gt;<i> index a50c7c9..0000000
</I>&gt;<i> --- a/test/runtests
</I>&gt;<i> +++ /dev/null
</I>&gt;<i> @@ -1,320 +0,0 @@
</I>&gt;<i> -#!/bin/bash
</I>&gt;<i> -
</I>&gt;<i> -#
</I>&gt;<i> -#   Copyright 2006 Adrian Thurston &lt;<A HREF="http://www.colm.net/cgi-bin/mailman/listinfo/ragel">thurs... at cs.queensu.ca</A>&gt;
</I>&gt;<i> -#
</I>&gt;<i> -
</I>&gt;<i> -#   This file is part of Ragel.
</I>&gt;<i> -#
</I>&gt;<i> -#   Ragel is free software; you can redistribute it and/or modify
</I>&gt;<i> -#   it under the terms of the GNU General Public License as published by
</I>&gt;<i> -#   the Free Software Foundation; either version 2 of the License, or
</I>&gt;<i> -#   (at your option) any later version.
</I>&gt;<i> -#
</I>&gt;<i> -#   Ragel is distributed in the hope that it will be useful,
</I>&gt;<i> -#   but WITHOUT ANY WARRANTY; without even the implied warranty of
</I>&gt;<i> -#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
</I>&gt;<i> -#   GNU General Public License for more details.
</I>&gt;<i> -#
</I>&gt;<i> -#   You should have received a copy of the GNU General Public License
</I>&gt;<i> -#   along with Ragel; if not, write to the Free Software
</I>&gt;<i> -#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
</I>&gt;<i> -
</I>&gt;<i> -while getopts &quot;gcnmleT:F:G:P:CDJRA&quot; opt; do
</I>&gt;<i> -	case $opt in
</I>&gt;<i> -		T|F|G|P) 
</I>&gt;<i> -			genflags=&quot;$genflags -$opt$OPTARG&quot;
</I>&gt;<i> -			options=&quot;$options -$opt$OPTARG&quot;
</I>&gt;<i> -			;;
</I>&gt;<i> -		n|m|l|e) 
</I>&gt;<i> -			minflags=&quot;$minflags -$opt&quot;
</I>&gt;<i> -			options=&quot;$options -$opt&quot;
</I>&gt;<i> -			;;
</I>&gt;<i> -		c) 
</I>&gt;<i> -			compile_only=&quot;true&quot;
</I>&gt;<i> -			options=&quot;$options -$opt&quot;
</I>&gt;<i> -			;;
</I>&gt;<i> -		g) 
</I>&gt;<i> -			allow_generated=&quot;true&quot;
</I>&gt;<i> -			;;
</I>&gt;<i> -		C|D|J|R|A) 
</I>&gt;<i> -			langflags=&quot;$langflags -$opt&quot;
</I>&gt;<i> -			;;
</I>&gt;<i> -	esac
</I>&gt;<i> -done
</I>&gt;<i> -
</I>&gt;<i> -[ -z &quot;$minflags&quot; ] &amp;&amp; minflags=&quot;-n -m -l -e&quot;
</I>&gt;<i> -[ -z &quot;$genflags&quot; ] &amp;&amp; genflags=&quot;-T0 -T1 -F0 -F1 -G0 -G1 -G2&quot;
</I>&gt;<i> -[ -z &quot;$langflags&quot; ] &amp;&amp; langflags=&quot;-C -D -J -R -A&quot;
</I>&gt;<i> -
</I>&gt;<i> -shift $((OPTIND - 1));
</I>&gt;<i> -
</I>&gt;<i> -[ -z &quot;$*&quot; ] &amp;&amp; set -- *.rl
</I>&gt;<i> -
</I>&gt;<i> -config=../common/config.h
</I>&gt;<i> -ragel=../ragel/ragel
</I>&gt;<i> -
</I>&gt;<i> -cxx_compiler=`sed '/^#define CXX/s/#define CXX *//p;d' $config`
</I>&gt;<i> -c_compiler=`sed '/^#define CC/s/#define CC *//p;d' $config`
</I>&gt;<i> -objc_compiler=`sed '/^#define GOBJC/s/#define GOBJC *//p;d' $config`
</I>&gt;<i> -d_compiler=`sed '/^#define GDC/s/#define GDC *//p;d' $config`
</I>&gt;<i> -java_compiler=`sed '/#define JAVAC/s/#define JAVAC *//p;d' $config`
</I>&gt;<i> -txl_engine=`sed '/^#define TXL/s/#define TXL *//p;d' $config`
</I>&gt;<i> -ruby_engine=`sed '/^#define RUBY/s/#define RUBY *//p;d' $config`
</I>&gt;<i> -csharp_compiler=`sed '/#define GMCS/s/#define GMCS *//p;d' $config`
</I>&gt;<i> -
</I>&gt;<i> -function test_error
</I>&gt;<i> -{
</I>&gt;<i> -	exit 1;
</I>&gt;<i> -}
</I>&gt;<i> -
</I>&gt;<i> -#	split_objs=&quot;&quot;
</I>&gt;<i> -#	if test $split_iters != &quot;$gen_opt&quot;; then
</I>&gt;<i> -#		n=0;
</I>&gt;<i> -#		while test $n -lt $split_iters; do
</I>&gt;<i> -#			part_root=${root}_`awk 'BEGIN {
</I>&gt;<i> -#				width = 0;
</I>&gt;<i> -#				high = '$split_iters' - 1;
</I>&gt;<i> -#				while ( high &gt; 0 ) {
</I>&gt;<i> -#					width = width + 1;
</I>&gt;<i> -#					high = int(high / 10);
</I>&gt;<i> -#				}
</I>&gt;<i> -#				suffFormat = &quot;%&quot; width &quot;.&quot; width &quot;d\n&quot;;
</I>&gt;<i> -#				printf( suffFormat, '$n' );
</I>&gt;<i> -#				exit 0;
</I>&gt;<i> -#			}'`
</I>&gt;<i> -#			part_src=${part_root}.c
</I>&gt;<i> -#			part_bin=${part_root}.o
</I>&gt;<i> -#			echo &quot;$compiler -c $cflags -o $part_bin $part_src&quot;
</I>&gt;<i> -#			if ! $compiler -c $cflags -o $part_bin $part_src; then
</I>&gt;<i> -#				test_error;
</I>&gt;<i> -#			fi
</I>&gt;<i> -#			split_objs=&quot;$split_objs $part_bin&quot;
</I>&gt;<i> -#			n=$((n+1))
</I>&gt;<i> -#		done
</I>&gt;<i> -#	fi
</I>&gt;<i> -
</I>&gt;<i> -function run_test()
</I>&gt;<i> -{
</I>&gt;<i> -	echo &quot;$ragel $lang_opt $min_opt $gen_opt -o $code_src $test_case&quot;
</I>&gt;<i> -	if ! $ragel $lang_opt $min_opt $gen_opt -o $code_src $test_case; then
</I>&gt;<i> -		test_error;
</I>&gt;<i> -	fi
</I>&gt;<i> -
</I>&gt;<i> -	out_args=&quot;&quot;
</I>&gt;<i> -	[ $lang != java ] &amp;&amp; out_args=&quot;-o ${binary}&quot;;
</I>&gt;<i> -    [ $lang == csharp ] &amp;&amp; out_args=&quot;-out:${binary}&quot;;
</I>&gt;<i> -
</I>&gt;<i> -	# Ruby doesn't need to be compiled.
</I>&gt;<i> -	if [ $lang != ruby ]; then
</I>&gt;<i> -		echo &quot;$compiler ${cflags} ${out_args} ${code_src}&quot;
</I>&gt;<i> -		if ! $compiler ${cflags} ${out_args} ${code_src}; then
</I>&gt;<i> -			test_error;
</I>&gt;<i> -		fi
</I>&gt;<i> -	fi
</I>&gt;<i> -
</I>&gt;<i> -	if [ &quot;$compile_only&quot; != &quot;true&quot; ]; then
</I>&gt;<i> -		echo -n &quot;running $root ... &quot;;
</I>&gt;<i> -		
</I>&gt;<i> -		exec_cmd=./$binary
</I>&gt;<i> -		[ $lang = java ] &amp;&amp; exec_cmd=&quot;java ${root}&quot;
</I>&gt;<i> -		[ $lang = ruby ] &amp;&amp; exec_cmd=&quot;ruby ${code_src}&quot;
</I>&gt;<i> -		[ $lang = csharp ] &amp;&amp; exec_cmd=&quot;mono ${exec_cmd}&quot;
</I>&gt;<i> -
</I>&gt;<i> -		$exec_cmd 2&gt;&amp;1 &gt; $output;
</I>&gt;<i> -		if diff $expected_out $output &gt; /dev/null; then
</I>&gt;<i> -			echo &quot;passed&quot;;
</I>&gt;<i> -		else
</I>&gt;<i> -			echo &quot;FAILED&quot;;
</I>&gt;<i> -			test_error;
</I>&gt;<i> -		fi;
</I>&gt;<i> -	fi
</I>&gt;<i> -}
</I>&gt;<i> -
</I>&gt;<i> -for test_case; do
</I>&gt;<i> -	root=${test_case%.rl};
</I>&gt;<i> -
</I>&gt;<i> -	if ! [ -f &quot;$test_case&quot; ]; then
</I>&gt;<i> -		echo &quot;runtests: not a file: $test_case&quot;; &gt;&amp;2
</I>&gt;<i> -		exit 1;
</I>&gt;<i> -	fi
</I>&gt;<i> -
</I>&gt;<i> -	# Check if we should ignore the test case
</I>&gt;<i> -	ignore=`sed '/@IGNORE:/s/^.*: *//p;d' $test_case`
</I>&gt;<i> -    if [ &quot;$ignore&quot; = yes ]; then
</I>&gt;<i> -        continue;
</I>&gt;<i> -    fi
</I>&gt;<i> -
</I>&gt;<i> -	# If the generated flag is given make sure that the test case is generated.
</I>&gt;<i> -	is_generated=`sed '/@GENERATED:/s/^.*: *//p;d' $test_case`
</I>&gt;<i> -	if [ &quot;$is_generated&quot; = yes ] &amp;&amp; [ &quot;$allow_generated&quot; != true ]; then
</I>&gt;<i> -		continue;
</I>&gt;<i> -	fi
</I>&gt;<i> -
</I>&gt;<i> -	expected_out=$root.exp;
</I>&gt;<i> -	sed '1,/_____OUTPUT_____/d;$d' $test_case &gt; $expected_out
</I>&gt;<i> -
</I>&gt;<i> -	lang=`sed '/@LANG:/s/^.*: *//p;d' $test_case`
</I>&gt;<i> -	if [ -z &quot;$lang&quot; ]; then
</I>&gt;<i> -		echo &quot;$test_case: language unset&quot;; &gt;&amp;2
</I>&gt;<i> -		exit 1;
</I>&gt;<i> -	fi
</I>&gt;<i> -
</I>&gt;<i> -	case $lang in
</I>&gt;<i> -		c++)
</I>&gt;<i> -			lang_opt=-C;
</I>&gt;<i> -			codegen=../rlgen-cd/rlgen-cd;
</I>&gt;<i> -			code_suffix=cpp;
</I>&gt;<i> -			compiler=$cxx_compiler;
</I>&gt;<i> -			cflags=&quot;-pedantic -ansi -Wall -O3&quot;
</I>&gt;<i> -		;;
</I>&gt;<i> -		d)
</I>&gt;<i> -			lang_opt=-D;
</I>&gt;<i> -			codegen=../rlgen-cd/rlgen-cd;
</I>&gt;<i> -			code_suffix=d;
</I>&gt;<i> -			compiler=$d_compiler;
</I>&gt;<i> -			cflags=&quot;-Wall -O3&quot;
</I>&gt;<i> -		;;
</I>&gt;<i> -		c)
</I>&gt;<i> -			lang_opt=-C;
</I>&gt;<i> -			codegen=../rlgen-cd/rlgen-cd;
</I>&gt;<i> -			code_suffix=c;
</I>&gt;<i> -			compiler=$c_compiler;
</I>&gt;<i> -			cflags=&quot;-pedantic -ansi -Wall -O3&quot;
</I>&gt;<i> -		;;
</I>&gt;<i> -		obj-c)
</I>&gt;<i> -			lang_opt=-C;
</I>&gt;<i> -			codegen=../rlgen-cd/rlgen-cd;
</I>&gt;<i> -			code_suffix=m;
</I>&gt;<i> -			compiler=$objc_compiler
</I>&gt;<i> -			cflags=&quot;-Wall -O3 -fno-strict-aliasing -lobjc&quot;
</I>&gt;<i> -		;;
</I>&gt;<i> -		java)
</I>&gt;<i> -			lang_opt=-J;
</I>&gt;<i> -			codegen=../rlgen-java/rlgen-java;
</I>&gt;<i> -			code_suffix=java;
</I>&gt;<i> -			compiler=$java_compiler
</I>&gt;<i> -			cflags=&quot;&quot;
</I>&gt;<i> -		;;
</I>&gt;<i> -		ruby)
</I>&gt;<i> -			lang_opt=-R;
</I>&gt;<i> -			codegen=../rlgen-ruby/rlgen-ruby;
</I>&gt;<i> -			code_suffix=rb;
</I>&gt;<i> -			compiler=$ruby_engine
</I>&gt;<i> -			cflags=&quot;&quot;
</I>&gt;<i> -		;;
</I>&gt;<i> -        csharp)
</I>&gt;<i> -            lang_opt=&quot;-A&quot;;
</I>&gt;<i> -            codegen=../rlgen-csharp/rlgen-csharp;
</I>&gt;<i> -            code_suffix=cs;
</I>&gt;<i> -            compiler=$csharp_compiler
</I>&gt;<i> -            cflags=&quot;&quot;
</I>&gt;<i> -        ;;
</I>&gt;<i> -		indep)
</I>&gt;<i> -			lang_opt=&quot;&quot;;
</I>&gt;<i> -
</I>&gt;<i> -			# If we have no txl engine then skip this test.
</I>&gt;<i> -			[ -z &quot;$txl_engine&quot; ] &amp;&amp; continue
</I>&gt;<i> -			for lang in c d java ruby csharp; do
</I>&gt;<i> -				case $lang in 
</I>&gt;<i> -					c) lf=&quot;-C&quot;;;
</I>&gt;<i> -					d) lf=&quot;-D&quot;;;
</I>&gt;<i> -					java) lf=&quot;-J&quot;;;
</I>&gt;<i> -					ruby) lf=&quot;-R&quot;;;
</I>&gt;<i> -                    csharp) lf=&quot;-A&quot;;;
</I>&gt;<i> -				esac
</I>&gt;<i> -
</I>&gt;<i> -				echo &quot;$langflags&quot; | grep -e $lf &gt;/dev/null || continue
</I>&gt;<i> -
</I>&gt;<i> -				targ=${root}_$lang.rl
</I>&gt;<i> -				echo &quot;./langtrans_$lang.sh $test_case &gt; $targ&quot;
</I>&gt;<i> -				if ! ./langtrans_$lang.sh $test_case &gt; $targ; then
</I>&gt;<i> -					test_error
</I>&gt;<i> -				fi
</I>&gt;<i> -				echo &quot;./runtests -g $options $targ&quot;
</I>&gt;<i> -				if !  ./runtests -g $options $targ; then
</I>&gt;<i> -					test_error
</I>&gt;<i> -				fi
</I>&gt;<i> -			done
</I>&gt;<i> -			continue;
</I>&gt;<i> -		;;
</I>&gt;<i> -		*)
</I>&gt;<i> -			echo &quot;$test_case: unknown language type $lang&quot; &gt;&amp;2
</I>&gt;<i> -			exit 1;
</I>&gt;<i> -		;;
</I>&gt;<i> -	esac
</I>&gt;<i> -
</I>&gt;<i> -	# Make sure that we are interested in the host language.
</I>&gt;<i> -	echo &quot;$langflags&quot; | grep -e $lang_opt &gt;/dev/null || continue
</I>&gt;<i> -
</I>&gt;<i> -	code_src=$root.$code_suffix;
</I>&gt;<i> -	binary=$root.bin;
</I>&gt;<i> -	output=$root.out;
</I>&gt;<i> -
</I>&gt;<i> -	# If we have no compiler for the source program then skip it.
</I>&gt;<i> -	[ -z &quot;$compiler&quot; ] &amp;&amp; continue
</I>&gt;<i> -
</I>&gt;<i> -	additional_cflags=`sed '/@CFLAGS:/s/^.*: *//p;d' $test_case`
</I>&gt;<i> -	[ -n &quot;$additional_cflags&quot; ] &amp;&amp; cflags=&quot;$cflags $additional_cflags&quot;
</I>&gt;<i> -
</I>&gt;<i> -	allow_minflags=`sed '/@ALLOW_MINFLAGS:/s/^.*: *//p;d' $test_case`
</I>&gt;<i> -	[ -z &quot;$allow_minflags&quot; ] &amp;&amp; allow_minflags=&quot;-n -m -l -e&quot;
</I>&gt;<i> -
</I>&gt;<i> -	case $lang in
</I>&gt;<i> -	c|c++|d)
</I>&gt;<i> -		# Using genflags, get the allowed gen flags from the test case. If the
</I>&gt;<i> -		# test case doesn't specify assume that all gen flags are allowed.
</I>&gt;<i> -		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
</I>&gt;<i> -		[ -z &quot;$allow_genflags&quot; ] &amp;&amp; allow_genflags=&quot;-T0 -T1 -F0 -F1 -G0 -G1 -G2&quot;
</I>&gt;<i> -
</I>&gt;<i> -		for min_opt in $minflags; do
</I>&gt;<i> -			echo &quot;$allow_minflags&quot; | grep -e $min_opt &gt;/dev/null || continue
</I>&gt;<i> -			for gen_opt in $genflags; do
</I>&gt;<i> -				echo &quot;$allow_genflags&quot; | grep -e $gen_opt &gt;/dev/null || continue
</I>&gt;<i> -				run_test
</I>&gt;<i> -			done
</I>&gt;<i> -		done
</I>&gt;<i> -	;;
</I>&gt;<i> -
</I>&gt;<i> -	java) 
</I>&gt;<i> -		# Not interested in gen opt.
</I>&gt;<i> -		gen_opt=&quot;&quot;
</I>&gt;<i> -		for min_opt in $minflags; do
</I>&gt;<i> -			echo &quot;$allow_minflags&quot; | grep -e $min_opt &gt;/dev/null || continue
</I>&gt;<i> -			run_test
</I>&gt;<i> -		done
</I>&gt;<i> -	;;
</I>&gt;<i> -
</I>&gt;<i> -	ruby) 
</I>&gt;<i> -		# Using genflags, get the allowed gen flags from the test case. If the
</I>&gt;<i> -		# test case doesn't specify assume that all gen flags are allowed.
</I>&gt;<i> -		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
</I>&gt;<i> -		[ -z &quot;$allow_genflags&quot; ] &amp;&amp; allow_genflags=&quot;-T0 -T1 -F0 -F1&quot;
</I>&gt;<i> -
</I>&gt;<i> -		for min_opt in $minflags; do
</I>&gt;<i> -			echo &quot;$allow_minflags&quot; | grep -e $min_opt &gt;/dev/null || continue
</I>&gt;<i> -
</I>&gt;<i> -			for gen_opt in $genflags; do
</I>&gt;<i> -				echo &quot;$allow_genflags&quot; | grep -e $gen_opt &gt;/dev/null || continue
</I>&gt;<i> -				run_test
</I>&gt;<i> -			done
</I>&gt;<i> -		done
</I>&gt;<i> -	;;
</I>&gt;<i> -
</I>&gt;<i> -	csharp)
</I>&gt;<i> -		# Using genflags, get the allowed gen flags from the test case. If the
</I>&gt;<i> -		# test case doesn't specify assume that all gen flags are allowed.
</I>&gt;<i> -		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
</I>&gt;<i> -		[ -z &quot;$allow_genflags&quot; ] &amp;&amp; allow_genflags=&quot;-T0 -T1 -F0 -F1 -G0 -G1&quot;
</I>&gt;<i> -
</I>&gt;<i> -		for min_opt in $minflags; do
</I>&gt;<i> -			echo &quot;$allow_minflags&quot; | grep -e $min_opt &gt;/dev/null || continue
</I>&gt;<i> -			for gen_opt in $genflags; do
</I>&gt;<i> -				echo &quot;$allow_genflags&quot; | grep -e $gen_opt &gt;/dev/null || continue
</I>&gt;<i> -				run_test
</I>&gt;<i> -			done
</I>&gt;<i> -		done
</I>&gt;<i> -	;;
</I>&gt;<i> -	esac
</I>&gt;<i> -
</I>&gt;<i> -done
</I>&gt;<i> diff --git a/test/runtests.in b/test/runtests.in
</I>&gt;<i> new file mode 100755
</I>&gt;<i> index 0000000..ee14f6a
</I>&gt;<i> --- /dev/null
</I>&gt;<i> +++ b/test/runtests.in
</I>&gt;<i> @@ -0,0 +1,320 @@
</I>&gt;<i> +#!/bin/bash
</I>&gt;<i> +
</I>&gt;<i> +#
</I>&gt;<i> +#   Copyright 2006 Adrian Thurston &lt;<A HREF="http://www.colm.net/cgi-bin/mailman/listinfo/ragel">thurs... at cs.queensu.ca</A>&gt;
</I>&gt;<i> +#
</I>&gt;<i> +
</I>&gt;<i> +#   This file is part of Ragel.
</I>&gt;<i> +#
</I>&gt;<i> +#   Ragel is free software; you can redistribute it and/or modify
</I>&gt;<i> +#   it under the terms of the GNU General Public License as published by
</I>&gt;<i> +#   the Free Software Foundation; either version 2 of the License, or
</I>&gt;<i> +#   (at your option) any later version.
</I>&gt;<i> +#
</I>&gt;<i> +#   Ragel is distributed in the hope that it will be useful,
</I>&gt;<i> +#   but WITHOUT ANY WARRANTY; without even the implied warranty of
</I>&gt;<i> +#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
</I>&gt;<i> +#   GNU General Public License for more details.
</I>&gt;<i> +#
</I>&gt;<i> +#   You should have received a copy of the GNU General Public License
</I>&gt;<i> +#   along with Ragel; if not, write to the Free Software
</I>&gt;<i> +#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
</I>&gt;<i> +
</I>&gt;<i> +while getopts &quot;gcnmleT:F:G:P:CDJRA&quot; opt; do
</I>&gt;<i> +	case $opt in
</I>&gt;<i> +		T|F|G|P) 
</I>&gt;<i> +			genflags=&quot;$genflags -$opt$OPTARG&quot;
</I>&gt;<i> +			options=&quot;$options -$opt$OPTARG&quot;
</I>&gt;<i> +			;;
</I>&gt;<i> +		n|m|l|e) 
</I>&gt;<i> +			minflags=&quot;$minflags -$opt&quot;
</I>&gt;<i> +			options=&quot;$options -$opt&quot;
</I>&gt;<i> +			;;
</I>&gt;<i> +		c) 
</I>&gt;<i> +			compile_only=&quot;true&quot;
</I>&gt;<i> +			options=&quot;$options -$opt&quot;
</I>&gt;<i> +			;;
</I>&gt;<i> +		g) 
</I>&gt;<i> +			allow_generated=&quot;true&quot;
</I>&gt;<i> +			;;
</I>&gt;<i> +		C|D|J|R|A) 
</I>&gt;<i> +			langflags=&quot;$langflags -$opt&quot;
</I>&gt;<i> +			;;
</I>&gt;<i> +	esac
</I>&gt;<i> +done
</I>&gt;<i> +
</I>&gt;<i> +[ -z &quot;$minflags&quot; ] &amp;&amp; minflags=&quot;-n -m -l -e&quot;
</I>&gt;<i> +[ -z &quot;$genflags&quot; ] &amp;&amp; genflags=&quot;-T0 -T1 -F0 -F1 -G0 -G1 -G2&quot;
</I>&gt;<i> +[ -z &quot;$langflags&quot; ] &amp;&amp; langflags=&quot;-C -D -J -R -A&quot;
</I>&gt;<i> +
</I>&gt;<i> +shift $((OPTIND - 1));
</I>&gt;<i> +
</I>&gt;<i> +[ -z &quot;$*&quot; ] &amp;&amp; set -- *.rl
</I>&gt;<i> +
</I>&gt;<i> +config=../common/config.h
</I>&gt;<i> +ragel=../ragel/ragel
</I>&gt;<i> +
</I>&gt;<i> +cxx_compiler=@CXX@
</I>&gt;<i> +c_compiler=@CC@
</I>&gt;<i> +objc_compiler=@GOBJC@
</I>&gt;<i> +d_compiler=@GDC@
</I>&gt;<i> +java_compiler=@JAVAC@
</I>&gt;<i> +txl_engine=@TXL@
</I>&gt;<i> +ruby_engine=@RUBY@
</I>&gt;<i> +csharp_compiler=@GMCS@
</I>&gt;<i> +
</I>&gt;<i> +function test_error
</I>&gt;<i> +{
</I>&gt;<i> +	exit 1;
</I>&gt;<i> +}
</I>&gt;<i> +
</I>&gt;<i> +#	split_objs=&quot;&quot;
</I>&gt;<i> +#	if test $split_iters != &quot;$gen_opt&quot;; then
</I>&gt;<i> +#		n=0;
</I>&gt;<i> +#		while test $n -lt $split_iters; do
</I>&gt;<i> +#			part_root=${root}_`awk 'BEGIN {
</I>&gt;<i> +#				width = 0;
</I>&gt;<i> +#				high = '$split_iters' - 1;
</I>&gt;<i> +#				while ( high &gt; 0 ) {
</I>&gt;<i> +#					width = width + 1;
</I>&gt;<i> +#					high = int(high / 10);
</I>&gt;<i> +#				}
</I>&gt;<i> +#				suffFormat = &quot;%&quot; width &quot;.&quot; width &quot;d\n&quot;;
</I>&gt;<i> +#				printf( suffFormat, '$n' );
</I>&gt;<i> +#				exit 0;
</I>&gt;<i> +#			}'`
</I>&gt;<i> +#			part_src=${part_root}.c
</I>&gt;<i> +#			part_bin=${part_root}.o
</I>&gt;<i> +#			echo &quot;$compiler -c $cflags -o $part_bin $part_src&quot;
</I>&gt;<i> +#			if ! $compiler -c $cflags -o $part_bin $part_src; then
</I>&gt;<i> +#				test_error;
</I>&gt;<i> +#			fi
</I>&gt;<i> +#			split_objs=&quot;$split_objs $part_bin&quot;
</I>&gt;<i> +#			n=$((n+1))
</I>&gt;<i> +#		done
</I>&gt;<i> +#	fi
</I>&gt;<i> +
</I>&gt;<i> +function run_test()
</I>&gt;<i> +{
</I>&gt;<i> +	echo &quot;$ragel $lang_opt $min_opt $gen_opt -o $code_src $test_case&quot;
</I>&gt;<i> +	if ! $ragel $lang_opt $min_opt $gen_opt -o $code_src $test_case; then
</I>&gt;<i> +		test_error;
</I>&gt;<i> +	fi
</I>&gt;<i> +
</I>&gt;<i> +	out_args=&quot;&quot;
</I>&gt;<i> +	[ $lang != java ] &amp;&amp; out_args=&quot;-o ${binary}&quot;;
</I>&gt;<i> +    [ $lang == csharp ] &amp;&amp; out_args=&quot;-out:${binary}&quot;;
</I>&gt;<i> +
</I>&gt;<i> +	# Ruby doesn't need to be compiled.
</I>&gt;<i> +	if [ $lang != ruby ]; then
</I>&gt;<i> +		echo &quot;$compiler ${cflags} ${out_args} ${code_src}&quot;
</I>&gt;<i> +		if ! $compiler ${cflags} ${out_args} ${code_src}; then
</I>&gt;<i> +			test_error;
</I>&gt;<i> +		fi
</I>&gt;<i> +	fi
</I>&gt;<i> +
</I>&gt;<i> +	if [ &quot;$compile_only&quot; != &quot;true&quot; ]; then
</I>&gt;<i> +		echo -n &quot;running $root ... &quot;;
</I>&gt;<i> +		
</I>&gt;<i> +		exec_cmd=./$binary
</I>&gt;<i> +		[ $lang = java ] &amp;&amp; exec_cmd=&quot;java ${root}&quot;
</I>&gt;<i> +		[ $lang = ruby ] &amp;&amp; exec_cmd=&quot;ruby ${code_src}&quot;
</I>&gt;<i> +		[ $lang = csharp ] &amp;&amp; exec_cmd=&quot;mono ${exec_cmd}&quot;
</I>&gt;<i> +
</I>&gt;<i> +		$exec_cmd 2&gt;&amp;1 &gt; $output;
</I>&gt;<i> +		if diff $expected_out $output &gt; /dev/null; then
</I>&gt;<i> +			echo &quot;passed&quot;;
</I>&gt;<i> +		else
</I>&gt;<i> +			echo &quot;FAILED&quot;;
</I>&gt;<i> +			test_error;
</I>&gt;<i> +		fi;
</I>&gt;<i> +	fi
</I>&gt;<i> +}
</I>&gt;<i> +
</I>&gt;<i> +for test_case; do
</I>&gt;<i> +	root=${test_case%.rl};
</I>&gt;<i> +
</I>&gt;<i> +	if ! [ -f &quot;$test_case&quot; ]; then
</I>&gt;<i> +		echo &quot;runtests: not a file: $test_case&quot;; &gt;&amp;2
</I>&gt;<i> +		exit 1;
</I>&gt;<i> +	fi
</I>&gt;<i> +
</I>&gt;<i> +	# Check if we should ignore the test case
</I>&gt;<i> +	ignore=`sed '/@IGNORE:/s/^.*: *//p;d' $test_case`
</I>&gt;<i> +    if [ &quot;$ignore&quot; = yes ]; then
</I>&gt;<i> +        continue;
</I>&gt;<i> +    fi
</I>&gt;<i> +
</I>&gt;<i> +	# If the generated flag is given make sure that the test case is generated.
</I>&gt;<i> +	is_generated=`sed '/@GENERATED:/s/^.*: *//p;d' $test_case`
</I>&gt;<i> +	if [ &quot;$is_generated&quot; = yes ] &amp;&amp; [ &quot;$allow_generated&quot; != true ]; then
</I>&gt;<i> +		continue;
</I>&gt;<i> +	fi
</I>&gt;<i> +
</I>&gt;<i> +	expected_out=$root.exp;
</I>&gt;<i> +	sed '1,/_____OUTPUT_____/d;$d' $test_case &gt; $expected_out
</I>&gt;<i> +
</I>&gt;<i> +	lang=`sed '/@LANG:/s/^.*: *//p;d' $test_case`
</I>&gt;<i> +	if [ -z &quot;$lang&quot; ]; then
</I>&gt;<i> +		echo &quot;$test_case: language unset&quot;; &gt;&amp;2
</I>&gt;<i> +		exit 1;
</I>&gt;<i> +	fi
</I>&gt;<i> +
</I>&gt;<i> +	case $lang in
</I>&gt;<i> +		c++)
</I>&gt;<i> +			lang_opt=-C;
</I>&gt;<i> +			codegen=../rlgen-cd/rlgen-cd;
</I>&gt;<i> +			code_suffix=cpp;
</I>&gt;<i> +			compiler=$cxx_compiler;
</I>&gt;<i> +			cflags=&quot;-pedantic -ansi -Wall -O3&quot;
</I>&gt;<i> +		;;
</I>&gt;<i> +		d)
</I>&gt;<i> +			lang_opt=-D;
</I>&gt;<i> +			codegen=../rlgen-cd/rlgen-cd;
</I>&gt;<i> +			code_suffix=d;
</I>&gt;<i> +			compiler=$d_compiler;
</I>&gt;<i> +			cflags=&quot;-Wall -O3&quot;
</I>&gt;<i> +		;;
</I>&gt;<i> +		c)
</I>&gt;<i> +			lang_opt=-C;
</I>&gt;<i> +			codegen=../rlgen-cd/rlgen-cd;
</I>&gt;<i> +			code_suffix=c;
</I>&gt;<i> +			compiler=$c_compiler;
</I>&gt;<i> +			cflags=&quot;-pedantic -ansi -Wall -O3&quot;
</I>&gt;<i> +		;;
</I>&gt;<i> +		obj-c)
</I>&gt;<i> +			lang_opt=-C;
</I>&gt;<i> +			codegen=../rlgen-cd/rlgen-cd;
</I>&gt;<i> +			code_suffix=m;
</I>&gt;<i> +			compiler=$objc_compiler
</I>&gt;<i> +			cflags=&quot;-Wall -O3 -fno-strict-aliasing -lobjc&quot;
</I>&gt;<i> +		;;
</I>&gt;<i> +		java)
</I>&gt;<i> +			lang_opt=-J;
</I>&gt;<i> +			codegen=../rlgen-java/rlgen-java;
</I>&gt;<i> +			code_suffix=java;
</I>&gt;<i> +			compiler=$java_compiler
</I>&gt;<i> +			cflags=&quot;&quot;
</I>&gt;<i> +		;;
</I>&gt;<i> +		ruby)
</I>&gt;<i> +			lang_opt=-R;
</I>&gt;<i> +			codegen=../rlgen-ruby/rlgen-ruby;
</I>&gt;<i> +			code_suffix=rb;
</I>&gt;<i> +			compiler=$ruby_engine
</I>&gt;<i> +			cflags=&quot;&quot;
</I>&gt;<i> +		;;
</I>&gt;<i> +        csharp)
</I>&gt;<i> +            lang_opt=&quot;-A&quot;;
</I>&gt;<i> +            codegen=../rlgen-csharp/rlgen-csharp;
</I>&gt;<i> +            code_suffix=cs;
</I>&gt;<i> +            compiler=$csharp_compiler
</I>&gt;<i> +            cflags=&quot;&quot;
</I>&gt;<i> +        ;;
</I>&gt;<i> +		indep)
</I>&gt;<i> +			lang_opt=&quot;&quot;;
</I>&gt;<i> +
</I>&gt;<i> +			# If we have no txl engine then skip this test.
</I>&gt;<i> +			[ -z &quot;$txl_engine&quot; ] &amp;&amp; continue
</I>&gt;<i> +			for lang in c d java ruby csharp; do
</I>&gt;<i> +				case $lang in 
</I>&gt;<i> +					c) lf=&quot;-C&quot;;;
</I>&gt;<i> +					d) lf=&quot;-D&quot;;;
</I>&gt;<i> +					java) lf=&quot;-J&quot;;;
</I>&gt;<i> +					ruby) lf=&quot;-R&quot;;;
</I>&gt;<i> +                    csharp) lf=&quot;-A&quot;;;
</I>&gt;<i> +				esac
</I>&gt;<i> +
</I>&gt;<i> +				echo &quot;$langflags&quot; | grep -e $lf &gt;/dev/null || continue
</I>&gt;<i> +
</I>&gt;<i> +				targ=${root}_$lang.rl
</I>&gt;<i> +				echo &quot;./langtrans_$lang.sh $test_case &gt; $targ&quot;
</I>&gt;<i> +				if ! ./langtrans_$lang.sh $test_case &gt; $targ; then
</I>&gt;<i> +					test_error
</I>&gt;<i> +				fi
</I>&gt;<i> +				echo &quot;./runtests -g $options $targ&quot;
</I>&gt;<i> +				if !  ./runtests -g $options $targ; then
</I>&gt;<i> +					test_error
</I>&gt;<i> +				fi
</I>&gt;<i> +			done
</I>&gt;<i> +			continue;
</I>&gt;<i> +		;;
</I>&gt;<i> +		*)
</I>&gt;<i> +			echo &quot;$test_case: unknown language type $lang&quot; &gt;&amp;2
</I>&gt;<i> +			exit 1;
</I>&gt;<i> +		;;
</I>&gt;<i> +	esac
</I>&gt;<i> +
</I>&gt;<i> +	# Make sure that we are interested in the host language.
</I>&gt;<i> +	echo &quot;$langflags&quot; | grep -e $lang_opt &gt;/dev/null || continue
</I>&gt;<i> +
</I>&gt;<i> +	code_src=$root.$code_suffix;
</I>&gt;<i> +	binary=$root.bin;
</I>&gt;<i> +	output=$root.out;
</I>&gt;<i> +
</I>&gt;<i> +	# If we have no compiler for the source program then skip it.
</I>&gt;<i> +	[ -z &quot;$compiler&quot; ] &amp;&amp; continue
</I>&gt;<i> +
</I>&gt;<i> +	additional_cflags=`sed '/@CFLAGS:/s/^.*: *//p;d' $test_case`
</I>&gt;<i> +	[ -n &quot;$additional_cflags&quot; ] &amp;&amp; cflags=&quot;$cflags $additional_cflags&quot;
</I>&gt;<i> +
</I>&gt;<i> +	allow_minflags=`sed '/@ALLOW_MINFLAGS:/s/^.*: *//p;d' $test_case`
</I>&gt;<i> +	[ -z &quot;$allow_minflags&quot; ] &amp;&amp; allow_minflags=&quot;-n -m -l -e&quot;
</I>&gt;<i> +
</I>&gt;<i> +	case $lang in
</I>&gt;<i> +	c|c++|d)
</I>&gt;<i> +		# Using genflags, get the allowed gen flags from the test case. If the
</I>&gt;<i> +		# test case doesn't specify assume that all gen flags are allowed.
</I>&gt;<i> +		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
</I>&gt;<i> +		[ -z &quot;$allow_genflags&quot; ] &amp;&amp; allow_genflags=&quot;-T0 -T1 -F0 -F1 -G0 -G1 -G2&quot;
</I>&gt;<i> +
</I>&gt;<i> +		for min_opt in $minflags; do
</I>&gt;<i> +			echo &quot;$allow_minflags&quot; | grep -e $min_opt &gt;/dev/null || continue
</I>&gt;<i> +			for gen_opt in $genflags; do
</I>&gt;<i> +				echo &quot;$allow_genflags&quot; | grep -e $gen_opt &gt;/dev/null || continue
</I>&gt;<i> +				run_test
</I>&gt;<i> +			done
</I>&gt;<i> +		done
</I>&gt;<i> +	;;
</I>&gt;<i> +
</I>&gt;<i> +	java) 
</I>&gt;<i> +		# Not interested in gen opt.
</I>&gt;<i> +		gen_opt=&quot;&quot;
</I>&gt;<i> +		for min_opt in $minflags; do
</I>&gt;<i> +			echo &quot;$allow_minflags&quot; | grep -e $min_opt &gt;/dev/null || continue
</I>&gt;<i> +			run_test
</I>&gt;<i> +		done
</I>&gt;<i> +	;;
</I>&gt;<i> +
</I>&gt;<i> +	ruby) 
</I>&gt;<i> +		# Using genflags, get the allowed gen flags from the test case. If the
</I>&gt;<i> +		# test case doesn't specify assume that all gen flags are allowed.
</I>&gt;<i> +		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
</I>&gt;<i> +		[ -z &quot;$allow_genflags&quot; ] &amp;&amp; allow_genflags=&quot;-T0 -T1 -F0 -F1&quot;
</I>&gt;<i> +
</I>&gt;<i> +		for min_opt in $minflags; do
</I>&gt;<i> +			echo &quot;$allow_minflags&quot; | grep -e $min_opt &gt;/dev/null || continue
</I>&gt;<i> +
</I>&gt;<i> +			for gen_opt in $genflags; do
</I>&gt;<i> +				echo &quot;$allow_genflags&quot; | grep -e $gen_opt &gt;/dev/null || continue
</I>&gt;<i> +				run_test
</I>&gt;<i> +			done
</I>&gt;<i> +		done
</I>&gt;<i> +	;;
</I>&gt;<i> +
</I>&gt;<i> +	csharp)
</I>&gt;<i> +		# Using genflags, get the allowed gen flags from the test case. If the
</I>&gt;<i> +		# test case doesn't specify assume that all gen flags are allowed.
</I>&gt;<i> +		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
</I>&gt;<i> +		[ -z &quot;$allow_genflags&quot; ] &amp;&amp; allow_genflags=&quot;-T0 -T1 -F0 -F1 -G0 -G1&quot;
</I>&gt;<i> +
</I>&gt;<i> +		for min_opt in $minflags; do
</I>&gt;<i> +			echo &quot;$allow_minflags&quot; | grep -e $min_opt &gt;/dev/null || continue
</I>&gt;<i> +			for gen_opt in $genflags; do
</I>&gt;<i> +				echo &quot;$allow_genflags&quot; | grep -e $gen_opt &gt;/dev/null || continue
</I>&gt;<i> +				run_test
</I>&gt;<i> +			done
</I>&gt;<i> +		done
</I>&gt;<i> +	;;
</I>&gt;<i> +	esac
</I>&gt;<i> +
</I>&gt;<i> +done
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000754.html">[PATCH 1/6] Don't use AC_DEFINE to pass the commands for the	compilers to the runtest script.
</A></li>
	<LI>Next message: <A HREF="000738.html">[PATCH 2/6] Remove files generated by autotools.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#755">[ date ]</a>
              <a href="thread.html#755">[ thread ]</a>
              <a href="subject.html#755">[ subject ]</a>
              <a href="author.html#755">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.colm.net/cgi-bin/mailman/listinfo/ragel">More information about the ragel
mailing list</a><br>
</body></html>
