<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [ragel-users] Newbie problem with reading unsigned numbers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:ragel%40colm.net?Subject=Re%3A%20%5Bragel-users%5D%20Newbie%20problem%20with%20reading%20unsigned%20numbers&In-Reply-To=%3C4A9EA890.4080707%40esentire.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="000987.html">
   <LINK REL="Next"  HREF="000989.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[ragel-users] Newbie problem with reading unsigned numbers</H1>
    <B>Adrian Thurston</B> 
    <A HREF="mailto:ragel%40colm.net?Subject=Re%3A%20%5Bragel-users%5D%20Newbie%20problem%20with%20reading%20unsigned%20numbers&In-Reply-To=%3C4A9EA890.4080707%40esentire.com%3E"
       TITLE="[ragel-users] Newbie problem with reading unsigned numbers">adrian.thurston at esentire.com
       </A><BR>
    <I>Wed Sep  2 17:17:04 UTC 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000987.html">[ragel-users] Newbie problem with reading unsigned numbers
</A></li>
        <LI>Next message: <A HREF="000989.html">[ragel-users] Ragel for JSON
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#988">[ date ]</a>
              <a href="thread.html#988">[ thread ]</a>
              <a href="subject.html#988">[ subject ]</a>
              <a href="author.html#988">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The problem is casting. The fc expression is signed char (since the 
default alphabet is char) and it is being upcast to int size. In the 
process the high bits become 1 to preserve the negative property of the 
value.

Use:

alphtype unsigned char;

And make p and pe unsigned char* type;

-Adrian

Neil Webster wrote:
&gt;<i> Hi Guys,
</I>&gt;<i> 
</I>&gt;<i> Please accept my apologies for the email clutter but I forgot the 
</I>&gt;<i> attachment ....
</I>&gt;<i> 
</I>&gt;<i> On Wed, 2009-09-02 at 13:08 -0400, Neil Webster wrote:
</I>&gt;&gt;<i> I am trying to create a reusable structure for reading in data from a
</I>&gt;&gt;<i> binary data stream. I have attached a ragel file that demonstrates the
</I>&gt;&gt;<i> problem I am having and would appreciate tips and advice on what I am
</I>&gt;&gt;<i> doing wrong or better ways to go about solving the problem.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I have defined Word8b, Word16b and Word32b to represent the blocks I
</I>&gt;&gt;<i> will be reading from the data stream. The data is accumulated into a
</I>&gt;&gt;<i> temporary variable (temp) and then assigned to the specific variable on
</I>&gt;&gt;<i> exit from the appropriate machine. It works fine for small numbers but
</I>&gt;&gt;<i> does strange things with numbers &gt;127. It seems to be a problem with
</I>&gt;&gt;<i> signed vs unsigned but I can't figure out what it is.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What I expect
</I>&gt;&gt;<i> a8 1 b8 ff a16 2 b16 fe a32 3 b32 fd
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What I get
</I>&gt;&gt;<i>  
</I>&gt;&gt;<i> a8 1 b8 ffff a16 2 b16 fffe a32 3 b32 fffffffd 
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ------------------------------------------------------------------------
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> ragel-users mailing list
</I>&gt;<i> <A HREF="http://www.colm.net/cgi-bin/mailman/listinfo/ragel">ragel-users at complang.org</A>
</I>&gt;<i> <A HREF="http://www.complang.org/mailman/listinfo/ragel-users">http://www.complang.org/mailman/listinfo/ragel-users</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000987.html">[ragel-users] Newbie problem with reading unsigned numbers
</A></li>
	<LI>Next message: <A HREF="000989.html">[ragel-users] Ragel for JSON
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#988">[ date ]</a>
              <a href="thread.html#988">[ thread ]</a>
              <a href="subject.html#988">[ subject ]</a>
              <a href="author.html#988">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.colm.net/cgi-bin/mailman/listinfo/ragel">More information about the ragel
mailing list</a><br>
</body></html>
