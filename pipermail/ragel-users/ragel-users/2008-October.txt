From thurs... at cs.queensu.ca  Wed Oct  1 05:09:44 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Wed, 01 Oct 2008 01:09:44 -0400
Subject: [ragel-users] First FSM - is my approach correct?
In-Reply-To: <ec856bd0-d49d-4b3f-9102-4ac373b17784@x41g2000hsb.googlegroups.com>
References: <ec856bd0-d49d-4b3f-9102-4ac373b17784@x41g2000hsb.googlegroups.com>
Message-ID: <48E30618.3010709@cs.queensu.ca>

Hi Nick, it doesn't seem that what you want to do maps to the FSM model.
I think it might be more productive to bang out a mini version of this
without using ragel and then it might become clear if there is any
benefit at all to using ragel.

Adrian

Nick C wrote:
> Hi,
> 
> I would like to use Ragel to build a couple of FSMs based on the same
> machine definition, one handling data validation, and another to
> construct an interface (this would be the first time I use either
> Ragel or FSMs). The data causing state transitions will probably be
> passed in as key-value pairs. The validity of some keys depends on the
> values set for others; so for instance, if a user chooses
> "PublicTransport" as the value for the "FavouriteModeOfTransport" key,
> he will be able to choose from "Bus", "Metro", "Tramway" as possible
> values for the "FavouriteModeOfPublicTransport" key, but if he chooses
> "Motorbike" as the value for "FavouriteModeOfTransport", he won't be
> able to enter a value for "FavouriteModeOfPublicTransport" (validation
> would fail in the data validation routine, and the field wouldn't be
> displayed on the front end). There will be 40-50 different possible
> fields, out of which around 15 or so would be dependent on the values
> chosen for other fields. I can't guarantee the ordering of the keys,
> although I can guarantee that the "FavouriteModeOfPublicTransport" key
> would always be set after the "FavouriteModeOfTransport" key.
> 
> I was thinking as implementing this as a scanner, using conditions to
> determine whether the field is valid or not (for instance, the
> "FavouriteModeOfPublicTransport" field would only be valid if a
> "FavouriteModeOfTransport" field has already been supplied with the
> value set to "PublicTransport"). The disadvantage is that the full set
> of state transitions isn't purely defined in Ragel, which potentially
> makes the FSM hard to read (though if I'm correct defining the
> possible states for 15 conditional fields in Ragel would require 15^15
> different state definitions, which would probably be worse).
> 
> Do you think this approach would work? Am I missing a better way of
> doing this?
> 
> Thanks,
> Nick
> 


From flamee... at gmail.com  Wed Oct  1 14:36:52 2008
From: flamee... at gmail.com (Diego 'Flameeyes' =?utf-8?q?Petten=C3=B2?=)
Date: Wed, 01 Oct 2008 16:36:52 +0200
Subject: [PATCH 2/6] Remove files generated by autotools.
Message-ID: <20081001143647.22980.41584.stgit@yamato>

Remove from the repository the configure and config.h.in files
(generated by autoconf and autoheader respectively).

By removing config.h.in some information is lost (MSC support); to
restore that information, a config.h file might be created
specifically for MSC which only contains its definitions.
---

 common/config.h.in |   40 
 configure          | 4680 ----------------------------------------------------
 2 files changed, 0 insertions(+), 4720 deletions(-)
 delete mode 100644 common/config.h.in
 delete mode 100755 configure

diff --git a/common/config.h.in b/common/config.h.in
deleted file mode 100644
index eaacfb3..0000000
--- a/common/config.h.in
+++ /dev/null
@@ -1,40 +0,0 @@
-/*
- *  Copyright 2001 Adrian Thurston <thurs... at cs.queensu.ca>
- */
-
-/*  This file is part of Ragel.
- *
- *  Ragel is free software; you can redistribute it and/or modify
- *  it under the terms of the GNU General Public License as published by
- *  the Free Software Foundation; either version 2 of the License, or
- *  (at your option) any later version.
- * 
- *  Ragel is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  GNU General Public License for more details.
- * 
- *  You should have received a copy of the GNU General Public License
- *  along with Ragel; if not, write to the Free Software
- *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
- */
-
-#ifndef _CONFIG_H
-#define _CONFIG_H
-
-/* Programs. */
-#undef GDC
-#undef GOBJC
-#undef CXX
-#undef CC
-#undef JAVAC
-#undef TXL
-#undef RUBY
-#undef GMCS
-
-#ifdef _MSC_VER
-#define strtoll _strtoi64
-#pragma warning( disable: 4244 4250 4355 4800 )
-#endif
-
-#endif /* _CONFIG_H */
diff --git a/configure b/configure
deleted file mode 100755
index 47a1e4a..0000000
--- a/configure
+++ /dev/null
@@ -1,4680 +0,0 @@
-#! /bin/sh
-# Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.61.
-#
-# Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
-# 2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.
-# This configure script is free software; the Free Software Foundation
-# gives unlimited permission to copy, distribute and modify it.
-## --------------------- ##
-## M4sh Initialization.  ##
-## --------------------- ##
-
-# Be more Bourne compatible
-DUALCASE=1; export DUALCASE # for MKS sh
-if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
-  emulate sh
-  NULLCMD=:
-  # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
-  # is contrary to our usage.  Disable this feature.
-  alias -g '${1+"$@"}'='"$@"'
-  setopt NO_GLOB_SUBST
-else
-  case `(set -o) 2>/dev/null` in
-  *posix*) set -o posix ;;
-esac
-
-fi
-
-
-
-
-# PATH needs CR
-# Avoid depending upon Character Ranges.
-as_cr_letters='abcdefghijklmnopqrstuvwxyz'
-as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
-as_cr_Letters=$as_cr_letters$as_cr_LETTERS
-as_cr_digits='0123456789'
-as_cr_alnum=$as_cr_Letters$as_cr_digits
-
-# The user is always right.
-if test "${PATH_SEPARATOR+set}" != set; then
-  echo "#! /bin/sh" >conf$$.sh
-  echo  "exit 0"   >>conf$$.sh
-  chmod +x conf$$.sh
-  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
-    PATH_SEPARATOR=';'
-  else
-    PATH_SEPARATOR=:
-  fi
-  rm -f conf$$.sh
-fi
-
-# Support unset when possible.
-if ( (MAIL=60; unset MAIL) || exit) >/dev/null 2>&1; then
-  as_unset=unset
-else
-  as_unset=false
-fi
-
-
-# IFS
-# We need space, tab and new line, in precisely that order.  Quoting is
-# there to prevent editors from complaining about space-tab.
-# (If _AS_PATH_WALK were called with IFS unset, it would disable word
-# splitting by setting IFS to empty value.)
-as_nl='
-'
-IFS=" ""	$as_nl"
-
-# Find who we are.  Look in the path if we contain no directory separator.
-case $0 in
-  *[\\/]* ) as_myself=$0 ;;
-  *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
-done
-IFS=$as_save_IFS
-
-     ;;
-esac
-# We did not find ourselves, most probably we were run as `sh COMMAND'
-# in which case we are not to be found in the path.
-if test "x$as_myself" = x; then
-  as_myself=$0
-fi
-if test ! -f "$as_myself"; then
-  echo "$as_myself: error: cannot find myself; rerun with an absolute file name" >&2
-  { (exit 1); exit 1; }
-fi
-
-# Work around bugs in pre-3.0 UWIN ksh.
-for as_var in ENV MAIL MAILPATH
-do ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
-done
-PS1='$ '
-PS2='> '
-PS4='+ '
-
-# NLS nuisances.
-for as_var in \
-  LANG LANGUAGE LC_ADDRESS LC_ALL LC_COLLATE LC_CTYPE LC_IDENTIFICATION \
-  LC_MEASUREMENT LC_MESSAGES LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER \
-  LC_TELEPHONE LC_TIME
-do
-  if (set +x; test -z "`(eval $as_var=C; export $as_var) 2>&1`"); then
-    eval $as_var=C; export $as_var
-  else
-    ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
-  fi
-done
-
-# Required to use basename.
-if expr a : '\(a\)' >/dev/null 2>&1 &&
-   test "X`expr 00001 : '.*\(...\)'`" = X001; then
-  as_expr=expr
-else
-  as_expr=false
-fi
-
-if (basename -- /) >/dev/null 2>&1 && test "X`basename -- / 2>&1`" = "X/"; then
-  as_basename=basename
-else
-  as_basename=false
-fi
-
-
-# Name of the executable.
-as_me=`$as_basename -- "$0" ||
-$as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
-	 X"$0" : 'X\(//\)$' \| \
-	 X"$0" : 'X\(/\)' \| . 2>/dev/null ||
-echo X/"$0" |
-    sed '/^.*\/\([^/][^/]*\)\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\/\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\/\(\/\).*/{
-	    s//\1/
-	    q
-	  }
-	  s/.*/./; q'`
-
-# CDPATH.
-$as_unset CDPATH
-
-
-if test "x$CONFIG_SHELL" = x; then
-  if (eval ":") 2>/dev/null; then
-  as_have_required=yes
-else
-  as_have_required=no
-fi
-
-  if test $as_have_required = yes && 	 (eval ":
-(as_func_return () {
-  (exit \$1)
-}
-as_func_success () {
-  as_func_return 0
-}
-as_func_failure () {
-  as_func_return 1
-}
-as_func_ret_success () {
-  return 0
-}
-as_func_ret_failure () {
-  return 1
-}
-
-exitcode=0
-if as_func_success; then
-  :
-else
-  exitcode=1
-  echo as_func_success failed.
-fi
-
-if as_func_failure; then
-  exitcode=1
-  echo as_func_failure succeeded.
-fi
-
-if as_func_ret_success; then
-  :
-else
-  exitcode=1
-  echo as_func_ret_success failed.
-fi
-
-if as_func_ret_failure; then
-  exitcode=1
-  echo as_func_ret_failure succeeded.
-fi
-
-if ( set x; as_func_ret_success y && test x = \"\$1\" ); then
-  :
-else
-  exitcode=1
-  echo positional parameters were not saved.
-fi
-
-test \$exitcode = 0) || { (exit 1); exit 1; }
-
-(
-  as_lineno_1=\$LINENO
-  as_lineno_2=\$LINENO
-  test \"x\$as_lineno_1\" != \"x\$as_lineno_2\" &&
-  test \"x\`expr \$as_lineno_1 + 1\`\" = \"x\$as_lineno_2\") || { (exit 1); exit 1; }
-") 2> /dev/null; then
-  :
-else
-  as_candidate_shells=
-    as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in /bin$PATH_SEPARATOR/usr/bin$PATH_SEPARATOR$PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  case $as_dir in
-	 /*)
-	   for as_base in sh bash ksh sh5; do
-	     as_candidate_shells="$as_candidate_shells $as_dir/$as_base"
-	   done;;
-       esac
-done
-IFS=$as_save_IFS
-
-
-      for as_shell in $as_candidate_shells $SHELL; do
-	 # Try only shells that exist, to save several forks.
-	 if { test -f "$as_shell" || test -f "$as_shell.exe"; } &&
-		{ ("$as_shell") 2> /dev/null <<\_ASEOF
-if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
-  emulate sh
-  NULLCMD=:
-  # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
-  # is contrary to our usage.  Disable this feature.
-  alias -g '${1+"$@"}'='"$@"'
-  setopt NO_GLOB_SUBST
-else
-  case `(set -o) 2>/dev/null` in
-  *posix*) set -o posix ;;
-esac
-
-fi
-
-
-:
-_ASEOF
-}; then
-  CONFIG_SHELL=$as_shell
-	       as_have_required=yes
-	       if { "$as_shell" 2> /dev/null <<\_ASEOF
-if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
-  emulate sh
-  NULLCMD=:
-  # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
-  # is contrary to our usage.  Disable this feature.
-  alias -g '${1+"$@"}'='"$@"'
-  setopt NO_GLOB_SUBST
-else
-  case `(set -o) 2>/dev/null` in
-  *posix*) set -o posix ;;
-esac
-
-fi
-
-
-:
-(as_func_return () {
-  (exit $1)
-}
-as_func_success () {
-  as_func_return 0
-}
-as_func_failure () {
-  as_func_return 1
-}
-as_func_ret_success () {
-  return 0
-}
-as_func_ret_failure () {
-  return 1
-}
-
-exitcode=0
-if as_func_success; then
-  :
-else
-  exitcode=1
-  echo as_func_success failed.
-fi
-
-if as_func_failure; then
-  exitcode=1
-  echo as_func_failure succeeded.
-fi
-
-if as_func_ret_success; then
-  :
-else
-  exitcode=1
-  echo as_func_ret_success failed.
-fi
-
-if as_func_ret_failure; then
-  exitcode=1
-  echo as_func_ret_failure succeeded.
-fi
-
-if ( set x; as_func_ret_success y && test x = "$1" ); then
-  :
-else
-  exitcode=1
-  echo positional parameters were not saved.
-fi
-
-test $exitcode = 0) || { (exit 1); exit 1; }
-
-(
-  as_lineno_1=$LINENO
-  as_lineno_2=$LINENO
-  test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x`expr $as_lineno_1 + 1`" = "x$as_lineno_2") || { (exit 1); exit 1; }
-
-_ASEOF
-}; then
-  break
-fi
-
-fi
-
-      done
-
-      if test "x$CONFIG_SHELL" != x; then
-  for as_var in BASH_ENV ENV
-        do ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
-        done
-        export CONFIG_SHELL
-        exec "$CONFIG_SHELL" "$as_myself" ${1+"$@"}
-fi
-
-
-    if test $as_have_required = no; then
-  echo This script requires a shell more modern than all the
-      echo shells that I found on your system.  Please install a
-      echo modern shell, or manually run the script under such a
-      echo shell if you do have one.
-      { (exit 1); exit 1; }
-fi
-
-
-fi
-
-fi
-
-
-
-(eval "as_func_return () {
-  (exit \$1)
-}
-as_func_success () {
-  as_func_return 0
-}
-as_func_failure () {
-  as_func_return 1
-}
-as_func_ret_success () {
-  return 0
-}
-as_func_ret_failure () {
-  return 1
-}
-
-exitcode=0
-if as_func_success; then
-  :
-else
-  exitcode=1
-  echo as_func_success failed.
-fi
-
-if as_func_failure; then
-  exitcode=1
-  echo as_func_failure succeeded.
-fi
-
-if as_func_ret_success; then
-  :
-else
-  exitcode=1
-  echo as_func_ret_success failed.
-fi
-
-if as_func_ret_failure; then
-  exitcode=1
-  echo as_func_ret_failure succeeded.
-fi
-
-if ( set x; as_func_ret_success y && test x = \"\$1\" ); then
-  :
-else
-  exitcode=1
-  echo positional parameters were not saved.
-fi
-
-test \$exitcode = 0") || {
-  echo No shell found that supports shell functions.
-  echo Please tell autoc... at gnu.org about your system,
-  echo including any error possibly output before this
-  echo message
-}
-
-
-
-  as_lineno_1=$LINENO
-  as_lineno_2=$LINENO
-  test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x`expr $as_lineno_1 + 1`" = "x$as_lineno_2" || {
-
-  # Create $as_me.lineno as a copy of $as_myself, but with $LINENO
-  # uniformly replaced by the line number.  The first 'sed' inserts a
-  # line-number line after each line using $LINENO; the second 'sed'
-  # does the real work.  The second script uses 'N' to pair each
-  # line-number line with the line containing $LINENO, and appends
-  # trailing '-' during substitution so that $LINENO is not a special
-  # case at line end.
-  # (Raja R Harinath suggested sed '=', and Paul Eggert wrote the
-  # scripts with optimization help from Paolo Bonzini.  Blame Lee
-  # E. McMahon (1931-1989) for sed's syntax.  :-)
-  sed -n '
-    p
-    /[$]LINENO/=
-  ' <$as_myself |
-    sed '
-      s/[$]LINENO.*/&-/
-      t lineno
-      b
-      :lineno
-      N
-      :loop
-      s/[$]LINENO\([^'$as_cr_alnum'_].*\n\)\(.*\)/\2\1\2/
-      t loop
-      s/-\n.*//
-    ' >$as_me.lineno &&
-  chmod +x "$as_me.lineno" ||
-    { echo "$as_me: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&2
-   { (exit 1); exit 1; }; }
-
-  # Don't try to exec as it changes $[0], causing all sort of problems
-  # (the dirname of $[0] is not the place where we might find the
-  # original and so on.  Autoconf is especially sensitive to this).
-  . "./$as_me.lineno"
-  # Exit status is that of the last command.
-  exit
-}
-
-
-if (as_dir=`dirname -- /` && test "X$as_dir" = X/) >/dev/null 2>&1; then
-  as_dirname=dirname
-else
-  as_dirname=false
-fi
-
-ECHO_C= ECHO_N= ECHO_T=
-case `echo -n x` in
--n*)
-  case `echo 'x\c'` in
-  *c*) ECHO_T='	';;	# ECHO_T is single tab character.
-  *)   ECHO_C='\c';;
-  esac;;
-*)
-  ECHO_N='-n';;
-esac
-
-if expr a : '\(a\)' >/dev/null 2>&1 &&
-   test "X`expr 00001 : '.*\(...\)'`" = X001; then
-  as_expr=expr
-else
-  as_expr=false
-fi
-
-rm -f conf$$ conf$$.exe conf$$.file
-if test -d conf$$.dir; then
-  rm -f conf$$.dir/conf$$.file
-else
-  rm -f conf$$.dir
-  mkdir conf$$.dir
-fi
-echo >conf$$.file
-if ln -s conf$$.file conf$$ 2>/dev/null; then
-  as_ln_s='ln -s'
-  # ... but there are two gotchas:
-  # 1) On MSYS, both `ln -s file dir' and `ln file dir' fail.
-  # 2) DJGPP < 2.04 has no symlinks; `ln -s' creates a wrapper executable.
-  # In both cases, we have to default to `cp -p'.
-  ln -s conf$$.file conf$$.dir 2>/dev/null && test ! -f conf$$.exe ||
-    as_ln_s='cp -p'
-elif ln conf$$.file conf$$ 2>/dev/null; then
-  as_ln_s=ln
-else
-  as_ln_s='cp -p'
-fi
-rm -f conf$$ conf$$.exe conf$$.dir/conf$$.file conf$$.file
-rmdir conf$$.dir 2>/dev/null
-
-if mkdir -p . 2>/dev/null; then
-  as_mkdir_p=:
-else
-  test -d ./-p && rmdir ./-p
-  as_mkdir_p=false
-fi
-
-if test -x / >/dev/null 2>&1; then
-  as_test_x='test -x'
-else
-  if ls -dL / >/dev/null 2>&1; then
-    as_ls_L_option=L
-  else
-    as_ls_L_option=
-  fi
-  as_test_x='
-    eval sh -c '\''
-      if test -d "$1"; then
-        test -d "$1/.";
-      else
-	case $1 in
-        -*)set "./$1";;
-	esac;
-	case `ls -ld'$as_ls_L_option' "$1" 2>/dev/null` in
-	???[sx]*):;;*)false;;esac;fi
-    '\'' sh
-  '
-fi
-as_executable_p=$as_test_x
-
-# Sed expression to map a string onto a valid CPP name.
-as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
-
-# Sed expression to map a string onto a valid variable name.
-as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"
-
-
-
-exec 7<&0 </dev/null 6>&1
-
-# Name of the host.
-# hostname on some systems (SVR3.2, Linux) returns a bogus exit status,
-# so uname gets run too.
-ac_hostname=`(hostname || uname -n) 2>/dev/null | sed 1q`
-
-#
-# Initializations.
-#
-ac_default_prefix=/usr/local
-ac_clean_files=
-ac_config_libobj_dir=.
-LIBOBJS=
-cross_compiling=no
-subdirs=
-MFLAGS=
-MAKEFLAGS=
-SHELL=${CONFIG_SHELL-/bin/sh}
-
-# Identity of this package.
-PACKAGE_NAME=
-PACKAGE_TARNAME=
-PACKAGE_VERSION=
-PACKAGE_STRING=
-PACKAGE_BUGREPORT=
-
-ac_unique_file="ragel/main.cpp"
-ac_subst_vars='SHELL
-PATH_SEPARATOR
-PACKAGE_NAME
-PACKAGE_TARNAME
-PACKAGE_VERSION
-PACKAGE_STRING
-PACKAGE_BUGREPORT
-exec_prefix
-prefix
-program_transform_name
-bindir
-sbindir
-libexecdir
-datarootdir
-datadir
-sysconfdir
-sharedstatedir
-localstatedir
-includedir
-oldincludedir
-docdir
-infodir
-htmldir
-dvidir
-pdfdir
-psdir
-libdir
-localedir
-mandir
-DEFS
-ECHO_C
-ECHO_N
-ECHO_T
-LIBS
-build_alias
-host_alias
-target_alias
-BUILD_PARSERS
-CC
-CFLAGS
-LDFLAGS
-CPPFLAGS
-ac_ct_CC
-EXEEXT
-OBJEXT
-CXX
-CXXFLAGS
-ac_ct_CXX
-AR
-RANLIB
-SET_MAKE
-RAGEL
-GPERF
-KELBT
-GDC
-GOBJC
-JAVAC
-TXL
-RUBY
-GMCS
-LIBOBJS
-LTLIBOBJS'
-ac_subst_files=''
-      ac_precious_vars='build_alias
-host_alias
-target_alias
-CC
-CFLAGS
-LDFLAGS
-LIBS
-CPPFLAGS
-CXX
-CXXFLAGS
-CCC'
-
-
-# Initialize some variables set by options.
-ac_init_help=
-ac_init_version=false
-# The variables have the same names as the options, with
-# dashes changed to underlines.
-cache_file=/dev/null
-exec_prefix=NONE
-no_create=
-no_recursion=
-prefix=NONE
-program_prefix=NONE
-program_suffix=NONE
-program_transform_name=s,x,x,
-silent=
-site=
-srcdir=
-verbose=
-x_includes=NONE
-x_libraries=NONE
-
-# Installation directory options.
-# These are left unexpanded so users can "make install exec_prefix=/foo"
-# and all the variables that are supposed to be based on exec_prefix
-# by default will actually change.
-# Use braces instead of parens because sh, perl, etc. also accept them.
-# (The list follows the same order as the GNU Coding Standards.)
-bindir='${exec_prefix}/bin'
-sbindir='${exec_prefix}/sbin'
-libexecdir='${exec_prefix}/libexec'
-datarootdir='${prefix}/share'
-datadir='${datarootdir}'
-sysconfdir='${prefix}/etc'
-sharedstatedir='${prefix}/com'
-localstatedir='${prefix}/var'
-includedir='${prefix}/include'
-oldincludedir='/usr/include'
-docdir='${datarootdir}/doc/${PACKAGE}'
-infodir='${datarootdir}/info'
-htmldir='${docdir}'
-dvidir='${docdir}'
-pdfdir='${docdir}'
-psdir='${docdir}'
-libdir='${exec_prefix}/lib'
-localedir='${datarootdir}/locale'
-mandir='${datarootdir}/man'
-
-ac_prev=
-ac_dashdash=
-for ac_option
-do
-  # If the previous option needs an argument, assign it.
-  if test -n "$ac_prev"; then
-    eval $ac_prev=\$ac_option
-    ac_prev=
-    continue
-  fi
-
-  case $ac_option in
-  *=*)	ac_optarg=`expr "X$ac_option" : '[^=]*=\(.*\)'` ;;
-  *)	ac_optarg=yes ;;
-  esac
-
-  # Accept the important Cygnus configure options, so we can diagnose typos.
-
-  case $ac_dashdash$ac_option in
-  --)
-    ac_dashdash=yes ;;
-
-  -bindir | --bindir | --bindi | --bind | --bin | --bi)
-    ac_prev=bindir ;;
-  -bindir=* | --bindir=* | --bindi=* | --bind=* | --bin=* | --bi=*)
-    bindir=$ac_optarg ;;
-
-  -build | --build | --buil | --bui | --bu)
-    ac_prev=build_alias ;;
-  -build=* | --build=* | --buil=* | --bui=* | --bu=*)
-    build_alias=$ac_optarg ;;
-
-  -cache-file | --cache-file | --cache-fil | --cache-fi \
-  | --cache-f | --cache- | --cache | --cach | --cac | --ca | --c)
-    ac_prev=cache_file ;;
-  -cache-file=* | --cache-file=* | --cache-fil=* | --cache-fi=* \
-  | --cache-f=* | --cache-=* | --cache=* | --cach=* | --cac=* | --ca=* | --c=*)
-    cache_file=$ac_optarg ;;
-
-  --config-cache | -C)
-    cache_file=config.cache ;;
-
-  -datadir | --datadir | --datadi | --datad)
-    ac_prev=datadir ;;
-  -datadir=* | --datadir=* | --datadi=* | --datad=*)
-    datadir=$ac_optarg ;;
-
-  -datarootdir | --datarootdir | --datarootdi | --datarootd | --dataroot \
-  | --dataroo | --dataro | --datar)
-    ac_prev=datarootdir ;;
-  -datarootdir=* | --datarootdir=* | --datarootdi=* | --datarootd=* \
-  | --dataroot=* | --dataroo=* | --dataro=* | --datar=*)
-    datarootdir=$ac_optarg ;;
-
-  -disable-* | --disable-*)
-    ac_feature=`expr "x$ac_option" : 'x-*disable-\(.*\)'`
-    # Reject names that are not valid shell variable names.
-    expr "x$ac_feature" : ".*[^-._$as_cr_alnum]" >/dev/null &&
-      { echo "$as_me: error: invalid feature name: $ac_feature" >&2
-   { (exit 1); exit 1; }; }
-    ac_feature=`echo $ac_feature | sed 's/[-.]/_/g'`
-    eval enable_$ac_feature=no ;;
-
-  -docdir | --docdir | --docdi | --doc | --do)
-    ac_prev=docdir ;;
-  -docdir=* | --docdir=* | --docdi=* | --doc=* | --do=*)
-    docdir=$ac_optarg ;;
-
-  -dvidir | --dvidir | --dvidi | --dvid | --dvi | --dv)
-    ac_prev=dvidir ;;
-  -dvidir=* | --dvidir=* | --dvidi=* | --dvid=* | --dvi=* | --dv=*)
-    dvidir=$ac_optarg ;;
-
-  -enable-* | --enable-*)
-    ac_feature=`expr "x$ac_option" : 'x-*enable-\([^=]*\)'`
-    # Reject names that are not valid shell variable names.
-    expr "x$ac_feature" : ".*[^-._$as_cr_alnum]" >/dev/null &&
-      { echo "$as_me: error: invalid feature name: $ac_feature" >&2
-   { (exit 1); exit 1; }; }
-    ac_feature=`echo $ac_feature | sed 's/[-.]/_/g'`
-    eval enable_$ac_feature=\$ac_optarg ;;
-
-  -exec-prefix | --exec_prefix | --exec-prefix | --exec-prefi \
-  | --exec-pref | --exec-pre | --exec-pr | --exec-p | --exec- \
-  | --exec | --exe | --ex)
-    ac_prev=exec_prefix ;;
-  -exec-prefix=* | --exec_prefix=* | --exec-prefix=* | --exec-prefi=* \
-  | --exec-pref=* | --exec-pre=* | --exec-pr=* | --exec-p=* | --exec-=* \
-  | --exec=* | --exe=* | --ex=*)
-    exec_prefix=$ac_optarg ;;
-
-  -gas | --gas | --ga | --g)
-    # Obsolete; use --with-gas.
-    with_gas=yes ;;
-
-  -help | --help | --hel | --he | -h)
-    ac_init_help=long ;;
-  -help=r* | --help=r* | --hel=r* | --he=r* | -hr*)
-    ac_init_help=recursive ;;
-  -help=s* | --help=s* | --hel=s* | --he=s* | -hs*)
-    ac_init_help=short ;;
-
-  -host | --host | --hos | --ho)
-    ac_prev=host_alias ;;
-  -host=* | --host=* | --hos=* | --ho=*)
-    host_alias=$ac_optarg ;;
-
-  -htmldir | --htmldir | --htmldi | --htmld | --html | --htm | --ht)
-    ac_prev=htmldir ;;
-  -htmldir=* | --htmldir=* | --htmldi=* | --htmld=* | --html=* | --htm=* \
-  | --ht=*)
-    htmldir=$ac_optarg ;;
-
-  -includedir | --includedir | --includedi | --included | --include \
-  | --includ | --inclu | --incl | --inc)
-    ac_prev=includedir ;;
-  -includedir=* | --includedir=* | --includedi=* | --included=* | --include=* \
-  | --includ=* | --inclu=* | --incl=* | --inc=*)
-    includedir=$ac_optarg ;;
-
-  -infodir | --infodir | --infodi | --infod | --info | --inf)
-    ac_prev=infodir ;;
-  -infodir=* | --infodir=* | --infodi=* | --infod=* | --info=* | --inf=*)
-    infodir=$ac_optarg ;;
-
-  -libdir | --libdir | --libdi | --libd)
-    ac_prev=libdir ;;
-  -libdir=* | --libdir=* | --libdi=* | --libd=*)
-    libdir=$ac_optarg ;;
-
-  -libexecdir | --libexecdir | --libexecdi | --libexecd | --libexec \
-  | --libexe | --libex | --libe)
-    ac_prev=libexecdir ;;
-  -libexecdir=* | --libexecdir=* | --libexecdi=* | --libexecd=* | --libexec=* \
-  | --libexe=* | --libex=* | --libe=*)
-    libexecdir=$ac_optarg ;;
-
-  -localedir | --localedir | --localedi | --localed | --locale)
-    ac_prev=localedir ;;
-  -localedir=* | --localedir=* | --localedi=* | --localed=* | --locale=*)
-    localedir=$ac_optarg ;;
-
-  -localstatedir | --localstatedir | --localstatedi | --localstated \
-  | --localstate | --localstat | --localsta | --localst | --locals)
-    ac_prev=localstatedir ;;
-  -localstatedir=* | --localstatedir=* | --localstatedi=* | --localstated=* \
-  | --localstate=* | --localstat=* | --localsta=* | --localst=* | --locals=*)
-    localstatedir=$ac_optarg ;;
-
-  -mandir | --mandir | --mandi | --mand | --man | --ma | --m)
-    ac_prev=mandir ;;
-  -mandir=* | --mandir=* | --mandi=* | --mand=* | --man=* | --ma=* | --m=*)
-    mandir=$ac_optarg ;;
-
-  -nfp | --nfp | --nf)
-    # Obsolete; use --without-fp.
-    with_fp=no ;;
-
-  -no-create | --no-create | --no-creat | --no-crea | --no-cre \
-  | --no-cr | --no-c | -n)
-    no_create=yes ;;
-
-  -no-recursion | --no-recursion | --no-recursio | --no-recursi \
-  | --no-recurs | --no-recur | --no-recu | --no-rec | --no-re | --no-r)
-    no_recursion=yes ;;
-
-  -oldincludedir | --oldincludedir | --oldincludedi | --oldincluded \
-  | --oldinclude | --oldinclud | --oldinclu | --oldincl | --oldinc \
-  | --oldin | --oldi | --old | --ol | --o)
-    ac_prev=oldincludedir ;;
-  -oldincludedir=* | --oldincludedir=* | --oldincludedi=* | --oldincluded=* \
-  | --oldinclude=* | --oldinclud=* | --oldinclu=* | --oldincl=* | --oldinc=* \
-  | --oldin=* | --oldi=* | --old=* | --ol=* | --o=*)
-    oldincludedir=$ac_optarg ;;
-
-  -prefix | --prefix | --prefi | --pref | --pre | --pr | --p)
-    ac_prev=prefix ;;
-  -prefix=* | --prefix=* | --prefi=* | --pref=* | --pre=* | --pr=* | --p=*)
-    prefix=$ac_optarg ;;
-
-  -program-prefix | --program-prefix | --program-prefi | --program-pref \
-  | --program-pre | --program-pr | --program-p)
-    ac_prev=program_prefix ;;
-  -program-prefix=* | --program-prefix=* | --program-prefi=* \
-  | --program-pref=* | --program-pre=* | --program-pr=* | --program-p=*)
-    program_prefix=$ac_optarg ;;
-
-  -program-suffix | --program-suffix | --program-suffi | --program-suff \
-  | --program-suf | --program-su | --program-s)
-    ac_prev=program_suffix ;;
-  -program-suffix=* | --program-suffix=* | --program-suffi=* \
-  | --program-suff=* | --program-suf=* | --program-su=* | --program-s=*)
-    program_suffix=$ac_optarg ;;
-
-  -program-transform-name | --program-transform-name \
-  | --program-transform-nam | --program-transform-na \
-  | --program-transform-n | --program-transform- \
-  | --program-transform | --program-transfor \
-  | --program-transfo | --program-transf \
-  | --program-trans | --program-tran \
-  | --progr-tra | --program-tr | --program-t)
-    ac_prev=program_transform_name ;;
-  -program-transform-name=* | --program-transform-name=* \
-  | --program-transform-nam=* | --program-transform-na=* \
-  | --program-transform-n=* | --program-transform-=* \
-  | --program-transform=* | --program-transfor=* \
-  | --program-transfo=* | --program-transf=* \
-  | --program-trans=* | --program-tran=* \
-  | --progr-tra=* | --program-tr=* | --program-t=*)
-    program_transform_name=$ac_optarg ;;
-
-  -pdfdir | --pdfdir | --pdfdi | --pdfd | --pdf | --pd)
-    ac_prev=pdfdir ;;
-  -pdfdir=* | --pdfdir=* | --pdfdi=* | --pdfd=* | --pdf=* | --pd=*)
-    pdfdir=$ac_optarg ;;
-
-  -psdir | --psdir | --psdi | --psd | --ps)
-    ac_prev=psdir ;;
-  -psdir=* | --psdir=* | --psdi=* | --psd=* | --ps=*)
-    psdir=$ac_optarg ;;
-
-  -q | -quiet | --quiet | --quie | --qui | --qu | --q \
-  | -silent | --silent | --silen | --sile | --sil)
-    silent=yes ;;
-
-  -sbindir | --sbindir | --sbindi | --sbind | --sbin | --sbi | --sb)
-    ac_prev=sbindir ;;
-  -sbindir=* | --sbindir=* | --sbindi=* | --sbind=* | --sbin=* \
-  | --sbi=* | --sb=*)
-    sbindir=$ac_optarg ;;
-
-  -sharedstatedir | --sharedstatedir | --sharedstatedi \
-  | --sharedstated | --sharedstate | --sharedstat | --sharedsta \
-  | --sharedst | --shareds | --shared | --share | --shar \
-  | --sha | --sh)
-    ac_prev=sharedstatedir ;;
-  -sharedstatedir=* | --sharedstatedir=* | --sharedstatedi=* \
-  | --sharedstated=* | --sharedstate=* | --sharedstat=* | --sharedsta=* \
-  | --sharedst=* | --shareds=* | --shared=* | --share=* | --shar=* \
-  | --sha=* | --sh=*)
-    sharedstatedir=$ac_optarg ;;
-
-  -site | --site | --sit)
-    ac_prev=site ;;
-  -site=* | --site=* | --sit=*)
-    site=$ac_optarg ;;
-
-  -srcdir | --srcdir | --srcdi | --srcd | --src | --sr)
-    ac_prev=srcdir ;;
-  -srcdir=* | --srcdir=* | --srcdi=* | --srcd=* | --src=* | --sr=*)
-    srcdir=$ac_optarg ;;
-
-  -sysconfdir | --sysconfdir | --sysconfdi | --sysconfd | --sysconf \
-  | --syscon | --sysco | --sysc | --sys | --sy)
-    ac_prev=sysconfdir ;;
-  -sysconfdir=* | --sysconfdir=* | --sysconfdi=* | --sysconfd=* | --sysconf=* \
-  | --syscon=* | --sysco=* | --sysc=* | --sys=* | --sy=*)
-    sysconfdir=$ac_optarg ;;
-
-  -target | --target | --targe | --targ | --tar | --ta | --t)
-    ac_prev=target_alias ;;
-  -target=* | --target=* | --targe=* | --targ=* | --tar=* | --ta=* | --t=*)
-    target_alias=$ac_optarg ;;
-
-  -v | -verbose | --verbose | --verbos | --verbo | --verb)
-    verbose=yes ;;
-
-  -version | --version | --versio | --versi | --vers | -V)
-    ac_init_version=: ;;
-
-  -with-* | --with-*)
-    ac_package=`expr "x$ac_option" : 'x-*with-\([^=]*\)'`
-    # Reject names that are not valid shell variable names.
-    expr "x$ac_package" : ".*[^-._$as_cr_alnum]" >/dev/null &&
-      { echo "$as_me: error: invalid package name: $ac_package" >&2
-   { (exit 1); exit 1; }; }
-    ac_package=`echo $ac_package | sed 's/[-.]/_/g'`
-    eval with_$ac_package=\$ac_optarg ;;
-
-  -without-* | --without-*)
-    ac_package=`expr "x$ac_option" : 'x-*without-\(.*\)'`
-    # Reject names that are not valid shell variable names.
-    expr "x$ac_package" : ".*[^-._$as_cr_alnum]" >/dev/null &&
-      { echo "$as_me: error: invalid package name: $ac_package" >&2
-   { (exit 1); exit 1; }; }
-    ac_package=`echo $ac_package | sed 's/[-.]/_/g'`
-    eval with_$ac_package=no ;;
-
-  --x)
-    # Obsolete; use --with-x.
-    with_x=yes ;;
-
-  -x-includes | --x-includes | --x-include | --x-includ | --x-inclu \
-  | --x-incl | --x-inc | --x-in | --x-i)
-    ac_prev=x_includes ;;
-  -x-includes=* | --x-includes=* | --x-include=* | --x-includ=* | --x-inclu=* \
-  | --x-incl=* | --x-inc=* | --x-in=* | --x-i=*)
-    x_includes=$ac_optarg ;;
-
-  -x-libraries | --x-libraries | --x-librarie | --x-librari \
-  | --x-librar | --x-libra | --x-libr | --x-lib | --x-li | --x-l)
-    ac_prev=x_libraries ;;
-  -x-libraries=* | --x-libraries=* | --x-librarie=* | --x-librari=* \
-  | --x-librar=* | --x-libra=* | --x-libr=* | --x-lib=* | --x-li=* | --x-l=*)
-    x_libraries=$ac_optarg ;;
-
-  -*) { echo "$as_me: error: unrecognized option: $ac_option
-Try \`$0 --help' for more information." >&2
-   { (exit 1); exit 1; }; }
-    ;;
-
-  *=*)
-    ac_envvar=`expr "x$ac_option" : 'x\([^=]*\)='`
-    # Reject names that are not valid shell variable names.
-    expr "x$ac_envvar" : ".*[^_$as_cr_alnum]" >/dev/null &&
-      { echo "$as_me: error: invalid variable name: $ac_envvar" >&2
-   { (exit 1); exit 1; }; }
-    eval $ac_envvar=\$ac_optarg
-    export $ac_envvar ;;
-
-  *)
-    # FIXME: should be removed in autoconf 3.0.
-    echo "$as_me: WARNING: you should use --build, --host, --target" >&2
-    expr "x$ac_option" : ".*[^-._$as_cr_alnum]" >/dev/null &&
-      echo "$as_me: WARNING: invalid host type: $ac_option" >&2
-    : ${build_alias=$ac_option} ${host_alias=$ac_option} ${target_alias=$ac_option}
-    ;;
-
-  esac
-done
-
-if test -n "$ac_prev"; then
-  ac_option=--`echo $ac_prev | sed 's/_/-/g'`
-  { echo "$as_me: error: missing argument to $ac_option" >&2
-   { (exit 1); exit 1; }; }
-fi
-
-# Be sure to have absolute directory names.
-for ac_var in	exec_prefix prefix bindir sbindir libexecdir datarootdir \
-		datadir sysconfdir sharedstatedir localstatedir includedir \
-		oldincludedir docdir infodir htmldir dvidir pdfdir psdir \
-		libdir localedir mandir
-do
-  eval ac_val=\$$ac_var
-  case $ac_val in
-    [\\/$]* | ?:[\\/]* )  continue;;
-    NONE | '' ) case $ac_var in *prefix ) continue;; esac;;
-  esac
-  { echo "$as_me: error: expected an absolute directory name for --$ac_var: $ac_val" >&2
-   { (exit 1); exit 1; }; }
-done
-
-# There might be people who depend on the old broken behavior: `$host'
-# used to hold the argument of --host etc.
-# FIXME: To remove some day.
-build=$build_alias
-host=$host_alias
-target=$target_alias
-
-# FIXME: To remove some day.
-if test "x$host_alias" != x; then
-  if test "x$build_alias" = x; then
-    cross_compiling=maybe
-    echo "$as_me: WARNING: If you wanted to set the --build type, don't use --host.
-    If a cross compiler is detected then cross compile mode will be used." >&2
-  elif test "x$build_alias" != "x$host_alias"; then
-    cross_compiling=yes
-  fi
-fi
-
-ac_tool_prefix=
-test -n "$host_alias" && ac_tool_prefix=$host_alias-
-
-test "$silent" = yes && exec 6>/dev/null
-
-
-ac_pwd=`pwd` && test -n "$ac_pwd" &&
-ac_ls_di=`ls -di .` &&
-ac_pwd_ls_di=`cd "$ac_pwd" && ls -di .` ||
-  { echo "$as_me: error: Working directory cannot be determined" >&2
-   { (exit 1); exit 1; }; }
-test "X$ac_ls_di" = "X$ac_pwd_ls_di" ||
-  { echo "$as_me: error: pwd does not report name of working directory" >&2
-   { (exit 1); exit 1; }; }
-
-
-# Find the source files, if location was not specified.
-if test -z "$srcdir"; then
-  ac_srcdir_defaulted=yes
-  # Try the directory containing this script, then the parent directory.
-  ac_confdir=`$as_dirname -- "$0" ||
-$as_expr X"$0" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$0" : 'X\(//\)[^/]' \| \
-	 X"$0" : 'X\(//\)$' \| \
-	 X"$0" : 'X\(/\)' \| . 2>/dev/null ||
-echo X"$0" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)[^/].*/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\).*/{
-	    s//\1/
-	    q
-	  }
-	  s/.*/./; q'`
-  srcdir=$ac_confdir
-  if test ! -r "$srcdir/$ac_unique_file"; then
-    srcdir=..
-  fi
-else
-  ac_srcdir_defaulted=no
-fi
-if test ! -r "$srcdir/$ac_unique_file"; then
-  test "$ac_srcdir_defaulted" = yes && srcdir="$ac_confdir or .."
-  { echo "$as_me: error: cannot find sources ($ac_unique_file) in $srcdir" >&2
-   { (exit 1); exit 1; }; }
-fi
-ac_msg="sources are in $srcdir, but \`cd $srcdir' does not work"
-ac_abs_confdir=`(
-	cd "$srcdir" && test -r "./$ac_unique_file" || { echo "$as_me: error: $ac_msg" >&2
-   { (exit 1); exit 1; }; }
-	pwd)`
-# When building in place, set srcdir=.
-if test "$ac_abs_confdir" = "$ac_pwd"; then
-  srcdir=.
-fi
-# Remove unnecessary trailing slashes from srcdir.
-# Double slashes in file names in object file debugging info
-# mess up M-x gdb in Emacs.
-case $srcdir in
-*/) srcdir=`expr "X$srcdir" : 'X\(.*[^/]\)' \| "X$srcdir" : 'X\(.*\)'`;;
-esac
-for ac_var in $ac_precious_vars; do
-  eval ac_env_${ac_var}_set=\${${ac_var}+set}
-  eval ac_env_${ac_var}_value=\$${ac_var}
-  eval ac_cv_env_${ac_var}_set=\${${ac_var}+set}
-  eval ac_cv_env_${ac_var}_value=\$${ac_var}
-done
-
-#
-# Report the --help message.
-#
-if test "$ac_init_help" = "long"; then
-  # Omit some internal or obsolete options to make the list less imposing.
-  # This message is too long to be a string in the A/UX 3.1 sh.
-  cat <<_ACEOF
-\`configure' configures this package to adapt to many kinds of systems.
-
-Usage: $0 [OPTION]... [VAR=VALUE]...
-
-To assign environment variables (e.g., CC, CFLAGS...), specify them as
-VAR=VALUE.  See below for descriptions of some of the useful variables.
-
-Defaults for the options are specified in brackets.
-
-Configuration:
-  -h, --help              display this help and exit
-      --help=short        display options specific to this package
-      --help=recursive    display the short help of all the included packages
-  -V, --version           display version information and exit
-  -q, --quiet, --silent   do not print \`checking...' messages
-      --cache-file=FILE   cache test results in FILE [disabled]
-  -C, --config-cache      alias for \`--cache-file=config.cache'
-  -n, --no-create         do not create output files
-      --srcdir=DIR        find the sources in DIR [configure dir or \`..']
-
-Installation directories:
-  --prefix=PREFIX         install architecture-independent files in PREFIX
-			  [$ac_default_prefix]
-  --exec-prefix=EPREFIX   install architecture-dependent files in EPREFIX
-			  [PREFIX]
-
-By default, \`make install' will install all the files in
-\`$ac_default_prefix/bin', \`$ac_default_prefix/lib' etc.  You can specify
-an installation prefix other than \`$ac_default_prefix' using \`--prefix',
-for instance \`--prefix=\$HOME'.
-
-For better control, use the options below.
-
-Fine tuning of the installation directories:
-  --bindir=DIR           user executables [EPREFIX/bin]
-  --sbindir=DIR          system admin executables [EPREFIX/sbin]
-  --libexecdir=DIR       program executables [EPREFIX/libexec]
-  --sysconfdir=DIR       read-only single-machine data [PREFIX/etc]
-  --sharedstatedir=DIR   modifiable architecture-independent data [PREFIX/com]
-  --localstatedir=DIR    modifiable single-machine data [PREFIX/var]
-  --libdir=DIR           object code libraries [EPREFIX/lib]
-  --includedir=DIR       C header files [PREFIX/include]
-  --oldincludedir=DIR    C header files for non-gcc [/usr/include]
-  --datarootdir=DIR      read-only arch.-independent data root [PREFIX/share]
-  --datadir=DIR          read-only architecture-independent data [DATAROOTDIR]
-  --infodir=DIR          info documentation [DATAROOTDIR/info]
-  --localedir=DIR        locale-dependent data [DATAROOTDIR/locale]
-  --mandir=DIR           man documentation [DATAROOTDIR/man]
-  --docdir=DIR           documentation root [DATAROOTDIR/doc/PACKAGE]
-  --htmldir=DIR          html documentation [DOCDIR]
-  --dvidir=DIR           dvi documentation [DOCDIR]
-  --pdfdir=DIR           pdf documentation [DOCDIR]
-  --psdir=DIR            ps documentation [DOCDIR]
-_ACEOF
-
-  cat <<\_ACEOF
-_ACEOF
-fi
-
-if test -n "$ac_init_help"; then
-
-  cat <<\_ACEOF
-
-Some influential environment variables:
-  CC          C compiler command
-  CFLAGS      C compiler flags
-  LDFLAGS     linker flags, e.g. -L<lib dir> if you have libraries in a
-              nonstandard directory <lib dir>
-  LIBS        libraries to pass to the linker, e.g. -l<library>
-  CPPFLAGS    C/C++/Objective C preprocessor flags, e.g. -I<include dir> if
-              you have headers in a nonstandard directory <include dir>
-  CXX         C++ compiler command
-  CXXFLAGS    C++ compiler flags
-
-Use these variables to override the choices made by `configure' or to help
-it to find libraries and programs with nonstandard names/locations.
-
-_ACEOF
-ac_status=$?
-fi
-
-if test "$ac_init_help" = "recursive"; then
-  # If there are subdirs, report their specific --help.
-  for ac_dir in : $ac_subdirs_all; do test "x$ac_dir" = x: && continue
-    test -d "$ac_dir" || continue
-    ac_builddir=.
-
-case "$ac_dir" in
-.) ac_dir_suffix= ac_top_builddir_sub=. ac_top_build_prefix= ;;
-*)
-  ac_dir_suffix=/`echo "$ac_dir" | sed 's,^\.[\\/],,'`
-  # A ".." for each directory in $ac_dir_suffix.
-  ac_top_builddir_sub=`echo "$ac_dir_suffix" | sed 's,/[^\\/]*,/..,g;s,/,,'`
-  case $ac_top_builddir_sub in
-  "") ac_top_builddir_sub=. ac_top_build_prefix= ;;
-  *)  ac_top_build_prefix=$ac_top_builddir_sub/ ;;
-  esac ;;
-esac
-ac_abs_top_builddir=$ac_pwd
-ac_abs_builddir=$ac_pwd$ac_dir_suffix
-# for backward compatibility:
-ac_top_builddir=$ac_top_build_prefix
-
-case $srcdir in
-  .)  # We are building in place.
-    ac_srcdir=.
-    ac_top_srcdir=$ac_top_builddir_sub
-    ac_abs_top_srcdir=$ac_pwd ;;
-  [\\/]* | ?:[\\/]* )  # Absolute name.
-    ac_srcdir=$srcdir$ac_dir_suffix;
-    ac_top_srcdir=$srcdir
-    ac_abs_top_srcdir=$srcdir ;;
-  *) # Relative name.
-    ac_srcdir=$ac_top_build_prefix$srcdir$ac_dir_suffix
-    ac_top_srcdir=$ac_top_build_prefix$srcdir
-    ac_abs_top_srcdir=$ac_pwd/$srcdir ;;
-esac
-ac_abs_srcdir=$ac_abs_top_srcdir$ac_dir_suffix
-
-    cd "$ac_dir" || { ac_status=$?; continue; }
-    # Check for guested configure.
-    if test -f "$ac_srcdir/configure.gnu"; then
-      echo &&
-      $SHELL "$ac_srcdir/configure.gnu" --help=recursive
-    elif test -f "$ac_srcdir/configure"; then
-      echo &&
-      $SHELL "$ac_srcdir/configure" --help=recursive
-    else
-      echo "$as_me: WARNING: no configuration information is in $ac_dir" >&2
-    fi || ac_status=$?
-    cd "$ac_pwd" || { ac_status=$?; break; }
-  done
-fi
-
-test -n "$ac_init_help" && exit $ac_status
-if $ac_init_version; then
-  cat <<\_ACEOF
-configure
-generated by GNU Autoconf 2.61
-
-Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
-2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.
-This configure script is free software; the Free Software Foundation
-gives unlimited permission to copy, distribute and modify it.
-_ACEOF
-  exit
-fi
-cat >config.log <<_ACEOF
-This file contains any messages produced by compilers while
-running configure, to aid debugging if configure makes a mistake.
-
-It was created by $as_me, which was
-generated by GNU Autoconf 2.61.  Invocation command line was
-
-  $ $0 $@
-
-_ACEOF
-exec 5>>config.log
-{
-cat <<_ASUNAME
-## --------- ##
-## Platform. ##
-## --------- ##
-
-hostname = `(hostname || uname -n) 2>/dev/null | sed 1q`
-uname -m = `(uname -m) 2>/dev/null || echo unknown`
-uname -r = `(uname -r) 2>/dev/null || echo unknown`
-uname -s = `(uname -s) 2>/dev/null || echo unknown`
-uname -v = `(uname -v) 2>/dev/null || echo unknown`
-
-/usr/bin/uname -p = `(/usr/bin/uname -p) 2>/dev/null || echo unknown`
-/bin/uname -X     = `(/bin/uname -X) 2>/dev/null     || echo unknown`
-
-/bin/arch              = `(/bin/arch) 2>/dev/null              || echo unknown`
-/usr/bin/arch -k       = `(/usr/bin/arch -k) 2>/dev/null       || echo unknown`
-/usr/convex/getsysinfo = `(/usr/convex/getsysinfo) 2>/dev/null || echo unknown`
-/usr/bin/hostinfo      = `(/usr/bin/hostinfo) 2>/dev/null      || echo unknown`
-/bin/machine           = `(/bin/machine) 2>/dev/null           || echo unknown`
-/usr/bin/oslevel       = `(/usr/bin/oslevel) 2>/dev/null       || echo unknown`
-/bin/universe          = `(/bin/universe) 2>/dev/null          || echo unknown`
-
-_ASUNAME
-
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  echo "PATH: $as_dir"
-done
-IFS=$as_save_IFS
-
-} >&5
-
-cat >&5 <<_ACEOF
-
-
-## ----------- ##
-## Core tests. ##
-## ----------- ##
-
-_ACEOF
-
-
-# Keep a trace of the command line.
-# Strip out --no-create and --no-recursion so they do not pile up.
-# Strip out --silent because we don't want to record it for future runs.
-# Also quote any args containing shell meta-characters.
-# Make two passes to allow for proper duplicate-argument suppression.
-ac_configure_args=
-ac_configure_args0=
-ac_configure_args1=
-ac_must_keep_next=false
-for ac_pass in 1 2
-do
-  for ac_arg
-  do
-    case $ac_arg in
-    -no-create | --no-c* | -n | -no-recursion | --no-r*) continue ;;
-    -q | -quiet | --quiet | --quie | --qui | --qu | --q \
-    | -silent | --silent | --silen | --sile | --sil)
-      continue ;;
-    *\'*)
-      ac_arg=`echo "$ac_arg" | sed "s/'/'\\\\\\\\''/g"` ;;
-    esac
-    case $ac_pass in
-    1) ac_configure_args0="$ac_configure_args0 '$ac_arg'" ;;
-    2)
-      ac_configure_args1="$ac_configure_args1 '$ac_arg'"
-      if test $ac_must_keep_next = true; then
-	ac_must_keep_next=false # Got value, back to normal.
-      else
-	case $ac_arg in
-	  *=* | --config-cache | -C | -disable-* | --disable-* \
-	  | -enable-* | --enable-* | -gas | --g* | -nfp | --nf* \
-	  | -q | -quiet | --q* | -silent | --sil* | -v | -verb* \
-	  | -with-* | --with-* | -without-* | --without-* | --x)
-	    case "$ac_configure_args0 " in
-	      "$ac_configure_args1"*" '$ac_arg' "* ) continue ;;
-	    esac
-	    ;;
-	  -* ) ac_must_keep_next=true ;;
-	esac
-      fi
-      ac_configure_args="$ac_configure_args '$ac_arg'"
-      ;;
-    esac
-  done
-done
-$as_unset ac_configure_args0 || test "${ac_configure_args0+set}" != set || { ac_configure_args0=; export ac_configure_args0; }
-$as_unset ac_configure_args1 || test "${ac_configure_args1+set}" != set || { ac_configure_args1=; export ac_configure_args1; }
-
-# When interrupted or exit'd, cleanup temporary files, and complete
-# config.log.  We remove comments because anyway the quotes in there
-# would cause problems or look ugly.
-# WARNING: Use '\'' to represent an apostrophe within the trap.
-# WARNING: Do not start the trap code with a newline, due to a FreeBSD 4.0 bug.
-trap 'exit_status=$?
-  # Save into config.log some information that might help in debugging.
-  {
-    echo
-
-    cat <<\_ASBOX
-## ---------------- ##
-## Cache variables. ##
-## ---------------- ##
-_ASBOX
-    echo
-    # The following way of writing the cache mishandles newlines in values,
-(
-  for ac_var in `(set) 2>&1 | sed -n '\''s/^\([a-zA-Z_][a-zA-Z0-9_]*\)=.*/\1/p'\''`; do
-    eval ac_val=\$$ac_var
-    case $ac_val in #(
-    *${as_nl}*)
-      case $ac_var in #(
-      *_cv_*) { echo "$as_me:$LINENO: WARNING: Cache variable $ac_var contains a newline." >&5
-echo "$as_me: WARNING: Cache variable $ac_var contains a newline." >&2;} ;;
-      esac
-      case $ac_var in #(
-      _ | IFS | as_nl) ;; #(
-      *) $as_unset $ac_var ;;
-      esac ;;
-    esac
-  done
-  (set) 2>&1 |
-    case $as_nl`(ac_space='\'' '\''; set) 2>&1` in #(
-    *${as_nl}ac_space=\ *)
-      sed -n \
-	"s/'\''/'\''\\\\'\'''\''/g;
-	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='\''\\2'\''/p"
-      ;; #(
-    *)
-      sed -n "/^[_$as_cr_alnum]*_cv_[_$as_cr_alnum]*=/p"
-      ;;
-    esac |
-    sort
-)
-    echo
-
-    cat <<\_ASBOX
-## ----------------- ##
-## Output variables. ##
-## ----------------- ##
-_ASBOX
-    echo
-    for ac_var in $ac_subst_vars
-    do
-      eval ac_val=\$$ac_var
-      case $ac_val in
-      *\'\''*) ac_val=`echo "$ac_val" | sed "s/'\''/'\''\\\\\\\\'\'''\''/g"`;;
-      esac
-      echo "$ac_var='\''$ac_val'\''"
-    done | sort
-    echo
-
-    if test -n "$ac_subst_files"; then
-      cat <<\_ASBOX
-## ------------------- ##
-## File substitutions. ##
-## ------------------- ##
-_ASBOX
-      echo
-      for ac_var in $ac_subst_files
-      do
-	eval ac_val=\$$ac_var
-	case $ac_val in
-	*\'\''*) ac_val=`echo "$ac_val" | sed "s/'\''/'\''\\\\\\\\'\'''\''/g"`;;
-	esac
-	echo "$ac_var='\''$ac_val'\''"
-      done | sort
-      echo
-    fi
-
-    if test -s confdefs.h; then
-      cat <<\_ASBOX
-## ----------- ##
-## confdefs.h. ##
-## ----------- ##
-_ASBOX
-      echo
-      cat confdefs.h
-      echo
-    fi
-    test "$ac_signal" != 0 &&
-      echo "$as_me: caught signal $ac_signal"
-    echo "$as_me: exit $exit_status"
-  } >&5
-  rm -f core *.core core.conftest.* &&
-    rm -f -r conftest* confdefs* conf$$* $ac_clean_files &&
-    exit $exit_status
-' 0
-for ac_signal in 1 2 13 15; do
-  trap 'ac_signal='$ac_signal'; { (exit 1); exit 1; }' $ac_signal
-done
-ac_signal=0
-
-# confdefs.h avoids OS command line length limits that DEFS can exceed.
-rm -f -r conftest* confdefs.h
-
-# Predefined preprocessor variables.
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_NAME "$PACKAGE_NAME"
-_ACEOF
-
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_TARNAME "$PACKAGE_TARNAME"
-_ACEOF
-
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_VERSION "$PACKAGE_VERSION"
-_ACEOF
-
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_STRING "$PACKAGE_STRING"
-_ACEOF
-
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_BUGREPORT "$PACKAGE_BUGREPORT"
-_ACEOF
-
-
-# Let the site file select an alternate cache file if it wants to.
-# Prefer explicitly selected file to automatically selected ones.
-if test -n "$CONFIG_SITE"; then
-  set x "$CONFIG_SITE"
-elif test "x$prefix" != xNONE; then
-  set x "$prefix/share/config.site" "$prefix/etc/config.site"
-else
-  set x "$ac_default_prefix/share/config.site" \
-	"$ac_default_prefix/etc/config.site"
-fi
-shift
-for ac_site_file
-do
-  if test -r "$ac_site_file"; then
-    { echo "$as_me:$LINENO: loading site script $ac_site_file" >&5
-echo "$as_me: loading site script $ac_site_file" >&6;}
-    sed 's/^/| /' "$ac_site_file" >&5
-    . "$ac_site_file"
-  fi
-done
-
-if test -r "$cache_file"; then
-  # Some versions of bash will fail to source /dev/null (special
-  # files actually), so we avoid doing that.
-  if test -f "$cache_file"; then
-    { echo "$as_me:$LINENO: loading cache $cache_file" >&5
-echo "$as_me: loading cache $cache_file" >&6;}
-    case $cache_file in
-      [\\/]* | ?:[\\/]* ) . "$cache_file";;
-      *)                      . "./$cache_file";;
-    esac
-  fi
-else
-  { echo "$as_me:$LINENO: creating cache $cache_file" >&5
-echo "$as_me: creating cache $cache_file" >&6;}
-  >$cache_file
-fi
-
-# Check that the precious variables saved in the cache have kept the same
-# value.
-ac_cache_corrupted=false
-for ac_var in $ac_precious_vars; do
-  eval ac_old_set=\$ac_cv_env_${ac_var}_set
-  eval ac_new_set=\$ac_env_${ac_var}_set
-  eval ac_old_val=\$ac_cv_env_${ac_var}_value
-  eval ac_new_val=\$ac_env_${ac_var}_value
-  case $ac_old_set,$ac_new_set in
-    set,)
-      { echo "$as_me:$LINENO: error: \`$ac_var' was set to \`$ac_old_val' in the previous run" >&5
-echo "$as_me: error: \`$ac_var' was set to \`$ac_old_val' in the previous run" >&2;}
-      ac_cache_corrupted=: ;;
-    ,set)
-      { echo "$as_me:$LINENO: error: \`$ac_var' was not set in the previous run" >&5
-echo "$as_me: error: \`$ac_var' was not set in the previous run" >&2;}
-      ac_cache_corrupted=: ;;
-    ,);;
-    *)
-      if test "x$ac_old_val" != "x$ac_new_val"; then
-	{ echo "$as_me:$LINENO: error: \`$ac_var' has changed since the previous run:" >&5
-echo "$as_me: error: \`$ac_var' has changed since the previous run:" >&2;}
-	{ echo "$as_me:$LINENO:   former value:  $ac_old_val" >&5
-echo "$as_me:   former value:  $ac_old_val" >&2;}
-	{ echo "$as_me:$LINENO:   current value: $ac_new_val" >&5
-echo "$as_me:   current value: $ac_new_val" >&2;}
-	ac_cache_corrupted=:
-      fi;;
-  esac
-  # Pass precious variables to config.status.
-  if test "$ac_new_set" = set; then
-    case $ac_new_val in
-    *\'*) ac_arg=$ac_var=`echo "$ac_new_val" | sed "s/'/'\\\\\\\\''/g"` ;;
-    *) ac_arg=$ac_var=$ac_new_val ;;
-    esac
-    case " $ac_configure_args " in
-      *" '$ac_arg' "*) ;; # Avoid dups.  Use of quotes ensures accuracy.
-      *) ac_configure_args="$ac_configure_args '$ac_arg'" ;;
-    esac
-  fi
-done
-if $ac_cache_corrupted; then
-  { echo "$as_me:$LINENO: error: changes in the environment can compromise the build" >&5
-echo "$as_me: error: changes in the environment can compromise the build" >&2;}
-  { { echo "$as_me:$LINENO: error: run \`make distclean' and/or \`rm $cache_file' and start over" >&5
-echo "$as_me: error: run \`make distclean' and/or \`rm $cache_file' and start over" >&2;}
-   { (exit 1); exit 1; }; }
-fi
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-
-ac_config_headers="$ac_config_headers common/config.h"
-
-
-BUILD_PARSERS=true
-
-
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}gcc", so it can be a program name with args.
-set dummy ${ac_tool_prefix}gcc; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_CC="${ac_tool_prefix}gcc"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  { echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-fi
-if test -z "$ac_cv_prog_CC"; then
-  ac_ct_CC=$CC
-  # Extract the first word of "gcc", so it can be a program name with args.
-set dummy gcc; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_ac_ct_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_CC"; then
-  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_ac_ct_CC="gcc"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_CC=$ac_cv_prog_ac_ct_CC
-if test -n "$ac_ct_CC"; then
-  { echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
-echo "${ECHO_T}$ac_ct_CC" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-  if test "x$ac_ct_CC" = x; then
-    CC=""
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoc... at gnu.org." >&5
-echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoc... at gnu.org." >&2;}
-ac_tool_warned=yes ;;
-esac
-    CC=$ac_ct_CC
-  fi
-else
-  CC="$ac_cv_prog_CC"
-fi
-
-if test -z "$CC"; then
-          if test -n "$ac_tool_prefix"; then
-    # Extract the first word of "${ac_tool_prefix}cc", so it can be a program name with args.
-set dummy ${ac_tool_prefix}cc; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_CC="${ac_tool_prefix}cc"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  { echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-  fi
-fi
-if test -z "$CC"; then
-  # Extract the first word of "cc", so it can be a program name with args.
-set dummy cc; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-  ac_prog_rejected=no
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    if test "$as_dir/$ac_word$ac_exec_ext" = "/usr/ucb/cc"; then
-       ac_prog_rejected=yes
-       continue
-     fi
-    ac_cv_prog_CC="cc"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-if test $ac_prog_rejected = yes; then
-  # We found a bogon in the path, so make sure we never use it.
-  set dummy $ac_cv_prog_CC
-  shift
-  if test $# != 0; then
-    # We chose a different compiler from the bogus one.
-    # However, it has the same basename, so the bogon will be chosen
-    # first if we set CC to just the basename; use the full file name.
-    shift
-    ac_cv_prog_CC="$as_dir/$ac_word${1+' '}$@"
-  fi
-fi
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  { echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-fi
-if test -z "$CC"; then
-  if test -n "$ac_tool_prefix"; then
-  for ac_prog in cl.exe
-  do
-    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
-set dummy $ac_tool_prefix$ac_prog; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_CC="$ac_tool_prefix$ac_prog"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  { echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-    test -n "$CC" && break
-  done
-fi
-if test -z "$CC"; then
-  ac_ct_CC=$CC
-  for ac_prog in cl.exe
-do
-  # Extract the first word of "$ac_prog", so it can be a program name with args.
-set dummy $ac_prog; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_ac_ct_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_CC"; then
-  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_ac_ct_CC="$ac_prog"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_CC=$ac_cv_prog_ac_ct_CC
-if test -n "$ac_ct_CC"; then
-  { echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
-echo "${ECHO_T}$ac_ct_CC" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-  test -n "$ac_ct_CC" && break
-done
-
-  if test "x$ac_ct_CC" = x; then
-    CC=""
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoc... at gnu.org." >&5
-echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoc... at gnu.org." >&2;}
-ac_tool_warned=yes ;;
-esac
-    CC=$ac_ct_CC
-  fi
-fi
-
-fi
-
-
-test -z "$CC" && { { echo "$as_me:$LINENO: error: no acceptable C compiler found in \$PATH
-See \`config.log' for more details." >&5
-echo "$as_me: error: no acceptable C compiler found in \$PATH
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }
-
-# Provide some information about the compiler.
-echo "$as_me:$LINENO: checking for C compiler version" >&5
-ac_compiler=`set X $ac_compile; echo $2`
-{ (ac_try="$ac_compiler --version >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compiler --version >&5") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (ac_try="$ac_compiler -v >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compiler -v >&5") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (ac_try="$ac_compiler -V >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compiler -V >&5") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-ac_clean_files_save=$ac_clean_files
-ac_clean_files="$ac_clean_files a.out a.exe b.out"
-# Try to create an executable without -o first, disregard a.out.
-# It will help us diagnose broken compilers, and finding out an intuition
-# of exeext.
-{ echo "$as_me:$LINENO: checking for C compiler default output file name" >&5
-echo $ECHO_N "checking for C compiler default output file name... $ECHO_C" >&6; }
-ac_link_default=`echo "$ac_link" | sed 's/ -o *conftest[^ ]*//'`
-#
-# List of possible output files, starting from the most likely.
-# The algorithm is not robust to junk in `.', hence go to wildcards (a.*)
-# only as a last resort.  b.out is created by i960 compilers.
-ac_files='a_out.exe a.exe conftest.exe a.out conftest a.* conftest.* b.out'
-#
-# The IRIX 6 linker writes into existing files which may not be
-# executable, retaining their permissions.  Remove them first so a
-# subsequent execution test works.
-ac_rmfiles=
-for ac_file in $ac_files
-do
-  case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.o | *.obj ) ;;
-    * ) ac_rmfiles="$ac_rmfiles $ac_file";;
-  esac
-done
-rm -f $ac_rmfiles
-
-if { (ac_try="$ac_link_default"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link_default") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; then
-  # Autoconf-2.13 could set the ac_cv_exeext variable to `no'.
-# So ignore a value of `no', otherwise this would lead to `EXEEXT = no'
-# in a Makefile.  We should not override ac_cv_exeext if it was cached,
-# so that the user can short-circuit this test for compilers unknown to
-# Autoconf.
-for ac_file in $ac_files ''
-do
-  test -f "$ac_file" || continue
-  case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.o | *.obj )
-	;;
-    [ab].out )
-	# We found the default executable, but exeext='' is most
-	# certainly right.
-	break;;
-    *.* )
-        if test "${ac_cv_exeext+set}" = set && test "$ac_cv_exeext" != no;
-	then :; else
-	   ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
-	fi
-	# We set ac_cv_exeext here because the later test for it is not
-	# safe: cross compilers may not add the suffix if given an `-o'
-	# argument, so we may need to know it at that point already.
-	# Even if this section looks crufty: it has the advantage of
-	# actually working.
-	break;;
-    * )
-	break;;
-  esac
-done
-test "$ac_cv_exeext" = no && ac_cv_exeext=
-
-else
-  ac_file=''
-fi
-
-{ echo "$as_me:$LINENO: result: $ac_file" >&5
-echo "${ECHO_T}$ac_file" >&6; }
-if test -z "$ac_file"; then
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-{ { echo "$as_me:$LINENO: error: C compiler cannot create executables
-See \`config.log' for more details." >&5
-echo "$as_me: error: C compiler cannot create executables
-See \`config.log' for more details." >&2;}
-   { (exit 77); exit 77; }; }
-fi
-
-ac_exeext=$ac_cv_exeext
-
-# Check that the compiler produces executables we can run.  If not, either
-# the compiler is broken, or we cross compile.
-{ echo "$as_me:$LINENO: checking whether the C compiler works" >&5
-echo $ECHO_N "checking whether the C compiler works... $ECHO_C" >&6; }
-# FIXME: These cross compiler hacks should be removed for Autoconf 3.0
-# If not cross compiling, check that we can run a simple program.
-if test "$cross_compiling" != yes; then
-  if { ac_try='./$ac_file'
-  { (case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_try") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-    cross_compiling=no
-  else
-    if test "$cross_compiling" = maybe; then
-	cross_compiling=yes
-    else
-	{ { echo "$as_me:$LINENO: error: cannot run C compiled programs.
-If you meant to cross compile, use \`--host'.
-See \`config.log' for more details." >&5
-echo "$as_me: error: cannot run C compiled programs.
-If you meant to cross compile, use \`--host'.
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }
-    fi
-  fi
-fi
-{ echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; }
-
-rm -f a.out a.exe conftest$ac_cv_exeext b.out
-ac_clean_files=$ac_clean_files_save
-# Check that the compiler produces executables we can run.  If not, either
-# the compiler is broken, or we cross compile.
-{ echo "$as_me:$LINENO: checking whether we are cross compiling" >&5
-echo $ECHO_N "checking whether we are cross compiling... $ECHO_C" >&6; }
-{ echo "$as_me:$LINENO: result: $cross_compiling" >&5
-echo "${ECHO_T}$cross_compiling" >&6; }
-
-{ echo "$as_me:$LINENO: checking for suffix of executables" >&5
-echo $ECHO_N "checking for suffix of executables... $ECHO_C" >&6; }
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; then
-  # If both `conftest.exe' and `conftest' are `present' (well, observable)
-# catch `conftest.exe'.  For instance with Cygwin, `ls conftest' will
-# work properly (i.e., refer to `conftest.exe'), while it won't with
-# `rm'.
-for ac_file in conftest.exe conftest conftest.*; do
-  test -f "$ac_file" || continue
-  case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.o | *.obj ) ;;
-    *.* ) ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
-	  break;;
-    * ) break;;
-  esac
-done
-else
-  { { echo "$as_me:$LINENO: error: cannot compute suffix of executables: cannot compile and link
-See \`config.log' for more details." >&5
-echo "$as_me: error: cannot compute suffix of executables: cannot compile and link
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }
-fi
-
-rm -f conftest$ac_cv_exeext
-{ echo "$as_me:$LINENO: result: $ac_cv_exeext" >&5
-echo "${ECHO_T}$ac_cv_exeext" >&6; }
-
-rm -f conftest.$ac_ext
-EXEEXT=$ac_cv_exeext
-ac_exeext=$EXEEXT
-{ echo "$as_me:$LINENO: checking for suffix of object files" >&5
-echo $ECHO_N "checking for suffix of object files... $ECHO_C" >&6; }
-if test "${ac_cv_objext+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.o conftest.obj
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; then
-  for ac_file in conftest.o conftest.obj conftest.*; do
-  test -f "$ac_file" || continue;
-  case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf ) ;;
-    *) ac_cv_objext=`expr "$ac_file" : '.*\.\(.*\)'`
-       break;;
-  esac
-done
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-{ { echo "$as_me:$LINENO: error: cannot compute suffix of object files: cannot compile
-See \`config.log' for more details." >&5
-echo "$as_me: error: cannot compute suffix of object files: cannot compile
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }
-fi
-
-rm -f conftest.$ac_cv_objext conftest.$ac_ext
-fi
-{ echo "$as_me:$LINENO: result: $ac_cv_objext" >&5
-echo "${ECHO_T}$ac_cv_objext" >&6; }
-OBJEXT=$ac_cv_objext
-ac_objext=$OBJEXT
-{ echo "$as_me:$LINENO: checking whether we are using the GNU C compiler" >&5
-echo $ECHO_N "checking whether we are using the GNU C compiler... $ECHO_C" >&6; }
-if test "${ac_cv_c_compiler_gnu+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-#ifndef __GNUC__
-       choke me
-#endif
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_compiler_gnu=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_compiler_gnu=no
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-ac_cv_c_compiler_gnu=$ac_compiler_gnu
-
-fi
-{ echo "$as_me:$LINENO: result: $ac_cv_c_compiler_gnu" >&5
-echo "${ECHO_T}$ac_cv_c_compiler_gnu" >&6; }
-GCC=`test $ac_compiler_gnu = yes && echo yes`
-ac_test_CFLAGS=${CFLAGS+set}
-ac_save_CFLAGS=$CFLAGS
-{ echo "$as_me:$LINENO: checking whether $CC accepts -g" >&5
-echo $ECHO_N "checking whether $CC accepts -g... $ECHO_C" >&6; }
-if test "${ac_cv_prog_cc_g+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_save_c_werror_flag=$ac_c_werror_flag
-   ac_c_werror_flag=yes
-   ac_cv_prog_cc_g=no
-   CFLAGS="-g"
-   cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cc_g=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	CFLAGS=""
-      cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  :
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_c_werror_flag=$ac_save_c_werror_flag
-	 CFLAGS="-g"
-	 cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cc_g=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-   ac_c_werror_flag=$ac_save_c_werror_flag
-fi
-{ echo "$as_me:$LINENO: result: $ac_cv_prog_cc_g" >&5
-echo "${ECHO_T}$ac_cv_prog_cc_g" >&6; }
-if test "$ac_test_CFLAGS" = set; then
-  CFLAGS=$ac_save_CFLAGS
-elif test $ac_cv_prog_cc_g = yes; then
-  if test "$GCC" = yes; then
-    CFLAGS="-g -O2"
-  else
-    CFLAGS="-g"
-  fi
-else
-  if test "$GCC" = yes; then
-    CFLAGS="-O2"
-  else
-    CFLAGS=
-  fi
-fi
-{ echo "$as_me:$LINENO: checking for $CC option to accept ISO C89" >&5
-echo $ECHO_N "checking for $CC option to accept ISO C89... $ECHO_C" >&6; }
-if test "${ac_cv_prog_cc_c89+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_cv_prog_cc_c89=no
-ac_save_CC=$CC
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <stdarg.h>
-#include <stdio.h>
-#include <sys/types.h>
-#include <sys/stat.h>
-/* Most of the following tests are stolen from RCS 5.7's src/conf.sh.  */
-struct buf { int x; };
-FILE * (*rcsopen) (struct buf *, struct stat *, int);
-static char *e (p, i)
-     char **p;
-     int i;
-{
-  return p[i];
-}
-static char *f (char * (*g) (char **, int), char **p, ...)
-{
-  char *s;
-  va_list v;
-  va_start (v,p);
-  s = g (p, va_arg (v,int));
-  va_end (v);
-  return s;
-}
-
-/* OSF 4.0 Compaq cc is some sort of almost-ANSI by default.  It has
-   function prototypes and stuff, but not '\xHH' hex character constants.
-   These don't provoke an error unfortunately, instead are silently treated
-   as 'x'.  The following induces an error, until -std is added to get
-   proper ANSI mode.  Curiously '\x00'!='x' always comes out true, for an
-   array size at least.  It's necessary to write '\x00'==0 to get something
-   that's true only with -std.  */
-int osf4_cc_array ['\x00' == 0 ? 1 : -1];
-
-/* IBM C 6 for AIX is almost-ANSI by default, but it replaces macro parameters
-   inside strings and character constants.  */
-#define FOO(x) 'x'
-int xlc6_cc_array[FOO(a) == 'x' ? 1 : -1];
-
-int test (int i, double x);
-struct s1 {int (*f) (int a);};
-struct s2 {int (*f) (double a);};
-int pairnames (int, char **, FILE *(*)(struct buf *, struct stat *, int), int, int);
-int argc;
-char **argv;
-int
-main ()
-{
-return f (e, argv, 0) != argv[0]  ||  f (e, argv, 1) != argv[1];
-  ;
-  return 0;
-}
-_ACEOF
-for ac_arg in '' -qlanglvl=extc89 -qlanglvl=ansi -std \
-	-Ae "-Aa -D_HPUX_SOURCE" "-Xc -D__EXTENSIONS__"
-do
-  CC="$ac_save_CC $ac_arg"
-  rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cc_c89=$ac_arg
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-
-fi
-
-rm -f core conftest.err conftest.$ac_objext
-  test "x$ac_cv_prog_cc_c89" != "xno" && break
-done
-rm -f conftest.$ac_ext
-CC=$ac_save_CC
-
-fi
-# AC_CACHE_VAL
-case "x$ac_cv_prog_cc_c89" in
-  x)
-    { echo "$as_me:$LINENO: result: none needed" >&5
-echo "${ECHO_T}none needed" >&6; } ;;
-  xno)
-    { echo "$as_me:$LINENO: result: unsupported" >&5
-echo "${ECHO_T}unsupported" >&6; } ;;
-  *)
-    CC="$CC $ac_cv_prog_cc_c89"
-    { echo "$as_me:$LINENO: result: $ac_cv_prog_cc_c89" >&5
-echo "${ECHO_T}$ac_cv_prog_cc_c89" >&6; } ;;
-esac
-
-
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-if test -z "$CXX"; then
-  if test -n "$CCC"; then
-    CXX=$CCC
-  else
-    if test -n "$ac_tool_prefix"; then
-  for ac_prog in g++ c++ gpp aCC CC cxx cc++ cl.exe FCC KCC RCC xlC_r xlC
-  do
-    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
-set dummy $ac_tool_prefix$ac_prog; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_CXX+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$CXX"; then
-  ac_cv_prog_CXX="$CXX" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_CXX="$ac_tool_prefix$ac_prog"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-CXX=$ac_cv_prog_CXX
-if test -n "$CXX"; then
-  { echo "$as_me:$LINENO: result: $CXX" >&5
-echo "${ECHO_T}$CXX" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-    test -n "$CXX" && break
-  done
-fi
-if test -z "$CXX"; then
-  ac_ct_CXX=$CXX
-  for ac_prog in g++ c++ gpp aCC CC cxx cc++ cl.exe FCC KCC RCC xlC_r xlC
-do
-  # Extract the first word of "$ac_prog", so it can be a program name with args.
-set dummy $ac_prog; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_ac_ct_CXX+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_CXX"; then
-  ac_cv_prog_ac_ct_CXX="$ac_ct_CXX" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_ac_ct_CXX="$ac_prog"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_CXX=$ac_cv_prog_ac_ct_CXX
-if test -n "$ac_ct_CXX"; then
-  { echo "$as_me:$LINENO: result: $ac_ct_CXX" >&5
-echo "${ECHO_T}$ac_ct_CXX" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-  test -n "$ac_ct_CXX" && break
-done
-
-  if test "x$ac_ct_CXX" = x; then
-    CXX="g++"
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoc... at gnu.org." >&5
-echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoc... at gnu.org." >&2;}
-ac_tool_warned=yes ;;
-esac
-    CXX=$ac_ct_CXX
-  fi
-fi
-
-  fi
-fi
-# Provide some information about the compiler.
-echo "$as_me:$LINENO: checking for C++ compiler version" >&5
-ac_compiler=`set X $ac_compile; echo $2`
-{ (ac_try="$ac_compiler --version >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compiler --version >&5") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (ac_try="$ac_compiler -v >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compiler -v >&5") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (ac_try="$ac_compiler -V >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compiler -V >&5") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-
-{ echo "$as_me:$LINENO: checking whether we are using the GNU C++ compiler" >&5
-echo $ECHO_N "checking whether we are using the GNU C++ compiler... $ECHO_C" >&6; }
-if test "${ac_cv_cxx_compiler_gnu+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-#ifndef __GNUC__
-       choke me
-#endif
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_compiler_gnu=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_compiler_gnu=no
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-ac_cv_cxx_compiler_gnu=$ac_compiler_gnu
-
-fi
-{ echo "$as_me:$LINENO: result: $ac_cv_cxx_compiler_gnu" >&5
-echo "${ECHO_T}$ac_cv_cxx_compiler_gnu" >&6; }
-GXX=`test $ac_compiler_gnu = yes && echo yes`
-ac_test_CXXFLAGS=${CXXFLAGS+set}
-ac_save_CXXFLAGS=$CXXFLAGS
-{ echo "$as_me:$LINENO: checking whether $CXX accepts -g" >&5
-echo $ECHO_N "checking whether $CXX accepts -g... $ECHO_C" >&6; }
-if test "${ac_cv_prog_cxx_g+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_save_cxx_werror_flag=$ac_cxx_werror_flag
-   ac_cxx_werror_flag=yes
-   ac_cv_prog_cxx_g=no
-   CXXFLAGS="-g"
-   cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cxx_g=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	CXXFLAGS=""
-      cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  :
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_cxx_werror_flag=$ac_save_cxx_werror_flag
-	 CXXFLAGS="-g"
-	 cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cxx_g=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-   ac_cxx_werror_flag=$ac_save_cxx_werror_flag
-fi
-{ echo "$as_me:$LINENO: result: $ac_cv_prog_cxx_g" >&5
-echo "${ECHO_T}$ac_cv_prog_cxx_g" >&6; }
-if test "$ac_test_CXXFLAGS" = set; then
-  CXXFLAGS=$ac_save_CXXFLAGS
-elif test $ac_cv_prog_cxx_g = yes; then
-  if test "$GXX" = yes; then
-    CXXFLAGS="-g -O2"
-  else
-    CXXFLAGS="-g"
-  fi
-else
-  if test "$GXX" = yes; then
-    CXXFLAGS="-O2"
-  else
-    CXXFLAGS=
-  fi
-fi
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}ar", so it can be a program name with args.
-set dummy ${ac_tool_prefix}ar; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_AR+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$AR"; then
-  ac_cv_prog_AR="$AR" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_AR="${ac_tool_prefix}ar"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-AR=$ac_cv_prog_AR
-if test -n "$AR"; then
-  { echo "$as_me:$LINENO: result: $AR" >&5
-echo "${ECHO_T}$AR" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-fi
-if test -z "$ac_cv_prog_AR"; then
-  ac_ct_AR=$AR
-  # Extract the first word of "ar", so it can be a program name with args.
-set dummy ar; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_ac_ct_AR+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_AR"; then
-  ac_cv_prog_ac_ct_AR="$ac_ct_AR" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_ac_ct_AR="ar"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_AR=$ac_cv_prog_ac_ct_AR
-if test -n "$ac_ct_AR"; then
-  { echo "$as_me:$LINENO: result: $ac_ct_AR" >&5
-echo "${ECHO_T}$ac_ct_AR" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-  if test "x$ac_ct_AR" = x; then
-    AR=""
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoc... at gnu.org." >&5
-echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoc... at gnu.org." >&2;}
-ac_tool_warned=yes ;;
-esac
-    AR=$ac_ct_AR
-  fi
-else
-  AR="$ac_cv_prog_AR"
-fi
-
-if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}ranlib", so it can be a program name with args.
-set dummy ${ac_tool_prefix}ranlib; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_RANLIB+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$RANLIB"; then
-  ac_cv_prog_RANLIB="$RANLIB" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_RANLIB="${ac_tool_prefix}ranlib"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-RANLIB=$ac_cv_prog_RANLIB
-if test -n "$RANLIB"; then
-  { echo "$as_me:$LINENO: result: $RANLIB" >&5
-echo "${ECHO_T}$RANLIB" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-fi
-if test -z "$ac_cv_prog_RANLIB"; then
-  ac_ct_RANLIB=$RANLIB
-  # Extract the first word of "ranlib", so it can be a program name with args.
-set dummy ranlib; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_ac_ct_RANLIB+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_RANLIB"; then
-  ac_cv_prog_ac_ct_RANLIB="$ac_ct_RANLIB" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_ac_ct_RANLIB="ranlib"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_RANLIB=$ac_cv_prog_ac_ct_RANLIB
-if test -n "$ac_ct_RANLIB"; then
-  { echo "$as_me:$LINENO: result: $ac_ct_RANLIB" >&5
-echo "${ECHO_T}$ac_ct_RANLIB" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-  if test "x$ac_ct_RANLIB" = x; then
-    RANLIB=":"
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoc... at gnu.org." >&5
-echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoc... at gnu.org." >&2;}
-ac_tool_warned=yes ;;
-esac
-    RANLIB=$ac_ct_RANLIB
-  fi
-else
-  RANLIB="$ac_cv_prog_RANLIB"
-fi
-
-cat >>confdefs.h <<_ACEOF
-#define CC $CC
-_ACEOF
-
-cat >>confdefs.h <<_ACEOF
-#define CXX $CXX
-_ACEOF
-
-cat >>confdefs.h <<_ACEOF
-#define AR $AR
-_ACEOF
-
-cat >>confdefs.h <<_ACEOF
-#define RANLIB $RANLIB
-_ACEOF
-
-
-ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-
-
-{ echo "$as_me:$LINENO: checking whether ${MAKE-make} sets \$(MAKE)" >&5
-echo $ECHO_N "checking whether ${MAKE-make} sets \$(MAKE)... $ECHO_C" >&6; }
-set x ${MAKE-make}; ac_make=`echo "$2" | sed 's/+/p/g; s/[^a-zA-Z0-9_]/_/g'`
-if { as_var=ac_cv_prog_make_${ac_make}_set; eval "test \"\${$as_var+set}\" = set"; }; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.make <<\_ACEOF
-SHELL = /bin/sh
-all:
-	@echo '@@@%%%=$(MAKE)=@@@%%%'
-_ACEOF
-# GNU make sometimes prints "make[1]: Entering...", which would confuse us.
-case `${MAKE-make} -f conftest.make 2>/dev/null` in
-  *@@@%%%=?*=@@@%%%*)
-    eval ac_cv_prog_make_${ac_make}_set=yes;;
-  *)
-    eval ac_cv_prog_make_${ac_make}_set=no;;
-esac
-rm -f conftest.make
-fi
-if eval test \$ac_cv_prog_make_${ac_make}_set = yes; then
-  { echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; }
-  SET_MAKE=
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-  SET_MAKE="MAKE=${MAKE-make}"
-fi
-
-
-if test $BUILD_PARSERS = true; then
-
-# Extract the first word of "ragel", so it can be a program name with args.
-set dummy ragel; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_RAGEL+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$RAGEL"; then
-  ac_cv_prog_RAGEL="$RAGEL" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_RAGEL="ragel"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-RAGEL=$ac_cv_prog_RAGEL
-if test -n "$RAGEL"; then
-  { echo "$as_me:$LINENO: result: $RAGEL" >&5
-echo "${ECHO_T}$RAGEL" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-if test -z "$RAGEL"; then
-	echo
-	echo "error: ragel is required to build the parsers"
-	echo
-	exit 1
-fi
-
-# Extract the first word of "gperf", so it can be a program name with args.
-set dummy gperf; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_GPERF+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$GPERF"; then
-  ac_cv_prog_GPERF="$GPERF" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_GPERF="gperf"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-GPERF=$ac_cv_prog_GPERF
-if test -n "$GPERF"; then
-  { echo "$as_me:$LINENO: result: $GPERF" >&5
-echo "${ECHO_T}$GPERF" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-if test -z "$GPERF"; then
-	echo
-	echo "error: gperf is required to build the parsers"
-	echo
-	exit 1
-fi
-
-# Extract the first word of "kelbt", so it can be a program name with args.
-set dummy kelbt; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_KELBT+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$KELBT"; then
-  ac_cv_prog_KELBT="$KELBT" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_KELBT="kelbt"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-KELBT=$ac_cv_prog_KELBT
-if test -n "$KELBT"; then
-  { echo "$as_me:$LINENO: result: $KELBT" >&5
-echo "${ECHO_T}$KELBT" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-if test -z "$KELBT"; then
-	echo
-	echo "error: kelbt is required to build the parsers"
-	echo
-	exit 1
-fi
-
-fi # BUILD_PARSERS
-
-# Extract the first word of "gdc", so it can be a program name with args.
-set dummy gdc; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_GDC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$GDC"; then
-  ac_cv_prog_GDC="$GDC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_GDC="gdc"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-GDC=$ac_cv_prog_GDC
-if test -n "$GDC"; then
-  { echo "$as_me:$LINENO: result: $GDC" >&5
-echo "${ECHO_T}$GDC" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-if test -n "$GDC"; then
-	cat >>confdefs.h <<_ACEOF
-#define GDC $GDC
-_ACEOF
-
-fi
-
-{ echo "$as_me:$LINENO: checking for the Objective-C compiler" >&5
-echo $ECHO_N "checking for the Objective-C compiler... $ECHO_C" >&6; }
-cat > conftest.m <<EOF
-int main() { return 0; }
-EOF
-GOBJC=""
-if gcc -x objective-c conftest.m -o conftest.bin 2>/dev/null; then
-	GOBJC="gcc -x objective-c"
-	{ echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; }
-	cat >>confdefs.h <<_ACEOF
-#define GOBJC $GOBJC
-_ACEOF
-
-else
-	{ echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-# Extract the first word of "javac", so it can be a program name with args.
-set dummy javac; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_JAVAC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$JAVAC"; then
-  ac_cv_prog_JAVAC="$JAVAC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_JAVAC="javac"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-JAVAC=$ac_cv_prog_JAVAC
-if test -n "$JAVAC"; then
-  { echo "$as_me:$LINENO: result: $JAVAC" >&5
-echo "${ECHO_T}$JAVAC" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-if test -n "$JAVAC"; then
-	cat >>confdefs.h <<_ACEOF
-#define JAVAC $JAVAC
-_ACEOF
-
-fi
-
-# Extract the first word of "txl", so it can be a program name with args.
-set dummy txl; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_TXL+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$TXL"; then
-  ac_cv_prog_TXL="$TXL" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_TXL="txl"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-TXL=$ac_cv_prog_TXL
-if test -n "$TXL"; then
-  { echo "$as_me:$LINENO: result: $TXL" >&5
-echo "${ECHO_T}$TXL" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-if test -n "$TXL"; then
-	cat >>confdefs.h <<_ACEOF
-#define TXL $TXL
-_ACEOF
-
-fi
-
-# Extract the first word of "ruby", so it can be a program name with args.
-set dummy ruby; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_RUBY+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$RUBY"; then
-  ac_cv_prog_RUBY="$RUBY" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_RUBY="ruby"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-RUBY=$ac_cv_prog_RUBY
-if test -n "$RUBY"; then
-  { echo "$as_me:$LINENO: result: $RUBY" >&5
-echo "${ECHO_T}$RUBY" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-if test -n "$RUBY"; then
-	cat >>confdefs.h <<_ACEOF
-#define RUBY $RUBY
-_ACEOF
-
-fi
-
-# Extract the first word of "gmcs", so it can be a program name with args.
-set dummy gmcs; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_GMCS+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$GMCS"; then
-  ac_cv_prog_GMCS="$GMCS" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_GMCS="gmcs"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-GMCS=$ac_cv_prog_GMCS
-if test -n "$GMCS"; then
-  { echo "$as_me:$LINENO: result: $GMCS" >&5
-echo "${ECHO_T}$GMCS" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-if test -n "$GMCS"; then
-	cat >>confdefs.h <<_ACEOF
-#define GMCS $GMCS
-_ACEOF
-
-fi
-
-ac_config_files="$ac_config_files Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile"
-
-cat >confcache <<\_ACEOF
-# This file is a shell script that caches the results of configure
-# tests run on this system so they can be shared between configure
-# scripts and configure runs, see configure's option --config-cache.
-# It is not useful on other systems.  If it contains results you don't
-# want to keep, you may remove or edit it.
-#
-# config.status only pays attention to the cache file if you give it
-# the --recheck option to rerun configure.
-#
-# `ac_cv_env_foo' variables (set or unset) will be overridden when
-# loading this file, other *unset* `ac_cv_foo' will be assigned the
-# following values.
-
-_ACEOF
-
-# The following way of writing the cache mishandles newlines in values,
-# but we know of no workaround that is simple, portable, and efficient.
-# So, we kill variables containing newlines.
-# Ultrix sh set writes to stderr and can't be redirected directly,
-# and sets the high bit in the cache file unless we assign to the vars.
-(
-  for ac_var in `(set) 2>&1 | sed -n 's/^\([a-zA-Z_][a-zA-Z0-9_]*\)=.*/\1/p'`; do
-    eval ac_val=\$$ac_var
-    case $ac_val in #(
-    *${as_nl}*)
-      case $ac_var in #(
-      *_cv_*) { echo "$as_me:$LINENO: WARNING: Cache variable $ac_var contains a newline." >&5
-echo "$as_me: WARNING: Cache variable $ac_var contains a newline." >&2;} ;;
-      esac
-      case $ac_var in #(
-      _ | IFS | as_nl) ;; #(
-      *) $as_unset $ac_var ;;
-      esac ;;
-    esac
-  done
-
-  (set) 2>&1 |
-    case $as_nl`(ac_space=' '; set) 2>&1` in #(
-    *${as_nl}ac_space=\ *)
-      # `set' does not quote correctly, so add quotes (double-quote
-      # substitution turns \\\\ into \\, and sed turns \\ into \).
-      sed -n \
-	"s/'/'\\\\''/g;
-	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='\\2'/p"
-      ;; #(
-    *)
-      # `set' quotes correctly as required by POSIX, so do not add quotes.
-      sed -n "/^[_$as_cr_alnum]*_cv_[_$as_cr_alnum]*=/p"
-      ;;
-    esac |
-    sort
-) |
-  sed '
-     /^ac_cv_env_/b end
-     t clear
-     :clear
-     s/^\([^=]*\)=\(.*[{}].*\)$/test "${\1+set}" = set || &/
-     t end
-     s/^\([^=]*\)=\(.*\)$/\1=${\1=\2}/
-     :end' >>confcache
-if diff "$cache_file" confcache >/dev/null 2>&1; then :; else
-  if test -w "$cache_file"; then
-    test "x$cache_file" != "x/dev/null" &&
-      { echo "$as_me:$LINENO: updating cache $cache_file" >&5
-echo "$as_me: updating cache $cache_file" >&6;}
-    cat confcache >$cache_file
-  else
-    { echo "$as_me:$LINENO: not updating unwritable cache $cache_file" >&5
-echo "$as_me: not updating unwritable cache $cache_file" >&6;}
-  fi
-fi
-rm -f confcache
-
-test "x$prefix" = xNONE && prefix=$ac_default_prefix
-# Let make expand exec_prefix.
-test "x$exec_prefix" = xNONE && exec_prefix='${prefix}'
-
-DEFS=-DHAVE_CONFIG_H
-
-ac_libobjs=
-ac_ltlibobjs=
-for ac_i in : $LIBOBJS; do test "x$ac_i" = x: && continue
-  # 1. Remove the extension, and $U if already installed.
-  ac_script='s/\$U\././;s/\.o$//;s/\.obj$//'
-  ac_i=`echo "$ac_i" | sed "$ac_script"`
-  # 2. Prepend LIBOBJDIR.  When used with automake>=1.10 LIBOBJDIR
-  #    will be set to the directory where LIBOBJS objects are built.
-  ac_libobjs="$ac_libobjs \${LIBOBJDIR}$ac_i\$U.$ac_objext"
-  ac_ltlibobjs="$ac_ltlibobjs \${LIBOBJDIR}$ac_i"'$U.lo'
-done
-LIBOBJS=$ac_libobjs
-
-LTLIBOBJS=$ac_ltlibobjs
-
-
-
-: ${CONFIG_STATUS=./config.status}
-ac_clean_files_save=$ac_clean_files
-ac_clean_files="$ac_clean_files $CONFIG_STATUS"
-{ echo "$as_me:$LINENO: creating $CONFIG_STATUS" >&5
-echo "$as_me: creating $CONFIG_STATUS" >&6;}
-cat >$CONFIG_STATUS <<_ACEOF
-#! $SHELL
-# Generated by $as_me.
-# Run this file to recreate the current configuration.
-# Compiler output produced by configure, useful for debugging
-# configure, is in config.log if it exists.
-
-debug=false
-ac_cs_recheck=false
-ac_cs_silent=false
-SHELL=\${CONFIG_SHELL-$SHELL}
-_ACEOF
-
-cat >>$CONFIG_STATUS <<\_ACEOF
-## --------------------- ##
-## M4sh Initialization.  ##
-## --------------------- ##
-
-# Be more Bourne compatible
-DUALCASE=1; export DUALCASE # for MKS sh
-if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
-  emulate sh
-  NULLCMD=:
-  # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
-  # is contrary to our usage.  Disable this feature.
-  alias -g '${1+"$@"}'='"$@"'
-  setopt NO_GLOB_SUBST
-else
-  case `(set -o) 2>/dev/null` in
-  *posix*) set -o posix ;;
-esac
-
-fi
-
-
-
-
-# PATH needs CR
-# Avoid depending upon Character Ranges.
-as_cr_letters='abcdefghijklmnopqrstuvwxyz'
-as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
-as_cr_Letters=$as_cr_letters$as_cr_LETTERS
-as_cr_digits='0123456789'
-as_cr_alnum=$as_cr_Letters$as_cr_digits
-
-# The user is always right.
-if test "${PATH_SEPARATOR+set}" != set; then
-  echo "#! /bin/sh" >conf$$.sh
-  echo  "exit 0"   >>conf$$.sh
-  chmod +x conf$$.sh
-  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
-    PATH_SEPARATOR=';'
-  else
-    PATH_SEPARATOR=:
-  fi
-  rm -f conf$$.sh
-fi
-
-# Support unset when possible.
-if ( (MAIL=60; unset MAIL) || exit) >/dev/null 2>&1; then
-  as_unset=unset
-else
-  as_unset=false
-fi
-
-
-# IFS
-# We need space, tab and new line, in precisely that order.  Quoting is
-# there to prevent editors from complaining about space-tab.
-# (If _AS_PATH_WALK were called with IFS unset, it would disable word
-# splitting by setting IFS to empty value.)
-as_nl='
-'
-IFS=" ""	$as_nl"
-
-# Find who we are.  Look in the path if we contain no directory separator.
-case $0 in
-  *[\\/]* ) as_myself=$0 ;;
-  *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
-done
-IFS=$as_save_IFS
-
-     ;;
-esac
-# We did not find ourselves, most probably we were run as `sh COMMAND'
-# in which case we are not to be found in the path.
-if test "x$as_myself" = x; then
-  as_myself=$0
-fi
-if test ! -f "$as_myself"; then
-  echo "$as_myself: error: cannot find myself; rerun with an absolute file name" >&2
-  { (exit 1); exit 1; }
-fi
-
-# Work around bugs in pre-3.0 UWIN ksh.
-for as_var in ENV MAIL MAILPATH
-do ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
-done
-PS1='$ '
-PS2='> '
-PS4='+ '
-
-# NLS nuisances.
-for as_var in \
-  LANG LANGUAGE LC_ADDRESS LC_ALL LC_COLLATE LC_CTYPE LC_IDENTIFICATION \
-  LC_MEASUREMENT LC_MESSAGES LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER \
-  LC_TELEPHONE LC_TIME
-do
-  if (set +x; test -z "`(eval $as_var=C; export $as_var) 2>&1`"); then
-    eval $as_var=C; export $as_var
-  else
-    ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
-  fi
-done
-
-# Required to use basename.
-if expr a : '\(a\)' >/dev/null 2>&1 &&
-   test "X`expr 00001 : '.*\(...\)'`" = X001; then
-  as_expr=expr
-else
-  as_expr=false
-fi
-
-if (basename -- /) >/dev/null 2>&1 && test "X`basename -- / 2>&1`" = "X/"; then
-  as_basename=basename
-else
-  as_basename=false
-fi
-
-
-# Name of the executable.
-as_me=`$as_basename -- "$0" ||
-$as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
-	 X"$0" : 'X\(//\)$' \| \
-	 X"$0" : 'X\(/\)' \| . 2>/dev/null ||
-echo X/"$0" |
-    sed '/^.*\/\([^/][^/]*\)\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\/\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\/\(\/\).*/{
-	    s//\1/
-	    q
-	  }
-	  s/.*/./; q'`
-
-# CDPATH.
-$as_unset CDPATH
-
-
-
-  as_lineno_1=$LINENO
-  as_lineno_2=$LINENO
-  test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x`expr $as_lineno_1 + 1`" = "x$as_lineno_2" || {
-
-  # Create $as_me.lineno as a copy of $as_myself, but with $LINENO
-  # uniformly replaced by the line number.  The first 'sed' inserts a
-  # line-number line after each line using $LINENO; the second 'sed'
-  # does the real work.  The second script uses 'N' to pair each
-  # line-number line with the line containing $LINENO, and appends
-  # trailing '-' during substitution so that $LINENO is not a special
-  # case at line end.
-  # (Raja R Harinath suggested sed '=', and Paul Eggert wrote the
-  # scripts with optimization help from Paolo Bonzini.  Blame Lee
-  # E. McMahon (1931-1989) for sed's syntax.  :-)
-  sed -n '
-    p
-    /[$]LINENO/=
-  ' <$as_myself |
-    sed '
-      s/[$]LINENO.*/&-/
-      t lineno
-      b
-      :lineno
-      N
-      :loop
-      s/[$]LINENO\([^'$as_cr_alnum'_].*\n\)\(.*\)/\2\1\2/
-      t loop
-      s/-\n.*//
-    ' >$as_me.lineno &&
-  chmod +x "$as_me.lineno" ||
-    { echo "$as_me: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&2
-   { (exit 1); exit 1; }; }
-
-  # Don't try to exec as it changes $[0], causing all sort of problems
-  # (the dirname of $[0] is not the place where we might find the
-  # original and so on.  Autoconf is especially sensitive to this).
-  . "./$as_me.lineno"
-  # Exit status is that of the last command.
-  exit
-}
-
-
-if (as_dir=`dirname -- /` && test "X$as_dir" = X/) >/dev/null 2>&1; then
-  as_dirname=dirname
-else
-  as_dirname=false
-fi
-
-ECHO_C= ECHO_N= ECHO_T=
-case `echo -n x` in
--n*)
-  case `echo 'x\c'` in
-  *c*) ECHO_T='	';;	# ECHO_T is single tab character.
-  *)   ECHO_C='\c';;
-  esac;;
-*)
-  ECHO_N='-n';;
-esac
-
-if expr a : '\(a\)' >/dev/null 2>&1 &&
-   test "X`expr 00001 : '.*\(...\)'`" = X001; then
-  as_expr=expr
-else
-  as_expr=false
-fi
-
-rm -f conf$$ conf$$.exe conf$$.file
-if test -d conf$$.dir; then
-  rm -f conf$$.dir/conf$$.file
-else
-  rm -f conf$$.dir
-  mkdir conf$$.dir
-fi
-echo >conf$$.file
-if ln -s conf$$.file conf$$ 2>/dev/null; then
-  as_ln_s='ln -s'
-  # ... but there are two gotchas:
-  # 1) On MSYS, both `ln -s file dir' and `ln file dir' fail.
-  # 2) DJGPP < 2.04 has no symlinks; `ln -s' creates a wrapper executable.
-  # In both cases, we have to default to `cp -p'.
-  ln -s conf$$.file conf$$.dir 2>/dev/null && test ! -f conf$$.exe ||
-    as_ln_s='cp -p'
-elif ln conf$$.file conf$$ 2>/dev/null; then
-  as_ln_s=ln
-else
-  as_ln_s='cp -p'
-fi
-rm -f conf$$ conf$$.exe conf$$.dir/conf$$.file conf$$.file
-rmdir conf$$.dir 2>/dev/null
-
-if mkdir -p . 2>/dev/null; then
-  as_mkdir_p=:
-else
-  test -d ./-p && rmdir ./-p
-  as_mkdir_p=false
-fi
-
-if test -x / >/dev/null 2>&1; then
-  as_test_x='test -x'
-else
-  if ls -dL / >/dev/null 2>&1; then
-    as_ls_L_option=L
-  else
-    as_ls_L_option=
-  fi
-  as_test_x='
-    eval sh -c '\''
-      if test -d "$1"; then
-        test -d "$1/.";
-      else
-	case $1 in
-        -*)set "./$1";;
-	esac;
-	case `ls -ld'$as_ls_L_option' "$1" 2>/dev/null` in
-	???[sx]*):;;*)false;;esac;fi
-    '\'' sh
-  '
-fi
-as_executable_p=$as_test_x
-
-# Sed expression to map a string onto a valid CPP name.
-as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
-
-# Sed expression to map a string onto a valid variable name.
-as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"
-
-
-exec 6>&1
-
-# Save the log message, to keep $[0] and so on meaningful, and to
-# report actual input values of CONFIG_FILES etc. instead of their
-# values after options handling.
-ac_log="
-This file was extended by $as_me, which was
-generated by GNU Autoconf 2.61.  Invocation command line was
-
-  CONFIG_FILES    = $CONFIG_FILES
-  CONFIG_HEADERS  = $CONFIG_HEADERS
-  CONFIG_LINKS    = $CONFIG_LINKS
-  CONFIG_COMMANDS = $CONFIG_COMMANDS
-  $ $0 $@
-
-on `(hostname || uname -n) 2>/dev/null | sed 1q`
-"
-
-_ACEOF
-
-cat >>$CONFIG_STATUS <<_ACEOF
-# Files that config.status was made for.
-config_files="$ac_config_files"
-config_headers="$ac_config_headers"
-
-_ACEOF
-
-cat >>$CONFIG_STATUS <<\_ACEOF
-ac_cs_usage="\
-\`$as_me' instantiates files from templates according to the
-current configuration.
-
-Usage: $0 [OPTIONS] [FILE]...
-
-  -h, --help       print this help, then exit
-  -V, --version    print version number and configuration settings, then exit
-  -q, --quiet      do not print progress messages
-  -d, --debug      don't remove temporary files
-      --recheck    update $as_me by reconfiguring in the same conditions
-  --file=FILE[:TEMPLATE]
-		   instantiate the configuration file FILE
-  --header=FILE[:TEMPLATE]
-		   instantiate the configuration header FILE
-
-Configuration files:
-$config_files
-
-Configuration headers:
-$config_headers
-
-Report bugs to <bug-autoc... at gnu.org>."
-
-_ACEOF
-cat >>$CONFIG_STATUS <<_ACEOF
-ac_cs_version="\\
-config.status
-configured by $0, generated by GNU Autoconf 2.61,
-  with options \\"`echo "$ac_configure_args" | sed 's/^ //; s/[\\""\`\$]/\\\\&/g'`\\"
-
-Copyright (C) 2006 Free Software Foundation, Inc.
-This config.status script is free software; the Free Software Foundation
-gives unlimited permission to copy, distribute and modify it."
-
-ac_pwd='$ac_pwd'
-srcdir='$srcdir'
-_ACEOF
-
-cat >>$CONFIG_STATUS <<\_ACEOF
-# If no file are specified by the user, then we need to provide default
-# value.  By we need to know if files were specified by the user.
-ac_need_defaults=:
-while test $# != 0
-do
-  case $1 in
-  --*=*)
-    ac_option=`expr "X$1" : 'X\([^=]*\)='`
-    ac_optarg=`expr "X$1" : 'X[^=]*=\(.*\)'`
-    ac_shift=:
-    ;;
-  *)
-    ac_option=$1
-    ac_optarg=$2
-    ac_shift=shift
-    ;;
-  esac
-
-  case $ac_option in
-  # Handling of the options.
-  -recheck | --recheck | --rechec | --reche | --rech | --rec | --re | --r)
-    ac_cs_recheck=: ;;
-  --version | --versio | --versi | --vers | --ver | --ve | --v | -V )
-    echo "$ac_cs_version"; exit ;;
-  --debug | --debu | --deb | --de | --d | -d )
-    debug=: ;;
-  --file | --fil | --fi | --f )
-    $ac_shift
-    CONFIG_FILES="$CONFIG_FILES $ac_optarg"
-    ac_need_defaults=false;;
-  --header | --heade | --head | --hea )
-    $ac_shift
-    CONFIG_HEADERS="$CONFIG_HEADERS $ac_optarg"
-    ac_need_defaults=false;;
-  --he | --h)
-    # Conflict between --help and --header
-    { echo "$as_me: error: ambiguous option: $1
-Try \`$0 --help' for more information." >&2
-   { (exit 1); exit 1; }; };;
-  --help | --hel | -h )
-    echo "$ac_cs_usage"; exit ;;
-  -q | -quiet | --quiet | --quie | --qui | --qu | --q \
-  | -silent | --silent | --silen | --sile | --sil | --si | --s)
-    ac_cs_silent=: ;;
-
-  # This is an error.
-  -*) { echo "$as_me: error: unrecognized option: $1
-Try \`$0 --help' for more information." >&2
-   { (exit 1); exit 1; }; } ;;
-
-  *) ac_config_targets="$ac_config_targets $1"
-     ac_need_defaults=false ;;
-
-  esac
-  shift
-done
-
-ac_configure_extra_args=
-
-if $ac_cs_silent; then
-  exec 6>/dev/null
-  ac_configure_extra_args="$ac_configure_extra_args --silent"
-fi
-
-_ACEOF
-cat >>$CONFIG_STATUS <<_ACEOF
-if \$ac_cs_recheck; then
-  echo "running CONFIG_SHELL=$SHELL $SHELL $0 "$ac_configure_args \$ac_configure_extra_args " --no-create --no-recursion" >&6
-  CONFIG_SHELL=$SHELL
-  export CONFIG_SHELL
-  exec $SHELL "$0"$ac_configure_args \$ac_configure_extra_args --no-create --no-recursion
-fi
-
-_ACEOF
-cat >>$CONFIG_STATUS <<\_ACEOF
-exec 5>>config.log
-{
-  echo
-  sed 'h;s/./-/g;s/^.../## /;s/...$/ ##/;p;x;p;x' <<_ASBOX
-## Running $as_me. ##
-_ASBOX
-  echo "$ac_log"
-} >&5
-
-_ACEOF
-cat >>$CONFIG_STATUS <<_ACEOF
-_ACEOF
-
-cat >>$CONFIG_STATUS <<\_ACEOF
-
-# Handling of arguments.
-for ac_config_target in $ac_config_targets
-do
-  case $ac_config_target in
-    "common/config.h") CONFIG_HEADERS="$CONFIG_HEADERS common/config.h" ;;
-    "Makefile") CONFIG_FILES="$CONFIG_FILES Makefile" ;;
-    "common/Makefile") CONFIG_FILES="$CONFIG_FILES common/Makefile" ;;
-    "ragel/Makefile") CONFIG_FILES="$CONFIG_FILES ragel/Makefile" ;;
-    "redfsm/Makefile") CONFIG_FILES="$CONFIG_FILES redfsm/Makefile" ;;
-    "rlgen-cd/Makefile") CONFIG_FILES="$CONFIG_FILES rlgen-cd/Makefile" ;;
-    "rlgen-java/Makefile") CONFIG_FILES="$CONFIG_FILES rlgen-java/Makefile" ;;
-    "rlgen-ruby/Makefile") CONFIG_FILES="$CONFIG_FILES rlgen-ruby/Makefile" ;;
-    "rlgen-dot/Makefile") CONFIG_FILES="$CONFIG_FILES rlgen-dot/Makefile" ;;
-    "rlgen-csharp/Makefile") CONFIG_FILES="$CONFIG_FILES rlgen-csharp/Makefile" ;;
-    "doc/Makefile") CONFIG_FILES="$CONFIG_FILES doc/Makefile" ;;
-    "test/Makefile") CONFIG_FILES="$CONFIG_FILES test/Makefile" ;;
-
-  *) { { echo "$as_me:$LINENO: error: invalid argument: $ac_config_target" >&5
-echo "$as_me: error: invalid argument: $ac_config_target" >&2;}
-   { (exit 1); exit 1; }; };;
-  esac
-done
-
-
-# If the user did not use the arguments to specify the items to instantiate,
-# then the envvar interface is used.  Set only those that are not.
-# We use the long form for the default assignment because of an extremely
-# bizarre bug on SunOS 4.1.3.
-if $ac_need_defaults; then
-  test "${CONFIG_FILES+set}" = set || CONFIG_FILES=$config_files
-  test "${CONFIG_HEADERS+set}" = set || CONFIG_HEADERS=$config_headers
-fi
-
-# Have a temporary directory for convenience.  Make it in the build tree
-# simply because there is no reason against having it here, and in addition,
-# creating and moving files from /tmp can sometimes cause problems.
-# Hook for its removal unless debugging.
-# Note that there is a small window in which the directory will not be cleaned:
-# after its creation but before its name has been assigned to `$tmp'.
-$debug ||
-{
-  tmp=
-  trap 'exit_status=$?
-  { test -z "$tmp" || test ! -d "$tmp" || rm -fr "$tmp"; } && exit $exit_status
-' 0
-  trap '{ (exit 1); exit 1; }' 1 2 13 15
-}
-# Create a (secure) tmp directory for tmp files.
-
-{
-  tmp=`(umask 077 && mktemp -d "./confXXXXXX") 2>/dev/null` &&
-  test -n "$tmp" && test -d "$tmp"
-}  ||
-{
-  tmp=./conf$$-$RANDOM
-  (umask 077 && mkdir "$tmp")
-} ||
-{
-   echo "$me: cannot create a temporary directory in ." >&2
-   { (exit 1); exit 1; }
-}
-
-#
-# Set up the sed scripts for CONFIG_FILES section.
-#
-
-# No need to generate the scripts if there are no CONFIG_FILES.
-# This happens for instance when ./config.status config.h
-if test -n "$CONFIG_FILES"; then
-
-_ACEOF
-
-
-
-ac_delim='%!_!# '
-for ac_last_try in false false false false false :; do
-  cat >conf$$subs.sed <<_ACEOF
-SHELL!$SHELL$ac_delim
-PATH_SEPARATOR!$PATH_SEPARATOR$ac_delim
-PACKAGE_NAME!$PACKAGE_NAME$ac_delim
-PACKAGE_TARNAME!$PACKAGE_TARNAME$ac_delim
-PACKAGE_VERSION!$PACKAGE_VERSION$ac_delim
-PACKAGE_STRING!$PACKAGE_STRING$ac_delim
-PACKAGE_BUGREPORT!$PACKAGE_BUGREPORT$ac_delim
-exec_prefix!$exec_prefix$ac_delim
-prefix!$prefix$ac_delim
-program_transform_name!$program_transform_name$ac_delim
-bindir!$bindir$ac_delim
-sbindir!$sbindir$ac_delim
-libexecdir!$libexecdir$ac_delim
-datarootdir!$datarootdir$ac_delim
-datadir!$datadir$ac_delim
-sysconfdir!$sysconfdir$ac_delim
-sharedstatedir!$sharedstatedir$ac_delim
-localstatedir!$localstatedir$ac_delim
-includedir!$includedir$ac_delim
-oldincludedir!$oldincludedir$ac_delim
-docdir!$docdir$ac_delim
-infodir!$infodir$ac_delim
-htmldir!$htmldir$ac_delim
-dvidir!$dvidir$ac_delim
-pdfdir!$pdfdir$ac_delim
-psdir!$psdir$ac_delim
-libdir!$libdir$ac_delim
-localedir!$localedir$ac_delim
-mandir!$mandir$ac_delim
-DEFS!$DEFS$ac_delim
-ECHO_C!$ECHO_C$ac_delim
-ECHO_N!$ECHO_N$ac_delim
-ECHO_T!$ECHO_T$ac_delim
-LIBS!$LIBS$ac_delim
-build_alias!$build_alias$ac_delim
-host_alias!$host_alias$ac_delim
-target_alias!$target_alias$ac_delim
-BUILD_PARSERS!$BUILD_PARSERS$ac_delim
-CC!$CC$ac_delim
-CFLAGS!$CFLAGS$ac_delim
-LDFLAGS!$LDFLAGS$ac_delim
-CPPFLAGS!$CPPFLAGS$ac_delim
-ac_ct_CC!$ac_ct_CC$ac_delim
-EXEEXT!$EXEEXT$ac_delim
-OBJEXT!$OBJEXT$ac_delim
-CXX!$CXX$ac_delim
-CXXFLAGS!$CXXFLAGS$ac_delim
-ac_ct_CXX!$ac_ct_CXX$ac_delim
-AR!$AR$ac_delim
-RANLIB!$RANLIB$ac_delim
-SET_MAKE!$SET_MAKE$ac_delim
-RAGEL!$RAGEL$ac_delim
-GPERF!$GPERF$ac_delim
-KELBT!$KELBT$ac_delim
-GDC!$GDC$ac_delim
-GOBJC!$GOBJC$ac_delim
-JAVAC!$JAVAC$ac_delim
-TXL!$TXL$ac_delim
-RUBY!$RUBY$ac_delim
-GMCS!$GMCS$ac_delim
-LIBOBJS!$LIBOBJS$ac_delim
-LTLIBOBJS!$LTLIBOBJS$ac_delim
-_ACEOF
-
-  if test `sed -n "s/.*$ac_delim\$/X/p" conf$$subs.sed | grep -c X` = 62; then
-    break
-  elif $ac_last_try; then
-    { { echo "$as_me:$LINENO: error: could not make $CONFIG_STATUS" >&5
-echo "$as_me: error: could not make $CONFIG_STATUS" >&2;}
-   { (exit 1); exit 1; }; }
-  else
-    ac_delim="$ac_delim!$ac_delim _$ac_delim!! "
-  fi
-done
-
-ac_eof=`sed -n '/^CEOF[0-9]*$/s/CEOF/0/p' conf$$subs.sed`
-if test -n "$ac_eof"; then
-  ac_eof=`echo "$ac_eof" | sort -nru | sed 1q`
-  ac_eof=`expr $ac_eof + 1`
-fi
-
-cat >>$CONFIG_STATUS <<_ACEOF
-cat >"\$tmp/subs-1.sed" <<\CEOF$ac_eof
-/@[a-zA-Z_][a-zA-Z_0-9]*@/!b end
-_ACEOF
-sed '
-s/[,\\&]/\\&/g; s/@/@|#_!!_#|/g
-s/^/s,@/; s/!/@,|#_!!_#|/
-:n
-t n
-s/'"$ac_delim"'$/,g/; t
-s/$/\\/; p
-N; s/^.*\n//; s/[,\\&]/\\&/g; s/@/@|#_!!_#|/g; b n
-' >>$CONFIG_STATUS <conf$$subs.sed
-rm -f conf$$subs.sed
-cat >>$CONFIG_STATUS <<_ACEOF
-:end
-s/|#_!!_#|//g
-CEOF$ac_eof
-_ACEOF
-
-
-# VPATH may cause trouble with some makes, so we remove $(srcdir),
-# ${srcdir} and @srcdir@ from VPATH if srcdir is ".", strip leading and
-# trailing colons and then remove the whole line if VPATH becomes empty
-# (actually we leave an empty line to preserve line numbers).
-if test "x$srcdir" = x.; then
-  ac_vpsub='/^[	 ]*VPATH[	 ]*=/{
-s/:*\$(srcdir):*/:/
-s/:*\${srcdir}:*/:/
-s/:*@srcdir@:*/:/
-s/^\([^=]*=[	 ]*\):*/\1/
-s/:*$//
-s/^[^=]*=[	 ]*$//
-}'
-fi
-
-cat >>$CONFIG_STATUS <<\_ACEOF
-fi # test -n "$CONFIG_FILES"
-
-
-for ac_tag in  :F $CONFIG_FILES  :H $CONFIG_HEADERS
-do
-  case $ac_tag in
-  :[FHLC]) ac_mode=$ac_tag; continue;;
-  esac
-  case $ac_mode$ac_tag in
-  :[FHL]*:*);;
-  :L* | :C*:*) { { echo "$as_me:$LINENO: error: Invalid tag $ac_tag." >&5
-echo "$as_me: error: Invalid tag $ac_tag." >&2;}
-   { (exit 1); exit 1; }; };;
-  :[FH]-) ac_tag=-:-;;
-  :[FH]*) ac_tag=$ac_tag:$ac_tag.in;;
-  esac
-  ac_save_IFS=$IFS
-  IFS=:
-  set x $ac_tag
-  IFS=$ac_save_IFS
-  shift
-  ac_file=$1
-  shift
-
-  case $ac_mode in
-  :L) ac_source=$1;;
-  :[FH])
-    ac_file_inputs=
-    for ac_f
-    do
-      case $ac_f in
-      -) ac_f="$tmp/stdin";;
-      *) # Look for the file first in the build tree, then in the source tree
-	 # (if the path is not absolute).  The absolute path cannot be DOS-style,
-	 # because $ac_f cannot contain `:'.
-	 test -f "$ac_f" ||
-	   case $ac_f in
-	   [\\/$]*) false;;
-	   *) test -f "$srcdir/$ac_f" && ac_f="$srcdir/$ac_f";;
-	   esac ||
-	   { { echo "$as_me:$LINENO: error: cannot find input file: $ac_f" >&5
-echo "$as_me: error: cannot find input file: $ac_f" >&2;}
-   { (exit 1); exit 1; }; };;
-      esac
-      ac_file_inputs="$ac_file_inputs $ac_f"
-    done
-
-    # Let's still pretend it is `configure' which instantiates (i.e., don't
-    # use $as_me), people would be surprised to read:
-    #    /* config.h.  Generated by config.status.  */
-    configure_input="Generated from "`IFS=:
-	  echo $* | sed 's|^[^:]*/||;s|:[^:]*/|, |g'`" by configure."
-    if test x"$ac_file" != x-; then
-      configure_input="$ac_file.  $configure_input"
-      { echo "$as_me:$LINENO: creating $ac_file" >&5
-echo "$as_me: creating $ac_file" >&6;}
-    fi
-
-    case $ac_tag in
-    *:-:* | *:-) cat >"$tmp/stdin";;
-    esac
-    ;;
-  esac
-
-  ac_dir=`$as_dirname -- "$ac_file" ||
-$as_expr X"$ac_file" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$ac_file" : 'X\(//\)[^/]' \| \
-	 X"$ac_file" : 'X\(//\)$' \| \
-	 X"$ac_file" : 'X\(/\)' \| . 2>/dev/null ||
-echo X"$ac_file" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)[^/].*/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\).*/{
-	    s//\1/
-	    q
-	  }
-	  s/.*/./; q'`
-  { as_dir="$ac_dir"
-  case $as_dir in #(
-  -*) as_dir=./$as_dir;;
-  esac
-  test -d "$as_dir" || { $as_mkdir_p && mkdir -p "$as_dir"; } || {
-    as_dirs=
-    while :; do
-      case $as_dir in #(
-      *\'*) as_qdir=`echo "$as_dir" | sed "s/'/'\\\\\\\\''/g"`;; #(
-      *) as_qdir=$as_dir;;
-      esac
-      as_dirs="'$as_qdir' $as_dirs"
-      as_dir=`$as_dirname -- "$as_dir" ||
-$as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$as_dir" : 'X\(//\)[^/]' \| \
-	 X"$as_dir" : 'X\(//\)$' \| \
-	 X"$as_dir" : 'X\(/\)' \| . 2>/dev/null ||
-echo X"$as_dir" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)[^/].*/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\).*/{
-	    s//\1/
-	    q
-	  }
-	  s/.*/./; q'`
-      test -d "$as_dir" && break
-    done
-    test -z "$as_dirs" || eval "mkdir $as_dirs"
-  } || test -d "$as_dir" || { { echo "$as_me:$LINENO: error: cannot create directory $as_dir" >&5
-echo "$as_me: error: cannot create directory $as_dir" >&2;}
-   { (exit 1); exit 1; }; }; }
-  ac_builddir=.
-
-case "$ac_dir" in
-.) ac_dir_suffix= ac_top_builddir_sub=. ac_top_build_prefix= ;;
-*)
-  ac_dir_suffix=/`echo "$ac_dir" | sed 's,^\.[\\/],,'`
-  # A ".." for each directory in $ac_dir_suffix.
-  ac_top_builddir_sub=`echo "$ac_dir_suffix" | sed 's,/[^\\/]*,/..,g;s,/,,'`
-  case $ac_top_builddir_sub in
-  "") ac_top_builddir_sub=. ac_top_build_prefix= ;;
-  *)  ac_top_build_prefix=$ac_top_builddir_sub/ ;;
-  esac ;;
-esac
-ac_abs_top_builddir=$ac_pwd
-ac_abs_builddir=$ac_pwd$ac_dir_suffix
-# for backward compatibility:
-ac_top_builddir=$ac_top_build_prefix
-
-case $srcdir in
-  .)  # We are building in place.
-    ac_srcdir=.
-    ac_top_srcdir=$ac_top_builddir_sub
-    ac_abs_top_srcdir=$ac_pwd ;;
-  [\\/]* | ?:[\\/]* )  # Absolute name.
-    ac_srcdir=$srcdir$ac_dir_suffix;
-    ac_top_srcdir=$srcdir
-    ac_abs_top_srcdir=$srcdir ;;
-  *) # Relative name.
-    ac_srcdir=$ac_top_build_prefix$srcdir$ac_dir_suffix
-    ac_top_srcdir=$ac_top_build_prefix$srcdir
-    ac_abs_top_srcdir=$ac_pwd/$srcdir ;;
-esac
-ac_abs_srcdir=$ac_abs_top_srcdir$ac_dir_suffix
-
-
-  case $ac_mode in
-  :F)
-  #
-  # CONFIG_FILE
-  #
-
-_ACEOF
-
-cat >>$CONFIG_STATUS <<\_ACEOF
-# If the template does not know about datarootdir, expand it.
-# FIXME: This hack should be removed a few years after 2.60.
-ac_datarootdir_hack=; ac_datarootdir_seen=
-
-case `sed -n '/datarootdir/ {
-  p
-  q
-}
-/@datadir@/p
-/@docdir@/p
-/@infodir@/p
-/@localedir@/p
-/@mandir@/p
-' $ac_file_inputs` in
-*datarootdir*) ac_datarootdir_seen=yes;;
-*@datadir@*|*@docdir@*|*@infodir@*|*@localedir@*|*@mandir@*)
-  { echo "$as_me:$LINENO: WARNING: $ac_file_inputs seems to ignore the --datarootdir setting" >&5
-echo "$as_me: WARNING: $ac_file_inputs seems to ignore the --datarootdir setting" >&2;}
-_ACEOF
-cat >>$CONFIG_STATUS <<_ACEOF
-  ac_datarootdir_hack='
-  s&@datadir@&$datadir&g
-  s&@docdir@&$docdir&g
-  s&@infodir@&$infodir&g
-  s&@localedir@&$localedir&g
-  s&@mandir@&$mandir&g
-    s&\\\${datarootdir}&$datarootdir&g' ;;
-esac
-_ACEOF
-
-# Neutralize VPATH when `$srcdir' = `.'.
-# Shell code in configure.ac might set extrasub.
-# FIXME: do we really want to maintain this feature?
-cat >>$CONFIG_STATUS <<_ACEOF
-  sed "$ac_vpsub
-$extrasub
-_ACEOF
-cat >>$CONFIG_STATUS <<\_ACEOF
-:t
-/@[a-zA-Z_][a-zA-Z_0-9]*@/!b
-s&@configure_input@&$configure_input&;t t
-s&@top_builddir@&$ac_top_builddir_sub&;t t
-s&@srcdir@&$ac_srcdir&;t t
-s&@abs_srcdir@&$ac_abs_srcdir&;t t
-s&@top_srcdir@&$ac_top_srcdir&;t t
-s&@abs_top_srcdir@&$ac_abs_top_srcdir&;t t
-s&@builddir@&$ac_builddir&;t t
-s&@abs_builddir@&$ac_abs_builddir&;t t
-s&@abs_top_builddir@&$ac_abs_top_builddir&;t t
-$ac_datarootdir_hack
-" $ac_file_inputs | sed -f "$tmp/subs-1.sed" >$tmp/out
-
-test -z "$ac_datarootdir_hack$ac_datarootdir_seen" &&
-  { ac_out=`sed -n '/\${datarootdir}/p' "$tmp/out"`; test -n "$ac_out"; } &&
-  { ac_out=`sed -n '/^[	 ]*datarootdir[	 ]*:*=/p' "$tmp/out"`; test -z "$ac_out"; } &&
-  { echo "$as_me:$LINENO: WARNING: $ac_file contains a reference to the variable \`datarootdir'
-which seems to be undefined.  Please make sure it is defined." >&5
-echo "$as_me: WARNING: $ac_file contains a reference to the variable \`datarootdir'
-which seems to be undefined.  Please make sure it is defined." >&2;}
-
-  rm -f "$tmp/stdin"
-  case $ac_file in
-  -) cat "$tmp/out"; rm -f "$tmp/out";;
-  *) rm -f "$ac_file"; mv "$tmp/out" $ac_file;;
-  esac
- ;;
-  :H)
-  #
-  # CONFIG_HEADER
-  #
-_ACEOF
-
-# Transform confdefs.h into a sed script `conftest.defines', that
-# substitutes the proper values into config.h.in to produce config.h.
-rm -f conftest.defines conftest.tail
-# First, append a space to every undef/define line, to ease matching.
-echo 's/$/ /' >conftest.defines
-# Then, protect against being on the right side of a sed subst, or in
-# an unquoted here document, in config.status.  If some macros were
-# called several times there might be several #defines for the same
-# symbol, which is useless.  But do not sort them, since the last
-# AC_DEFINE must be honored.
-ac_word_re=[_$as_cr_Letters][_$as_cr_alnum]*
-# These sed commands are passed to sed as "A NAME B PARAMS C VALUE D", where
-# NAME is the cpp macro being defined, VALUE is the value it is being given.
-# PARAMS is the parameter list in the macro definition--in most cases, it's
-# just an empty string.
-ac_dA='s,^\\([	 #]*\\)[^	 ]*\\([	 ]*'
-ac_dB='\\)[	 (].*,\\1define\\2'
-ac_dC=' '
-ac_dD=' ,'
-
-uniq confdefs.h |
-  sed -n '
-	t rset
-	:rset
-	s/^[	 ]*#[	 ]*define[	 ][	 ]*//
-	t ok
-	d
-	:ok
-	s/[\\&,]/\\&/g
-	s/^\('"$ac_word_re"'\)\(([^()]*)\)[	 ]*\(.*\)/ '"$ac_dA"'\1'"$ac_dB"'\2'"${ac_dC}"'\3'"$ac_dD"'/p
-	s/^\('"$ac_word_re"'\)[	 ]*\(.*\)/'"$ac_dA"'\1'"$ac_dB$ac_dC"'\2'"$ac_dD"'/p
-  ' >>conftest.defines
-
-# Remove the space that was appended to ease matching.
-# Then replace #undef with comments.  This is necessary, for
-# example, in the case of _POSIX_SOURCE, which is predefined and required
-# on some systems where configure will not decide to define it.
-# (The regexp can be short, since the line contains either #define or #undef.)
-echo 's/ $//
-s,^[	 #]*u.*,/* & */,' >>conftest.defines
-
-# Break up conftest.defines:
-ac_max_sed_lines=50
-
-# First sed command is:	 sed -f defines.sed $ac_file_inputs >"$tmp/out1"
-# Second one is:	 sed -f defines.sed "$tmp/out1" >"$tmp/out2"
-# Third one will be:	 sed -f defines.sed "$tmp/out2" >"$tmp/out1"
-# et cetera.
-ac_in='$ac_file_inputs'
-ac_out='"$tmp/out1"'
-ac_nxt='"$tmp/out2"'
-
-while :
-do
-  # Write a here document:
-    cat >>$CONFIG_STATUS <<_ACEOF
-    # First, check the format of the line:
-    cat >"\$tmp/defines.sed" <<\\CEOF
-/^[	 ]*#[	 ]*undef[	 ][	 ]*$ac_word_re[	 ]*\$/b def
-/^[	 ]*#[	 ]*define[	 ][	 ]*$ac_word_re[(	 ]/b def
-b
-:def
-_ACEOF
-  sed ${ac_max_sed_lines}q conftest.defines >>$CONFIG_STATUS
-  echo 'CEOF
-    sed -f "$tmp/defines.sed"' "$ac_in >$ac_out" >>$CONFIG_STATUS
-  ac_in=$ac_out; ac_out=$ac_nxt; ac_nxt=$ac_in
-  sed 1,${ac_max_sed_lines}d conftest.defines >conftest.tail
-  grep . conftest.tail >/dev/null || break
-  rm -f conftest.defines
-  mv conftest.tail conftest.defines
-done
-rm -f conftest.defines conftest.tail
-
-echo "ac_result=$ac_in" >>$CONFIG_STATUS
-cat >>$CONFIG_STATUS <<\_ACEOF
-  if test x"$ac_file" != x-; then
-    echo "/* $configure_input  */" >"$tmp/config.h"
-    cat "$ac_result" >>"$tmp/config.h"
-    if diff $ac_file "$tmp/config.h" >/dev/null 2>&1; then
-      { echo "$as_me:$LINENO: $ac_file is unchanged" >&5
-echo "$as_me: $ac_file is unchanged" >&6;}
-    else
-      rm -f $ac_file
-      mv "$tmp/config.h" $ac_file
-    fi
-  else
-    echo "/* $configure_input  */"
-    cat "$ac_result"
-  fi
-  rm -f "$tmp/out12"
- ;;
-
-
-  esac
-
-done # for ac_tag
-
-
-{ (exit 0); exit 0; }
-_ACEOF
-chmod +x $CONFIG_STATUS
-ac_clean_files=$ac_clean_files_save
-
-
-# configure is writing to config.log, and then calls config.status.
-# config.status does its own redirection, appending to config.log.
-# Unfortunately, on DOS this fails, as config.log is still kept open
-# by configure, so config.status won't be able to write to it; its
-# output is simply discarded.  So we exec the FD to /dev/null,
-# effectively closing config.log, so it can be properly (re)opened and
-# appended to by config.status.  When coming back to configure, we
-# need to make the FD available again.
-if test "$no_create" != yes; then
-  ac_cs_success=:
-  ac_config_status_args=
-  test "$silent" = yes &&
-    ac_config_status_args="$ac_config_status_args --quiet"
-  exec 5>/dev/null
-  $SHELL $CONFIG_STATUS $ac_config_status_args || ac_cs_success=false
-  exec 5>>config.log
-  # Use ||, not &&, to avoid exiting from the if with $? = 1, which
-  # would make configure fail if this is the last instruction.
-  $ac_cs_success || { (exit 1); exit 1; }
-fi
-
-
-echo "configuration of ragel complete"


From flamee... at gmail.com  Wed Oct  1 14:37:39 2008
From: flamee... at gmail.com (Diego 'Flameeyes' =?utf-8?q?Petten=C3=B2?=)
Date: Wed, 01 Oct 2008 16:37:39 +0200
Subject: [PATCH 5/6] Replace custom makefiles with automake.
Message-ID: <20081001143739.22980.34660.stgit@yamato>

Since there are a lot of limitations with the current custon
makefiles, move to use proper GNU automake, that will allow for a
quite easier life for package maintainers too.
---

 Makefile.am               |   21 +++++
 Makefile.in               |   76 -------------------
 common/Makefile.am        |   12 +++
 common/Makefile.in        |   68 -----------------
 configure.in              |    8 +-
 doc/Makefile.am           |   13 +++
 doc/Makefile.in           |   71 -----------------
 examples/Makefile         |  142 -----------------------------------
 examples/Makefile.am      |   38 +++++++++
 examples/cppscan.lex      |  143 -----------------------------------
 examples/cppscan.rec      |  183 ---------------------------------------------
 examples/lex-cppscan.l    |  143 +++++++++++++++++++++++++++++++++++
 examples/re2c-cppscan.rec |  183 +++++++++++++++++++++++++++++++++++++++++++++
 ragel/Makefile.am         |   38 +++++++++
 ragel/Makefile.in         |  101 -------------------------
 redfsm/Makefile.am        |   29 +++++++
 redfsm/Makefile.in        |   85 ---------------------
 rlgen-cd/Makefile.am      |   12 +++
 rlgen-cd/Makefile.in      |   69 -----------------
 rlgen-csharp/Makefile.am  |   12 +++
 rlgen-csharp/Makefile.in  |   69 -----------------
 rlgen-dot/Makefile.am     |    7 ++
 rlgen-dot/Makefile.in     |   66 ----------------
 rlgen-java/Makefile.am    |    8 ++
 rlgen-java/Makefile.in    |   66 ----------------
 rlgen-ruby/Makefile.am    |   11 +++
 rlgen-ruby/Makefile.in    |   67 ----------------
 test/Makefile.am          |   23 ++++++
 test/Makefile.in          |   30 -------
 29 files changed, 555 insertions(+), 1239 deletions(-)
 create mode 100644 Makefile.am
 delete mode 100644 Makefile.in
 create mode 100644 common/Makefile.am
 delete mode 100644 common/Makefile.in
 create mode 100644 doc/Makefile.am
 delete mode 100644 doc/Makefile.in
 delete mode 100644 examples/Makefile
 create mode 100644 examples/Makefile.am
 delete mode 100644 examples/cppscan.lex
 delete mode 100644 examples/cppscan.rec
 create mode 100644 examples/lex-cppscan.l
 create mode 100644 examples/re2c-cppscan.rec
 create mode 100644 ragel/Makefile.am
 delete mode 100644 ragel/Makefile.in
 create mode 100644 redfsm/Makefile.am
 delete mode 100644 redfsm/Makefile.in
 create mode 100644 rlgen-cd/Makefile.am
 delete mode 100644 rlgen-cd/Makefile.in
 create mode 100644 rlgen-csharp/Makefile.am
 delete mode 100644 rlgen-csharp/Makefile.in
 create mode 100644 rlgen-dot/Makefile.am
 delete mode 100644 rlgen-dot/Makefile.in
 create mode 100644 rlgen-java/Makefile.am
 delete mode 100644 rlgen-java/Makefile.in
 create mode 100644 rlgen-ruby/Makefile.am
 delete mode 100644 rlgen-ruby/Makefile.in
 create mode 100644 test/Makefile.am
 delete mode 100644 test/Makefile.in

diff --git a/Makefile.am b/Makefile.am
new file mode 100644
index 0000000..3dd8634
--- /dev/null
+++ b/Makefile.am
@@ -0,0 +1,21 @@
+# aapl headers and docs
+noinst_HEADERS = aapl/avlbasic.h aapl/avlimel.h aapl/avlmap.h		\
+	aapl/bstcommon.h aapl/compare.h aapl/insertsort.h		\
+	aapl/sbstset.h aapl/avlcommon.h aapl/avlimelkey.h		\
+	aapl/avlmel.h aapl/bstmap.h aapl/dlcommon.h aapl/mergesort.h	\
+	aapl/sbsttable.h aapl/avlibasic.h aapl/avliset.h		\
+	aapl/avlmelkey.h aapl/bstset.h aapl/dlist.h aapl/quicksort.h	\
+	aapl/svector.h aapl/avlikeyless.h aapl/avlitree.h		\
+	aapl/avlset.h aapl/bsttable.h aapl/dlistmel.h aapl/resize.h	\
+	aapl/table.h aapl/avlimap.h aapl/avlkeyless.h aapl/avltree.h	\
+	aapl/bubblesort.h aapl/dlistval.h aapl/sbstmap.h aapl/vector.h
+EXTRA_DIST = aapl/README aapl/COPYING
+
+BUILD_COMMON = common redfsm rlgen-cd rlgen-java rlgen-ruby rlgen-csharp rlgen-dot
+BUILD_SUBDIRS = ragel 
+ALL_SUBDIRS = $(BUILD_COMMON) $(BUILD_SUBDIRS) test examples doc
+
+SUBDIRS = common redfsm \
+	rlgen-cd rlgen-java rlgen-ruby rlgen-csharp rlgen-dot \
+	ragel \
+	test examples doc
diff --git a/Makefile.in b/Makefile.in
deleted file mode 100644
index 4619bb5..0000000
--- a/Makefile.in
+++ /dev/null
@@ -1,76 +0,0 @@
-#
-#   Copyright 2001-2007 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-BUILD_COMMON = common redfsm rlgen-cd rlgen-java rlgen-ruby rlgen-csharp rlgen-dot
-BUILD_SUBDIRS = ragel 
-ALL_SUBDIRS = $(BUILD_COMMON) $(BUILD_SUBDIRS) test examples doc
-
-#*************************************
-
-# Programs
-CXX = @CXX@
-
-
-# build targets
-all: $(BUILD_SUBDIRS)
-
-.PHONY: $(ALL_SUBDIRS)
-
-$(BUILD_COMMON):
-	@cd $@ && $(MAKE)
-
-$(BUILD_SUBDIRS): $(BUILD_COMMON)
-	@cd $@ && $(MAKE)
-
-# clean targets.
-
-CLEAN_SUBDIRS = $(ALL_SUBDIRS:%=%-clean)
-
-.PHONY: $(CLEAN_SUBDIRS)
-
-$(CLEAN_SUBDIRS):
-	@cd $(@:%-clean=%) && $(MAKE) clean
-
-clean: $(CLEAN_SUBDIRS)
-	rm -f tags
-
-# distcleaan targets
-
-DISTCLEAN_SUBDIRS = $(ALL_SUBDIRS:%=%-distclean)
-
-.PHONY: $(DISTCLEAN_SUBDIRS)
-
-$(DISTCLEAN_SUBDIRS):
-	@cd $(@:%-distclean=%) && $(MAKE) distclean
-
-distclean: $(DISTCLEAN_SUBDIRS)
-	rm -f Makefile config.cache config.status config.log
-
-#install targets
-
-INSTALL_SUBDIRS = $(BUILD_SUBDIRS:%=%-install)
-
-.PHONY: $(INSTALL_SUBDIRS)
-
-$(INSTALL_SUBDIRS):
-	@cd $(@:%-install=%) && $(MAKE) install
-
-install: $(INSTALL_SUBDIRS)
-
diff --git a/common/Makefile.am b/common/Makefile.am
new file mode 100644
index 0000000..5a82a1b
--- /dev/null
+++ b/common/Makefile.am
@@ -0,0 +1,12 @@
+INCLUDES = -I$(top_srcdir)/aapl
+
+AM_CXXFLAGS = -g -Wall
+
+noinst_LIBRARIES = libcommon.a
+
+libcommon_a_SOURCES = common.h common.cpp version.h buffer.h pcheck.h
+
+BUILT_SOURCES = version.h
+
+version.h:
+	echo '#define PREFIX "$(prefix)"' >> version.h
diff --git a/common/Makefile.in b/common/Makefile.in
deleted file mode 100644
index e79d6a4..0000000
--- a/common/Makefile.in
+++ /dev/null
@@ -1,68 +0,0 @@
-#
-#   Copyright 2001-2006 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-INCS += -I../aapl
-DEFS +=
-
-CXXFLAGS += -g -Wall
-LDFLAGS +=
-
-CC_SRCS = common.cpp
-
-GEN_SRC = version.h
-
-#*************************************
-prefix = @prefix@
-
-# Programs
-CXX = @CXX@
-AR = @AR@
-RANLIB = @RANLIB@
-
-# Get objects and dependencies from sources.
-OBJS = $(CC_SRCS:%.cpp=%.o)
-DEPS = $(CC_SRCS:%.cpp=.%.d)
-
-
-# rules
-
-all: common.a
-
-common.a: $(GEN_SRC) $(OBJS)
-	$(AR) -cr $@ $(OBJS) 
-	$(RANLIB) $@
-
-version.h:
-	echo '#define PREFIX "$(prefix)"' >> version.h
-
-%.o: %.cpp
-	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
-
-distclean: clean
-	rm -f Makefile config.h
-
-clean:
-	rm -f tags version.h .*.d *.o common.a
-
-install:
-	@true
-
--include $(DEPS)
diff --git a/configure.in b/configure.in
index 85e93b0..0b9fa44 100644
--- a/configure.in
+++ b/configure.in
@@ -21,6 +21,8 @@ dnl   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 AC_INIT(ragel/main.cpp, 6.3)
 AC_CONFIG_HEADER(common/config.h)
 
+AM_INIT_AUTOMAKE([1.10 foreign])
+
 PACKAGE_PUBDATE="August 2008"
 AC_SUBST(PACKAGE_PUBDATE)
 AC_DEFINE_UNQUOTED([PACKAGE_PUBDATE], ["$PACKAGE_PUBDATE"], [Package publication date])
@@ -30,13 +32,13 @@ dnl and don't need to be built.
 AC_ARG_ENABLE([parsers],
   AS_HELP_STRING([--disable-parsers], [Disable building of parsers with ragel, kelbt and gperf]),
   [], [enable_parsers=yes])
-AC_SUBST([enable_parsers])
+AM_CONDITIONAL([BUILD_PARSERS], [test "x$enable_parsers" = "xyes"])
 
 dnl Checks for programs.
 AC_PROG_CC
 AC_PROG_CXX
-AC_CHECK_TOOL(AR, ar)
 AC_PROG_RANLIB
+AM_PROG_LEX
 
 dnl Set test on c++ compiler.
 AC_LANG_CPLUSPLUS
@@ -111,6 +113,6 @@ AC_CHECK_PROG(GMCS, gmcs, gmcs)
 AC_SUBST(GMCS)
 
 dnl write output files
-AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile test/runtests doc/ragel.1 doc/rlgen-cd.1 doc/rlgen-java.1 doc/rlgen-ruby.1 doc/rlgen-dot.1 doc/version.tex)
+AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile examples/Makefile test/runtests doc/ragel.1 doc/rlgen-cd.1 doc/rlgen-java.1 doc/rlgen-ruby.1 doc/rlgen-dot.1 doc/version.tex)
 
 echo "configuration of ragel complete"
diff --git a/doc/Makefile.am b/doc/Makefile.am
new file mode 100644
index 0000000..816a279
--- /dev/null
+++ b/doc/Makefile.am
@@ -0,0 +1,13 @@
+.fig.pdf:
+	fig2dev -L pdf $< $@
+
+.tex.pdf:
+	pdflatex -interaction=nonstopmode $<
+	pdflatex -interaction=nonstopmode $<
+	pdflatex -interaction=nonstopmode $<
+
+man_MANS = ragel.1 rlgen-cd.1 rlgen-java.1 rlgen-ruby.1 rlgen-dot.1
+
+#dist_doc_DATA = ragel-guide.pdf
+
+doc_DATA = ../ChangeLog
diff --git a/doc/Makefile.in b/doc/Makefile.in
deleted file mode 100644
index 6178f0d..0000000
--- a/doc/Makefile.in
+++ /dev/null
@@ -1,71 +0,0 @@
-#
-#   Copyright 2001-2007 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-INPUT = version.tex ragel-guide.tex
-
-# Pick up all the figures in the current dir.
-FIGURES = $(wildcard *.fig)
-PDFFIGS = $(FIGURES:%.fig=%.pdf)
-
-
-# Installation locations.
-PACKAGE     = ragel
-prefix      = @prefix@
-datarootdir = @datarootdir@
-docdir      = @docdir@
-mandir      = @mandir@
-
-MANPAGES = ragel.1 rlgen-cd.1 rlgen-java.1 rlgen-ruby.1 rlgen-dot.1
-
-# Rules.
-all: ragel-guide.pdf $(MANPAGES)
-
-ragel-guide.pdf: $(PDFFIGS) $(INPUT)
-
-%.pdf: %.fig
-	fig2dev -L pdf $< $@
-
-%.pdf: %.tex
-	pdflatex -interaction=nonstopmode $< >/dev/null
-	pdflatex -interaction=nonstopmode $< >/dev/null
-	pdflatex -interaction=nonstopmode $< >/dev/null
-
-clean:
-	rm -f *.bak *.aux *.dvi *.log *.toc *.pdf
-
-distclean: clean
-	rm -f Makefile $(MANPAGES) version.tex
-
-man: $(MANPAGES)
-
-man-install: man
-	install -d $(DESTDIR)$(mandir)/man1
-	install -m 644 ragel.1      (DESTDIR)$(mandir)/man1/ragel.1
-	install -m 644 rlgen-dot.1  (DESTDIR)$(mandir)/man1/rlgen-dot.1
-	install -m 644 rlgen-cd.1   (DESTDIR)$(mandir)/man1/rlgen-cd.1
-	install -m 644 rlgen-java.1 (DESTDIR)$(mandir)/man1/rlgen-java.1
-	install -m 644 rlgen-ruby.1 (DESTDIR)$(mandir)/man1/rlgen-ruby.1
-
-install: all man-install
-	install -d $(DESTDIR)$(docdir)
-	install -m 644 ragel-guide.pdf $(DESTDIR)$(docdir)/ragel-guide.pdf
-	gzip -c ../ChangeLog > ChangeLog.gz
-	install -m 644 ChangeLog.gz $(DESTDIR)$(docdir)/ChangeLog.gz
-	rm ChangeLog.gz
diff --git a/examples/Makefile b/examples/Makefile
deleted file mode 100644
index b9fcc21..0000000
--- a/examples/Makefile
+++ /dev/null
@@ -1,142 +0,0 @@
-#
-#   Copyright 2002-2007 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-RAGEL = ../ragel/ragel
-FLEX = flex
-RE2C = re2c
-
-TARGS = \
-	atoi awkemu clang concurrent cppscan format gotocallret mailbox params \
-	pullscan rlscan statechart 
-
-#########################################
-
-all: $(TARGS)
-
-distclean clean:
-	rm -Rf *.o *.c *.cpp $(TARGS)
-
-%.o: %.c
-	gcc $(CFLAGS) -Wall -g -c -O3 -o $@ $<
-
-%.o: %.cpp
-	g++ $(CXXFLAGS) -Wall -g -c -O3 -o $@ $<
-
-#########################################
-
-gotocallret: gotocallret.o
-	g++ -g -o gotocallret gotocallret.o 
-
-gotocallret.cpp: gotocallret.rl
-	$(RAGEL) -G2 -o gotocallret.cpp gotocallret.rl 
-
-gotocallret.o: gotocallret.cpp
-	g++ -Wall -g -c -O3 -o $@ $<
-
-
-pullscan: pullscan.o
-	gcc -g -o $@ $<
-
-pullscan.c: pullscan.rl $(RAGEL) 
-	$(RAGEL) -G2 -o $@ pullscan.rl
-
-concurrent: concurrent.o
-	g++ -g -o concurrent concurrent.o 
-
-concurrent.cpp: concurrent.rl $(RAGEL)
-	$(RAGEL) -G2 -o concurrent.cpp concurrent.rl
-
-rlscan: rlscan.o
-	g++ -g -o rlscan rlscan.o 
-
-rlscan.cpp: rlscan.rl 
-	$(RAGEL) -G2 -o rlscan.cpp rlscan.rl
-
-statechart: statechart.o
-	g++ -g -o statechart statechart.o 
-
-statechart.cpp: statechart.rl 
-	$(RAGEL) -G2 -o statechart.cpp statechart.rl
-
-statechart.o: statechart.cpp
-	g++ -Wall -g -c -O3 -o $@ $<
-
-params: params.o 
-	gcc -g -o params params.o
-
-params.c: params.rl
-	$(RAGEL) -G2 -o params.c params.rl
-
-clang: clang.o 
-	gcc -g -o clang clang.o
-
-clang.c: clang.rl 
-	$(RAGEL) -G2 -o clang.c clang.rl
-
-optional: lex-cppscan re2c-cppscan
-
-cppscan: cppscan.o
-	g++ -g -o $@ $<
-
-lex-cppscan: lex-cppscan.o
-	g++ -g -o $@ $<
-	
-re2c-cppscan: re2c-cppscan.o
-	g++ -g -o $@ $<
-	
-cppscan.cpp: cppscan.rl 
-	$(RAGEL) -G2 -o $@ cppscan.rl
-
-lex-cppscan.cpp: cppscan.lex
-	$(FLEX) -f -o $@ $<
-
-re2c-cppscan.cpp: cppscan.rec
-	$(RE2C) -s $< > $@
-
-example.cpp: example.rec
-	$(RE2C) -s $< > $@
-
-format: format.o 
-	gcc -g -o format format.o
-
-format.c: format.rl
-	$(RAGEL) -G2 -o format.c format.rl
-
-awkemu: awkemu.o
-	gcc -g -o awkemu awkemu.o
-
-awkemu.c: awkemu.rl
-	$(RAGEL) -G2 -o awkemu.c awkemu.rl
-
-
-mailbox: mailbox.o
-	g++ -g -o mailbox mailbox.o 
-
-mailbox.cpp: mailbox.rl
-	$(RAGEL) -G2 -o mailbox.cpp mailbox.rl
-
-atoi: atoi.o
-	g++ -g -o atoi atoi.o 
-
-atoi.cpp: atoi.rl
-	$(RAGEL) -G2 -o atoi.cpp atoi.rl
-
-atoi.o: atoi.cpp
-	g++ -Wall -g -c -O3 -o $@ $<
diff --git a/examples/Makefile.am b/examples/Makefile.am
new file mode 100644
index 0000000..3950fc6
--- /dev/null
+++ b/examples/Makefile.am
@@ -0,0 +1,38 @@
+.rl.cpp:
+	../ragel/ragel -G2 -o $@ $<
+
+.rl.c:
+	../ragel/ragel -G2 -o $@ $<
+
+.rec.cpp:
+	re2c -s $< > $@
+
+RAGEL_EXAMPLES = atoi awkemu clang concurrent cppscan format	\
+	gotocallret mailbox params pullscan rlscan statechart
+
+EXTRA_PROGRAMS = $(RAGEL_EXAMPLES) lex-cppscan re2c-cppscan
+
+examples: $(RAGEL_EXAMPLES)
+
+atoi_SOURCES = atoi.cpp
+awkemu_SOURCES = awkemu.c
+clang_SOURCES = clang.c
+concurrent_SOURCES = concurrent.cpp
+cppscan_SOURCES = cppscan.cpp
+format_SOURCES = format.c
+gotocallret_SOURCES = gotocallret.cpp
+mailbox_SOURCES = mailbox.cpp
+params_SOURCES = params.c
+pullscan_SOURCES = pullscan.c
+rlscan_SOURCES = rlscan.cpp
+statechart_SOURCES = statechart.cpp
+
+lex_cppscan_SOURCES = lex-cppscan.l
+re2c_cppscan_SOURCES = re2c-cppscan.cpp
+
+BUILT_SOURCES = $(atoi_SOURCES) $(awkemu_SOURCES) $(clang_SOURCES)	\
+	$(concurrent_SOURCES) $(cppscan_SOURCES) $(format_SOURCES)	\
+	$(gotocallret_SOURCES) $(mailbox_SOURCES) $(params_SOURCES)	\
+	$(pullscan_SOURCES) $(rlscan_SOURCES) $(statechart_SOURCES)	\
+	$(lex_cppscan_SOURCES) $(re2c_cppscan_SOURCES)
+
diff --git a/examples/cppscan.lex b/examples/cppscan.lex
deleted file mode 100644
index fb66253..0000000
--- a/examples/cppscan.lex
+++ /dev/null
@@ -1,143 +0,0 @@
-/*
- * flex equivalent to cppscan.rl
- */
-
-%{
-
-#include <stdio.h>
-
-#define TK_Dlit 256
-#define TK_Slit 257
-#define TK_Float 258
-#define TK_Id 259
-#define TK_NameSep 260
-#define TK_Arrow 261
-#define TK_PlusPlus 262
-#define TK_MinusMinus 263
-#define TK_ArrowStar 264
-#define TK_DotStar 265
-#define TK_ShiftLeft 266
-#define TK_ShiftRight 267
-#define TK_IntegerDecimal 268
-#define TK_IntegerOctal 269
-#define TK_IntegerHex 270
-#define TK_EqualsEquals 271
-#define TK_NotEquals 272
-#define TK_AndAnd 273
-#define TK_OrOr 274
-#define TK_MultAssign 275
-#define TK_DivAssign 276
-#define TK_PercentAssign 277
-#define TK_PlusAssign 278
-#define TK_MinusAssign 279
-#define TK_AmpAssign 280
-#define TK_CaretAssign 281
-#define TK_BarAssign 282
-#define TK_DotDotDot 283
-#define TK_Whitespace 284
-#define TK_Comment 285
-
-int line = 1, col = 1;
-
-void token( int tok, char *data, int len )
-{
-	printf( "<%i> ", tok );
-	for ( int i = 0; i < len; i++ )
-		fputc( data[i], stdout );
-	fputc( '\n', stdout );
-
-	/* Count newlines and columns. This code is here mainly for having some
-	 * code in the token routine when commenting out the above output during
-	 * performance testing. */
-	for ( int i = 0; i < len; i ++ ) {
-		if ( data[i] == '\n' ) {
-			line += 1;
-			col = 1;
-		}
-		else {
-			col += 1;
-		}
-	}
-}
-
-
-%}
-
-%x COMMENT
-
-FRACT_CONST		[0-9]*\.[0-9]+|[0-9]+\.
-EXPONENT		[eE][+\-]?[0-9]+
-FLOAT_SUFFIX	[flFL]
-
-%%
-
-	/* Single and double literals. */
-L?\'([^\'\\\n]|\\.)*\' {
-	token( TK_Slit, yytext, yyleng );
-}
-
-L?\"([^\"\\\n]|\\.)*\" {
-	token( TK_Dlit, yytext, yyleng );
-}
-
-[a-zA-Z_][a-zA-Z0-9_]* {
-	token( TK_Id, yytext, yyleng );
-}
-
-{FRACT_CONST}{EXPONENT}?{FLOAT_SUFFIX}?|[0-9]+{EXPONENT}{FLOAT_SUFFIX}? {
-	token( TK_Float, yytext, yyleng );
-}
-
-(0|[1-9][0-9]*)[ulUL]{0,3} {
-	token( TK_IntegerDecimal, yytext, yyleng );
-}
-
-0[0-9]+[ulUL]{0,2} {
-	token( TK_IntegerOctal, yytext, yyleng );
-}
-
-0x[0-9a-fA-F]+[ulUL]{0,2} {
-	token( TK_IntegerHex, yytext, yyleng );
-}
-
-:: token( TK_NameSep, yytext, yyleng );
-== token( TK_EqualsEquals, yytext, yyleng );
-!= token( TK_NotEquals, yytext, yyleng );
-&& token( TK_AndAnd, yytext, yyleng );
-\|\| token( TK_OrOr, yytext, yyleng );
-\*= token( TK_MultAssign, yytext, yyleng );
-\/= token( TK_DivAssign, yytext, yyleng );
-%= token( TK_PercentAssign, yytext, yyleng );
-\+= token( TK_PlusAssign, yytext, yyleng );
--= token( TK_MinusAssign, yytext, yyleng );
-&= token( TK_AmpAssign, yytext, yyleng );
-^= token( TK_CaretAssign, yytext, yyleng );
-\|= token( TK_BarAssign, yytext, yyleng );
-\+\+ token( TK_PlusPlus, yytext, yyleng );
--- token( TK_MinusMinus, yytext, yyleng );
--> token( TK_Arrow, yytext, yyleng );
-->\* token( TK_ArrowStar, yytext, yyleng );
-\.\* token( TK_DotStar, yytext, yyleng );
-\.\.\. token( TK_DotDotDot, yytext, yyleng );
-
-\/\*				BEGIN(COMMENT);
-<COMMENT>\*\/		BEGIN(INITIAL);
-<COMMENT>(.|\n)		{ }
-
-\/\/.*\n			{}
-[^!-~]+				{}
-
-[!-/:-@\[-`{-~] token( yytext[0], yytext, yyleng );
-	
-%%
-
-int yywrap()
-{
-	/* Once the input is done, no more. */
-	return 1;
-}
-
-int main()
-{
-	yylex();
-}
diff --git a/examples/cppscan.rec b/examples/cppscan.rec
deleted file mode 100644
index 43f297d..0000000
--- a/examples/cppscan.rec
+++ /dev/null
@@ -1,183 +0,0 @@
-#include <stdio.h>
-#include <string.h>
-#include <stdlib.h>
-
-#define TK_Dlit 256
-#define TK_Slit 257
-#define TK_Float 258
-#define TK_Id 259
-#define TK_NameSep 260
-#define TK_Arrow 261
-#define TK_PlusPlus 262
-#define TK_MinusMinus 263
-#define TK_ArrowStar 264
-#define TK_DotStar 265
-#define TK_ShiftLeft 266
-#define TK_ShiftRight 267
-#define TK_IntegerDecimal 268
-#define TK_IntegerOctal 269
-#define TK_IntegerHex 270
-#define TK_EqualsEquals 271
-#define TK_NotEquals 272
-#define TK_AndAnd 273
-#define TK_OrOr 274
-#define TK_MultAssign 275
-#define TK_DivAssign 276
-#define TK_PercentAssign 277
-#define TK_PlusAssign 278
-#define TK_MinusAssign 279
-#define TK_AmpAssign 280
-#define TK_CaretAssign 281
-#define TK_BarAssign 282
-#define TK_DotDotDot 283
-#define TK_Whitespace 284
-#define TK_Comment 285
-
-int line = 1, col = 1;
-
-void token( int tok, char *data, int len )
-{
-	printf( "<%i> ", tok );
-	for ( int i = 0; i < len; i++ )
-		fputc( data[i], stdout );
-	fputc( '\n', stdout );
-
-	/* Count newlines and columns. This code is here mainly for having some
-	 * code in the token routine when commenting out the above output during
-	 * performance testing. */
-	for ( int i = 0; i < len; i ++ ) {
-		if ( data[i] == '\n' ) {
-			line += 1;
-			col = 1;
-		}
-		else {
-			col += 1;
-		}
-	}
-}
-
-#define BUFSIZE 8192
-char buf[BUFSIZE];
-
-void fill( int n )
-{
-	printf("fill(%i)\n", n);
-	exit(1);
-}
-
-int main()
-{
-	char *start, *p = buf, *lim = buf, *marker;
-	int len, have, want, shift;
-	int done = 0;
-	
-#define YYCTYPE         char
-
-#define YYCURSOR        p
-#define YYLIMIT         lim
-#define YYMARKER        marker
-
-#define YYFILL(n)      { \
-		if ( ! done ) { \
-			have = lim-start; \
-			if ( start > buf ) { \
-				shift = start-buf; \
-				memmove( buf, start, have ); \
-				start -= shift; \
-				p -= shift; \
-				lim -= shift; \
-				marker -= shift; \
-			} \
-			want = BUFSIZE - have - 1; \
-			len = fread( lim, 1, want, stdin ); \
-			lim += len; \
-			if ( len < want ) { \
-				*lim++ = 0; \
-				done = 1; \
-			} \
-		} \
-	}
-
-again:
-	start = p;
-
-/*!re2c
-
-ANY				= [\000-\377];
-FRACTCONST		= ( [0-9]* "." [0-9]+ ) | [0-9]+ ".";
-EXPONENT		= [eE] [+\-]? [0-9]+;
-FLOATSUFFIX		= [flFL];
-
-	"L"? "\'" ( ANY \ [\'\\\n] | "\\" ANY )* "\'" {
-		token( TK_Slit, start, p-start );
-		goto again;
-	}
-
-	"L"? "\"" ( ANY \ [\"\\\n] | "\\" ANY )* "\"" {
-		token( TK_Dlit, start, p-start );
-		goto again;
-	}
-
-	[a-zA-Z_][a-zA-Z0-9_]* {
-		token( TK_Id, start, p-start );
-		goto again;
-	}
-
-	( FRACTCONST EXPONENT? FLOATSUFFIX? ) | ( [0-9]+ EXPONENT FLOATSUFFIX? ) {
-		token( TK_Float, start, p-start );
-		goto again;
-	}
-
-
-	( "0" | [1-9][0-9]* ) [ulUL]* {
-		token( TK_IntegerDecimal, start, p-start );
-		goto again;
-	}
-
-	"0" [0-9]+ [ulUL]* {
-		token( TK_IntegerOctal, start, p-start );
-		goto again;
-	}
-
-	"0x" [0-9a-fA-F]+[ulUL]* {
-		token( TK_IntegerHex, start, p-start );
-		goto again;
-	}
-
-	"::"	{ token( TK_NameSep, start, p-start ); goto again; }
-	"=="	{ token( TK_EqualsEquals, start, p-start ); goto again; }
-	"!="	{ token( TK_NotEquals, start, p-start ); goto again; }
-	"&&"	{ token( TK_AndAnd, start, p-start ); goto again; }
-	"||"	{ token( TK_OrOr, start, p-start ); goto again; }
-	"*="	{ token( TK_MultAssign, start, p-start ); goto again; }
-	"/="	{ token( TK_DivAssign, start, p-start ); goto again; }
-	"%="	{ token( TK_PercentAssign, start, p-start ); goto again; }
-	"+="	{ token( TK_PlusAssign, start, p-start ); goto again; }
-	"-="	{ token( TK_MinusAssign, start, p-start ); goto again; }
-	"&="	{ token( TK_AmpAssign, start, p-start ); goto again; }
-	"^="	{ token( TK_CaretAssign, start, p-start ); goto again; }
-	"|="	{ token( TK_BarAssign, start, p-start ); goto again; }
-	"++"	{ token( TK_PlusPlus, start, p-start ); goto again; }
-	"--"	{ token( TK_MinusMinus, start, p-start ); goto again; }
-	"->"	{ token( TK_Arrow, start, p-start ); goto again; }
-	"->*"	{ token( TK_ArrowStar, start, p-start ); goto again; }
-	".*"	{ token( TK_DotStar, start, p-start ); goto again; }
-	"..."	{ token( TK_DotDotDot, start, p-start ); goto again; }
-
-	"/*" { goto comment; }
-	"//" (ANY\"\n")* "\n"	{ goto again; }
-	[\001-\040\177]+		{ goto again; }
-
-	[\041-\057\072-\100\133-\140\173-\176]	{
-		token( *start, start, p-start );
-		goto again;
-	}
-	"\000"					{ return 0; }
-*/
-
-comment:
-/*!re2c
-	"*/"					{ goto again; }
-	ANY						{ goto comment; }
-*/
-}
diff --git a/examples/lex-cppscan.l b/examples/lex-cppscan.l
new file mode 100644
index 0000000..fb66253
--- /dev/null
+++ b/examples/lex-cppscan.l
@@ -0,0 +1,143 @@
+/*
+ * flex equivalent to cppscan.rl
+ */
+
+%{
+
+#include <stdio.h>
+
+#define TK_Dlit 256
+#define TK_Slit 257
+#define TK_Float 258
+#define TK_Id 259
+#define TK_NameSep 260
+#define TK_Arrow 261
+#define TK_PlusPlus 262
+#define TK_MinusMinus 263
+#define TK_ArrowStar 264
+#define TK_DotStar 265
+#define TK_ShiftLeft 266
+#define TK_ShiftRight 267
+#define TK_IntegerDecimal 268
+#define TK_IntegerOctal 269
+#define TK_IntegerHex 270
+#define TK_EqualsEquals 271
+#define TK_NotEquals 272
+#define TK_AndAnd 273
+#define TK_OrOr 274
+#define TK_MultAssign 275
+#define TK_DivAssign 276
+#define TK_PercentAssign 277
+#define TK_PlusAssign 278
+#define TK_MinusAssign 279
+#define TK_AmpAssign 280
+#define TK_CaretAssign 281
+#define TK_BarAssign 282
+#define TK_DotDotDot 283
+#define TK_Whitespace 284
+#define TK_Comment 285
+
+int line = 1, col = 1;
+
+void token( int tok, char *data, int len )
+{
+	printf( "<%i> ", tok );
+	for ( int i = 0; i < len; i++ )
+		fputc( data[i], stdout );
+	fputc( '\n', stdout );
+
+	/* Count newlines and columns. This code is here mainly for having some
+	 * code in the token routine when commenting out the above output during
+	 * performance testing. */
+	for ( int i = 0; i < len; i ++ ) {
+		if ( data[i] == '\n' ) {
+			line += 1;
+			col = 1;
+		}
+		else {
+			col += 1;
+		}
+	}
+}
+
+
+%}
+
+%x COMMENT
+
+FRACT_CONST		[0-9]*\.[0-9]+|[0-9]+\.
+EXPONENT		[eE][+\-]?[0-9]+
+FLOAT_SUFFIX	[flFL]
+
+%%
+
+	/* Single and double literals. */
+L?\'([^\'\\\n]|\\.)*\' {
+	token( TK_Slit, yytext, yyleng );
+}
+
+L?\"([^\"\\\n]|\\.)*\" {
+	token( TK_Dlit, yytext, yyleng );
+}
+
+[a-zA-Z_][a-zA-Z0-9_]* {
+	token( TK_Id, yytext, yyleng );
+}
+
+{FRACT_CONST}{EXPONENT}?{FLOAT_SUFFIX}?|[0-9]+{EXPONENT}{FLOAT_SUFFIX}? {
+	token( TK_Float, yytext, yyleng );
+}
+
+(0|[1-9][0-9]*)[ulUL]{0,3} {
+	token( TK_IntegerDecimal, yytext, yyleng );
+}
+
+0[0-9]+[ulUL]{0,2} {
+	token( TK_IntegerOctal, yytext, yyleng );
+}
+
+0x[0-9a-fA-F]+[ulUL]{0,2} {
+	token( TK_IntegerHex, yytext, yyleng );
+}
+
+:: token( TK_NameSep, yytext, yyleng );
+== token( TK_EqualsEquals, yytext, yyleng );
+!= token( TK_NotEquals, yytext, yyleng );
+&& token( TK_AndAnd, yytext, yyleng );
+\|\| token( TK_OrOr, yytext, yyleng );
+\*= token( TK_MultAssign, yytext, yyleng );
+\/= token( TK_DivAssign, yytext, yyleng );
+%= token( TK_PercentAssign, yytext, yyleng );
+\+= token( TK_PlusAssign, yytext, yyleng );
+-= token( TK_MinusAssign, yytext, yyleng );
+&= token( TK_AmpAssign, yytext, yyleng );
+^= token( TK_CaretAssign, yytext, yyleng );
+\|= token( TK_BarAssign, yytext, yyleng );
+\+\+ token( TK_PlusPlus, yytext, yyleng );
+-- token( TK_MinusMinus, yytext, yyleng );
+-> token( TK_Arrow, yytext, yyleng );
+->\* token( TK_ArrowStar, yytext, yyleng );
+\.\* token( TK_DotStar, yytext, yyleng );
+\.\.\. token( TK_DotDotDot, yytext, yyleng );
+
+\/\*				BEGIN(COMMENT);
+<COMMENT>\*\/		BEGIN(INITIAL);
+<COMMENT>(.|\n)		{ }
+
+\/\/.*\n			{}
+[^!-~]+				{}
+
+[!-/:-@\[-`{-~] token( yytext[0], yytext, yyleng );
+	
+%%
+
+int yywrap()
+{
+	/* Once the input is done, no more. */
+	return 1;
+}
+
+int main()
+{
+	yylex();
+}
diff --git a/examples/re2c-cppscan.rec b/examples/re2c-cppscan.rec
new file mode 100644
index 0000000..43f297d
--- /dev/null
+++ b/examples/re2c-cppscan.rec
@@ -0,0 +1,183 @@
+#include <stdio.h>
+#include <string.h>
+#include <stdlib.h>
+
+#define TK_Dlit 256
+#define TK_Slit 257
+#define TK_Float 258
+#define TK_Id 259
+#define TK_NameSep 260
+#define TK_Arrow 261
+#define TK_PlusPlus 262
+#define TK_MinusMinus 263
+#define TK_ArrowStar 264
+#define TK_DotStar 265
+#define TK_ShiftLeft 266
+#define TK_ShiftRight 267
+#define TK_IntegerDecimal 268
+#define TK_IntegerOctal 269
+#define TK_IntegerHex 270
+#define TK_EqualsEquals 271
+#define TK_NotEquals 272
+#define TK_AndAnd 273
+#define TK_OrOr 274
+#define TK_MultAssign 275
+#define TK_DivAssign 276
+#define TK_PercentAssign 277
+#define TK_PlusAssign 278
+#define TK_MinusAssign 279
+#define TK_AmpAssign 280
+#define TK_CaretAssign 281
+#define TK_BarAssign 282
+#define TK_DotDotDot 283
+#define TK_Whitespace 284
+#define TK_Comment 285
+
+int line = 1, col = 1;
+
+void token( int tok, char *data, int len )
+{
+	printf( "<%i> ", tok );
+	for ( int i = 0; i < len; i++ )
+		fputc( data[i], stdout );
+	fputc( '\n', stdout );
+
+	/* Count newlines and columns. This code is here mainly for having some
+	 * code in the token routine when commenting out the above output during
+	 * performance testing. */
+	for ( int i = 0; i < len; i ++ ) {
+		if ( data[i] == '\n' ) {
+			line += 1;
+			col = 1;
+		}
+		else {
+			col += 1;
+		}
+	}
+}
+
+#define BUFSIZE 8192
+char buf[BUFSIZE];
+
+void fill( int n )
+{
+	printf("fill(%i)\n", n);
+	exit(1);
+}
+
+int main()
+{
+	char *start, *p = buf, *lim = buf, *marker;
+	int len, have, want, shift;
+	int done = 0;
+	
+#define YYCTYPE         char
+
+#define YYCURSOR        p
+#define YYLIMIT         lim
+#define YYMARKER        marker
+
+#define YYFILL(n)      { \
+		if ( ! done ) { \
+			have = lim-start; \
+			if ( start > buf ) { \
+				shift = start-buf; \
+				memmove( buf, start, have ); \
+				start -= shift; \
+				p -= shift; \
+				lim -= shift; \
+				marker -= shift; \
+			} \
+			want = BUFSIZE - have - 1; \
+			len = fread( lim, 1, want, stdin ); \
+			lim += len; \
+			if ( len < want ) { \
+				*lim++ = 0; \
+				done = 1; \
+			} \
+		} \
+	}
+
+again:
+	start = p;
+
+/*!re2c
+
+ANY				= [\000-\377];
+FRACTCONST		= ( [0-9]* "." [0-9]+ ) | [0-9]+ ".";
+EXPONENT		= [eE] [+\-]? [0-9]+;
+FLOATSUFFIX		= [flFL];
+
+	"L"? "\'" ( ANY \ [\'\\\n] | "\\" ANY )* "\'" {
+		token( TK_Slit, start, p-start );
+		goto again;
+	}
+
+	"L"? "\"" ( ANY \ [\"\\\n] | "\\" ANY )* "\"" {
+		token( TK_Dlit, start, p-start );
+		goto again;
+	}
+
+	[a-zA-Z_][a-zA-Z0-9_]* {
+		token( TK_Id, start, p-start );
+		goto again;
+	}
+
+	( FRACTCONST EXPONENT? FLOATSUFFIX? ) | ( [0-9]+ EXPONENT FLOATSUFFIX? ) {
+		token( TK_Float, start, p-start );
+		goto again;
+	}
+
+
+	( "0" | [1-9][0-9]* ) [ulUL]* {
+		token( TK_IntegerDecimal, start, p-start );
+		goto again;
+	}
+
+	"0" [0-9]+ [ulUL]* {
+		token( TK_IntegerOctal, start, p-start );
+		goto again;
+	}
+
+	"0x" [0-9a-fA-F]+[ulUL]* {
+		token( TK_IntegerHex, start, p-start );
+		goto again;
+	}
+
+	"::"	{ token( TK_NameSep, start, p-start ); goto again; }
+	"=="	{ token( TK_EqualsEquals, start, p-start ); goto again; }
+	"!="	{ token( TK_NotEquals, start, p-start ); goto again; }
+	"&&"	{ token( TK_AndAnd, start, p-start ); goto again; }
+	"||"	{ token( TK_OrOr, start, p-start ); goto again; }
+	"*="	{ token( TK_MultAssign, start, p-start ); goto again; }
+	"/="	{ token( TK_DivAssign, start, p-start ); goto again; }
+	"%="	{ token( TK_PercentAssign, start, p-start ); goto again; }
+	"+="	{ token( TK_PlusAssign, start, p-start ); goto again; }
+	"-="	{ token( TK_MinusAssign, start, p-start ); goto again; }
+	"&="	{ token( TK_AmpAssign, start, p-start ); goto again; }
+	"^="	{ token( TK_CaretAssign, start, p-start ); goto again; }
+	"|="	{ token( TK_BarAssign, start, p-start ); goto again; }
+	"++"	{ token( TK_PlusPlus, start, p-start ); goto again; }
+	"--"	{ token( TK_MinusMinus, start, p-start ); goto again; }
+	"->"	{ token( TK_Arrow, start, p-start ); goto again; }
+	"->*"	{ token( TK_ArrowStar, start, p-start ); goto again; }
+	".*"	{ token( TK_DotStar, start, p-start ); goto again; }
+	"..."	{ token( TK_DotDotDot, start, p-start ); goto again; }
+
+	"/*" { goto comment; }
+	"//" (ANY\"\n")* "\n"	{ goto again; }
+	[\001-\040\177]+		{ goto again; }
+
+	[\041-\057\072-\100\133-\140\173-\176]	{
+		token( *start, start, p-start );
+		goto again;
+	}
+	"\000"					{ return 0; }
+*/
+
+comment:
+/*!re2c
+	"*/"					{ goto again; }
+	ANY						{ goto comment; }
+*/
+}
diff --git a/ragel/Makefile.am b/ragel/Makefile.am
new file mode 100644
index 0000000..bbe85ce
--- /dev/null
+++ b/ragel/Makefile.am
@@ -0,0 +1,38 @@
+INCLUDES = -I$(top_srcdir)/common -I$(top_srcdir)/redfsm -I$(top_builddir)/redfsm -I$(top_srcdir)/aapl
+
+AM_CXXFLAGS = -g -Wall
+
+BUILT_SOURCES = rlscan.cpp rlparse.h rlparse.cpp
+EXTRA_DIST = $(BUILT_SOURCES) rlscan.rl rlparse.kl rlparse.kh
+
+bin_PROGRAMS = ragel
+
+ragel_SOURCES = ragel.h main.cpp parsetree.h parsetree.cpp parsedata.h	\
+	parsedata.cpp fsmstate.cpp fsmbase.cpp fsmattach.cpp		\
+	fsmmin.cpp fsmgraph.h fsmgraph.cpp fsmap.cpp xmlcodegen.h	\
+	xmlcodegen.cpp rlscan.h $(BUILT_SOURCES)
+
+ragel_LDADD = ../common/libcommon.a \
+	../redfsm/libredfsm.a \
+	../rlgen-cd/librlgen-cd.a \
+	../rlgen-java/librlgen-java.a \
+	../rlgen-ruby/librlgen-ruby.a \
+	../rlgen-csharp/librlgen-csharp.a \
+	../rlgen-dot/librlgen-dot.a
+
+if BUILD_PARSERS
+rlparse.h: rlparse.kh
+	kelbt -o $@ $<
+
+rlparse.cpp: rlparse.kl rlparse.kh
+	(cd "${srcdir}"; kelbt -o "${abs_builddir}"/$@ "${abs_builddir}"/$<; )
+
+# This dependency comes from the import of the parser defines
+# into the scanner.
+rlscan.cpp: rlparse.h
+
+rlscan.cpp: rlscan.rl
+	ragel -G2 -I. -o $@ $<
+
+CLEANFILES = $(BUILT_SOURCES)
+endif
diff --git a/ragel/Makefile.in b/ragel/Makefile.in
deleted file mode 100644
index 2a6b5da..0000000
--- a/ragel/Makefile.in
+++ /dev/null
@@ -1,101 +0,0 @@
-#
-#   Copyright 2001-2007 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-INCS += -I../common -I../aapl -I../redfsm
-DEFS +=
-
-CXXFLAGS += -g -Wall
-LDFLAGS +=
-
-CC_SRCS = \
-	main.cpp parsetree.cpp parsedata.cpp fsmstate.cpp fsmbase.cpp \
-	fsmattach.cpp fsmmin.cpp fsmgraph.cpp fsmap.cpp xmlcodegen.cpp \
-	rlscan.cpp rlparse.cpp
-
-GEN_SRC = rlscan.cpp rlparse.h rlparse.cpp
-
-RAGEL_LIBS = ../common/common.a \
-	../redfsm/redfsm.a \
-	../rlgen-cd/rlgen-cd.a \
-	../rlgen-java/rlgen-java.a \
-	../rlgen-ruby/rlgen-ruby.a \
-	../rlgen-csharp/rlgen-csharp.a \
-	../rlgen-dot/rlgen-dot.a
-
-LIBS = $(RAGEL_LIBS)
-MINGW_LIBS = -lpsapi
-
-#*************************************
-
-prefix = @prefix@
-BUILD_PARSERS = @enable_parsers@
-EXEEXT = @EXEEXT@
-CXX = @CXX@
-
-ifeq ($(EXEEXT), .exe)
-LIBS += $(MINGW_LIBS)
-endif
-
-# Get objects and dependencies from sources.
-OBJS = $(CC_SRCS:%.cpp=%.o)
-DEPS = $(CC_SRCS:%.cpp=.%.d)
-
-# Rules.
-all: ragel$(EXEEXT)
-
-ragel$(EXEEXT): $(GEN_SRC) $(OBJS) $(RAGEL_LIBS)
-	$(CXX) $(LDFLAGS) -o $@ $(OBJS) $(LIBS)
-
-ifeq ($(BUILD_PARSERS),yes)
-
-rlparse.h: rlparse.kh
-	kelbt -o $@ $<
-
-rlparse.cpp: rlparse.kl rlparse.kh
-	kelbt -o $@ $<
-
-# This dependency comes from the import of the parser defines
-# into the scanner.
-rlscan.cpp: rlparse.h
-
-rlscan.cpp: rlscan.rl
-	ragel -G2 -o $@ $<
-
-endif
-
-%.o: %.cpp
-	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
-
-distclean: clean
-	rm -f Makefile 
-
-ifeq ($(BUILD_PARSERS),yes)
-EXTRA_CLEAN = $(GEN_SRC)
-endif
-
-clean:
-	rm -f tags .*.d *.o ragel $(EXTRA_CLEAN)
-
-install: all
-	install -d $(DESTDIR)$(prefix)/bin
-	install ragel $(DESTDIR)$(prefix)/bin/ragel
-
--include $(DEPS)
diff --git a/redfsm/Makefile.am b/redfsm/Makefile.am
new file mode 100644
index 0000000..ae625d9
--- /dev/null
+++ b/redfsm/Makefile.am
@@ -0,0 +1,29 @@
+INCLUDES = -I$(top_srcdir)/common -I$(top_srcdir)/aapl
+
+AM_CXXFLAGS = -g -Wall
+
+noinst_LIBRARIES = libredfsm.a
+
+BUILT_SOURCES = xmltags.cpp xmlscan.cpp xmlparse.cpp xmlparse.h
+EXTRA_DIST = $(BUILT_SOURCES) xmltags.gperf xmlscan.rl xmlparse.kl	\
+	xmlparse.kh
+
+libredfsm_a_SOURCES = redfsm.h redfsm.cpp gendata.h gendata.cpp	\
+	xmltags.cpp xmlscan.cpp xmlparse.cpp $(BUILT_SOURCES)
+
+if BUILD_PARSERS
+xmlparse.h: xmlparse.kh
+	kelbt -o $@ $<
+
+xmlparse.cpp: xmlparse.kl xmlparse.kh
+	(cd "${srcdir}"; kelbt -o "${abs_builddir}"/$@ "${abs_builddir}"/$<; )
+
+xmlscan.cpp: xmlscan.rl
+	ragel -G2 -o $@ $<
+
+xmltags.cpp: xmltags.gperf
+	gperf -L C++ -t $< > $@
+
+
+CLEANFILES = $(BUILT_SOURCES)
+endif
diff --git a/redfsm/Makefile.in b/redfsm/Makefile.in
deleted file mode 100644
index 8e67233..0000000
--- a/redfsm/Makefile.in
+++ /dev/null
@@ -1,85 +0,0 @@
-#
-#   Copyright 2001-2006 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-INCS += -I../common -I../aapl
-DEFS +=
-
-CXXFLAGS += -g -Wall
-LDFLAGS +=
-
-CC_SRCS = redfsm.cpp gendata.cpp xmltags.cpp xmlscan.cpp xmlparse.cpp
-
-GEN_SRC = xmltags.cpp xmlscan.cpp xmlparse.cpp xmlparse.h
-
-BUILD_PARSERS = @enable_parsers@
-
-#*************************************
-
-# Programs
-CXX = @CXX@
-AR = @AR@
-RANLIB = @RANLIB@
-
-# Get objects and dependencies from sources.
-OBJS = $(CC_SRCS:%.cpp=%.o)
-DEPS = $(CC_SRCS:%.cpp=.%.d)
-
-
-# Rules.
-all: redfsm.a
-
-redfsm.a: $(GEN_SRC) $(OBJS)
-	$(AR) -cr $@ $(OBJS) 
-	$(RANLIB) $@
-
-ifeq ($(BUILD_PARSERS),true)
-
-xmlparse.h: xmlparse.kh
-	kelbt -o $@ $<
-
-xmlparse.cpp: xmlparse.kl xmlparse.kh
-	kelbt -o $@ $<
-
-xmlscan.cpp: xmlscan.rl
-	ragel -G2 -o xmlscan.cpp xmlscan.rl
-
-xmltags.cpp: xmltags.gperf
-	gperf -L C++ -t $< > $@
-
-endif
-
-%.o: %.cpp
-	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
-
-distclean: clean
-	rm -f Makefile
-
-ifeq ($(BUILD_PARSERS),true)
-EXTRA_CLEAN = $(GEN_SRC)
-endif
-
-clean:
-	rm -f tags .*.d *.o rlgen-cd $(EXTRA_CLEAN)
-
-install:
-	@true
-
--include $(DEPS)
diff --git a/rlgen-cd/Makefile.am b/rlgen-cd/Makefile.am
new file mode 100644
index 0000000..cd5e46f
--- /dev/null
+++ b/rlgen-cd/Makefile.am
@@ -0,0 +1,12 @@
+INCLUDES = -I$(top_srcdir)/common -I$(top_srcdir)/redfsm -I$(top_builddir)/redfsm -I$(top_srcdir)/aapl
+
+AM_CXXFLAGS = -g -Wall
+
+noinst_LIBRARIES = librlgen-cd.a
+
+librlgen_cd_a_SOURCES = rlgen-cd.h main.cpp fsmcodegen.h		\
+	fsmcodegen.cpp tabcodegen.h tabcodegen.cpp ftabcodegen.h	\
+	ftabcodegen.cpp flatcodegen.h flatcodegen.cpp fflatcodegen.h	\
+	fflatcodegen.cpp gotocodegen.h gotocodegen.cpp fgotocodegen.h	\
+	fgotocodegen.cpp ipgotocodegen.h ipgotocodegen.cpp		\
+	splitcodegen.h splitcodegen.cpp
diff --git a/rlgen-cd/Makefile.in b/rlgen-cd/Makefile.in
deleted file mode 100644
index 7b06285..0000000
--- a/rlgen-cd/Makefile.in
+++ /dev/null
@@ -1,69 +0,0 @@
-#
-#   Copyright 2001-2006 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-INCS += -I../common -I../redfsm -I../aapl
-DEFS +=
-
-CXXFLAGS += -g -Wall
-LDFLAGS +=
-
-CC_SRCS = main.cpp fsmcodegen.cpp \
-	tabcodegen.cpp ftabcodegen.cpp flatcodegen.cpp \
-	fflatcodegen.cpp gotocodegen.cpp fgotocodegen.cpp \
-	ipgotocodegen.cpp splitcodegen.cpp 
-
-GEN_SRC = xmltags.cpp xmlscan.cpp xmlparse.cpp xmlparse.h
-
-LIBS = ../common/common.a ../redfsm/redfsm.a
-
-#*************************************
-
-prefix = @prefix@
-EXEEXT = @EXEEXT@
-CXX = @CXX@
-AR = @AR@
-RANLIB = @RANLIB@
-
-# Get objects and dependencies from sources.
-OBJS = $(CC_SRCS:%.cpp=%.o)
-DEPS = $(CC_SRCS:%.cpp=.%.d)
-
-
-# Rules.
-all: rlgen-cd.a
-
-rlgen-cd.a: $(LIBS) $(OBJS)
-	$(AR) -cr $@ $(OBJS) 
-	$(RANLIB) $@
-
-%.o: %.cpp
-	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
-
-distclean: clean
-	rm -f Makefile
-
-clean:
-	rm -f tags .*.d *.o rlgen-cd.a $(EXTRA_CLEAN)
-
-install:
-	@true
-
--include $(DEPS)
diff --git a/rlgen-csharp/Makefile.am b/rlgen-csharp/Makefile.am
new file mode 100644
index 0000000..ebdf08c
--- /dev/null
+++ b/rlgen-csharp/Makefile.am
@@ -0,0 +1,12 @@
+INCLUDES = -I$(top_srcdir)/common -I$(top_srcdir)/redfsm -I$(top_builddir)/redfsm -I$(top_srcdir)/aapl
+
+AM_CXXFLAGS = -g -Wall
+
+noinst_LIBRARIES = librlgen-csharp.a
+
+librlgen_csharp_a_SOURCES = rlgen-csharp.h main.cpp fsmcodegen.h	\
+	fsmcodegen.cpp tabcodegen.h tabcodegen.cpp ftabcodegen.h	\
+	ftabcodegen.cpp flatcodegen.h flatcodegen.cpp fflatcodegen.h	\
+	fflatcodegen.cpp gotocodegen.h gotocodegen.cpp fgotocodegen.h	\
+	fgotocodegen.cpp ipgotocodegen.h ipgotocodegen.cpp		\
+	splitcodegen.h splitcodegen.cpp
diff --git a/rlgen-csharp/Makefile.in b/rlgen-csharp/Makefile.in
deleted file mode 100644
index fc5380f..0000000
--- a/rlgen-csharp/Makefile.in
+++ /dev/null
@@ -1,69 +0,0 @@
-#
-#   Copyright 2001-2006 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-INCS += -I../common -I../redfsm -I../aapl
-DEFS +=
-
-CXXFLAGS += -g -Wall
-LDFLAGS +=
-
-CC_SRCS = main.cpp fsmcodegen.cpp \
-	tabcodegen.cpp ftabcodegen.cpp flatcodegen.cpp \
-	fflatcodegen.cpp gotocodegen.cpp fgotocodegen.cpp \
-	ipgotocodegen.cpp splitcodegen.cpp 
-
-GEN_SRC = xmltags.cpp xmlscan.cpp xmlparse.cpp xmlparse.h
-
-LIBS = ../common/common.a ../redfsm/redfsm.a
-
-#*************************************
-
-prefix = @prefix@
-EXEEXT = @EXEEXT@
-CXX = @CXX@
-AR = @AR@
-RANLIB = @RANLIB@
-
-# Get objects and dependencies from sources.
-OBJS = $(CC_SRCS:%.cpp=%.o)
-DEPS = $(CC_SRCS:%.cpp=.%.d)
-
-
-# Rules.
-all: rlgen-csharp.a
-
-rlgen-csharp.a: $(LIBS) $(OBJS)
-	$(AR) -cr $@ $(OBJS) 
-	$(RANLIB) $@
-
-%.o: %.cpp
-	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
-
-distclean: clean
-	rm -f Makefile
-
-clean:
-	rm -f tags .*.d *.o rlgen-csharp.a $(EXTRA_CLEAN)
-
-install:
-	@true
-
--include $(DEPS)
diff --git a/rlgen-dot/Makefile.am b/rlgen-dot/Makefile.am
new file mode 100644
index 0000000..025d6f3
--- /dev/null
+++ b/rlgen-dot/Makefile.am
@@ -0,0 +1,7 @@
+INCLUDES = -I$(top_srcdir)/common -I$(top_srcdir)/redfsm -I$(top_builddir)/redfsm -I$(top_srcdir)/aapl
+
+AM_CXXFLAGS = -g -Wall
+
+noinst_LIBRARIES = librlgen-dot.a
+
+librlgen_dot_a_SOURCES = rlgen-dot.h main.cpp gvdotgen.h gvdotgen.cpp
diff --git a/rlgen-dot/Makefile.in b/rlgen-dot/Makefile.in
deleted file mode 100644
index c5611c2..0000000
--- a/rlgen-dot/Makefile.in
+++ /dev/null
@@ -1,66 +0,0 @@
-#
-#   Copyright 2001-2007 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-INCS += -I../common -I../redfsm -I../aapl
-DEFS +=
-
-CXXFLAGS += -g -Wall
-LDFLAGS +=
-
-CC_SRCS = main.cpp gvdotgen.cpp 
-
-LIBS = ../common/common.a ../redfsm/redfsm.a
-
-
-#*************************************
-
-prefix = @prefix@
-EXEEXT = @EXEEXT@
-CXX = @CXX@
-AR = @AR@
-RANLIB = @RANLIB@
-
-# Get objects and dependencies from sources.
-OBJS = $(CC_SRCS:%.cpp=%.o)
-DEPS = $(CC_SRCS:%.cpp=.%.d)
-
-
-# Rules.
-all: rlgen-dot.a
-
-rlgen-dot.a: $(LIBS) $(OBJS)
-	$(AR) -cr $@ $(OBJS) 
-	$(RANLIB) $@
-
-%.o: %.cpp
-	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
-
-distclean: clean
-	rm -f Makefile
-
-clean:
-	rm -f tags .*.d *.o rlgen-dot $(EXTRA_CLEAN)
-
-install: all
-	install -d $(DESTDIR)$(prefix)/bin
-	install rlgen-dot $(DESTDIR)$(prefix)/bin/rlgen-dot
-
--include $(DEPS)
diff --git a/rlgen-java/Makefile.am b/rlgen-java/Makefile.am
new file mode 100644
index 0000000..c15b720
--- /dev/null
+++ b/rlgen-java/Makefile.am
@@ -0,0 +1,8 @@
+INCLUDES = -I$(top_srcdir)/common -I$(top_srcdir)/redfsm -I$(top_builddir)/redfsm -I$(top_srcdir)/aapl
+
+AM_CXXFLAGS = -g -Wall
+
+noinst_LIBRARIES = librlgen-java.a
+
+librlgen_java_a_SOURCES = rlgen-java.h main.cpp javacodegen.h	\
+	javacodegen.cpp
diff --git a/rlgen-java/Makefile.in b/rlgen-java/Makefile.in
deleted file mode 100644
index c429dde..0000000
--- a/rlgen-java/Makefile.in
+++ /dev/null
@@ -1,66 +0,0 @@
-#
-#   Copyright 2007 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-INCS += -I../common -I../redfsm -I../aapl
-DEFS +=
-
-CXXFLAGS += -g -Wall
-LDFLAGS +=
-
-CC_SRCS = main.cpp javacodegen.cpp
-
-LIBS = ../common/common.a ../redfsm/redfsm.a
-
-LIBS += @LIBS@
-
-#*************************************
-
-prefix = @prefix@
-EXEEXT = @EXEEXT@
-CXX = @CXX@
-AR = @AR@
-RANLIB = @RANLIB@
-
-# Get objects and dependencies from sources.
-OBJS = $(CC_SRCS:%.cpp=%.o)
-DEPS = $(CC_SRCS:%.cpp=.%.d)
-
-
-# Rules.
-all: rlgen-java.a
-
-rlgen-java.a: $(LIBS) $(OBJS)
-	$(AR) -cr $@ $(OBJS) 
-	$(RANLIB) $@
-
-%.o: %.cpp
-	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
-
-distclean: clean
-	rm -f Makefile
-
-clean:
-	rm -f tags .*.d *.o rlgen-java.a
-
-install: all
-	@true
-
--include $(DEPS)
diff --git a/rlgen-ruby/Makefile.am b/rlgen-ruby/Makefile.am
new file mode 100644
index 0000000..a64f2c6
--- /dev/null
+++ b/rlgen-ruby/Makefile.am
@@ -0,0 +1,11 @@
+INCLUDES = -I$(top_srcdir)/common -I$(top_srcdir)/redfsm -I$(top_builddir)/redfsm -I$(top_srcdir)/aapl
+
+AM_CXXFLAGS = -g -Wall
+
+noinst_LIBRARIES = librlgen-ruby.a
+
+librlgen_ruby_a_SOURCES = rlgen-ruby.h main.cpp ruby-codegen.h		\
+	ruby-codegen.cpp ruby-tabcodegen.h ruby-tabcodegen.cpp		\
+	ruby-ftabcodegen.h ruby-ftabcodegen.cpp ruby-flatcodegen.h	\
+	ruby-flatcodegen.cpp ruby-fflatcodegen.h ruby-fflatcodegen.cpp	\
+	rbx-gotocodegen.h rbx-gotocodegen.cpp
diff --git a/rlgen-ruby/Makefile.in b/rlgen-ruby/Makefile.in
deleted file mode 100644
index 96d5399..0000000
--- a/rlgen-ruby/Makefile.in
+++ /dev/null
@@ -1,67 +0,0 @@
-#
-#   Copyright 2007 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-INCS += -I../common -I../redfsm -I../aapl
-DEFS +=
-
-CXXFLAGS += -g -Wall
-LDFLAGS +=
-
-CC_SRCS = main.cpp ruby-codegen.cpp ruby-tabcodegen.cpp ruby-ftabcodegen.cpp \
-	ruby-flatcodegen.cpp ruby-fflatcodegen.cpp rbx-gotocodegen.cpp
-
-LIBS = ../common/common.a ../redfsm/redfsm.a
-
-LIBS += @LIBS@
-
-#*************************************
-
-prefix = @prefix@
-EXEEXT = @EXEEXT@
-CXX = @CXX@
-AR = @AR@
-RANLIB = @RANLIB@
-
-# Get objects and dependencies from sources.
-OBJS = $(CC_SRCS:%.cpp=%.o)
-DEPS = $(CC_SRCS:%.cpp=.%.d)
-
-
-# Rules.
-all: rlgen-ruby.a
-
-rlgen-ruby.a: $(LIBS) $(OBJS)
-	$(AR) -cr $@ $(OBJS) 
-	$(RANLIB) $@
-
-%.o: %.cpp
-	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
-
-distclean: clean
-	rm -f Makefile
-
-clean:
-	rm -f tags .*.d *.o rlgen-ruby.a
-
-install:
-	@true
-
--include $(DEPS)
diff --git a/test/Makefile.am b/test/Makefile.am
new file mode 100644
index 0000000..7689bf7
--- /dev/null
+++ b/test/Makefile.am
@@ -0,0 +1,23 @@
+#TESTS = runtests
+
+EXTRA_DIST = atoi1.rl cppscan1.rl export2.rl langtrans_c.txl		\
+	repetition.rl atoi2.rl cppscan2.rl export3.rl langtrans_d.sh	\
+	rlscan.rl atoi3.rl cppscan3.rl export4.rl langtrans_d.txl	\
+	ruby1.rl awkemu.rl cppscan4.rl fnext1.rl langtrans_java.sh	\
+	builtin.rl cppscan5.rl forder1.rl langtrans_java.txl scan1.rl	\
+	call1.rl cppscan6.rl forder2.rl langtrans_ruby.sh scan2.rl	\
+	call2.rl element1.rl forder3.rl langtrans_ruby.txl scan3.rl	\
+	call3.rl element2.rl gotocallret1.rl lmgoto.rl scan4.rl		\
+	checkeofact.txl element3.rl gotocallret2.rl mailbox1.h		\
+	stateact1.rl clang1.rl eofact.h high1.rl mailbox1.rl		\
+	statechart1.rl clang2.rl eofact.rl high2.rl mailbox2.rl		\
+	strings1.rl clang3.rl erract1.rl high3.rl mailbox3.rl		\
+	strings2.h clang4.rl erract2.rl import1.rl strings2.rl		\
+	cond1.rl erract3.rl include1.rl testcase.txl cond2.rl		\
+	erract4.rl include2.rl minimize1.rl tokstart1.rl cond3.rl	\
+	erract5.rl java1.rl patact.rl union.rl cond4.rl erract6.rl	\
+	java2.rl range.rl xmlcommon.rl cond5.rl erract7.rl keller1.rl	\
+	README xml.rl cond6.rl erract8.rl langtrans_c.sh		\
+	recdescent1.rl cond7.rl erract9.rl langtrans_csharp.sh		\
+	recdescent2.rl cppscan1.h export1.rl langtrans_csharp.txl	\
+	recdescent3.rl
\ No newline at end of file
diff --git a/test/Makefile.in b/test/Makefile.in
deleted file mode 100644
index fe49856..0000000
--- a/test/Makefile.in
+++ /dev/null
@@ -1,30 +0,0 @@
-#
-#   Copyright 2002-2006 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-
-test:
-	@./runtests
-
-clean:
-	rm -f *.c *.cpp *.m *.d *.java *.bin *.class *.exp \
-		*.out *_c.rl *_d.rl *_java.rl *_ruby.rl *_csharp.rl *.cs *.exe
-
-distclean: clean
-	rm -f Makefile


From flamee... at gmail.com  Wed Oct  1 15:06:14 2008
From: flamee... at gmail.com (Diego 'Flameeyes' =?utf-8?q?Petten=C3=B2?=)
Date: Wed, 01 Oct 2008 17:06:14 +0200
Subject: [PATCH] Make the configure.in look more like an autoconf script.
Message-ID: <20081001150614.23241.87348.stgit@yamato>


---

 configure.in |   61 +++++++++++++++++++++++++++++-----------------------------
 1 files changed, 31 insertions(+), 30 deletions(-)

diff --git a/configure.in b/configure.in
index 0b9fa44..df70e9c 100644
--- a/configure.in
+++ b/configure.in
@@ -18,7 +18,8 @@ dnl   You should have received a copy of the GNU General Public License
 dnl   along with Ragel; if not, write to the Free Software
 dnl   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 
-AC_INIT(ragel/main.cpp, 6.3)
+AC_PREREQ([2.60])
+AC_INIT(ragel, 6.3)
 AC_CONFIG_HEADER(common/config.h)
 
 AM_INIT_AUTOMAKE([1.10 foreign])
@@ -46,36 +47,16 @@ AC_LANG_CPLUSPLUS
 dnl Check for definition of MAKE.
 AC_PROG_MAKE_SET
 
-if test $enable_parsers = yes; then
+AS_IF([test "x$enable_parsres" = "xyes"], [
+  AC_CHECK_PROG(RAGEL, ragel, ragel)
+  AS_IF([test -z "$RAGEL"], [AC_MSG_ERROR([ragel is required to build the parsers])])
 
-dnl Check for Ragel
-AC_CHECK_PROG(RAGEL, ragel, ragel)
-if test -z "$RAGEL"; then
-	echo
-	echo "error: ragel is required to build the parsers"
-	echo
-	exit 1
-fi
-
-dnl Check for gperf
-AC_CHECK_PROG(GPERF, gperf, gperf)
-if test -z "$GPERF"; then
-	echo
-	echo "error: gperf is required to build the parsers"
-	echo
-	exit 1
-fi
-
-dnl Check for Kelbt
-AC_CHECK_PROG(KELBT, kelbt, kelbt)
-if test -z "$KELBT"; then
-	echo
-	echo "error: kelbt is required to build the parsers"
-	echo
-	exit 1
-fi
+  AC_CHECK_PROG(GPERF, gperf, gperf)
+  AS_IF([test -z "$GPERF"], [AC_MSG_ERROR([gperf is required to build the parsers])])
 
-fi # BUILD_PARSERS
+  AC_CHECK_PROG(KELBT, kelbt, kelbt)
+  AS_IF([test -z "$KELBT"], [AC_MSG_ERROR([kelbt is required to build the parsers])])
+])
 
 dnl Check for the D compiler
 AC_CHECK_PROG(GDC, gdc, gdc)
@@ -113,6 +94,26 @@ AC_CHECK_PROG(GMCS, gmcs, gmcs)
 AC_SUBST(GMCS)
 
 dnl write output files
-AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile examples/Makefile test/runtests doc/ragel.1 doc/rlgen-cd.1 doc/rlgen-java.1 doc/rlgen-ruby.1 doc/rlgen-dot.1 doc/version.tex)
+AC_OUTPUT([
+	Makefile
+	common/Makefile
+	doc/Makefile
+	doc/ragel.1
+	doc/rlgen-cd.1
+	doc/rlgen-dot.1
+	doc/rlgen-java.1
+	doc/rlgen-ruby.1
+	doc/version.tex
+	examples/Makefile
+	ragel/Makefile
+	redfsm/Makefile
+	rlgen-cd/Makefile
+	rlgen-csharp/Makefile
+	rlgen-dot/Makefile
+	rlgen-java/Makefile
+	rlgen-ruby/Makefile
+	test/Makefile
+	test/runtests
+])
 
 echo "configuration of ragel complete"


From thurs... at cs.queensu.ca  Thu Oct  2 17:41:17 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Thu, 02 Oct 2008 13:41:17 -0400
Subject: ragel has a new home
Message-ID: <48E507BD.6030903@cs.queensu.ca>

Hey Everyone,

I'm going to be graduating soon (woohoo) and that means it's time for
ragel to get a new home.

http://www.complang.org/ragel/

Cheers,
 Adrian


From flamee... at gmail.com  Wed Oct  1 11:12:34 2008
From: flamee... at gmail.com (Diego 'Flameeyes' =?utf-8?q?Petten=C3=B2?=)
Date: Wed, 01 Oct 2008 13:12:34 +0200
Subject: [PATCH 0/3] Making the buildsystem more distribution-friendly
Message-ID: <20081001110922.10537.90259.stgit@yamato>

Hello,

I'm a Gentoo Linux developer (but not limited to that), I'm interested
in using ragel for a few projects, but looking at updating it in our
tree, I've seen that the build system requires quite a few quirks that
makes it a bit unfriendly.

I'm sending a few patches that makes it slightly more friendly (two
out of three apply over 6.3 version too, one just applies to trunk).

I'm also wondering why it doesn't use directly automake and whether
that could be considered (if so, I'll be glad to help by porting it to
automake myself).

At any rate, I hope this can be of help.

Thanks,
Diego 'Flameeyes' Petten

---

Diego 'Flameeyes' Petten (3):
      Add support for DESTDIR variable for offset installation.
      Use CXXFLAGS for compiling rather than CFLAGS.
      Don't use install -s to strip files during install.


 common/Makefile.in       |    4 ++--
 doc/Makefile.in          |   18 +++++++++---------
 examples/Makefile        |    3 +--
 ragel/Makefile.in        |    8 ++++----
 redfsm/Makefile.in       |    4 ++--
 rlgen-cd/Makefile.in     |    4 ++--
 rlgen-csharp/Makefile.in |    4 ++--
 rlgen-dot/Makefile.in    |    8 ++++----
 rlgen-java/Makefile.in   |    4 ++--
 rlgen-ruby/Makefile.in   |    4 ++--
 10 files changed, 30 insertions(+), 31 deletions(-)


From flamee... at gmail.com  Wed Oct  1 11:12:48 2008
From: flamee... at gmail.com (Diego 'Flameeyes' =?utf-8?q?Petten=C3=B2?=)
Date: Wed, 01 Oct 2008 13:12:48 +0200
Subject: [PATCH 1/3] Don't use install -s to strip files during install.
In-Reply-To: <20081001110922.10537.90259.stgit@yamato>
References: <20081001110922.10537.90259.stgit@yamato>
Message-ID: <20081001111243.10537.46949.stgit@yamato>

Allow the user to decide whether to strip files or not, by using
install -s the user has no choice but to install stripped files, which
will be a problem to debug; most distributions will also not want
files to be stripped during install, and would rather take care of
stripping them through their own packaging toolchain (so that debug
packages may also be provided, for instance).
---

 ragel/Makefile.in     |    2 +-
 rlgen-dot/Makefile.in |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/ragel/Makefile.in b/ragel/Makefile.in
index 6190a5f..daa42e7 100644
--- a/ragel/Makefile.in
+++ b/ragel/Makefile.in
@@ -96,6 +96,6 @@ clean:
 
 install: all
 	install -d $(prefix)/bin
-	install -s ragel $(prefix)/bin/ragel
+	install ragel $(prefix)/bin/ragel
 
 -include $(DEPS)
diff --git a/rlgen-dot/Makefile.in b/rlgen-dot/Makefile.in
index 3f7b7f6..7cd4ee6 100644
--- a/rlgen-dot/Makefile.in
+++ b/rlgen-dot/Makefile.in
@@ -63,6 +63,6 @@ clean:
 
 install: all
 	install -d $(prefix)/bin
-	install -s rlgen-dot $(prefix)/bin/rlgen-dot
+	install rlgen-dot $(prefix)/bin/rlgen-dot
 
 -include $(DEPS)


From flamee... at gmail.com  Wed Oct  1 11:12:56 2008
From: flamee... at gmail.com (Diego 'Flameeyes' =?utf-8?q?Petten=C3=B2?=)
Date: Wed, 01 Oct 2008 13:12:56 +0200
Subject: [PATCH 2/3] Use CXXFLAGS for compiling rather than CFLAGS.
In-Reply-To: <20081001110922.10537.90259.stgit@yamato>
References: <20081001110922.10537.90259.stgit@yamato>
Message-ID: <20081001111256.10537.14923.stgit@yamato>

Most buildsystem divide flags on a per-language basis, since all
compilers support some flags only for one particular language.

The CFLAGS variable is reserved for C compiler flags, while C++
compiler flags are usually passed through CXXFLAGS variables; autoconf
supports this, and will help the user to use those.
---

 common/Makefile.in       |    4 ++--
 examples/Makefile        |    3 +--
 ragel/Makefile.in        |    4 ++--
 redfsm/Makefile.in       |    4 ++--
 rlgen-cd/Makefile.in     |    4 ++--
 rlgen-csharp/Makefile.in |    4 ++--
 rlgen-dot/Makefile.in    |    4 ++--
 rlgen-java/Makefile.in   |    4 ++--
 rlgen-ruby/Makefile.in   |    4 ++--
 9 files changed, 17 insertions(+), 18 deletions(-)

diff --git a/common/Makefile.in b/common/Makefile.in
index 54ed940..112e59c 100644
--- a/common/Makefile.in
+++ b/common/Makefile.in
@@ -21,7 +21,7 @@
 INCS += -I../aapl
 DEFS +=
 
-CFLAGS += -g -Wall
+CXXFLAGS += -g -Wall
 LDFLAGS +=
 
 CC_SRCS = common.cpp
@@ -58,7 +58,7 @@ version.h: ../version.mk
 
 %.o: %.cpp
 	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
+	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
 
 distclean: clean
 	rm -f Makefile config.h
diff --git a/examples/Makefile b/examples/Makefile
index a392aa8..b9fcc21 100644
--- a/examples/Makefile
+++ b/examples/Makefile
@@ -21,7 +21,6 @@
 RAGEL = ../ragel/ragel
 FLEX = flex
 RE2C = re2c
-CFLAGS = -Wall -g -O3
 
 TARGS = \
 	atoi awkemu clang concurrent cppscan format gotocallret mailbox params \
@@ -38,7 +37,7 @@ distclean clean:
 	gcc $(CFLAGS) -Wall -g -c -O3 -o $@ $<
 
 %.o: %.cpp
-	g++ $(CFLAGS) -Wall -g -c -O3 -o $@ $<
+	g++ $(CXXFLAGS) -Wall -g -c -O3 -o $@ $<
 
 #########################################
 
diff --git a/ragel/Makefile.in b/ragel/Makefile.in
index daa42e7..3a23267 100644
--- a/ragel/Makefile.in
+++ b/ragel/Makefile.in
@@ -21,7 +21,7 @@
 INCS += -I../common -I../aapl -I../redfsm
 DEFS +=
 
-CFLAGS += -g -Wall
+CXXFLAGS += -g -Wall
 LDFLAGS +=
 
 CC_SRCS = \
@@ -82,7 +82,7 @@ endif
 
 %.o: %.cpp
 	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
+	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
 
 distclean: clean
 	rm -f Makefile 
diff --git a/redfsm/Makefile.in b/redfsm/Makefile.in
index fc28171..a4c6737 100644
--- a/redfsm/Makefile.in
+++ b/redfsm/Makefile.in
@@ -21,7 +21,7 @@
 INCS += -I../common -I../aapl
 DEFS +=
 
-CFLAGS += -g -Wall
+CXXFLAGS += -g -Wall
 LDFLAGS +=
 
 CC_SRCS = redfsm.cpp gendata.cpp xmltags.cpp xmlscan.cpp xmlparse.cpp
@@ -69,7 +69,7 @@ endif
 
 %.o: %.cpp
 	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
+	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
 
 distclean: clean
 	rm -f Makefile
diff --git a/rlgen-cd/Makefile.in b/rlgen-cd/Makefile.in
index 6d4a293..49031e3 100644
--- a/rlgen-cd/Makefile.in
+++ b/rlgen-cd/Makefile.in
@@ -21,7 +21,7 @@
 INCS += -I../common -I../redfsm -I../aapl
 DEFS +=
 
-CFLAGS += -g -Wall
+CXXFLAGS += -g -Wall
 LDFLAGS +=
 
 CC_SRCS = main.cpp fsmcodegen.cpp \
@@ -57,7 +57,7 @@ rlgen-cd.a: $(LIBS) $(OBJS)
 
 %.o: %.cpp
 	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
+	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
 
 distclean: clean
 	rm -f Makefile
diff --git a/rlgen-csharp/Makefile.in b/rlgen-csharp/Makefile.in
index 24d992b..fa57e49 100644
--- a/rlgen-csharp/Makefile.in
+++ b/rlgen-csharp/Makefile.in
@@ -21,7 +21,7 @@
 INCS += -I../common -I../redfsm -I../aapl
 DEFS +=
 
-CFLAGS += -g -Wall
+CXXFLAGS += -g -Wall
 LDFLAGS +=
 
 CC_SRCS = main.cpp fsmcodegen.cpp \
@@ -57,7 +57,7 @@ rlgen-csharp.a: $(LIBS) $(OBJS)
 
 %.o: %.cpp
 	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
+	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
 
 distclean: clean
 	rm -f Makefile
diff --git a/rlgen-dot/Makefile.in b/rlgen-dot/Makefile.in
index 7cd4ee6..8decf2b 100644
--- a/rlgen-dot/Makefile.in
+++ b/rlgen-dot/Makefile.in
@@ -21,7 +21,7 @@
 INCS += -I../common -I../redfsm -I../aapl
 DEFS +=
 
-CFLAGS += -g -Wall
+CXXFLAGS += -g -Wall
 LDFLAGS +=
 
 CC_SRCS = main.cpp gvdotgen.cpp 
@@ -53,7 +53,7 @@ rlgen-dot.a: $(LIBS) $(OBJS)
 
 %.o: %.cpp
 	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
+	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
 
 distclean: clean
 	rm -f Makefile
diff --git a/rlgen-java/Makefile.in b/rlgen-java/Makefile.in
index e242a64..2fe5cd7 100644
--- a/rlgen-java/Makefile.in
+++ b/rlgen-java/Makefile.in
@@ -21,7 +21,7 @@
 INCS += -I../common -I../redfsm -I../aapl
 DEFS +=
 
-CFLAGS += -g -Wall
+CXXFLAGS += -g -Wall
 LDFLAGS +=
 
 CC_SRCS = main.cpp javacodegen.cpp
@@ -54,7 +54,7 @@ rlgen-java.a: $(LIBS) $(OBJS)
 
 %.o: %.cpp
 	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
+	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
 
 distclean: clean
 	rm -f Makefile
diff --git a/rlgen-ruby/Makefile.in b/rlgen-ruby/Makefile.in
index c9bd4f1..a0a2d52 100644
--- a/rlgen-ruby/Makefile.in
+++ b/rlgen-ruby/Makefile.in
@@ -21,7 +21,7 @@
 INCS += -I../common -I../redfsm -I../aapl
 DEFS +=
 
-CFLAGS += -g -Wall
+CXXFLAGS += -g -Wall
 LDFLAGS +=
 
 CC_SRCS = main.cpp ruby-codegen.cpp ruby-tabcodegen.cpp ruby-ftabcodegen.cpp \
@@ -55,7 +55,7 @@ rlgen-ruby.a: $(LIBS) $(OBJS)
 
 %.o: %.cpp
 	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
+	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
 
 distclean: clean
 	rm -f Makefile


From flamee... at gmail.com  Wed Oct  1 11:13:11 2008
From: flamee... at gmail.com (Diego 'Flameeyes' =?utf-8?q?Petten=C3=B2?=)
Date: Wed, 01 Oct 2008 13:13:11 +0200
Subject: [PATCH 3/3] Add support for DESTDIR variable for offset installation.
In-Reply-To: <20081001110922.10537.90259.stgit@yamato>
References: <20081001110922.10537.90259.stgit@yamato>
Message-ID: <20081001111311.10537.57009.stgit@yamato>

Most distributions use the DESTDIR variable to install the package
just built in a temporary tree used to build the package; such an
option can also be used to test that the software is getting installed
properly.

Add support for this variable by prefixing all paths used during
installation with $(DESTDIR).
---

 doc/Makefile.in       |   18 +++++++++---------
 ragel/Makefile.in     |    4 ++--
 rlgen-dot/Makefile.in |    4 ++--
 3 files changed, 13 insertions(+), 13 deletions(-)

diff --git a/doc/Makefile.in b/doc/Makefile.in
index 9d2ded2..a6ff456 100644
--- a/doc/Makefile.in
+++ b/doc/Makefile.in
@@ -66,16 +66,16 @@ distclean: clean
 man: $(MANPAGES)
 
 man-install: man
-	install -d $(mandir)/man1
-	install -m 644 ragel.1      $(mandir)/man1/ragel.1
-	install -m 644 rlgen-dot.1  $(mandir)/man1/rlgen-dot.1
-	install -m 644 rlgen-cd.1   $(mandir)/man1/rlgen-cd.1
-	install -m 644 rlgen-java.1 $(mandir)/man1/rlgen-java.1
-	install -m 644 rlgen-ruby.1 $(mandir)/man1/rlgen-ruby.1
+	install -d $(DESTDIR)$(mandir)/man1
+	install -m 644 ragel.1      (DESTDIR)$(mandir)/man1/ragel.1
+	install -m 644 rlgen-dot.1  (DESTDIR)$(mandir)/man1/rlgen-dot.1
+	install -m 644 rlgen-cd.1   (DESTDIR)$(mandir)/man1/rlgen-cd.1
+	install -m 644 rlgen-java.1 (DESTDIR)$(mandir)/man1/rlgen-java.1
+	install -m 644 rlgen-ruby.1 (DESTDIR)$(mandir)/man1/rlgen-ruby.1
 
 install: all man-install
-	install -d $(docdir)
-	install -m 644 ragel-guide.pdf $(docdir)/ragel-guide.pdf
+	install -d $(DESTDIR)$(docdir)
+	install -m 644 ragel-guide.pdf $(DESTDIR)$(docdir)/ragel-guide.pdf
 	gzip -c ../ChangeLog > ChangeLog.gz
-	install -m 644 ChangeLog.gz $(docdir)/ChangeLog.gz
+	install -m 644 ChangeLog.gz $(DESTDIR)$(docdir)/ChangeLog.gz
 	rm ChangeLog.gz
diff --git a/ragel/Makefile.in b/ragel/Makefile.in
index 3a23267..b6397dc 100644
--- a/ragel/Makefile.in
+++ b/ragel/Makefile.in
@@ -95,7 +95,7 @@ clean:
 	rm -f tags .*.d *.o ragel $(EXTRA_CLEAN)
 
 install: all
-	install -d $(prefix)/bin
-	install ragel $(prefix)/bin/ragel
+	install -d $(DESTDIR)$(prefix)/bin
+	install ragel $(DESTDIR)$(prefix)/bin/ragel
 
 -include $(DEPS)
diff --git a/rlgen-dot/Makefile.in b/rlgen-dot/Makefile.in
index 8decf2b..5d33931 100644
--- a/rlgen-dot/Makefile.in
+++ b/rlgen-dot/Makefile.in
@@ -62,7 +62,7 @@ clean:
 	rm -f tags .*.d *.o rlgen-dot $(EXTRA_CLEAN)
 
 install: all
-	install -d $(prefix)/bin
-	install rlgen-dot $(prefix)/bin/rlgen-dot
+	install -d $(DESTDIR)$(prefix)/bin
+	install rlgen-dot $(DESTDIR)$(prefix)/bin/rlgen-dot
 
 -include $(DEPS)


From thurs... at cs.queensu.ca  Mon Oct  6 03:16:50 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Sun, 05 Oct 2008 23:16:50 -0400
Subject: [ragel-users] [PATCH 0/3] Making the buildsystem more distribution-friendly
In-Reply-To: <20081001110922.10537.90259.stgit@yamato>
References: <20081001110922.10537.90259.stgit@yamato>
Message-ID: <48E98322.7080608@cs.queensu.ca>

Hey Diego,

I'll be looking at your patches soon! I've been a little tied up lately.

I'm not a fan of automake. I find it a little too much 'auto.' Just my
personal taste.

-Adrian

Diego 'Flameeyes' Petten wrote:
> Hello,
> 
> I'm a Gentoo Linux developer (but not limited to that), I'm interested
> in using ragel for a few projects, but looking at updating it in our
> tree, I've seen that the build system requires quite a few quirks that
> makes it a bit unfriendly.
> 
> I'm sending a few patches that makes it slightly more friendly (two
> out of three apply over 6.3 version too, one just applies to trunk).
> 
> I'm also wondering why it doesn't use directly automake and whether
> that could be considered (if so, I'll be glad to help by porting it to
> automake myself).
> 
> At any rate, I hope this can be of help.
> 
> Thanks,
> Diego 'Flameeyes' Petten
> 
> ---
> 
> Diego 'Flameeyes' Petten (3):
>       Add support for DESTDIR variable for offset installation.
>       Use CXXFLAGS for compiling rather than CFLAGS.
>       Don't use install -s to strip files during install.
> 
> 
>  common/Makefile.in       |    4 ++--
>  doc/Makefile.in          |   18 +++++++++---------
>  examples/Makefile        |    3 +--
>  ragel/Makefile.in        |    8 ++++----
>  redfsm/Makefile.in       |    4 ++--
>  rlgen-cd/Makefile.in     |    4 ++--
>  rlgen-csharp/Makefile.in |    4 ++--
>  rlgen-dot/Makefile.in    |    8 ++++----
>  rlgen-java/Makefile.in   |    4 ++--
>  rlgen-ruby/Makefile.in   |    4 ++--
>  10 files changed, 30 insertions(+), 31 deletions(-)
> 
> 


From thurs... at cs.queensu.ca  Mon Oct  6 16:36:14 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Mon, 06 Oct 2008 12:36:14 -0400
Subject: [ragel-users] [PATCH 1/3] Don't use install -s to strip files
 during install.
In-Reply-To: <20081001111243.10537.46949.stgit@yamato>
References: <20081001110922.10537.90259.stgit@yamato> <20081001111243.10537.46949.stgit@yamato>
Message-ID: <48EA3E7E.4070002@cs.queensu.ca>

Hmmm, I thought it was more common to install and strip the files. Maybe 
another target, install-debug, would be better?

-Adrian

Diego 'Flameeyes' Petten wrote:
> Allow the user to decide whether to strip files or not, by using
> install -s the user has no choice but to install stripped files, which
> will be a problem to debug; most distributions will also not want
> files to be stripped during install, and would rather take care of
> stripping them through their own packaging toolchain (so that debug
> packages may also be provided, for instance).
> ---
> 
>  ragel/Makefile.in     |    2 +-
>  rlgen-dot/Makefile.in |    2 +-
>  2 files changed, 2 insertions(+), 2 deletions(-)
> 
> diff --git a/ragel/Makefile.in b/ragel/Makefile.in
> index 6190a5f..daa42e7 100644
> --- a/ragel/Makefile.in
> +++ b/ragel/Makefile.in
> @@ -96,6 +96,6 @@ clean:
>  
>  install: all
>  	install -d $(prefix)/bin
> -	install -s ragel $(prefix)/bin/ragel
> +	install ragel $(prefix)/bin/ragel
>  
>  -include $(DEPS)
> diff --git a/rlgen-dot/Makefile.in b/rlgen-dot/Makefile.in
> index 3f7b7f6..7cd4ee6 100644
> --- a/rlgen-dot/Makefile.in
> +++ b/rlgen-dot/Makefile.in
> @@ -63,6 +63,6 @@ clean:
>  
>  install: all
>  	install -d $(prefix)/bin
> -	install -s rlgen-dot $(prefix)/bin/rlgen-dot
> +	install rlgen-dot $(prefix)/bin/rlgen-dot
>  
>  -include $(DEPS)
> 
> 
> 


From thurs... at cs.queensu.ca  Mon Oct  6 16:46:11 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Mon, 06 Oct 2008 12:46:11 -0400
Subject: [ragel-users] [PATCH 2/3] Use CXXFLAGS for compiling rather than
 CFLAGS.
In-Reply-To: <20081001111256.10537.14923.stgit@yamato>
References: <20081001110922.10537.90259.stgit@yamato> <20081001111256.10537.14923.stgit@yamato>
Message-ID: <48EA40D3.9060605@cs.queensu.ca>

Applied.

-Adrian

Diego 'Flameeyes' Petten wrote:
> Most buildsystem divide flags on a per-language basis, since all
> compilers support some flags only for one particular language.
> 
> The CFLAGS variable is reserved for C compiler flags, while C++
> compiler flags are usually passed through CXXFLAGS variables; autoconf
> supports this, and will help the user to use those.
> ---
> 
>  common/Makefile.in       |    4 ++--
>  examples/Makefile        |    3 +--
>  ragel/Makefile.in        |    4 ++--
>  redfsm/Makefile.in       |    4 ++--
>  rlgen-cd/Makefile.in     |    4 ++--
>  rlgen-csharp/Makefile.in |    4 ++--
>  rlgen-dot/Makefile.in    |    4 ++--
>  rlgen-java/Makefile.in   |    4 ++--
>  rlgen-ruby/Makefile.in   |    4 ++--
>  9 files changed, 17 insertions(+), 18 deletions(-)
> 
> diff --git a/common/Makefile.in b/common/Makefile.in
> index 54ed940..112e59c 100644
> --- a/common/Makefile.in
> +++ b/common/Makefile.in
> @@ -21,7 +21,7 @@
>  INCS += -I../aapl
>  DEFS +=
>  
> -CFLAGS += -g -Wall
> +CXXFLAGS += -g -Wall
>  LDFLAGS +=
>  
>  CC_SRCS = common.cpp
> @@ -58,7 +58,7 @@ version.h: ../version.mk
>  
>  %.o: %.cpp
>  	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
> -	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
> +	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
>  
>  distclean: clean
>  	rm -f Makefile config.h
> diff --git a/examples/Makefile b/examples/Makefile
> index a392aa8..b9fcc21 100644
> --- a/examples/Makefile
> +++ b/examples/Makefile
> @@ -21,7 +21,6 @@
>  RAGEL = ../ragel/ragel
>  FLEX = flex
>  RE2C = re2c
> -CFLAGS = -Wall -g -O3
>  
>  TARGS = \
>  	atoi awkemu clang concurrent cppscan format gotocallret mailbox params \
> @@ -38,7 +37,7 @@ distclean clean:
>  	gcc $(CFLAGS) -Wall -g -c -O3 -o $@ $<
>  
>  %.o: %.cpp
> -	g++ $(CFLAGS) -Wall -g -c -O3 -o $@ $<
> +	g++ $(CXXFLAGS) -Wall -g -c -O3 -o $@ $<
>  
>  #########################################
>  
> diff --git a/ragel/Makefile.in b/ragel/Makefile.in
> index daa42e7..3a23267 100644
> --- a/ragel/Makefile.in
> +++ b/ragel/Makefile.in
> @@ -21,7 +21,7 @@
>  INCS += -I../common -I../aapl -I../redfsm
>  DEFS +=
>  
> -CFLAGS += -g -Wall
> +CXXFLAGS += -g -Wall
>  LDFLAGS +=
>  
>  CC_SRCS = \
> @@ -82,7 +82,7 @@ endif
>  
>  %.o: %.cpp
>  	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
> -	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
> +	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
>  
>  distclean: clean
>  	rm -f Makefile 
> diff --git a/redfsm/Makefile.in b/redfsm/Makefile.in
> index fc28171..a4c6737 100644
> --- a/redfsm/Makefile.in
> +++ b/redfsm/Makefile.in
> @@ -21,7 +21,7 @@
>  INCS += -I../common -I../aapl
>  DEFS +=
>  
> -CFLAGS += -g -Wall
> +CXXFLAGS += -g -Wall
>  LDFLAGS +=
>  
>  CC_SRCS = redfsm.cpp gendata.cpp xmltags.cpp xmlscan.cpp xmlparse.cpp
> @@ -69,7 +69,7 @@ endif
>  
>  %.o: %.cpp
>  	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
> -	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
> +	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
>  
>  distclean: clean
>  	rm -f Makefile
> diff --git a/rlgen-cd/Makefile.in b/rlgen-cd/Makefile.in
> index 6d4a293..49031e3 100644
> --- a/rlgen-cd/Makefile.in
> +++ b/rlgen-cd/Makefile.in
> @@ -21,7 +21,7 @@
>  INCS += -I../common -I../redfsm -I../aapl
>  DEFS +=
>  
> -CFLAGS += -g -Wall
> +CXXFLAGS += -g -Wall
>  LDFLAGS +=
>  
>  CC_SRCS = main.cpp fsmcodegen.cpp \
> @@ -57,7 +57,7 @@ rlgen-cd.a: $(LIBS) $(OBJS)
>  
>  %.o: %.cpp
>  	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
> -	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
> +	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
>  
>  distclean: clean
>  	rm -f Makefile
> diff --git a/rlgen-csharp/Makefile.in b/rlgen-csharp/Makefile.in
> index 24d992b..fa57e49 100644
> --- a/rlgen-csharp/Makefile.in
> +++ b/rlgen-csharp/Makefile.in
> @@ -21,7 +21,7 @@
>  INCS += -I../common -I../redfsm -I../aapl
>  DEFS +=
>  
> -CFLAGS += -g -Wall
> +CXXFLAGS += -g -Wall
>  LDFLAGS +=
>  
>  CC_SRCS = main.cpp fsmcodegen.cpp \
> @@ -57,7 +57,7 @@ rlgen-csharp.a: $(LIBS) $(OBJS)
>  
>  %.o: %.cpp
>  	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
> -	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
> +	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
>  
>  distclean: clean
>  	rm -f Makefile
> diff --git a/rlgen-dot/Makefile.in b/rlgen-dot/Makefile.in
> index 7cd4ee6..8decf2b 100644
> --- a/rlgen-dot/Makefile.in
> +++ b/rlgen-dot/Makefile.in
> @@ -21,7 +21,7 @@
>  INCS += -I../common -I../redfsm -I../aapl
>  DEFS +=
>  
> -CFLAGS += -g -Wall
> +CXXFLAGS += -g -Wall
>  LDFLAGS +=
>  
>  CC_SRCS = main.cpp gvdotgen.cpp 
> @@ -53,7 +53,7 @@ rlgen-dot.a: $(LIBS) $(OBJS)
>  
>  %.o: %.cpp
>  	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
> -	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
> +	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
>  
>  distclean: clean
>  	rm -f Makefile
> diff --git a/rlgen-java/Makefile.in b/rlgen-java/Makefile.in
> index e242a64..2fe5cd7 100644
> --- a/rlgen-java/Makefile.in
> +++ b/rlgen-java/Makefile.in
> @@ -21,7 +21,7 @@
>  INCS += -I../common -I../redfsm -I../aapl
>  DEFS +=
>  
> -CFLAGS += -g -Wall
> +CXXFLAGS += -g -Wall
>  LDFLAGS +=
>  
>  CC_SRCS = main.cpp javacodegen.cpp
> @@ -54,7 +54,7 @@ rlgen-java.a: $(LIBS) $(OBJS)
>  
>  %.o: %.cpp
>  	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
> -	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
> +	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
>  
>  distclean: clean
>  	rm -f Makefile
> diff --git a/rlgen-ruby/Makefile.in b/rlgen-ruby/Makefile.in
> index c9bd4f1..a0a2d52 100644
> --- a/rlgen-ruby/Makefile.in
> +++ b/rlgen-ruby/Makefile.in
> @@ -21,7 +21,7 @@
>  INCS += -I../common -I../redfsm -I../aapl
>  DEFS +=
>  
> -CFLAGS += -g -Wall
> +CXXFLAGS += -g -Wall
>  LDFLAGS +=
>  
>  CC_SRCS = main.cpp ruby-codegen.cpp ruby-tabcodegen.cpp ruby-ftabcodegen.cpp \
> @@ -55,7 +55,7 @@ rlgen-ruby.a: $(LIBS) $(OBJS)
>  
>  %.o: %.cpp
>  	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
> -	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
> +	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
>  
>  distclean: clean
>  	rm -f Makefile
> 
> 
> 


From thurs... at cs.queensu.ca  Mon Oct  6 17:12:19 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Mon, 06 Oct 2008 13:12:19 -0400
Subject: [ragel-users] [PATCH 3/3] Add support for DESTDIR variable for
 offset installation.
In-Reply-To: <20081001111311.10537.57009.stgit@yamato>
References: <20081001110922.10537.90259.stgit@yamato> <20081001111311.10537.57009.stgit@yamato>
Message-ID: <48EA46F3.9050203@cs.queensu.ca>

Applied.

Diego 'Flameeyes' Petten wrote:
> Most distributions use the DESTDIR variable to install the package
> just built in a temporary tree used to build the package; such an
> option can also be used to test that the software is getting installed
> properly.
> 
> Add support for this variable by prefixing all paths used during
> installation with $(DESTDIR).
> ---
> 
>  doc/Makefile.in       |   18 +++++++++---------
>  ragel/Makefile.in     |    4 ++--
>  rlgen-dot/Makefile.in |    4 ++--
>  3 files changed, 13 insertions(+), 13 deletions(-)
> 
> diff --git a/doc/Makefile.in b/doc/Makefile.in
> index 9d2ded2..a6ff456 100644
> --- a/doc/Makefile.in
> +++ b/doc/Makefile.in
> @@ -66,16 +66,16 @@ distclean: clean
>  man: $(MANPAGES)
>  
>  man-install: man
> -	install -d $(mandir)/man1
> -	install -m 644 ragel.1      $(mandir)/man1/ragel.1
> -	install -m 644 rlgen-dot.1  $(mandir)/man1/rlgen-dot.1
> -	install -m 644 rlgen-cd.1   $(mandir)/man1/rlgen-cd.1
> -	install -m 644 rlgen-java.1 $(mandir)/man1/rlgen-java.1
> -	install -m 644 rlgen-ruby.1 $(mandir)/man1/rlgen-ruby.1
> +	install -d $(DESTDIR)$(mandir)/man1
> +	install -m 644 ragel.1      (DESTDIR)$(mandir)/man1/ragel.1
> +	install -m 644 rlgen-dot.1  (DESTDIR)$(mandir)/man1/rlgen-dot.1
> +	install -m 644 rlgen-cd.1   (DESTDIR)$(mandir)/man1/rlgen-cd.1
> +	install -m 644 rlgen-java.1 (DESTDIR)$(mandir)/man1/rlgen-java.1
> +	install -m 644 rlgen-ruby.1 (DESTDIR)$(mandir)/man1/rlgen-ruby.1
>  
>  install: all man-install
> -	install -d $(docdir)
> -	install -m 644 ragel-guide.pdf $(docdir)/ragel-guide.pdf
> +	install -d $(DESTDIR)$(docdir)
> +	install -m 644 ragel-guide.pdf $(DESTDIR)$(docdir)/ragel-guide.pdf
>  	gzip -c ../ChangeLog > ChangeLog.gz
> -	install -m 644 ChangeLog.gz $(docdir)/ChangeLog.gz
> +	install -m 644 ChangeLog.gz $(DESTDIR)$(docdir)/ChangeLog.gz
>  	rm ChangeLog.gz
> diff --git a/ragel/Makefile.in b/ragel/Makefile.in
> index 3a23267..b6397dc 100644
> --- a/ragel/Makefile.in
> +++ b/ragel/Makefile.in
> @@ -95,7 +95,7 @@ clean:
>  	rm -f tags .*.d *.o ragel $(EXTRA_CLEAN)
>  
>  install: all
> -	install -d $(prefix)/bin
> -	install ragel $(prefix)/bin/ragel
> +	install -d $(DESTDIR)$(prefix)/bin
> +	install ragel $(DESTDIR)$(prefix)/bin/ragel
>  
>  -include $(DEPS)
> diff --git a/rlgen-dot/Makefile.in b/rlgen-dot/Makefile.in
> index 8decf2b..5d33931 100644
> --- a/rlgen-dot/Makefile.in
> +++ b/rlgen-dot/Makefile.in
> @@ -62,7 +62,7 @@ clean:
>  	rm -f tags .*.d *.o rlgen-dot $(EXTRA_CLEAN)
>  
>  install: all
> -	install -d $(prefix)/bin
> -	install rlgen-dot $(prefix)/bin/rlgen-dot
> +	install -d $(DESTDIR)$(prefix)/bin
> +	install rlgen-dot $(DESTDIR)$(prefix)/bin/rlgen-dot
>  
>  -include $(DEPS)
> 
> 
> 


From flamee... at gmail.com  Wed Oct  1 14:37:20 2008
From: flamee... at gmail.com (Diego 'Flameeyes' =?utf-8?q?Petten=C3=B2?=)
Date: Wed, 01 Oct 2008 16:37:20 +0200
Subject: [PATCH 3/6] Make it possible to enable/disable parsers generation at
	./configure
Message-ID: <20081001143720.22980.87619.stgit@yamato>

Instead of having to edit the configure.in file to disable parsers,
make it possible to disable it at ./configure stage, like any good
autoconf project should do.
---

 configure.in       |   12 +++++++-----
 ragel/Makefile.in  |    6 +++---
 redfsm/Makefile.in |    2 +-
 3 files changed, 11 insertions(+), 9 deletions(-)

diff --git a/configure.in b/configure.in
index cc25f2e..3995551 100644
--- a/configure.in
+++ b/configure.in
@@ -21,10 +21,12 @@ dnl   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 AC_INIT(ragel/main.cpp)
 AC_CONFIG_HEADER(common/config.h)
 
-dnl Set to true if build system should generate parsers from ragel, kelbt, and
-dnl gperf sources. Set to false if generated files are included and not to be
-dnl built (production).
-AC_SUBST(BUILD_PARSERS,true)
+dnl You need to enable this unless the generated files are included
+dnl and don't need to be built.
+AC_ARG_ENABLE([parsers],
+  AS_HELP_STRING([--disable-parsers], [Disable building of parsers with ragel, kelbt and gperf]),
+  [], [enable_parsers=yes])
+AC_SUBST([enable_parsers])
 
 dnl Checks for programs.
 AC_PROG_CC
@@ -38,7 +40,7 @@ AC_LANG_CPLUSPLUS
 dnl Check for definition of MAKE.
 AC_PROG_MAKE_SET
 
-if test $BUILD_PARSERS = true; then
+if test $enable_parsers = yes; then
 
 dnl Check for Ragel
 AC_CHECK_PROG(RAGEL, ragel, ragel)
diff --git a/ragel/Makefile.in b/ragel/Makefile.in
index b6397dc..2a6b5da 100644
--- a/ragel/Makefile.in
+++ b/ragel/Makefile.in
@@ -45,7 +45,7 @@ MINGW_LIBS = -lpsapi
 #*************************************
 
 prefix = @prefix@
-BUILD_PARSERS = @BUILD_PARSERS@
+BUILD_PARSERS = @enable_parsers@
 EXEEXT = @EXEEXT@
 CXX = @CXX@
 
@@ -63,7 +63,7 @@ all: ragel$(EXEEXT)
 ragel$(EXEEXT): $(GEN_SRC) $(OBJS) $(RAGEL_LIBS)
 	$(CXX) $(LDFLAGS) -o $@ $(OBJS) $(LIBS)
 
-ifeq ($(BUILD_PARSERS),true)
+ifeq ($(BUILD_PARSERS),yes)
 
 rlparse.h: rlparse.kh
 	kelbt -o $@ $<
@@ -87,7 +87,7 @@ endif
 distclean: clean
 	rm -f Makefile 
 
-ifeq ($(BUILD_PARSERS),true)
+ifeq ($(BUILD_PARSERS),yes)
 EXTRA_CLEAN = $(GEN_SRC)
 endif
 
diff --git a/redfsm/Makefile.in b/redfsm/Makefile.in
index a4c6737..951de79 100644
--- a/redfsm/Makefile.in
+++ b/redfsm/Makefile.in
@@ -28,7 +28,7 @@ CC_SRCS = redfsm.cpp gendata.cpp xmltags.cpp xmlscan.cpp xmlparse.cpp
 
 GEN_SRC = xmltags.cpp xmlscan.cpp xmlparse.cpp xmlparse.h
 
-BUILD_PARSERS = @BUILD_PARSERS@
+BUILD_PARSERS = @enable_parsers@
 
 #*************************************
 


From thurs... at cs.queensu.ca  Mon Oct  6 17:24:05 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Mon, 06 Oct 2008 13:24:05 -0400
Subject: [ragel-users] [PATCH 3/6] Make it possible to enable/disable
 parsers generation at ./configure
In-Reply-To: <20081001143720.22980.87619.stgit@yamato>
References: <20081001143720.22980.87619.stgit@yamato>
Message-ID: <48EA49B5.7080002@cs.queensu.ca>

I don't see why anyone would need to use this. Either you're doing 
development on ragel and you're working out of SVN or you're grabbing a 
release for building and installing. Maybe someone might want to do 
development on an older version but I think that would be pretty rare.

Adrian

Diego 'Flameeyes' Petten wrote:
> Instead of having to edit the configure.in file to disable parsers,
> make it possible to disable it at ./configure stage, like any good
> autoconf project should do.
> ---
> 
>  configure.in       |   12 +++++++-----
>  ragel/Makefile.in  |    6 +++---
>  redfsm/Makefile.in |    2 +-
>  3 files changed, 11 insertions(+), 9 deletions(-)
> 
> diff --git a/configure.in b/configure.in
> index cc25f2e..3995551 100644
> --- a/configure.in
> +++ b/configure.in
> @@ -21,10 +21,12 @@ dnl   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
>  AC_INIT(ragel/main.cpp)
>  AC_CONFIG_HEADER(common/config.h)
>  
> -dnl Set to true if build system should generate parsers from ragel, kelbt, and
> -dnl gperf sources. Set to false if generated files are included and not to be
> -dnl built (production).
> -AC_SUBST(BUILD_PARSERS,true)
> +dnl You need to enable this unless the generated files are included
> +dnl and don't need to be built.
> +AC_ARG_ENABLE([parsers],
> +  AS_HELP_STRING([--disable-parsers], [Disable building of parsers with ragel, kelbt and gperf]),
> +  [], [enable_parsers=yes])
> +AC_SUBST([enable_parsers])
>  
>  dnl Checks for programs.
>  AC_PROG_CC
> @@ -38,7 +40,7 @@ AC_LANG_CPLUSPLUS
>  dnl Check for definition of MAKE.
>  AC_PROG_MAKE_SET
>  
> -if test $BUILD_PARSERS = true; then
> +if test $enable_parsers = yes; then
>  
>  dnl Check for Ragel
>  AC_CHECK_PROG(RAGEL, ragel, ragel)
> diff --git a/ragel/Makefile.in b/ragel/Makefile.in
> index b6397dc..2a6b5da 100644
> --- a/ragel/Makefile.in
> +++ b/ragel/Makefile.in
> @@ -45,7 +45,7 @@ MINGW_LIBS = -lpsapi
>  #*************************************
>  
>  prefix = @prefix@
> -BUILD_PARSERS = @BUILD_PARSERS@
> +BUILD_PARSERS = @enable_parsers@
>  EXEEXT = @EXEEXT@
>  CXX = @CXX@
>  
> @@ -63,7 +63,7 @@ all: ragel$(EXEEXT)
>  ragel$(EXEEXT): $(GEN_SRC) $(OBJS) $(RAGEL_LIBS)
>  	$(CXX) $(LDFLAGS) -o $@ $(OBJS) $(LIBS)
>  
> -ifeq ($(BUILD_PARSERS),true)
> +ifeq ($(BUILD_PARSERS),yes)
>  
>  rlparse.h: rlparse.kh
>  	kelbt -o $@ $<
> @@ -87,7 +87,7 @@ endif
>  distclean: clean
>  	rm -f Makefile 
>  
> -ifeq ($(BUILD_PARSERS),true)
> +ifeq ($(BUILD_PARSERS),yes)
>  EXTRA_CLEAN = $(GEN_SRC)
>  endif
>  
> diff --git a/redfsm/Makefile.in b/redfsm/Makefile.in
> index a4c6737..951de79 100644
> --- a/redfsm/Makefile.in
> +++ b/redfsm/Makefile.in
> @@ -28,7 +28,7 @@ CC_SRCS = redfsm.cpp gendata.cpp xmltags.cpp xmlscan.cpp xmlparse.cpp
>  
>  GEN_SRC = xmltags.cpp xmlscan.cpp xmlparse.cpp xmlparse.h
>  
> -BUILD_PARSERS = @BUILD_PARSERS@
> +BUILD_PARSERS = @enable_parsers@
>  
>  #*************************************
>  
> 
> 
> 


From flamee... at gmail.com  Wed Oct  1 14:36:16 2008
From: flamee... at gmail.com (Diego 'Flameeyes' =?utf-8?q?Petten=C3=B2?=)
Date: Wed, 01 Oct 2008 16:36:16 +0200
Subject: [PATCH 0/6] Port the build system to autotools
Message-ID: <20081001143058.22980.51881.stgit@yamato>

Since I found quite a few problems trying to put ragel inside a chain
of packages to build for a project, I decided to go on and port it to
automake already.

The attached patches (which might require a bit of work to apply on
SVN because of removed and renamed files) replace the custom tailored
build system with a much more stable autotools-based one; it's not
perfect yet but it's certainly better than it was before for most
distribution and end-user uses.

I guess I'd have to do the same to kelbt (as wella s fixing one code
generation problem: char * vs const char const*), so that I can put
all in a single chain, and it's going to be a bit of a problem to get
ragel to bootstrap as it needs itself.

I'll also see if I can get something better for the tests.

Testing of these patches is very welcome by everybody, I can improve
them if I missed something.

---

Diego 'Flameeyes' Petten (6):
      Make the configure.in look more like an autoconf script.
      Replace custom makefiles with automake.
      Remove need for version.mk file.
      Make it possible to enable/disable parsers generation at ./configure
      Remove files generated by autotools.
      Don't use AC_DEFINE to pass the commands for the compilers to the runtest script.


 Makefile.am               |   21 
 Makefile.in               |   78 -
 common/Makefile.am        |   12 
 common/Makefile.in        |   72 -
 common/config.h.in        |   40 
 configure                 | 4680 ---------------------------------------------
 configure.in              |  109 +
 doc/Makefile.am           |   13 
 doc/Makefile.in           |   81 -
 doc/ragel.1.in            |    2 
 doc/rlgen-cd.1.in         |    2 
 doc/rlgen-dot.1.in        |    2 
 doc/rlgen-java.1.in       |    2 
 doc/rlgen-ruby.1.in       |    2 
 doc/version.tex.in        |    2 
 examples/Makefile         |  142 -
 examples/Makefile.am      |   38 
 examples/cppscan.lex      |  143 -
 examples/cppscan.rec      |  183 --
 examples/lex-cppscan.l    |  143 +
 examples/re2c-cppscan.rec |  183 ++
 ragel/Makefile.am         |   38 
 ragel/Makefile.in         |  101 -
 ragel/main.cpp            |    2 
 ragel/parsedata.cpp       |    4 
 redfsm/Makefile.am        |   29 
 redfsm/Makefile.in        |   87 -
 redfsm/xmlparse.kl        |    2 
 rlgen-cd/Makefile.am      |   12 
 rlgen-cd/Makefile.in      |   71 -
 rlgen-csharp/Makefile.am  |   12 
 rlgen-csharp/Makefile.in  |   71 -
 rlgen-csharp/main.cpp     |    2 
 rlgen-dot/Makefile.am     |    7 
 rlgen-dot/Makefile.in     |   68 -
 rlgen-java/Makefile.am    |    8 
 rlgen-java/Makefile.in    |   68 -
 rlgen-ruby/Makefile.am    |   11 
 rlgen-ruby/Makefile.in    |   69 -
 test/Makefile.am          |   23 
 test/Makefile.in          |   30 
 test/runtests             |  320 ---
 test/runtests.in          |  320 +++
 version.mk                |    2 
 44 files changed, 934 insertions(+), 6373 deletions(-)
 create mode 100644 Makefile.am
 delete mode 100644 Makefile.in
 create mode 100644 common/Makefile.am
 delete mode 100644 common/Makefile.in
 delete mode 100644 common/config.h.in
 delete mode 100755 configure
 create mode 100644 doc/Makefile.am
 delete mode 100644 doc/Makefile.in
 create mode 100644 doc/version.tex.in
 delete mode 100644 examples/Makefile
 create mode 100644 examples/Makefile.am
 delete mode 100644 examples/cppscan.lex
 delete mode 100644 examples/cppscan.rec
 create mode 100644 examples/lex-cppscan.l
 create mode 100644 examples/re2c-cppscan.rec
 create mode 100644 ragel/Makefile.am
 delete mode 100644 ragel/Makefile.in
 create mode 100644 redfsm/Makefile.am
 delete mode 100644 redfsm/Makefile.in
 create mode 100644 rlgen-cd/Makefile.am
 delete mode 100644 rlgen-cd/Makefile.in
 create mode 100644 rlgen-csharp/Makefile.am
 delete mode 100644 rlgen-csharp/Makefile.in
 create mode 100644 rlgen-dot/Makefile.am
 delete mode 100644 rlgen-dot/Makefile.in
 create mode 100644 rlgen-java/Makefile.am
 delete mode 100644 rlgen-java/Makefile.in
 create mode 100644 rlgen-ruby/Makefile.am
 delete mode 100644 rlgen-ruby/Makefile.in
 create mode 100644 test/Makefile.am
 delete mode 100644 test/Makefile.in
 delete mode 100755 test/runtests
 create mode 100755 test/runtests.in
 delete mode 100644 version.mk


From thurs... at cs.queensu.ca  Mon Oct  6 17:25:02 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Mon, 06 Oct 2008 13:25:02 -0400
Subject: [ragel-users] [PATCH 0/6] Port the build system to autotools
In-Reply-To: <20081001143058.22980.51881.stgit@yamato>
References: <20081001143058.22980.51881.stgit@yamato>
Message-ID: <48EA49EE.1020004@cs.queensu.ca>

Sorry I don't want to use automake for ragel.

Adrian

Diego 'Flameeyes' Petten wrote:
> Since I found quite a few problems trying to put ragel inside a chain
> of packages to build for a project, I decided to go on and port it to
> automake already.
> 
> The attached patches (which might require a bit of work to apply on
> SVN because of removed and renamed files) replace the custom tailored
> build system with a much more stable autotools-based one; it's not
> perfect yet but it's certainly better than it was before for most
> distribution and end-user uses.
> 
> I guess I'd have to do the same to kelbt (as wella s fixing one code
> generation problem: char * vs const char const*), so that I can put
> all in a single chain, and it's going to be a bit of a problem to get
> ragel to bootstrap as it needs itself.
> 
> I'll also see if I can get something better for the tests.
> 
> Testing of these patches is very welcome by everybody, I can improve
> them if I missed something.
> 
> ---
> 
> Diego 'Flameeyes' Petten (6):
>       Make the configure.in look more like an autoconf script.
>       Replace custom makefiles with automake.
>       Remove need for version.mk file.
>       Make it possible to enable/disable parsers generation at ./configure
>       Remove files generated by autotools.
>       Don't use AC_DEFINE to pass the commands for the compilers to the runtest script.
> 
> 
>  Makefile.am               |   21 
>  Makefile.in               |   78 -
>  common/Makefile.am        |   12 
>  common/Makefile.in        |   72 -
>  common/config.h.in        |   40 
>  configure                 | 4680 ---------------------------------------------
>  configure.in              |  109 +
>  doc/Makefile.am           |   13 
>  doc/Makefile.in           |   81 -
>  doc/ragel.1.in            |    2 
>  doc/rlgen-cd.1.in         |    2 
>  doc/rlgen-dot.1.in        |    2 
>  doc/rlgen-java.1.in       |    2 
>  doc/rlgen-ruby.1.in       |    2 
>  doc/version.tex.in        |    2 
>  examples/Makefile         |  142 -
>  examples/Makefile.am      |   38 
>  examples/cppscan.lex      |  143 -
>  examples/cppscan.rec      |  183 --
>  examples/lex-cppscan.l    |  143 +
>  examples/re2c-cppscan.rec |  183 ++
>  ragel/Makefile.am         |   38 
>  ragel/Makefile.in         |  101 -
>  ragel/main.cpp            |    2 
>  ragel/parsedata.cpp       |    4 
>  redfsm/Makefile.am        |   29 
>  redfsm/Makefile.in        |   87 -
>  redfsm/xmlparse.kl        |    2 
>  rlgen-cd/Makefile.am      |   12 
>  rlgen-cd/Makefile.in      |   71 -
>  rlgen-csharp/Makefile.am  |   12 
>  rlgen-csharp/Makefile.in  |   71 -
>  rlgen-csharp/main.cpp     |    2 
>  rlgen-dot/Makefile.am     |    7 
>  rlgen-dot/Makefile.in     |   68 -
>  rlgen-java/Makefile.am    |    8 
>  rlgen-java/Makefile.in    |   68 -
>  rlgen-ruby/Makefile.am    |   11 
>  rlgen-ruby/Makefile.in    |   69 -
>  test/Makefile.am          |   23 
>  test/Makefile.in          |   30 
>  test/runtests             |  320 ---
>  test/runtests.in          |  320 +++
>  version.mk                |    2 
>  44 files changed, 934 insertions(+), 6373 deletions(-)
>  create mode 100644 Makefile.am
>  delete mode 100644 Makefile.in
>  create mode 100644 common/Makefile.am
>  delete mode 100644 common/Makefile.in
>  delete mode 100644 common/config.h.in
>  delete mode 100755 configure
>  create mode 100644 doc/Makefile.am
>  delete mode 100644 doc/Makefile.in
>  create mode 100644 doc/version.tex.in
>  delete mode 100644 examples/Makefile
>  create mode 100644 examples/Makefile.am
>  delete mode 100644 examples/cppscan.lex
>  delete mode 100644 examples/cppscan.rec
>  create mode 100644 examples/lex-cppscan.l
>  create mode 100644 examples/re2c-cppscan.rec
>  create mode 100644 ragel/Makefile.am
>  delete mode 100644 ragel/Makefile.in
>  create mode 100644 redfsm/Makefile.am
>  delete mode 100644 redfsm/Makefile.in
>  create mode 100644 rlgen-cd/Makefile.am
>  delete mode 100644 rlgen-cd/Makefile.in
>  create mode 100644 rlgen-csharp/Makefile.am
>  delete mode 100644 rlgen-csharp/Makefile.in
>  create mode 100644 rlgen-dot/Makefile.am
>  delete mode 100644 rlgen-dot/Makefile.in
>  create mode 100644 rlgen-java/Makefile.am
>  delete mode 100644 rlgen-java/Makefile.in
>  create mode 100644 rlgen-ruby/Makefile.am
>  delete mode 100644 rlgen-ruby/Makefile.in
>  create mode 100644 test/Makefile.am
>  delete mode 100644 test/Makefile.in
>  delete mode 100755 test/runtests
>  create mode 100755 test/runtests.in
>  delete mode 100644 version.mk
> 
> 


From flamee... at gmail.com  Wed Oct  1 14:36:36 2008
From: flamee... at gmail.com (Diego 'Flameeyes' =?utf-8?q?Petten=C3=B2?=)
Date: Wed, 01 Oct 2008 16:36:36 +0200
Subject: [PATCH 1/6] Don't use AC_DEFINE to pass the commands for the
	compilers to the runtest script.
Message-ID: <20081001143631.22980.46335.stgit@yamato>

Instead of parsing the config.h header from runtest, make it use
proper autoconf by generating it at the end of the configure run.
---

 configure.in     |   28 +----
 test/runtests    |  320 ------------------------------------------------------
 test/runtests.in |  320 ++++++++++++++++++++++++++++++++++++++++++++++++++++++
 3 files changed, 327 insertions(+), 341 deletions(-)
 delete mode 100755 test/runtests
 create mode 100755 test/runtests.in

diff --git a/configure.in b/configure.in
index a257a70..cc25f2e 100644
--- a/configure.in
+++ b/configure.in
@@ -31,10 +31,6 @@ AC_PROG_CC
 AC_PROG_CXX
 AC_CHECK_TOOL(AR, ar)
 AC_PROG_RANLIB
-AC_DEFINE_UNQUOTED(CC,$CC)
-AC_DEFINE_UNQUOTED(CXX,$CXX)
-AC_DEFINE_UNQUOTED(AR,$AR)
-AC_DEFINE_UNQUOTED(RANLIB,$RANLIB)
 
 dnl Set test on c++ compiler.
 AC_LANG_CPLUSPLUS
@@ -75,9 +71,7 @@ fi # BUILD_PARSERS
 
 dnl Check for the D compiler
 AC_CHECK_PROG(GDC, gdc, gdc)
-if test -n "$GDC"; then
-	AC_DEFINE_UNQUOTED(GDC,$GDC)
-fi
+AC_SUBST(GDC)
 
 dnl Check for the Objective-C compiler
 AC_MSG_CHECKING([for the Objective-C compiler])
@@ -88,7 +82,7 @@ GOBJC=""
 if gcc -x objective-c conftest.m -o conftest.bin 2>/dev/null; then
 	GOBJC="gcc -x objective-c"
 	AC_MSG_RESULT([yes])
-	AC_DEFINE_UNQUOTED(GOBJC,$GOBJC)
+	AC_SUBST(GOBJC)
 else
 	AC_MSG_RESULT([no])
 fi
@@ -96,29 +90,21 @@ AC_SUBST(GOBJC)
 
 dnl Check for the Java compiler.
 AC_CHECK_PROG(JAVAC, javac, javac)
-if test -n "$JAVAC"; then
-	AC_DEFINE_UNQUOTED(JAVAC,$JAVAC)
-fi
+AC_SUBST(JAVAC)
 
 dnl Check for TXL.
 AC_CHECK_PROG(TXL, txl, txl)
-if test -n "$TXL"; then
-	AC_DEFINE_UNQUOTED(TXL,$TXL)
-fi
+AC_SUBST(TXL)
 
 dnl Check for Ruby.
 AC_CHECK_PROG(RUBY, ruby, ruby)
-if test -n "$RUBY"; then
-	AC_DEFINE_UNQUOTED(RUBY,$RUBY)
-fi
+AC_SUBST(RUBY)
 
 dnl Check for the C# compiler.
 AC_CHECK_PROG(GMCS, gmcs, gmcs)
-if test -n "$GMCS"; then
-	AC_DEFINE_UNQUOTED(GMCS,$GMCS)
-fi
+AC_SUBST(GMCS)
 
 dnl write output files
-AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile)
+AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile test/runtests)
 
 echo "configuration of ragel complete"
diff --git a/test/runtests b/test/runtests
deleted file mode 100755
index a50c7c9..0000000
--- a/test/runtests
+++ /dev/null
@@ -1,320 +0,0 @@
-#!/bin/bash
-
-#
-#   Copyright 2006 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-while getopts "gcnmleT:F:G:P:CDJRA" opt; do
-	case $opt in
-		T|F|G|P) 
-			genflags="$genflags -$opt$OPTARG"
-			options="$options -$opt$OPTARG"
-			;;
-		n|m|l|e) 
-			minflags="$minflags -$opt"
-			options="$options -$opt"
-			;;
-		c) 
-			compile_only="true"
-			options="$options -$opt"
-			;;
-		g) 
-			allow_generated="true"
-			;;
-		C|D|J|R|A) 
-			langflags="$langflags -$opt"
-			;;
-	esac
-done
-
-[ -z "$minflags" ] && minflags="-n -m -l -e"
-[ -z "$genflags" ] && genflags="-T0 -T1 -F0 -F1 -G0 -G1 -G2"
-[ -z "$langflags" ] && langflags="-C -D -J -R -A"
-
-shift $((OPTIND - 1));
-
-[ -z "$*" ] && set -- *.rl
-
-config=../common/config.h
-ragel=../ragel/ragel
-
-cxx_compiler=`sed '/^#define CXX/s/#define CXX *//p;d' $config`
-c_compiler=`sed '/^#define CC/s/#define CC *//p;d' $config`
-objc_compiler=`sed '/^#define GOBJC/s/#define GOBJC *//p;d' $config`
-d_compiler=`sed '/^#define GDC/s/#define GDC *//p;d' $config`
-java_compiler=`sed '/#define JAVAC/s/#define JAVAC *//p;d' $config`
-txl_engine=`sed '/^#define TXL/s/#define TXL *//p;d' $config`
-ruby_engine=`sed '/^#define RUBY/s/#define RUBY *//p;d' $config`
-csharp_compiler=`sed '/#define GMCS/s/#define GMCS *//p;d' $config`
-
-function test_error
-{
-	exit 1;
-}
-
-#	split_objs=""
-#	if test $split_iters != "$gen_opt"; then
-#		n=0;
-#		while test $n -lt $split_iters; do
-#			part_root=${root}_`awk 'BEGIN {
-#				width = 0;
-#				high = '$split_iters' - 1;
-#				while ( high > 0 ) {
-#					width = width + 1;
-#					high = int(high / 10);
-#				}
-#				suffFormat = "%" width "." width "d\n";
-#				printf( suffFormat, '$n' );
-#				exit 0;
-#			}'`
-#			part_src=${part_root}.c
-#			part_bin=${part_root}.o
-#			echo "$compiler -c $cflags -o $part_bin $part_src"
-#			if ! $compiler -c $cflags -o $part_bin $part_src; then
-#				test_error;
-#			fi
-#			split_objs="$split_objs $part_bin"
-#			n=$((n+1))
-#		done
-#	fi
-
-function run_test()
-{
-	echo "$ragel $lang_opt $min_opt $gen_opt -o $code_src $test_case"
-	if ! $ragel $lang_opt $min_opt $gen_opt -o $code_src $test_case; then
-		test_error;
-	fi
-
-	out_args=""
-	[ $lang != java ] && out_args="-o ${binary}";
-    [ $lang == csharp ] && out_args="-out:${binary}";
-
-	# Ruby doesn't need to be compiled.
-	if [ $lang != ruby ]; then
-		echo "$compiler ${cflags} ${out_args} ${code_src}"
-		if ! $compiler ${cflags} ${out_args} ${code_src}; then
-			test_error;
-		fi
-	fi
-
-	if [ "$compile_only" != "true" ]; then
-		echo -n "running $root ... ";
-		
-		exec_cmd=./$binary
-		[ $lang = java ] && exec_cmd="java ${root}"
-		[ $lang = ruby ] && exec_cmd="ruby ${code_src}"
-		[ $lang = csharp ] && exec_cmd="mono ${exec_cmd}"
-
-		$exec_cmd 2>&1 > $output;
-		if diff $expected_out $output > /dev/null; then
-			echo "passed";
-		else
-			echo "FAILED";
-			test_error;
-		fi;
-	fi
-}
-
-for test_case; do
-	root=${test_case%.rl};
-
-	if ! [ -f "$test_case" ]; then
-		echo "runtests: not a file: $test_case"; >&2
-		exit 1;
-	fi
-
-	# Check if we should ignore the test case
-	ignore=`sed '/@IGNORE:/s/^.*: *//p;d' $test_case`
-    if [ "$ignore" = yes ]; then
-        continue;
-    fi
-
-	# If the generated flag is given make sure that the test case is generated.
-	is_generated=`sed '/@GENERATED:/s/^.*: *//p;d' $test_case`
-	if [ "$is_generated" = yes ] && [ "$allow_generated" != true ]; then
-		continue;
-	fi
-
-	expected_out=$root.exp;
-	sed '1,/_____OUTPUT_____/d;$d' $test_case > $expected_out
-
-	lang=`sed '/@LANG:/s/^.*: *//p;d' $test_case`
-	if [ -z "$lang" ]; then
-		echo "$test_case: language unset"; >&2
-		exit 1;
-	fi
-
-	case $lang in
-		c++)
-			lang_opt=-C;
-			codegen=../rlgen-cd/rlgen-cd;
-			code_suffix=cpp;
-			compiler=$cxx_compiler;
-			cflags="-pedantic -ansi -Wall -O3"
-		;;
-		d)
-			lang_opt=-D;
-			codegen=../rlgen-cd/rlgen-cd;
-			code_suffix=d;
-			compiler=$d_compiler;
-			cflags="-Wall -O3"
-		;;
-		c)
-			lang_opt=-C;
-			codegen=../rlgen-cd/rlgen-cd;
-			code_suffix=c;
-			compiler=$c_compiler;
-			cflags="-pedantic -ansi -Wall -O3"
-		;;
-		obj-c)
-			lang_opt=-C;
-			codegen=../rlgen-cd/rlgen-cd;
-			code_suffix=m;
-			compiler=$objc_compiler
-			cflags="-Wall -O3 -fno-strict-aliasing -lobjc"
-		;;
-		java)
-			lang_opt=-J;
-			codegen=../rlgen-java/rlgen-java;
-			code_suffix=java;
-			compiler=$java_compiler
-			cflags=""
-		;;
-		ruby)
-			lang_opt=-R;
-			codegen=../rlgen-ruby/rlgen-ruby;
-			code_suffix=rb;
-			compiler=$ruby_engine
-			cflags=""
-		;;
-        csharp)
-            lang_opt="-A";
-            codegen=../rlgen-csharp/rlgen-csharp;
-            code_suffix=cs;
-            compiler=$csharp_compiler
-            cflags=""
-        ;;
-		indep)
-			lang_opt="";
-
-			# If we have no txl engine then skip this test.
-			[ -z "$txl_engine" ] && continue
-			for lang in c d java ruby csharp; do
-				case $lang in 
-					c) lf="-C";;
-					d) lf="-D";;
-					java) lf="-J";;
-					ruby) lf="-R";;
-                    csharp) lf="-A";;
-				esac
-
-				echo "$langflags" | grep -e $lf >/dev/null || continue
-
-				targ=${root}_$lang.rl
-				echo "./langtrans_$lang.sh $test_case > $targ"
-				if ! ./langtrans_$lang.sh $test_case > $targ; then
-					test_error
-				fi
-				echo "./runtests -g $options $targ"
-				if !  ./runtests -g $options $targ; then
-					test_error
-				fi
-			done
-			continue;
-		;;
-		*)
-			echo "$test_case: unknown language type $lang" >&2
-			exit 1;
-		;;
-	esac
-
-	# Make sure that we are interested in the host language.
-	echo "$langflags" | grep -e $lang_opt >/dev/null || continue
-
-	code_src=$root.$code_suffix;
-	binary=$root.bin;
-	output=$root.out;
-
-	# If we have no compiler for the source program then skip it.
-	[ -z "$compiler" ] && continue
-
-	additional_cflags=`sed '/@CFLAGS:/s/^.*: *//p;d' $test_case`
-	[ -n "$additional_cflags" ] && cflags="$cflags $additional_cflags"
-
-	allow_minflags=`sed '/@ALLOW_MINFLAGS:/s/^.*: *//p;d' $test_case`
-	[ -z "$allow_minflags" ] && allow_minflags="-n -m -l -e"
-
-	case $lang in
-	c|c++|d)
-		# Using genflags, get the allowed gen flags from the test case. If the
-		# test case doesn't specify assume that all gen flags are allowed.
-		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
-		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1 -G0 -G1 -G2"
-
-		for min_opt in $minflags; do
-			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
-			for gen_opt in $genflags; do
-				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
-				run_test
-			done
-		done
-	;;
-
-	java) 
-		# Not interested in gen opt.
-		gen_opt=""
-		for min_opt in $minflags; do
-			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
-			run_test
-		done
-	;;
-
-	ruby) 
-		# Using genflags, get the allowed gen flags from the test case. If the
-		# test case doesn't specify assume that all gen flags are allowed.
-		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
-		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1"
-
-		for min_opt in $minflags; do
-			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
-
-			for gen_opt in $genflags; do
-				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
-				run_test
-			done
-		done
-	;;
-
-	csharp)
-		# Using genflags, get the allowed gen flags from the test case. If the
-		# test case doesn't specify assume that all gen flags are allowed.
-		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
-		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1 -G0 -G1"
-
-		for min_opt in $minflags; do
-			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
-			for gen_opt in $genflags; do
-				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
-				run_test
-			done
-		done
-	;;
-	esac
-
-done
diff --git a/test/runtests.in b/test/runtests.in
new file mode 100755
index 0000000..ee14f6a
--- /dev/null
+++ b/test/runtests.in
@@ -0,0 +1,320 @@
+#!/bin/bash
+
+#
+#   Copyright 2006 Adrian Thurston <thurs... at cs.queensu.ca>
+#
+
+#   This file is part of Ragel.
+#
+#   Ragel is free software; you can redistribute it and/or modify
+#   it under the terms of the GNU General Public License as published by
+#   the Free Software Foundation; either version 2 of the License, or
+#   (at your option) any later version.
+#
+#   Ragel is distributed in the hope that it will be useful,
+#   but WITHOUT ANY WARRANTY; without even the implied warranty of
+#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+#   GNU General Public License for more details.
+#
+#   You should have received a copy of the GNU General Public License
+#   along with Ragel; if not, write to the Free Software
+#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
+
+while getopts "gcnmleT:F:G:P:CDJRA" opt; do
+	case $opt in
+		T|F|G|P) 
+			genflags="$genflags -$opt$OPTARG"
+			options="$options -$opt$OPTARG"
+			;;
+		n|m|l|e) 
+			minflags="$minflags -$opt"
+			options="$options -$opt"
+			;;
+		c) 
+			compile_only="true"
+			options="$options -$opt"
+			;;
+		g) 
+			allow_generated="true"
+			;;
+		C|D|J|R|A) 
+			langflags="$langflags -$opt"
+			;;
+	esac
+done
+
+[ -z "$minflags" ] && minflags="-n -m -l -e"
+[ -z "$genflags" ] && genflags="-T0 -T1 -F0 -F1 -G0 -G1 -G2"
+[ -z "$langflags" ] && langflags="-C -D -J -R -A"
+
+shift $((OPTIND - 1));
+
+[ -z "$*" ] && set -- *.rl
+
+config=../common/config.h
+ragel=../ragel/ragel
+
+cxx_compiler=@CXX@
+c_compiler=@CC@
+objc_compiler=@GOBJC@
+d_compiler=@GDC@
+java_compiler=@JAVAC@
+txl_engine=@TXL@
+ruby_engine=@RUBY@
+csharp_compiler=@GMCS@
+
+function test_error
+{
+	exit 1;
+}
+
+#	split_objs=""
+#	if test $split_iters != "$gen_opt"; then
+#		n=0;
+#		while test $n -lt $split_iters; do
+#			part_root=${root}_`awk 'BEGIN {
+#				width = 0;
+#				high = '$split_iters' - 1;
+#				while ( high > 0 ) {
+#					width = width + 1;
+#					high = int(high / 10);
+#				}
+#				suffFormat = "%" width "." width "d\n";
+#				printf( suffFormat, '$n' );
+#				exit 0;
+#			}'`
+#			part_src=${part_root}.c
+#			part_bin=${part_root}.o
+#			echo "$compiler -c $cflags -o $part_bin $part_src"
+#			if ! $compiler -c $cflags -o $part_bin $part_src; then
+#				test_error;
+#			fi
+#			split_objs="$split_objs $part_bin"
+#			n=$((n+1))
+#		done
+#	fi
+
+function run_test()
+{
+	echo "$ragel $lang_opt $min_opt $gen_opt -o $code_src $test_case"
+	if ! $ragel $lang_opt $min_opt $gen_opt -o $code_src $test_case; then
+		test_error;
+	fi
+
+	out_args=""
+	[ $lang != java ] && out_args="-o ${binary}";
+    [ $lang == csharp ] && out_args="-out:${binary}";
+
+	# Ruby doesn't need to be compiled.
+	if [ $lang != ruby ]; then
+		echo "$compiler ${cflags} ${out_args} ${code_src}"
+		if ! $compiler ${cflags} ${out_args} ${code_src}; then
+			test_error;
+		fi
+	fi
+
+	if [ "$compile_only" != "true" ]; then
+		echo -n "running $root ... ";
+		
+		exec_cmd=./$binary
+		[ $lang = java ] && exec_cmd="java ${root}"
+		[ $lang = ruby ] && exec_cmd="ruby ${code_src}"
+		[ $lang = csharp ] && exec_cmd="mono ${exec_cmd}"
+
+		$exec_cmd 2>&1 > $output;
+		if diff $expected_out $output > /dev/null; then
+			echo "passed";
+		else
+			echo "FAILED";
+			test_error;
+		fi;
+	fi
+}
+
+for test_case; do
+	root=${test_case%.rl};
+
+	if ! [ -f "$test_case" ]; then
+		echo "runtests: not a file: $test_case"; >&2
+		exit 1;
+	fi
+
+	# Check if we should ignore the test case
+	ignore=`sed '/@IGNORE:/s/^.*: *//p;d' $test_case`
+    if [ "$ignore" = yes ]; then
+        continue;
+    fi
+
+	# If the generated flag is given make sure that the test case is generated.
+	is_generated=`sed '/@GENERATED:/s/^.*: *//p;d' $test_case`
+	if [ "$is_generated" = yes ] && [ "$allow_generated" != true ]; then
+		continue;
+	fi
+
+	expected_out=$root.exp;
+	sed '1,/_____OUTPUT_____/d;$d' $test_case > $expected_out
+
+	lang=`sed '/@LANG:/s/^.*: *//p;d' $test_case`
+	if [ -z "$lang" ]; then
+		echo "$test_case: language unset"; >&2
+		exit 1;
+	fi
+
+	case $lang in
+		c++)
+			lang_opt=-C;
+			codegen=../rlgen-cd/rlgen-cd;
+			code_suffix=cpp;
+			compiler=$cxx_compiler;
+			cflags="-pedantic -ansi -Wall -O3"
+		;;
+		d)
+			lang_opt=-D;
+			codegen=../rlgen-cd/rlgen-cd;
+			code_suffix=d;
+			compiler=$d_compiler;
+			cflags="-Wall -O3"
+		;;
+		c)
+			lang_opt=-C;
+			codegen=../rlgen-cd/rlgen-cd;
+			code_suffix=c;
+			compiler=$c_compiler;
+			cflags="-pedantic -ansi -Wall -O3"
+		;;
+		obj-c)
+			lang_opt=-C;
+			codegen=../rlgen-cd/rlgen-cd;
+			code_suffix=m;
+			compiler=$objc_compiler
+			cflags="-Wall -O3 -fno-strict-aliasing -lobjc"
+		;;
+		java)
+			lang_opt=-J;
+			codegen=../rlgen-java/rlgen-java;
+			code_suffix=java;
+			compiler=$java_compiler
+			cflags=""
+		;;
+		ruby)
+			lang_opt=-R;
+			codegen=../rlgen-ruby/rlgen-ruby;
+			code_suffix=rb;
+			compiler=$ruby_engine
+			cflags=""
+		;;
+        csharp)
+            lang_opt="-A";
+            codegen=../rlgen-csharp/rlgen-csharp;
+            code_suffix=cs;
+            compiler=$csharp_compiler
+            cflags=""
+        ;;
+		indep)
+			lang_opt="";
+
+			# If we have no txl engine then skip this test.
+			[ -z "$txl_engine" ] && continue
+			for lang in c d java ruby csharp; do
+				case $lang in 
+					c) lf="-C";;
+					d) lf="-D";;
+					java) lf="-J";;
+					ruby) lf="-R";;
+                    csharp) lf="-A";;
+				esac
+
+				echo "$langflags" | grep -e $lf >/dev/null || continue
+
+				targ=${root}_$lang.rl
+				echo "./langtrans_$lang.sh $test_case > $targ"
+				if ! ./langtrans_$lang.sh $test_case > $targ; then
+					test_error
+				fi
+				echo "./runtests -g $options $targ"
+				if !  ./runtests -g $options $targ; then
+					test_error
+				fi
+			done
+			continue;
+		;;
+		*)
+			echo "$test_case: unknown language type $lang" >&2
+			exit 1;
+		;;
+	esac
+
+	# Make sure that we are interested in the host language.
+	echo "$langflags" | grep -e $lang_opt >/dev/null || continue
+
+	code_src=$root.$code_suffix;
+	binary=$root.bin;
+	output=$root.out;
+
+	# If we have no compiler for the source program then skip it.
+	[ -z "$compiler" ] && continue
+
+	additional_cflags=`sed '/@CFLAGS:/s/^.*: *//p;d' $test_case`
+	[ -n "$additional_cflags" ] && cflags="$cflags $additional_cflags"
+
+	allow_minflags=`sed '/@ALLOW_MINFLAGS:/s/^.*: *//p;d' $test_case`
+	[ -z "$allow_minflags" ] && allow_minflags="-n -m -l -e"
+
+	case $lang in
+	c|c++|d)
+		# Using genflags, get the allowed gen flags from the test case. If the
+		# test case doesn't specify assume that all gen flags are allowed.
+		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
+		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1 -G0 -G1 -G2"
+
+		for min_opt in $minflags; do
+			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
+			for gen_opt in $genflags; do
+				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
+				run_test
+			done
+		done
+	;;
+
+	java) 
+		# Not interested in gen opt.
+		gen_opt=""
+		for min_opt in $minflags; do
+			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
+			run_test
+		done
+	;;
+
+	ruby) 
+		# Using genflags, get the allowed gen flags from the test case. If the
+		# test case doesn't specify assume that all gen flags are allowed.
+		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
+		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1"
+
+		for min_opt in $minflags; do
+			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
+
+			for gen_opt in $genflags; do
+				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
+				run_test
+			done
+		done
+	;;
+
+	csharp)
+		# Using genflags, get the allowed gen flags from the test case. If the
+		# test case doesn't specify assume that all gen flags are allowed.
+		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
+		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1 -G0 -G1"
+
+		for min_opt in $minflags; do
+			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
+			for gen_opt in $genflags; do
+				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
+				run_test
+			done
+		done
+	;;
+	esac
+
+done


From thurs... at cs.queensu.ca  Mon Oct  6 17:33:07 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Mon, 06 Oct 2008 13:33:07 -0400
Subject: [ragel-users] [PATCH 1/6] Don't use AC_DEFINE to pass the commands
 for the compilers to the runtest script.
In-Reply-To: <20081001143631.22980.46335.stgit@yamato>
References: <20081001143631.22980.46335.stgit@yamato>
Message-ID: <48EA4BD3.5010604@cs.queensu.ca>

Any reason? The effect of both approaches seems to be the same.

-Adrian

Diego 'Flameeyes' Petten wrote:
> Instead of parsing the config.h header from runtest, make it use
> proper autoconf by generating it at the end of the configure run.
> ---
> 
>  configure.in     |   28 +----
>  test/runtests    |  320 ------------------------------------------------------
>  test/runtests.in |  320 ++++++++++++++++++++++++++++++++++++++++++++++++++++++
>  3 files changed, 327 insertions(+), 341 deletions(-)
>  delete mode 100755 test/runtests
>  create mode 100755 test/runtests.in
> 
> diff --git a/configure.in b/configure.in
> index a257a70..cc25f2e 100644
> --- a/configure.in
> +++ b/configure.in
> @@ -31,10 +31,6 @@ AC_PROG_CC
>  AC_PROG_CXX
>  AC_CHECK_TOOL(AR, ar)
>  AC_PROG_RANLIB
> -AC_DEFINE_UNQUOTED(CC,$CC)
> -AC_DEFINE_UNQUOTED(CXX,$CXX)
> -AC_DEFINE_UNQUOTED(AR,$AR)
> -AC_DEFINE_UNQUOTED(RANLIB,$RANLIB)
>  
>  dnl Set test on c++ compiler.
>  AC_LANG_CPLUSPLUS
> @@ -75,9 +71,7 @@ fi # BUILD_PARSERS
>  
>  dnl Check for the D compiler
>  AC_CHECK_PROG(GDC, gdc, gdc)
> -if test -n "$GDC"; then
> -	AC_DEFINE_UNQUOTED(GDC,$GDC)
> -fi
> +AC_SUBST(GDC)
>  
>  dnl Check for the Objective-C compiler
>  AC_MSG_CHECKING([for the Objective-C compiler])
> @@ -88,7 +82,7 @@ GOBJC=""
>  if gcc -x objective-c conftest.m -o conftest.bin 2>/dev/null; then
>  	GOBJC="gcc -x objective-c"
>  	AC_MSG_RESULT([yes])
> -	AC_DEFINE_UNQUOTED(GOBJC,$GOBJC)
> +	AC_SUBST(GOBJC)
>  else
>  	AC_MSG_RESULT([no])
>  fi
> @@ -96,29 +90,21 @@ AC_SUBST(GOBJC)
>  
>  dnl Check for the Java compiler.
>  AC_CHECK_PROG(JAVAC, javac, javac)
> -if test -n "$JAVAC"; then
> -	AC_DEFINE_UNQUOTED(JAVAC,$JAVAC)
> -fi
> +AC_SUBST(JAVAC)
>  
>  dnl Check for TXL.
>  AC_CHECK_PROG(TXL, txl, txl)
> -if test -n "$TXL"; then
> -	AC_DEFINE_UNQUOTED(TXL,$TXL)
> -fi
> +AC_SUBST(TXL)
>  
>  dnl Check for Ruby.
>  AC_CHECK_PROG(RUBY, ruby, ruby)
> -if test -n "$RUBY"; then
> -	AC_DEFINE_UNQUOTED(RUBY,$RUBY)
> -fi
> +AC_SUBST(RUBY)
>  
>  dnl Check for the C# compiler.
>  AC_CHECK_PROG(GMCS, gmcs, gmcs)
> -if test -n "$GMCS"; then
> -	AC_DEFINE_UNQUOTED(GMCS,$GMCS)
> -fi
> +AC_SUBST(GMCS)
>  
>  dnl write output files
> -AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile)
> +AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile test/runtests)
>  
>  echo "configuration of ragel complete"
> diff --git a/test/runtests b/test/runtests
> deleted file mode 100755
> index a50c7c9..0000000
> --- a/test/runtests
> +++ /dev/null
> @@ -1,320 +0,0 @@
> -#!/bin/bash
> -
> -#
> -#   Copyright 2006 Adrian Thurston <thurs... at cs.queensu.ca>
> -#
> -
> -#   This file is part of Ragel.
> -#
> -#   Ragel is free software; you can redistribute it and/or modify
> -#   it under the terms of the GNU General Public License as published by
> -#   the Free Software Foundation; either version 2 of the License, or
> -#   (at your option) any later version.
> -#
> -#   Ragel is distributed in the hope that it will be useful,
> -#   but WITHOUT ANY WARRANTY; without even the implied warranty of
> -#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
> -#   GNU General Public License for more details.
> -#
> -#   You should have received a copy of the GNU General Public License
> -#   along with Ragel; if not, write to the Free Software
> -#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
> -
> -while getopts "gcnmleT:F:G:P:CDJRA" opt; do
> -	case $opt in
> -		T|F|G|P) 
> -			genflags="$genflags -$opt$OPTARG"
> -			options="$options -$opt$OPTARG"
> -			;;
> -		n|m|l|e) 
> -			minflags="$minflags -$opt"
> -			options="$options -$opt"
> -			;;
> -		c) 
> -			compile_only="true"
> -			options="$options -$opt"
> -			;;
> -		g) 
> -			allow_generated="true"
> -			;;
> -		C|D|J|R|A) 
> -			langflags="$langflags -$opt"
> -			;;
> -	esac
> -done
> -
> -[ -z "$minflags" ] && minflags="-n -m -l -e"
> -[ -z "$genflags" ] && genflags="-T0 -T1 -F0 -F1 -G0 -G1 -G2"
> -[ -z "$langflags" ] && langflags="-C -D -J -R -A"
> -
> -shift $((OPTIND - 1));
> -
> -[ -z "$*" ] && set -- *.rl
> -
> -config=../common/config.h
> -ragel=../ragel/ragel
> -
> -cxx_compiler=`sed '/^#define CXX/s/#define CXX *//p;d' $config`
> -c_compiler=`sed '/^#define CC/s/#define CC *//p;d' $config`
> -objc_compiler=`sed '/^#define GOBJC/s/#define GOBJC *//p;d' $config`
> -d_compiler=`sed '/^#define GDC/s/#define GDC *//p;d' $config`
> -java_compiler=`sed '/#define JAVAC/s/#define JAVAC *//p;d' $config`
> -txl_engine=`sed '/^#define TXL/s/#define TXL *//p;d' $config`
> -ruby_engine=`sed '/^#define RUBY/s/#define RUBY *//p;d' $config`
> -csharp_compiler=`sed '/#define GMCS/s/#define GMCS *//p;d' $config`
> -
> -function test_error
> -{
> -	exit 1;
> -}
> -
> -#	split_objs=""
> -#	if test $split_iters != "$gen_opt"; then
> -#		n=0;
> -#		while test $n -lt $split_iters; do
> -#			part_root=${root}_`awk 'BEGIN {
> -#				width = 0;
> -#				high = '$split_iters' - 1;
> -#				while ( high > 0 ) {
> -#					width = width + 1;
> -#					high = int(high / 10);
> -#				}
> -#				suffFormat = "%" width "." width "d\n";
> -#				printf( suffFormat, '$n' );
> -#				exit 0;
> -#			}'`
> -#			part_src=${part_root}.c
> -#			part_bin=${part_root}.o
> -#			echo "$compiler -c $cflags -o $part_bin $part_src"
> -#			if ! $compiler -c $cflags -o $part_bin $part_src; then
> -#				test_error;
> -#			fi
> -#			split_objs="$split_objs $part_bin"
> -#			n=$((n+1))
> -#		done
> -#	fi
> -
> -function run_test()
> -{
> -	echo "$ragel $lang_opt $min_opt $gen_opt -o $code_src $test_case"
> -	if ! $ragel $lang_opt $min_opt $gen_opt -o $code_src $test_case; then
> -		test_error;
> -	fi
> -
> -	out_args=""
> -	[ $lang != java ] && out_args="-o ${binary}";
> -    [ $lang == csharp ] && out_args="-out:${binary}";
> -
> -	# Ruby doesn't need to be compiled.
> -	if [ $lang != ruby ]; then
> -		echo "$compiler ${cflags} ${out_args} ${code_src}"
> -		if ! $compiler ${cflags} ${out_args} ${code_src}; then
> -			test_error;
> -		fi
> -	fi
> -
> -	if [ "$compile_only" != "true" ]; then
> -		echo -n "running $root ... ";
> -		
> -		exec_cmd=./$binary
> -		[ $lang = java ] && exec_cmd="java ${root}"
> -		[ $lang = ruby ] && exec_cmd="ruby ${code_src}"
> -		[ $lang = csharp ] && exec_cmd="mono ${exec_cmd}"
> -
> -		$exec_cmd 2>&1 > $output;
> -		if diff $expected_out $output > /dev/null; then
> -			echo "passed";
> -		else
> -			echo "FAILED";
> -			test_error;
> -		fi;
> -	fi
> -}
> -
> -for test_case; do
> -	root=${test_case%.rl};
> -
> -	if ! [ -f "$test_case" ]; then
> -		echo "runtests: not a file: $test_case"; >&2
> -		exit 1;
> -	fi
> -
> -	# Check if we should ignore the test case
> -	ignore=`sed '/@IGNORE:/s/^.*: *//p;d' $test_case`
> -    if [ "$ignore" = yes ]; then
> -        continue;
> -    fi
> -
> -	# If the generated flag is given make sure that the test case is generated.
> -	is_generated=`sed '/@GENERATED:/s/^.*: *//p;d' $test_case`
> -	if [ "$is_generated" = yes ] && [ "$allow_generated" != true ]; then
> -		continue;
> -	fi
> -
> -	expected_out=$root.exp;
> -	sed '1,/_____OUTPUT_____/d;$d' $test_case > $expected_out
> -
> -	lang=`sed '/@LANG:/s/^.*: *//p;d' $test_case`
> -	if [ -z "$lang" ]; then
> -		echo "$test_case: language unset"; >&2
> -		exit 1;
> -	fi
> -
> -	case $lang in
> -		c++)
> -			lang_opt=-C;
> -			codegen=../rlgen-cd/rlgen-cd;
> -			code_suffix=cpp;
> -			compiler=$cxx_compiler;
> -			cflags="-pedantic -ansi -Wall -O3"
> -		;;
> -		d)
> -			lang_opt=-D;
> -			codegen=../rlgen-cd/rlgen-cd;
> -			code_suffix=d;
> -			compiler=$d_compiler;
> -			cflags="-Wall -O3"
> -		;;
> -		c)
> -			lang_opt=-C;
> -			codegen=../rlgen-cd/rlgen-cd;
> -			code_suffix=c;
> -			compiler=$c_compiler;
> -			cflags="-pedantic -ansi -Wall -O3"
> -		;;
> -		obj-c)
> -			lang_opt=-C;
> -			codegen=../rlgen-cd/rlgen-cd;
> -			code_suffix=m;
> -			compiler=$objc_compiler
> -			cflags="-Wall -O3 -fno-strict-aliasing -lobjc"
> -		;;
> -		java)
> -			lang_opt=-J;
> -			codegen=../rlgen-java/rlgen-java;
> -			code_suffix=java;
> -			compiler=$java_compiler
> -			cflags=""
> -		;;
> -		ruby)
> -			lang_opt=-R;
> -			codegen=../rlgen-ruby/rlgen-ruby;
> -			code_suffix=rb;
> -			compiler=$ruby_engine
> -			cflags=""
> -		;;
> -        csharp)
> -            lang_opt="-A";
> -            codegen=../rlgen-csharp/rlgen-csharp;
> -            code_suffix=cs;
> -            compiler=$csharp_compiler
> -            cflags=""
> -        ;;
> -		indep)
> -			lang_opt="";
> -
> -			# If we have no txl engine then skip this test.
> -			[ -z "$txl_engine" ] && continue
> -			for lang in c d java ruby csharp; do
> -				case $lang in 
> -					c) lf="-C";;
> -					d) lf="-D";;
> -					java) lf="-J";;
> -					ruby) lf="-R";;
> -                    csharp) lf="-A";;
> -				esac
> -
> -				echo "$langflags" | grep -e $lf >/dev/null || continue
> -
> -				targ=${root}_$lang.rl
> -				echo "./langtrans_$lang.sh $test_case > $targ"
> -				if ! ./langtrans_$lang.sh $test_case > $targ; then
> -					test_error
> -				fi
> -				echo "./runtests -g $options $targ"
> -				if !  ./runtests -g $options $targ; then
> -					test_error
> -				fi
> -			done
> -			continue;
> -		;;
> -		*)
> -			echo "$test_case: unknown language type $lang" >&2
> -			exit 1;
> -		;;
> -	esac
> -
> -	# Make sure that we are interested in the host language.
> -	echo "$langflags" | grep -e $lang_opt >/dev/null || continue
> -
> -	code_src=$root.$code_suffix;
> -	binary=$root.bin;
> -	output=$root.out;
> -
> -	# If we have no compiler for the source program then skip it.
> -	[ -z "$compiler" ] && continue
> -
> -	additional_cflags=`sed '/@CFLAGS:/s/^.*: *//p;d' $test_case`
> -	[ -n "$additional_cflags" ] && cflags="$cflags $additional_cflags"
> -
> -	allow_minflags=`sed '/@ALLOW_MINFLAGS:/s/^.*: *//p;d' $test_case`
> -	[ -z "$allow_minflags" ] && allow_minflags="-n -m -l -e"
> -
> -	case $lang in
> -	c|c++|d)
> -		# Using genflags, get the allowed gen flags from the test case. If the
> -		# test case doesn't specify assume that all gen flags are allowed.
> -		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
> -		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1 -G0 -G1 -G2"
> -
> -		for min_opt in $minflags; do
> -			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
> -			for gen_opt in $genflags; do
> -				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
> -				run_test
> -			done
> -		done
> -	;;
> -
> -	java) 
> -		# Not interested in gen opt.
> -		gen_opt=""
> -		for min_opt in $minflags; do
> -			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
> -			run_test
> -		done
> -	;;
> -
> -	ruby) 
> -		# Using genflags, get the allowed gen flags from the test case. If the
> -		# test case doesn't specify assume that all gen flags are allowed.
> -		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
> -		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1"
> -
> -		for min_opt in $minflags; do
> -			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
> -
> -			for gen_opt in $genflags; do
> -				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
> -				run_test
> -			done
> -		done
> -	;;
> -
> -	csharp)
> -		# Using genflags, get the allowed gen flags from the test case. If the
> -		# test case doesn't specify assume that all gen flags are allowed.
> -		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
> -		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1 -G0 -G1"
> -
> -		for min_opt in $minflags; do
> -			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
> -			for gen_opt in $genflags; do
> -				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
> -				run_test
> -			done
> -		done
> -	;;
> -	esac
> -
> -done
> diff --git a/test/runtests.in b/test/runtests.in
> new file mode 100755
> index 0000000..ee14f6a
> --- /dev/null
> +++ b/test/runtests.in
> @@ -0,0 +1,320 @@
> +#!/bin/bash
> +
> +#
> +#   Copyright 2006 Adrian Thurston <thurs... at cs.queensu.ca>
> +#
> +
> +#   This file is part of Ragel.
> +#
> +#   Ragel is free software; you can redistribute it and/or modify
> +#   it under the terms of the GNU General Public License as published by
> +#   the Free Software Foundation; either version 2 of the License, or
> +#   (at your option) any later version.
> +#
> +#   Ragel is distributed in the hope that it will be useful,
> +#   but WITHOUT ANY WARRANTY; without even the implied warranty of
> +#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
> +#   GNU General Public License for more details.
> +#
> +#   You should have received a copy of the GNU General Public License
> +#   along with Ragel; if not, write to the Free Software
> +#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
> +
> +while getopts "gcnmleT:F:G:P:CDJRA" opt; do
> +	case $opt in
> +		T|F|G|P) 
> +			genflags="$genflags -$opt$OPTARG"
> +			options="$options -$opt$OPTARG"
> +			;;
> +		n|m|l|e) 
> +			minflags="$minflags -$opt"
> +			options="$options -$opt"
> +			;;
> +		c) 
> +			compile_only="true"
> +			options="$options -$opt"
> +			;;
> +		g) 
> +			allow_generated="true"
> +			;;
> +		C|D|J|R|A) 
> +			langflags="$langflags -$opt"
> +			;;
> +	esac
> +done
> +
> +[ -z "$minflags" ] && minflags="-n -m -l -e"
> +[ -z "$genflags" ] && genflags="-T0 -T1 -F0 -F1 -G0 -G1 -G2"
> +[ -z "$langflags" ] && langflags="-C -D -J -R -A"
> +
> +shift $((OPTIND - 1));
> +
> +[ -z "$*" ] && set -- *.rl
> +
> +config=../common/config.h
> +ragel=../ragel/ragel
> +
> +cxx_compiler=@CXX@
> +c_compiler=@CC@
> +objc_compiler=@GOBJC@
> +d_compiler=@GDC@
> +java_compiler=@JAVAC@
> +txl_engine=@TXL@
> +ruby_engine=@RUBY@
> +csharp_compiler=@GMCS@
> +
> +function test_error
> +{
> +	exit 1;
> +}
> +
> +#	split_objs=""
> +#	if test $split_iters != "$gen_opt"; then
> +#		n=0;
> +#		while test $n -lt $split_iters; do
> +#			part_root=${root}_`awk 'BEGIN {
> +#				width = 0;
> +#				high = '$split_iters' - 1;
> +#				while ( high > 0 ) {
> +#					width = width + 1;
> +#					high = int(high / 10);
> +#				}
> +#				suffFormat = "%" width "." width "d\n";
> +#				printf( suffFormat, '$n' );
> +#				exit 0;
> +#			}'`
> +#			part_src=${part_root}.c
> +#			part_bin=${part_root}.o
> +#			echo "$compiler -c $cflags -o $part_bin $part_src"
> +#			if ! $compiler -c $cflags -o $part_bin $part_src; then
> +#				test_error;
> +#			fi
> +#			split_objs="$split_objs $part_bin"
> +#			n=$((n+1))
> +#		done
> +#	fi
> +
> +function run_test()
> +{
> +	echo "$ragel $lang_opt $min_opt $gen_opt -o $code_src $test_case"
> +	if ! $ragel $lang_opt $min_opt $gen_opt -o $code_src $test_case; then
> +		test_error;
> +	fi
> +
> +	out_args=""
> +	[ $lang != java ] && out_args="-o ${binary}";
> +    [ $lang == csharp ] && out_args="-out:${binary}";
> +
> +	# Ruby doesn't need to be compiled.
> +	if [ $lang != ruby ]; then
> +		echo "$compiler ${cflags} ${out_args} ${code_src}"
> +		if ! $compiler ${cflags} ${out_args} ${code_src}; then
> +			test_error;
> +		fi
> +	fi
> +
> +	if [ "$compile_only" != "true" ]; then
> +		echo -n "running $root ... ";
> +		
> +		exec_cmd=./$binary
> +		[ $lang = java ] && exec_cmd="java ${root}"
> +		[ $lang = ruby ] && exec_cmd="ruby ${code_src}"
> +		[ $lang = csharp ] && exec_cmd="mono ${exec_cmd}"
> +
> +		$exec_cmd 2>&1 > $output;
> +		if diff $expected_out $output > /dev/null; then
> +			echo "passed";
> +		else
> +			echo "FAILED";
> +			test_error;
> +		fi;
> +	fi
> +}
> +
> +for test_case; do
> +	root=${test_case%.rl};
> +
> +	if ! [ -f "$test_case" ]; then
> +		echo "runtests: not a file: $test_case"; >&2
> +		exit 1;
> +	fi
> +
> +	# Check if we should ignore the test case
> +	ignore=`sed '/@IGNORE:/s/^.*: *//p;d' $test_case`
> +    if [ "$ignore" = yes ]; then
> +        continue;
> +    fi
> +
> +	# If the generated flag is given make sure that the test case is generated.
> +	is_generated=`sed '/@GENERATED:/s/^.*: *//p;d' $test_case`
> +	if [ "$is_generated" = yes ] && [ "$allow_generated" != true ]; then
> +		continue;
> +	fi
> +
> +	expected_out=$root.exp;
> +	sed '1,/_____OUTPUT_____/d;$d' $test_case > $expected_out
> +
> +	lang=`sed '/@LANG:/s/^.*: *//p;d' $test_case`
> +	if [ -z "$lang" ]; then
> +		echo "$test_case: language unset"; >&2
> +		exit 1;
> +	fi
> +
> +	case $lang in
> +		c++)
> +			lang_opt=-C;
> +			codegen=../rlgen-cd/rlgen-cd;
> +			code_suffix=cpp;
> +			compiler=$cxx_compiler;
> +			cflags="-pedantic -ansi -Wall -O3"
> +		;;
> +		d)
> +			lang_opt=-D;
> +			codegen=../rlgen-cd/rlgen-cd;
> +			code_suffix=d;
> +			compiler=$d_compiler;
> +			cflags="-Wall -O3"
> +		;;
> +		c)
> +			lang_opt=-C;
> +			codegen=../rlgen-cd/rlgen-cd;
> +			code_suffix=c;
> +			compiler=$c_compiler;
> +			cflags="-pedantic -ansi -Wall -O3"
> +		;;
> +		obj-c)
> +			lang_opt=-C;
> +			codegen=../rlgen-cd/rlgen-cd;
> +			code_suffix=m;
> +			compiler=$objc_compiler
> +			cflags="-Wall -O3 -fno-strict-aliasing -lobjc"
> +		;;
> +		java)
> +			lang_opt=-J;
> +			codegen=../rlgen-java/rlgen-java;
> +			code_suffix=java;
> +			compiler=$java_compiler
> +			cflags=""
> +		;;
> +		ruby)
> +			lang_opt=-R;
> +			codegen=../rlgen-ruby/rlgen-ruby;
> +			code_suffix=rb;
> +			compiler=$ruby_engine
> +			cflags=""
> +		;;
> +        csharp)
> +            lang_opt="-A";
> +            codegen=../rlgen-csharp/rlgen-csharp;
> +            code_suffix=cs;
> +            compiler=$csharp_compiler
> +            cflags=""
> +        ;;
> +		indep)
> +			lang_opt="";
> +
> +			# If we have no txl engine then skip this test.
> +			[ -z "$txl_engine" ] && continue
> +			for lang in c d java ruby csharp; do
> +				case $lang in 
> +					c) lf="-C";;
> +					d) lf="-D";;
> +					java) lf="-J";;
> +					ruby) lf="-R";;
> +                    csharp) lf="-A";;
> +				esac
> +
> +				echo "$langflags" | grep -e $lf >/dev/null || continue
> +
> +				targ=${root}_$lang.rl
> +				echo "./langtrans_$lang.sh $test_case > $targ"
> +				if ! ./langtrans_$lang.sh $test_case > $targ; then
> +					test_error
> +				fi
> +				echo "./runtests -g $options $targ"
> +				if !  ./runtests -g $options $targ; then
> +					test_error
> +				fi
> +			done
> +			continue;
> +		;;
> +		*)
> +			echo "$test_case: unknown language type $lang" >&2
> +			exit 1;
> +		;;
> +	esac
> +
> +	# Make sure that we are interested in the host language.
> +	echo "$langflags" | grep -e $lang_opt >/dev/null || continue
> +
> +	code_src=$root.$code_suffix;
> +	binary=$root.bin;
> +	output=$root.out;
> +
> +	# If we have no compiler for the source program then skip it.
> +	[ -z "$compiler" ] && continue
> +
> +	additional_cflags=`sed '/@CFLAGS:/s/^.*: *//p;d' $test_case`
> +	[ -n "$additional_cflags" ] && cflags="$cflags $additional_cflags"
> +
> +	allow_minflags=`sed '/@ALLOW_MINFLAGS:/s/^.*: *//p;d' $test_case`
> +	[ -z "$allow_minflags" ] && allow_minflags="-n -m -l -e"
> +
> +	case $lang in
> +	c|c++|d)
> +		# Using genflags, get the allowed gen flags from the test case. If the
> +		# test case doesn't specify assume that all gen flags are allowed.
> +		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
> +		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1 -G0 -G1 -G2"
> +
> +		for min_opt in $minflags; do
> +			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
> +			for gen_opt in $genflags; do
> +				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
> +				run_test
> +			done
> +		done
> +	;;
> +
> +	java) 
> +		# Not interested in gen opt.
> +		gen_opt=""
> +		for min_opt in $minflags; do
> +			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
> +			run_test
> +		done
> +	;;
> +
> +	ruby) 
> +		# Using genflags, get the allowed gen flags from the test case. If the
> +		# test case doesn't specify assume that all gen flags are allowed.
> +		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
> +		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1"
> +
> +		for min_opt in $minflags; do
> +			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
> +
> +			for gen_opt in $genflags; do
> +				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
> +				run_test
> +			done
> +		done
> +	;;
> +
> +	csharp)
> +		# Using genflags, get the allowed gen flags from the test case. If the
> +		# test case doesn't specify assume that all gen flags are allowed.
> +		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
> +		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1 -G0 -G1"
> +
> +		for min_opt in $minflags; do
> +			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
> +			for gen_opt in $genflags; do
> +				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
> +				run_test
> +			done
> +		done
> +	;;
> +	esac
> +
> +done
> 
> 
> 


From flamee... at gmail.com  Wed Oct  1 14:37:30 2008
From: flamee... at gmail.com (Diego 'Flameeyes' =?utf-8?q?Petten=C3=B2?=)
Date: Wed, 01 Oct 2008 16:37:30 +0200
Subject: [PATCH 4/6] Remove need for version.mk file.
Message-ID: <20081001143729.22980.85186.stgit@yamato>

Use autoconf to generate version.tex and the man pages, instead of
using Makefile and version.mk. Also define PACKAGE_PUBDATE and
PACKAGE_VERSION through autoconf/autoheader.
---

 Makefile.in              |    2 --
 common/Makefile.in       |    6 +-----
 configure.in             |   12 ++++++++----
 doc/Makefile.in          |   14 ++------------
 doc/ragel.1.in           |    2 +-
 doc/rlgen-cd.1.in        |    2 +-
 doc/rlgen-dot.1.in       |    2 +-
 doc/rlgen-java.1.in      |    2 +-
 doc/rlgen-ruby.1.in      |    2 +-
 doc/version.tex.in       |    2 ++
 ragel/main.cpp           |    2 +-
 ragel/parsedata.cpp      |    4 ++--
 redfsm/Makefile.in       |    2 --
 redfsm/xmlparse.kl       |    2 +-
 rlgen-cd/Makefile.in     |    2 --
 rlgen-csharp/Makefile.in |    2 --
 rlgen-csharp/main.cpp    |    2 +-
 rlgen-dot/Makefile.in    |    2 --
 rlgen-java/Makefile.in   |    2 --
 rlgen-ruby/Makefile.in   |    2 --
 version.mk               |    2 --
 21 files changed, 23 insertions(+), 47 deletions(-)
 create mode 100644 doc/version.tex.in
 delete mode 100644 version.mk

diff --git a/Makefile.in b/Makefile.in
index 2666c48..4619bb5 100644
--- a/Makefile.in
+++ b/Makefile.in
@@ -27,8 +27,6 @@ ALL_SUBDIRS = $(BUILD_COMMON) $(BUILD_SUBDIRS) test examples doc
 # Programs
 CXX = @CXX@
 
-# Get the version info.
-include version.mk
 
 # build targets
 all: $(BUILD_SUBDIRS)
diff --git a/common/Makefile.in b/common/Makefile.in
index 112e59c..e79d6a4 100644
--- a/common/Makefile.in
+++ b/common/Makefile.in
@@ -40,8 +40,6 @@ RANLIB = @RANLIB@
 OBJS = $(CC_SRCS:%.cpp=%.o)
 DEPS = $(CC_SRCS:%.cpp=.%.d)
 
-# Get the version info.
-include ../version.mk
 
 # rules
 
@@ -51,9 +49,7 @@ common.a: $(GEN_SRC) $(OBJS)
 	$(AR) -cr $@ $(OBJS) 
 	$(RANLIB) $@
 
-version.h: ../version.mk
-	echo '#define VERSION "$(VERSION)"' > version.h
-	echo '#define PUBDATE "$(PUBDATE)"' >> version.h
+version.h:
 	echo '#define PREFIX "$(prefix)"' >> version.h
 
 %.o: %.cpp
diff --git a/configure.in b/configure.in
index 3995551..85e93b0 100644
--- a/configure.in
+++ b/configure.in
@@ -16,11 +16,15 @@ dnl   GNU General Public License for more details.
 dnl   
 dnl   You should have received a copy of the GNU General Public License
 dnl   along with Ragel; if not, write to the Free Software
-dnl   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-  
-AC_INIT(ragel/main.cpp)
+dnl   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+
+AC_INIT(ragel/main.cpp, 6.3)
 AC_CONFIG_HEADER(common/config.h)
 
+PACKAGE_PUBDATE="August 2008"
+AC_SUBST(PACKAGE_PUBDATE)
+AC_DEFINE_UNQUOTED([PACKAGE_PUBDATE], ["$PACKAGE_PUBDATE"], [Package publication date])
+
 dnl You need to enable this unless the generated files are included
 dnl and don't need to be built.
 AC_ARG_ENABLE([parsers],
@@ -107,6 +111,6 @@ AC_CHECK_PROG(GMCS, gmcs, gmcs)
 AC_SUBST(GMCS)
 
 dnl write output files
-AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile test/runtests)
+AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile test/runtests doc/ragel.1 doc/rlgen-cd.1 doc/rlgen-java.1 doc/rlgen-ruby.1 doc/rlgen-dot.1 doc/version.tex)
 
 echo "configuration of ragel complete"
diff --git a/doc/Makefile.in b/doc/Makefile.in
index a6ff456..6178f0d 100644
--- a/doc/Makefile.in
+++ b/doc/Makefile.in
@@ -24,8 +24,6 @@ INPUT = version.tex ragel-guide.tex
 FIGURES = $(wildcard *.fig)
 PDFFIGS = $(FIGURES:%.fig=%.pdf)
 
-# Get the version info.
-include ../version.mk
 
 # Installation locations.
 PACKAGE     = ragel
@@ -49,19 +47,11 @@ ragel-guide.pdf: $(PDFFIGS) $(INPUT)
 	pdflatex -interaction=nonstopmode $< >/dev/null
 	pdflatex -interaction=nonstopmode $< >/dev/null
 
-version.tex: ../version.mk
-	echo '|def|version{$(VERSION)}' | tr '|' '\\' > version.tex
-	echo '|def|pubdate{$(PUBDATE)}' | tr '|' '\\' >> version.tex
-
-%.1: %.1.in ../version.mk
-	cat $< | sed 's/@PUBDATE@/$(PUBDATE)/' \
-		| sed 's/@VERSION@/$(VERSION)/' > $@
-
 clean:
-	rm -f $(MANPAGES) *.bak *.aux *.dvi *.log *.toc *.pdf
+	rm -f *.bak *.aux *.dvi *.log *.toc *.pdf
 
 distclean: clean
-	rm -f Makefile
+	rm -f Makefile $(MANPAGES) version.tex
 
 man: $(MANPAGES)
 
diff --git a/doc/ragel.1.in b/doc/ragel.1.in
index 68142e2..66753cc 100644
--- a/doc/ragel.1.in
+++ b/doc/ragel.1.in
@@ -21,7 +21,7 @@
 .\"   Process this file with
 .\"   groff -man -Tascii ragel.1
 .\"
-.TH RAGEL 1 "@PUBDATE@" "Ragel @VERSION@" "Ragel State Machine Compiler"
+.TH RAGEL 1 "@PACKAGE_PUBDATE@" "Ragel @PACKAGE_VERSION@" "Ragel State Machine Compiler"
 .SH NAME
 ragel \- compile regular languages into executable state machines 
 .SH SYNOPSIS
diff --git a/doc/rlgen-cd.1.in b/doc/rlgen-cd.1.in
index 33cc088..0d0087f 100644
--- a/doc/rlgen-cd.1.in
+++ b/doc/rlgen-cd.1.in
@@ -21,7 +21,7 @@
 .\"   Process this file with
 .\"   groff -man -Tascii rlgen-cd.1
 .\"
-.TH RLGEN-CD 1 "@PUBDATE@" "Ragel @VERSION@" "Ragel State Machine Compiler"
+.TH RLGEN-CD 1 "@PACKAGE_PUBDATE@" "Ragel @PACKAGE_VERSION@" "Ragel State Machine Compiler"
 .SH NAME
 rlgen-cd \- code generator for Ragel State Machine Compiler
 .SH SYNOPSIS
diff --git a/doc/rlgen-dot.1.in b/doc/rlgen-dot.1.in
index 5c24091..c7a7cbe 100644
--- a/doc/rlgen-dot.1.in
+++ b/doc/rlgen-dot.1.in
@@ -21,7 +21,7 @@
 .\"   Process this file with
 .\"   groff -man -Tascii rlgen-dot.1
 .\"
-.TH RLGEN-DOT 1 "@PUBDATE@" "Ragel @VERSION@" "Ragel State Machine Compiler"
+.TH RLGEN-DOT 1 "@PACKAGE_PUBDATE@" "Ragel @PACKAGE_VERSION@" "Ragel State Machine Compiler"
 .SH NAME
 rlgen-dot \- Dotfile generator for Ragel State Machine Compiler
 .SH SYNOPSIS
diff --git a/doc/rlgen-java.1.in b/doc/rlgen-java.1.in
index c143d15..5528a2f 100644
--- a/doc/rlgen-java.1.in
+++ b/doc/rlgen-java.1.in
@@ -21,7 +21,7 @@
 .\"   Process this file with
 .\"   groff -man -Tascii rlgen-java.1
 .\"
-.TH RLGEN-JAVA 1 "@PUBDATE@" "Ragel @VERSION@" "Ragel State Machine Compiler"
+.TH RLGEN-JAVA 1 "@PACKAGE_PUBDATE@" "Ragel @PACKAGE_VERSION@" "Ragel State Machine Compiler"
 .SH NAME
 rlgen-java \- code generator for Ragel State Machine Compiler
 .SH SYNOPSIS
diff --git a/doc/rlgen-ruby.1.in b/doc/rlgen-ruby.1.in
index 9aecfe2..08f1dce 100644
--- a/doc/rlgen-ruby.1.in
+++ b/doc/rlgen-ruby.1.in
@@ -21,7 +21,7 @@
 .\"   Process this file with
 .\"   groff -man -Tascii rlgen-ruby.1
 .\"
-.TH RLGEN-RUBY 1 "@PUBDATE@" "Ragel @VERSION@" "Ragel State Machine Compiler"
+.TH RLGEN-RUBY 1 "@PACKAGE_PUBDATE@" "Ragel @PACKAGE_VERSION@" "Ragel State Machine Compiler"
 .SH NAME
 rlgen-ruby \- code generator for Ragel State Machine Compiler
 .SH SYNOPSIS
diff --git a/doc/version.tex.in b/doc/version.tex.in
new file mode 100644
index 0000000..3c0fc35
--- /dev/null
+++ b/doc/version.tex.in
@@ -0,0 +1,2 @@
+\def\version{@PACKAGE_VERSION@}
+\def\pubdate{@PACKAGE_PUBDATE@}
diff --git a/ragel/main.cpp b/ragel/main.cpp
index 1e7ccc0..56095db 100644
--- a/ragel/main.cpp
+++ b/ragel/main.cpp
@@ -153,7 +153,7 @@ void usage()
 /* Print version information and exit. */
 void version()
 {
-	cout << "Ragel State Machine Compiler version " VERSION << " " PUBDATE << endl <<
+	cout << "Ragel State Machine Compiler version " PACKAGE_VERSION " " PACKAGE_PUBDATE << endl <<
 			"Copyright (c) 2001-2007 by Adrian Thurston" << endl;
 	exit(0);
 }
diff --git a/ragel/parsedata.cpp b/ragel/parsedata.cpp
index 73f52c6..3985b2f 100644
--- a/ragel/parsedata.cpp
+++ b/ragel/parsedata.cpp
@@ -1482,7 +1482,7 @@ void writeMachines( std::ostream &out, std::string hostData,
 		}
 
 		if ( gblErrorCount == 0 ) {
-			out << "<ragel version=\"" VERSION "\" filename=\"" << inputFileName << "\"";
+			out << "<ragel version=\"" PACKAGE_VERSION "\" filename=\"" << inputFileName << "\"";
 			writeLanguage( out );
 			out << ">\n";
 			for ( ParserDict::Iter parser = parserDict; parser.lte(); parser++ ) {
@@ -1523,7 +1523,7 @@ void writeMachines( std::ostream &out, std::string hostData,
 			/* Section/Machine to emit was found. Prepare and emit it. */
 			parseData->prepareMachineGen( graphDictEl );
 			if ( gblErrorCount == 0 ) {
-				out << "<ragel version=\"" VERSION "\" filename=\"" << inputFileName << "\"";
+				out << "<ragel version=\"" PACKAGE_VERSION "\" filename=\"" << inputFileName << "\"";
 				writeLanguage( out );
 				out << ">\n";
 				parseData->generateXML( out );
diff --git a/redfsm/Makefile.in b/redfsm/Makefile.in
index 951de79..8e67233 100644
--- a/redfsm/Makefile.in
+++ b/redfsm/Makefile.in
@@ -41,8 +41,6 @@ RANLIB = @RANLIB@
 OBJS = $(CC_SRCS:%.cpp=%.o)
 DEPS = $(CC_SRCS:%.cpp=.%.d)
 
-# Get the version info.
-include ../version.mk
 
 # Rules.
 all: redfsm.a
diff --git a/redfsm/xmlparse.kl b/redfsm/xmlparse.kl
index e725fcc..6ce677a 100644
--- a/redfsm/xmlparse.kl
+++ b/redfsm/xmlparse.kl
@@ -108,7 +108,7 @@ tag_ragel_head: TAG_ragel
 		Attribute *versionAttr = $1->tag->findAttr( "version" );
 		if ( versionAttr == 0 )
 			error($1->loc) << "tag <ragel> requires a version attribute" << endp;
-		if ( strcmp( versionAttr->value, VERSION ) != 0 )
+		if ( strcmp( versionAttr->value, PACKAGE_VERSION ) != 0 )
 			error($1->loc) << "version mismatch between frontend and backend" << endp;
 
 		/* Check for file name attribute. */
diff --git a/rlgen-cd/Makefile.in b/rlgen-cd/Makefile.in
index 49031e3..7b06285 100644
--- a/rlgen-cd/Makefile.in
+++ b/rlgen-cd/Makefile.in
@@ -45,8 +45,6 @@ RANLIB = @RANLIB@
 OBJS = $(CC_SRCS:%.cpp=%.o)
 DEPS = $(CC_SRCS:%.cpp=.%.d)
 
-# Get the version info.
-include ../version.mk
 
 # Rules.
 all: rlgen-cd.a
diff --git a/rlgen-csharp/Makefile.in b/rlgen-csharp/Makefile.in
index fa57e49..fc5380f 100644
--- a/rlgen-csharp/Makefile.in
+++ b/rlgen-csharp/Makefile.in
@@ -45,8 +45,6 @@ RANLIB = @RANLIB@
 OBJS = $(CC_SRCS:%.cpp=%.o)
 DEPS = $(CC_SRCS:%.cpp=.%.d)
 
-# Get the version info.
-include ../version.mk
 
 # Rules.
 all: rlgen-csharp.a
diff --git a/rlgen-csharp/main.cpp b/rlgen-csharp/main.cpp
index 1a78848..8a6fa4b 100644
--- a/rlgen-csharp/main.cpp
+++ b/rlgen-csharp/main.cpp
@@ -92,7 +92,7 @@ void csharp_usage()
 void csharp_version()
 {
 	cout << "Ragel Code Generator for C#" << endl <<
-			"Version " VERSION << ", " PUBDATE << endl <<
+			"Version " PACKAGE_VERSION ", " PACKAGE_PUBDATE << endl <<
 			"Copyright (c) 2001-2007 by Adrian Thurston" << endl;
 }
 
diff --git a/rlgen-dot/Makefile.in b/rlgen-dot/Makefile.in
index 5d33931..c5611c2 100644
--- a/rlgen-dot/Makefile.in
+++ b/rlgen-dot/Makefile.in
@@ -41,8 +41,6 @@ RANLIB = @RANLIB@
 OBJS = $(CC_SRCS:%.cpp=%.o)
 DEPS = $(CC_SRCS:%.cpp=.%.d)
 
-# Get the version info.
-include ../version.mk
 
 # Rules.
 all: rlgen-dot.a
diff --git a/rlgen-java/Makefile.in b/rlgen-java/Makefile.in
index 2fe5cd7..c429dde 100644
--- a/rlgen-java/Makefile.in
+++ b/rlgen-java/Makefile.in
@@ -42,8 +42,6 @@ RANLIB = @RANLIB@
 OBJS = $(CC_SRCS:%.cpp=%.o)
 DEPS = $(CC_SRCS:%.cpp=.%.d)
 
-# Get the version info.
-include ../version.mk
 
 # Rules.
 all: rlgen-java.a
diff --git a/rlgen-ruby/Makefile.in b/rlgen-ruby/Makefile.in
index a0a2d52..96d5399 100644
--- a/rlgen-ruby/Makefile.in
+++ b/rlgen-ruby/Makefile.in
@@ -43,8 +43,6 @@ RANLIB = @RANLIB@
 OBJS = $(CC_SRCS:%.cpp=%.o)
 DEPS = $(CC_SRCS:%.cpp=.%.d)
 
-# Get the version info.
-include ../version.mk
 
 # Rules.
 all: rlgen-ruby.a
diff --git a/version.mk b/version.mk
deleted file mode 100644
index 12353fa..0000000
--- a/version.mk
+++ /dev/null
@@ -1,2 +0,0 @@
-VERSION = 6.3
-PUBDATE = August 2008


From thurs... at cs.queensu.ca  Mon Oct  6 17:34:21 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Mon, 06 Oct 2008 13:34:21 -0400
Subject: [ragel-users] [PATCH 4/6] Remove need for version.mk file.
In-Reply-To: <20081001143729.22980.85186.stgit@yamato>
References: <20081001143729.22980.85186.stgit@yamato>
Message-ID: <48EA4C1D.3000806@cs.queensu.ca>

Again, is there a reason why this is better?

-Adrian

Diego 'Flameeyes' Petten wrote:
> Use autoconf to generate version.tex and the man pages, instead of
> using Makefile and version.mk. Also define PACKAGE_PUBDATE and
> PACKAGE_VERSION through autoconf/autoheader.
> ---
> 
>  Makefile.in              |    2 --
>  common/Makefile.in       |    6 +-----
>  configure.in             |   12 ++++++++----
>  doc/Makefile.in          |   14 ++------------
>  doc/ragel.1.in           |    2 +-
>  doc/rlgen-cd.1.in        |    2 +-
>  doc/rlgen-dot.1.in       |    2 +-
>  doc/rlgen-java.1.in      |    2 +-
>  doc/rlgen-ruby.1.in      |    2 +-
>  doc/version.tex.in       |    2 ++
>  ragel/main.cpp           |    2 +-
>  ragel/parsedata.cpp      |    4 ++--
>  redfsm/Makefile.in       |    2 --
>  redfsm/xmlparse.kl       |    2 +-
>  rlgen-cd/Makefile.in     |    2 --
>  rlgen-csharp/Makefile.in |    2 --
>  rlgen-csharp/main.cpp    |    2 +-
>  rlgen-dot/Makefile.in    |    2 --
>  rlgen-java/Makefile.in   |    2 --
>  rlgen-ruby/Makefile.in   |    2 --
>  version.mk               |    2 --
>  21 files changed, 23 insertions(+), 47 deletions(-)
>  create mode 100644 doc/version.tex.in
>  delete mode 100644 version.mk
> 
> diff --git a/Makefile.in b/Makefile.in
> index 2666c48..4619bb5 100644
> --- a/Makefile.in
> +++ b/Makefile.in
> @@ -27,8 +27,6 @@ ALL_SUBDIRS = $(BUILD_COMMON) $(BUILD_SUBDIRS) test examples doc
>  # Programs
>  CXX = @CXX@
>  
> -# Get the version info.
> -include version.mk
>  
>  # build targets
>  all: $(BUILD_SUBDIRS)
> diff --git a/common/Makefile.in b/common/Makefile.in
> index 112e59c..e79d6a4 100644
> --- a/common/Makefile.in
> +++ b/common/Makefile.in
> @@ -40,8 +40,6 @@ RANLIB = @RANLIB@
>  OBJS = $(CC_SRCS:%.cpp=%.o)
>  DEPS = $(CC_SRCS:%.cpp=.%.d)
>  
> -# Get the version info.
> -include ../version.mk
>  
>  # rules
>  
> @@ -51,9 +49,7 @@ common.a: $(GEN_SRC) $(OBJS)
>  	$(AR) -cr $@ $(OBJS) 
>  	$(RANLIB) $@
>  
> -version.h: ../version.mk
> -	echo '#define VERSION "$(VERSION)"' > version.h
> -	echo '#define PUBDATE "$(PUBDATE)"' >> version.h
> +version.h:
>  	echo '#define PREFIX "$(prefix)"' >> version.h
>  
>  %.o: %.cpp
> diff --git a/configure.in b/configure.in
> index 3995551..85e93b0 100644
> --- a/configure.in
> +++ b/configure.in
> @@ -16,11 +16,15 @@ dnl   GNU General Public License for more details.
>  dnl   
>  dnl   You should have received a copy of the GNU General Public License
>  dnl   along with Ragel; if not, write to the Free Software
> -dnl   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
> -  
> -AC_INIT(ragel/main.cpp)
> +dnl   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
> +
> +AC_INIT(ragel/main.cpp, 6.3)
>  AC_CONFIG_HEADER(common/config.h)
>  
> +PACKAGE_PUBDATE="August 2008"
> +AC_SUBST(PACKAGE_PUBDATE)
> +AC_DEFINE_UNQUOTED([PACKAGE_PUBDATE], ["$PACKAGE_PUBDATE"], [Package publication date])
> +
>  dnl You need to enable this unless the generated files are included
>  dnl and don't need to be built.
>  AC_ARG_ENABLE([parsers],
> @@ -107,6 +111,6 @@ AC_CHECK_PROG(GMCS, gmcs, gmcs)
>  AC_SUBST(GMCS)
>  
>  dnl write output files
> -AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile test/runtests)
> +AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile test/runtests doc/ragel.1 doc/rlgen-cd.1 doc/rlgen-java.1 doc/rlgen-ruby.1 doc/rlgen-dot.1 doc/version.tex)
>  
>  echo "configuration of ragel complete"
> diff --git a/doc/Makefile.in b/doc/Makefile.in
> index a6ff456..6178f0d 100644
> --- a/doc/Makefile.in
> +++ b/doc/Makefile.in
> @@ -24,8 +24,6 @@ INPUT = version.tex ragel-guide.tex
>  FIGURES = $(wildcard *.fig)
>  PDFFIGS = $(FIGURES:%.fig=%.pdf)
>  
> -# Get the version info.
> -include ../version.mk
>  
>  # Installation locations.
>  PACKAGE     = ragel
> @@ -49,19 +47,11 @@ ragel-guide.pdf: $(PDFFIGS) $(INPUT)
>  	pdflatex -interaction=nonstopmode $< >/dev/null
>  	pdflatex -interaction=nonstopmode $< >/dev/null
>  
> -version.tex: ../version.mk
> -	echo '|def|version{$(VERSION)}' | tr '|' '\\' > version.tex
> -	echo '|def|pubdate{$(PUBDATE)}' | tr '|' '\\' >> version.tex
> -
> -%.1: %.1.in ../version.mk
> -	cat $< | sed 's/@PUBDATE@/$(PUBDATE)/' \
> -		| sed 's/@VERSION@/$(VERSION)/' > $@
> -
>  clean:
> -	rm -f $(MANPAGES) *.bak *.aux *.dvi *.log *.toc *.pdf
> +	rm -f *.bak *.aux *.dvi *.log *.toc *.pdf
>  
>  distclean: clean
> -	rm -f Makefile
> +	rm -f Makefile $(MANPAGES) version.tex
>  
>  man: $(MANPAGES)
>  
> diff --git a/doc/ragel.1.in b/doc/ragel.1.in
> index 68142e2..66753cc 100644
> --- a/doc/ragel.1.in
> +++ b/doc/ragel.1.in
> @@ -21,7 +21,7 @@
>  .\"   Process this file with
>  .\"   groff -man -Tascii ragel.1
>  .\"
> -.TH RAGEL 1 "@PUBDATE@" "Ragel @VERSION@" "Ragel State Machine Compiler"
> +.TH RAGEL 1 "@PACKAGE_PUBDATE@" "Ragel @PACKAGE_VERSION@" "Ragel State Machine Compiler"
>  .SH NAME
>  ragel \- compile regular languages into executable state machines 
>  .SH SYNOPSIS
> diff --git a/doc/rlgen-cd.1.in b/doc/rlgen-cd.1.in
> index 33cc088..0d0087f 100644
> --- a/doc/rlgen-cd.1.in
> +++ b/doc/rlgen-cd.1.in
> @@ -21,7 +21,7 @@
>  .\"   Process this file with
>  .\"   groff -man -Tascii rlgen-cd.1
>  .\"
> -.TH RLGEN-CD 1 "@PUBDATE@" "Ragel @VERSION@" "Ragel State Machine Compiler"
> +.TH RLGEN-CD 1 "@PACKAGE_PUBDATE@" "Ragel @PACKAGE_VERSION@" "Ragel State Machine Compiler"
>  .SH NAME
>  rlgen-cd \- code generator for Ragel State Machine Compiler
>  .SH SYNOPSIS
> diff --git a/doc/rlgen-dot.1.in b/doc/rlgen-dot.1.in
> index 5c24091..c7a7cbe 100644
> --- a/doc/rlgen-dot.1.in
> +++ b/doc/rlgen-dot.1.in
> @@ -21,7 +21,7 @@
>  .\"   Process this file with
>  .\"   groff -man -Tascii rlgen-dot.1
>  .\"
> -.TH RLGEN-DOT 1 "@PUBDATE@" "Ragel @VERSION@" "Ragel State Machine Compiler"
> +.TH RLGEN-DOT 1 "@PACKAGE_PUBDATE@" "Ragel @PACKAGE_VERSION@" "Ragel State Machine Compiler"
>  .SH NAME
>  rlgen-dot \- Dotfile generator for Ragel State Machine Compiler
>  .SH SYNOPSIS
> diff --git a/doc/rlgen-java.1.in b/doc/rlgen-java.1.in
> index c143d15..5528a2f 100644
> --- a/doc/rlgen-java.1.in
> +++ b/doc/rlgen-java.1.in
> @@ -21,7 +21,7 @@
>  .\"   Process this file with
>  .\"   groff -man -Tascii rlgen-java.1
>  .\"
> -.TH RLGEN-JAVA 1 "@PUBDATE@" "Ragel @VERSION@" "Ragel State Machine Compiler"
> +.TH RLGEN-JAVA 1 "@PACKAGE_PUBDATE@" "Ragel @PACKAGE_VERSION@" "Ragel State Machine Compiler"
>  .SH NAME
>  rlgen-java \- code generator for Ragel State Machine Compiler
>  .SH SYNOPSIS
> diff --git a/doc/rlgen-ruby.1.in b/doc/rlgen-ruby.1.in
> index 9aecfe2..08f1dce 100644
> --- a/doc/rlgen-ruby.1.in
> +++ b/doc/rlgen-ruby.1.in
> @@ -21,7 +21,7 @@
>  .\"   Process this file with
>  .\"   groff -man -Tascii rlgen-ruby.1
>  .\"
> -.TH RLGEN-RUBY 1 "@PUBDATE@" "Ragel @VERSION@" "Ragel State Machine Compiler"
> +.TH RLGEN-RUBY 1 "@PACKAGE_PUBDATE@" "Ragel @PACKAGE_VERSION@" "Ragel State Machine Compiler"
>  .SH NAME
>  rlgen-ruby \- code generator for Ragel State Machine Compiler
>  .SH SYNOPSIS
> diff --git a/doc/version.tex.in b/doc/version.tex.in
> new file mode 100644
> index 0000000..3c0fc35
> --- /dev/null
> +++ b/doc/version.tex.in
> @@ -0,0 +1,2 @@
> +\def\version{@PACKAGE_VERSION@}
> +\def\pubdate{@PACKAGE_PUBDATE@}
> diff --git a/ragel/main.cpp b/ragel/main.cpp
> index 1e7ccc0..56095db 100644
> --- a/ragel/main.cpp
> +++ b/ragel/main.cpp
> @@ -153,7 +153,7 @@ void usage()
>  /* Print version information and exit. */
>  void version()
>  {
> -	cout << "Ragel State Machine Compiler version " VERSION << " " PUBDATE << endl <<
> +	cout << "Ragel State Machine Compiler version " PACKAGE_VERSION " " PACKAGE_PUBDATE << endl <<
>  			"Copyright (c) 2001-2007 by Adrian Thurston" << endl;
>  	exit(0);
>  }
> diff --git a/ragel/parsedata.cpp b/ragel/parsedata.cpp
> index 73f52c6..3985b2f 100644
> --- a/ragel/parsedata.cpp
> +++ b/ragel/parsedata.cpp
> @@ -1482,7 +1482,7 @@ void writeMachines( std::ostream &out, std::string hostData,
>  		}
>  
>  		if ( gblErrorCount == 0 ) {
> -			out << "<ragel version=\"" VERSION "\" filename=\"" << inputFileName << "\"";
> +			out << "<ragel version=\"" PACKAGE_VERSION "\" filename=\"" << inputFileName << "\"";
>  			writeLanguage( out );
>  			out << ">\n";
>  			for ( ParserDict::Iter parser = parserDict; parser.lte(); parser++ ) {
> @@ -1523,7 +1523,7 @@ void writeMachines( std::ostream &out, std::string hostData,
>  			/* Section/Machine to emit was found. Prepare and emit it. */
>  			parseData->prepareMachineGen( graphDictEl );
>  			if ( gblErrorCount == 0 ) {
> -				out << "<ragel version=\"" VERSION "\" filename=\"" << inputFileName << "\"";
> +				out << "<ragel version=\"" PACKAGE_VERSION "\" filename=\"" << inputFileName << "\"";
>  				writeLanguage( out );
>  				out << ">\n";
>  				parseData->generateXML( out );
> diff --git a/redfsm/Makefile.in b/redfsm/Makefile.in
> index 951de79..8e67233 100644
> --- a/redfsm/Makefile.in
> +++ b/redfsm/Makefile.in
> @@ -41,8 +41,6 @@ RANLIB = @RANLIB@
>  OBJS = $(CC_SRCS:%.cpp=%.o)
>  DEPS = $(CC_SRCS:%.cpp=.%.d)
>  
> -# Get the version info.
> -include ../version.mk
>  
>  # Rules.
>  all: redfsm.a
> diff --git a/redfsm/xmlparse.kl b/redfsm/xmlparse.kl
> index e725fcc..6ce677a 100644
> --- a/redfsm/xmlparse.kl
> +++ b/redfsm/xmlparse.kl
> @@ -108,7 +108,7 @@ tag_ragel_head: TAG_ragel
>  		Attribute *versionAttr = $1->tag->findAttr( "version" );
>  		if ( versionAttr == 0 )
>  			error($1->loc) << "tag <ragel> requires a version attribute" << endp;
> -		if ( strcmp( versionAttr->value, VERSION ) != 0 )
> +		if ( strcmp( versionAttr->value, PACKAGE_VERSION ) != 0 )
>  			error($1->loc) << "version mismatch between frontend and backend" << endp;
>  
>  		/* Check for file name attribute. */
> diff --git a/rlgen-cd/Makefile.in b/rlgen-cd/Makefile.in
> index 49031e3..7b06285 100644
> --- a/rlgen-cd/Makefile.in
> +++ b/rlgen-cd/Makefile.in
> @@ -45,8 +45,6 @@ RANLIB = @RANLIB@
>  OBJS = $(CC_SRCS:%.cpp=%.o)
>  DEPS = $(CC_SRCS:%.cpp=.%.d)
>  
> -# Get the version info.
> -include ../version.mk
>  
>  # Rules.
>  all: rlgen-cd.a
> diff --git a/rlgen-csharp/Makefile.in b/rlgen-csharp/Makefile.in
> index fa57e49..fc5380f 100644
> --- a/rlgen-csharp/Makefile.in
> +++ b/rlgen-csharp/Makefile.in
> @@ -45,8 +45,6 @@ RANLIB = @RANLIB@
>  OBJS = $(CC_SRCS:%.cpp=%.o)
>  DEPS = $(CC_SRCS:%.cpp=.%.d)
>  
> -# Get the version info.
> -include ../version.mk
>  
>  # Rules.
>  all: rlgen-csharp.a
> diff --git a/rlgen-csharp/main.cpp b/rlgen-csharp/main.cpp
> index 1a78848..8a6fa4b 100644
> --- a/rlgen-csharp/main.cpp
> +++ b/rlgen-csharp/main.cpp
> @@ -92,7 +92,7 @@ void csharp_usage()
>  void csharp_version()
>  {
>  	cout << "Ragel Code Generator for C#" << endl <<
> -			"Version " VERSION << ", " PUBDATE << endl <<
> +			"Version " PACKAGE_VERSION ", " PACKAGE_PUBDATE << endl <<
>  			"Copyright (c) 2001-2007 by Adrian Thurston" << endl;
>  }
>  
> diff --git a/rlgen-dot/Makefile.in b/rlgen-dot/Makefile.in
> index 5d33931..c5611c2 100644
> --- a/rlgen-dot/Makefile.in
> +++ b/rlgen-dot/Makefile.in
> @@ -41,8 +41,6 @@ RANLIB = @RANLIB@
>  OBJS = $(CC_SRCS:%.cpp=%.o)
>  DEPS = $(CC_SRCS:%.cpp=.%.d)
>  
> -# Get the version info.
> -include ../version.mk
>  
>  # Rules.
>  all: rlgen-dot.a
> diff --git a/rlgen-java/Makefile.in b/rlgen-java/Makefile.in
> index 2fe5cd7..c429dde 100644
> --- a/rlgen-java/Makefile.in
> +++ b/rlgen-java/Makefile.in
> @@ -42,8 +42,6 @@ RANLIB = @RANLIB@
>  OBJS = $(CC_SRCS:%.cpp=%.o)
>  DEPS = $(CC_SRCS:%.cpp=.%.d)
>  
> -# Get the version info.
> -include ../version.mk
>  
>  # Rules.
>  all: rlgen-java.a
> diff --git a/rlgen-ruby/Makefile.in b/rlgen-ruby/Makefile.in
> index a0a2d52..96d5399 100644
> --- a/rlgen-ruby/Makefile.in
> +++ b/rlgen-ruby/Makefile.in
> @@ -43,8 +43,6 @@ RANLIB = @RANLIB@
>  OBJS = $(CC_SRCS:%.cpp=%.o)
>  DEPS = $(CC_SRCS:%.cpp=.%.d)
>  
> -# Get the version info.
> -include ../version.mk
>  
>  # Rules.
>  all: rlgen-ruby.a
> diff --git a/version.mk b/version.mk
> deleted file mode 100644
> index 12353fa..0000000
> --- a/version.mk
> +++ /dev/null
> @@ -1,2 +0,0 @@
> -VERSION = 6.3
> -PUBDATE = August 2008
> 
> 
> 


From rober... at semistable.com  Thu Oct  2 10:07:10 2008
From: rober... at semistable.com (robertle)
Date: Thu, 2 Oct 2008 03:07:10 -0700 (PDT)
Subject: multiple output files
Message-ID: <eba28db2-9b38-4cd6-babd-6dc252906a3f@m3g2000hsc.googlegroups.com>

hi folks,

i asked this on irc, but wasn't able to stick around, sorry for the
duplication.

anyway: is there a way to generate multiple output files from one
ragel file? i am generating c++ classes that encapsulate a state
machine, and in the moment i have one .rl file and one .h file for
each machine. this is ok, but it would be very neat if i could just
include the .h declarations in the .rl file...


From thurs... at cs.queensu.ca  Mon Oct  6 17:39:37 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Mon, 06 Oct 2008 13:39:37 -0400
Subject: [ragel-users] multiple output files
In-Reply-To: <eba28db2-9b38-4cd6-babd-6dc252906a3f@m3g2000hsc.googlegroups.com>
References: <eba28db2-9b38-4cd6-babd-6dc252906a3f@m3g2000hsc.googlegroups.com>
Message-ID: <48EA4D59.4000904@cs.queensu.ca>

Hi Robert,

Ragel used to behave that way. You had one .rl file and it would spit 
out code and a header for you, but I fond it to be a pain to write 
makefiles. Now the model is one input file, one output file.

-Adrian

robertle wrote:
> hi folks,
> 
> i asked this on irc, but wasn't able to stick around, sorry for the
> duplication.
> 
> anyway: is there a way to generate multiple output files from one
> ragel file? i am generating c++ classes that encapsulate a state
> machine, and in the moment i have one .rl file and one .h file for
> each machine. this is ok, but it would be very neat if i could just
> include the .h declarations in the .rl file...
> 
> thanks  robert
> 


From thurs... at cs.queensu.ca  Tue Oct  7 04:59:56 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Tue, 07 Oct 2008 00:59:56 -0400
Subject: new mailing list
Message-ID: <48EAECCC.1080403@cs.queensu.ca>

Hi Everyone,

As many of you have noticed Ragel has a new home at:

http://www.complang.org/ragel/

This is a new machine for me and I can put anything I want on it, 
including mailing lists. A number of people have expressed an interest 
in a mailing list that is 'independent' and so it is time to move the 
list to this new server. The web home of the new list is at:

http://www.complang.org/mailman/listinfo/ragel-users

I have not subscribed anyone to this list.

Regards,
  Adrian


From thurston at complang.org  Tue Oct  7 04:28:31 2008
From: thurston at complang.org (Adrian Thurston)
Date: Tue, 07 Oct 2008 00:28:31 -0400
Subject: [ragel-users] first message
Message-ID: <48EAE56F.1000209@complang.org>

first message



From thurston at complang.org  Tue Oct  7 04:36:33 2008
From: thurston at complang.org (Adrian Thurston)
Date: Tue, 07 Oct 2008 00:36:33 -0400
Subject: [ragel-users] second message
Message-ID: <48EAE751.9080504@complang.org>

second message
[reply-to should be set]



From spider.karma+ragel-users at gmail.com  Fri Oct 10 21:16:10 2008
From: spider.karma+ragel-users at gmail.com (Gordon Smith)
Date: Fri, 10 Oct 2008 15:16:10 -0600
Subject: [ragel-users] fcall/fret operator error?
In-Reply-To: <2df568dc0810101415gec6a2dbh7faf2daac163d386@mail.gmail.com>
References: <2df568dc0810101415gec6a2dbh7faf2daac163d386@mail.gmail.com>
Message-ID: <2df568dc0810101416iada0e09t83bea2678349c06@mail.gmail.com>

Hello all -

Having a bit of trouble with fcall/fret.

I need to read a number in a string that indicates the number of bytes to
follow. I do this correctly with a complete string, but also reach a final
state with an incomplete string that includes some of the binary data. I'm
using fcall into another machine to read the binary data.

Have I missed something obvious?

Thanks,
Gordon

%%{
    machine TEST;
    alphtype char;

    action binary_data_length_check {
        fsm.binary_data_count++;
        if ( fsm.binary_data_count >= fsm.byte_count ) {
            //fhold;
            fret;
        }
    }

    action binary_data_init { fsm.binary_data_count = 0; }

    binary_data_machine := any+ $binary_data_length_check >binary_data_init;

    # We're trying to do this:
    # any{fsm.byte_count}
    action binary_data_action {
        fcall binary_data_machine;
    }

    binary_payload = 'r.' @binary_data_action;

    # b:<NumBytes>:<NumBytes of chars>:<CRC><CR>
    bridge_packet =
        'b:'
        ( xdigit @{ AddXDigit( fsm.byte_count, * p ); } )+
        ':'
        binary_payload
        ':'
        xdigit+
        '\r';

    main := bridge_packet;
}%%

%% write data;

void init() {
    %% write init;
    fsm.byte_count = 0;
}

void parse(char * payload, char * payloadEnd) {
    const char * p = payload;
    const char * pe = payloadEnd;

    %% access fsm.;
    %% write exec;

    if ( fsm.cs == TEST_error ) {
        std::cout << "FINISH_ERROR\n";
    } else if ( fsm.cs >= TEST_first_final ) {
        std::cout << "FINISH_FINAL\n";
    } else {
        std::cout << "FINISH_NOT_FINAL\n";
    }
}

int main() {
    init();
    {
        // Complete
        char * t1 = "b:0004:r.abcd:a0\r";
        parse(t1, t1 + strlen( t1 ) );
    }

    init();
    {
        // Incomplete
        char * t1 = "b:0004:r.ab";
        parse(t1, t1 + strlen( t1 ) );
    }

    return 0;
}

----------
Output is:
{{{
FINISH_FINAL
FINISH_FINAL
}}}

and I expect
{{{
FINISH_FINAL
FINISH_NOT_FINAL
}}}

AddXDigit( unsigned target, char c ) adds value of hexadecimal digit to
target.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.colm.net/pipermail/ragel/attachments/20081010/c351e260/attachment.html>

From spiderkarma at gmail.com  Fri Oct 10 21:15:25 2008
From: spiderkarma at gmail.com (Gordon Smith)
Date: Fri, 10 Oct 2008 15:15:25 -0600
Subject: [ragel-users] fcall/fret operator error?
Message-ID: <2df568dc0810101415gec6a2dbh7faf2daac163d386@mail.gmail.com>

Hello all -

Having a bit of trouble with fcall/fret.

I need to read a number in a string that indicates the number of bytes to
follow. I do this correctly with a complete string, but also reach a final
state with an incomplete string that includes some of the binary data. I'm
using fcall into another machine to read the binary data.

Have I missed something obvious?

Thanks,
Gordon

%%{
    machine TEST;
    alphtype char;

    action binary_data_length_check {
        fsm.binary_data_count++;
        if ( fsm.binary_data_count >= fsm.byte_count ) {
            //fhold;
            fret;
        }
    }

    action binary_data_init { fsm.binary_data_count = 0; }

    binary_data_machine := any+ $binary_data_length_check >binary_data_init;

    # We're trying to do this:
    # any{fsm.byte_count}
    action binary_data_action {
        fcall binary_data_machine;
    }

    binary_payload = 'r.' @binary_data_action;

    # b:<NumBytes>:<NumBytes of chars>:<CRC><CR>
    bridge_packet =
        'b:'
        ( xdigit @{ AddXDigit( fsm.byte_count, * p ); } )+
        ':'
        binary_payload
        ':'
        xdigit+
        '\r';

    main := bridge_packet;
}%%

%% write data;

void init() {
    %% write init;
    fsm.byte_count = 0;
}

void parse(char * payload, char * payloadEnd) {
    const char * p = payload;
    const char * pe = payloadEnd;

    %% access fsm.;
    %% write exec;

    if ( fsm.cs == TEST_error ) {
        std::cout << "FINISH_ERROR\n";
    } else if ( fsm.cs >= TEST_first_final ) {
        std::cout << "FINISH_FINAL\n";
    } else {
        std::cout << "FINISH_NOT_FINAL\n";
    }
}

int main() {
    init();
    {
        // Complete
        char * t1 = "b:0004:r.abcd:a0\r";
        parse(t1, t1 + strlen( t1 ) );
    }

    init();
    {
        // Incomplete
        char * t1 = "b:0004:r.ab";
        parse(t1, t1 + strlen( t1 ) );
    }

    return 0;
}

----------
Output is:
{{{
FINISH_FINAL
FINISH_FINAL
}}}

and I expect
{{{
FINISH_FINAL
FINISH_NOT_FINAL
}}}

AddXDigit( unsigned target, char c ) adds value of hexadecimal digit to
target.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.colm.net/pipermail/ragel/attachments/20081010/74e63ad8/attachment.html>

From thurston at complang.org  Fri Oct 10 21:36:04 2008
From: thurston at complang.org (Adrian Thurston)
Date: Fri, 10 Oct 2008 17:36:04 -0400
Subject: [ragel-users] fcall/fret operator error?
In-Reply-To: <2df568dc0810101416iada0e09t83bea2678349c06@mail.gmail.com>
References: <2df568dc0810101415gec6a2dbh7faf2daac163d386@mail.gmail.com>
	<2df568dc0810101416iada0e09t83bea2678349c06@mail.gmail.com>
Message-ID: <48EFCAC4.7050807@complang.org>

Hi Gordon,

That's happening because each machine instantiation has a set of final
states. When you pass an incomplete string the binary_data_machine ends
up in a final state. You can use an EOF action to catch this and raise
an error.

Adrian

P.S. sorry for the double posting of the question -- I approved the
non-member post at the same time as Gordon resent using his subscribed
address.

Gordon Smith wrote:
> Hello all -
> 
> Having a bit of trouble with fcall/fret.
> 
> I need to read a number in a string that indicates the number of bytes
> to follow. I do this correctly with a complete string, but also reach a
> final state with an incomplete string that includes some of the binary
> data. I'm using fcall into another machine to read the binary data.
> 
> Have I missed something obvious?
> 
> Thanks,
> Gordon
> 
> %%{
>     machine TEST;
>     alphtype char;
> 
>     action binary_data_length_check {
>         fsm.binary_data_count++;
>         if ( fsm.binary_data_count >= fsm.byte_count ) {
>             //fhold;
>             fret;
>         }
>     }
> 
>     action binary_data_init { fsm.binary_data_count = 0; }
> 
>     binary_data_machine := any+ $binary_data_length_check >binary_data_init;
> 
>     # We're trying to do this:
>     # any{fsm.byte_count}
>     action binary_data_action {
>         fcall binary_data_machine;
>     }
> 
>     binary_payload = 'r.' @binary_data_action;
> 
>     # b:<NumBytes>:<NumBytes of chars>:<CRC><CR>
>     bridge_packet =
>         'b:'
>         ( xdigit @{ AddXDigit( fsm.byte_count, * p ); } )+
>         ':'
>         binary_payload
>         ':'
>         xdigit+
>         '\r';
> 
>     main := bridge_packet;
> }%%
> 
> %% write data;
> 
> void init() {
>     %% write init;
>     fsm.byte_count = 0;
> }
> 
> void parse(char * payload, char * payloadEnd) {
>     const char * p = payload;
>     const char * pe = payloadEnd;
> 
>     %% access fsm.;
>     %% write exec;
> 
>     if ( fsm.cs == TEST_error ) {
>         std::cout << "FINISH_ERROR\n";
>     } else if ( fsm.cs >= TEST_first_final ) {
>         std::cout << "FINISH_FINAL\n";
>     } else {
>         std::cout << "FINISH_NOT_FINAL\n";
>     }
> }
> 
> int main() {
>     init();
>     {
>         // Complete
>         char * t1 = "b:0004:r.abcd:a0\r";
>         parse(t1, t1 + strlen( t1 ) );
>     }
>    
>     init();
>     {
>         // Incomplete
>         char * t1 = "b:0004:r.ab";
>         parse(t1, t1 + strlen( t1 ) );
>     }
>    
>     return 0;
> }
> 
> ----------
> Output is:
> {{{
> FINISH_FINAL
> FINISH_FINAL
> }}}
> 
> and I expect
> {{{
> FINISH_FINAL
> FINISH_NOT_FINAL
> }}}
> 
> AddXDigit( unsigned target, char c ) adds value of hexadecimal digit to
> target.
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From thurston at complang.org  Sat Oct 11 04:11:25 2008
From: thurston at complang.org (Adrian Thurston)
Date: Sat, 11 Oct 2008 00:11:25 -0400
Subject: [ragel-users] new subversion repository
Message-ID: <48F0276D.1080404@complang.org>

Hey Everyone,

The Ragel subversion repository has been moved to the new machine:

svn://xform.complang.org/ragel/trunk/

Cheers,
  Adrian



From ragel-user at jgoettgens.de  Sun Oct 12 13:50:39 2008
From: ragel-user at jgoettgens.de (RU)
Date: Sun, 12 Oct 2008 15:50:39 +0200
Subject: [ragel-users] vs. 6.3 4 Windows
Message-ID: <F4BCEA6B7A3F4B5A95D49A38E631C029@lynx>

I have packaged vs. 6.3 for Visual Studio 2008:

  http://www.jgoettgens.de/Meine_Bilder_und_Dateien/ragel-vs2008.7z

The 7-zip archive contains (the slightly changed) sources, x86 and AMD64 
binaries.

Happy scanning!




From hsanson at gmail.com  Tue Oct 21 15:26:35 2008
From: hsanson at gmail.com (Horacio Sanson)
Date: Wed, 22 Oct 2008 00:26:35 +0900
Subject: [ragel-users] Reduce ragel generator time
Message-ID: <6156dd8b0810210826u2fb60fbs703753a2d4b3fb29@mail.gmail.com>

I have this Ragel machine to parse RTSP messages that takes almost 20
minutes to generate the C code. I remember reading in the mailing list
about someone complaining that Ragel was taking too long to generate
his/her SIP parser. In that same thread a solution about a machine
that eats the blank spaces or something like that helped reduce the
generation time from hours to a few minutes was posted but for some
reason I cannot find this email in my email archives.

If someone could repost this email or give me a simple example on how
this was done I would appreciate it.

regards,
Horacio



From thurston at complang.org  Wed Oct 22 05:48:02 2008
From: thurston at complang.org (Adrian Thurston)
Date: Wed, 22 Oct 2008 01:48:02 -0400
Subject: [ragel-users] Reduce ragel generator time
In-Reply-To: <6156dd8b0810210826u2fb60fbs703753a2d4b3fb29@mail.gmail.com>
References: <6156dd8b0810210826u2fb60fbs703753a2d4b3fb29@mail.gmail.com>
Message-ID: <48FEBE92.3020504@complang.org>

There was this thread:

http://groups.google.com/group/ragel-users/browse_thread/thread/70232b2c5fd478d0/

I think there have been others but my searching skills suck right now.

A good way to track down state explosions is to rebuild the grammar from 
the bottom up, incrementally, and look for large unruly jumps in the 
size. Just comment out the original main and start doing:

main := <smaller_component>;

Move <smaller_component> "up" the grammar until you get to the original 
main. See chapter 4 of the manual for ways to fix the problems you find.

Cheers,
  Adrian



Horacio Sanson wrote:
> I have this Ragel machine to parse RTSP messages that takes almost 20
> minutes to generate the C code. I remember reading in the mailing list
> about someone complaining that Ragel was taking too long to generate
> his/her SIP parser. In that same thread a solution about a machine
> that eats the blank spaces or something like that helped reduce the
> generation time from hours to a few minutes was posted but for some
> reason I cannot find this email in my email archives.
> 
> If someone could repost this email or give me a simple example on how
> this was done I would appreciate it.
> 
> regards,
> Horacio
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From robertle at semistable.com  Wed Oct 22 13:38:02 2008
From: robertle at semistable.com (Robert Lemmen)
Date: Wed, 22 Oct 2008 14:38:02 +0100
Subject: [ragel-users] interleaving two machines
Message-ID: <20081022133802.GA12780@semistable.com>

hi folks,

i need a way to combine two machines in an interleaved way, so optimally
i would have an operator ?? that if used like this:

'abcd' ?? 'AB'

would match:

abcdAB
ABabcd
aABbcd
abAcBd

i have so far not managed to construct such a machine without
explicitely stating all the ordering possibilities, which get a bit
cumbersome as the two machines get longer...

thanks  robert

-- 
Robert Lemmen                               http://www.semistable.com 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <http://www.colm.net/pipermail/ragel/attachments/20081022/8ccafc69/attachment.sig>

From thurston at complang.org  Wed Oct 22 14:58:37 2008
From: thurston at complang.org (Adrian Thurston)
Date: Wed, 22 Oct 2008 10:58:37 -0400
Subject: [ragel-users] interleaving two machines
In-Reply-To: <20081022133802.GA12780@semistable.com>
References: <20081022133802.GA12780@semistable.com>
Message-ID: <48FF3F9D.3030603@complang.org>

I think this has been requested before, or something similar to it. Is
this a language of your making, or some existing language? I'm
interested in an example use.

-Adrian

Robert Lemmen wrote:
> hi folks,
> 
> i need a way to combine two machines in an interleaved way, so optimally
> i would have an operator ?? that if used like this:
> 
> 'abcd' ?? 'AB'
> 
> would match:
> 
> abcdAB
> ABabcd
> aABbcd
> abAcBd
> 
> i have so far not managed to construct such a machine without
> explicitely stating all the ordering possibilities, which get a bit
> cumbersome as the two machines get longer...
> 
> thanks  robert
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From robertle at semistable.com  Wed Oct 22 15:25:58 2008
From: robertle at semistable.com (Robert Lemmen)
Date: Wed, 22 Oct 2008 16:25:58 +0100
Subject: [ragel-users] interleaving two machines
In-Reply-To: <48FF3F9D.3030603@complang.org>
References: <20081022133802.GA12780@semistable.com>
	<48FF3F9D.3030603@complang.org>
Message-ID: <20081022152558.GA14866@semistable.com>

On Wed, Oct 22, 2008 at 10:58:37AM -0400, Adrian Thurston wrote:
> I think this has been requested before, or something similar to it. Is
> this a language of your making, or some existing language? I'm
> interested in an example use.

it is a language of my making, but i think it is a quite neat feature.
in my case it is a handshake protocol over the network. you could work
your way around it by specifying the exact order, i.e. one end (the
server) moderates the whole protocol, the other end just answers. it is
however much more efficient and neat if you could avoid that. a really
simple example:

--- helo   -->
<-- helo   ---
--- ident  -->
<-- ident  ---
--- query  -->
<-- answer ---
--- ok     -->
<-- ok     ---

basically, both ends send a "helo", wait for an "ident" and then either
do a "query" which needs an "answer", or just send an "ok". after two
"ok"s the handshake is done. we can of course require the above
ordering, but if we allow both ends to send a package whenever it makes
sense, then the whole thing might get heavily reordered:

--- helo   -->   <-- helo   ---
--- ident  -->   <-- ident  ---
--- query  -->   <-- ok     ---
                 <-- answer ---
--- ok     -->

as you can see, we can then do things in parallel, which is especially
important on high-latency links...

cu  robert

-- 
Robert Lemmen                               http://www.semistable.com 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <http://www.colm.net/pipermail/ragel/attachments/20081022/c7c62be6/attachment.sig>

From thurston at complang.org  Wed Oct 22 23:28:43 2008
From: thurston at complang.org (Adrian Thurston)
Date: Wed, 22 Oct 2008 19:28:43 -0400
Subject: [ragel-users] interleaving two machines
In-Reply-To: <20081022152558.GA14866@semistable.com>
References: <20081022133802.GA12780@semistable.com>	<48FF3F9D.3030603@complang.org>
	<20081022152558.GA14866@semistable.com>
Message-ID: <48FFB72B.2060307@complang.org>

Right, I see how that would be useful. I'm pretty sure this has been 
asked for in the past but I didn't get it.

-Adrian

Robert Lemmen wrote:
> On Wed, Oct 22, 2008 at 10:58:37AM -0400, Adrian Thurston wrote:
>> I think this has been requested before, or something similar to it. Is
>> this a language of your making, or some existing language? I'm
>> interested in an example use.
> 
> it is a language of my making, but i think it is a quite neat feature.
> in my case it is a handshake protocol over the network. you could work
> your way around it by specifying the exact order, i.e. one end (the
> server) moderates the whole protocol, the other end just answers. it is
> however much more efficient and neat if you could avoid that. a really
> simple example:
> 
> --- helo   -->
> <-- helo   ---
> --- ident  -->
> <-- ident  ---
> --- query  -->
> <-- answer ---
> --- ok     -->
> <-- ok     ---
> 
> basically, both ends send a "helo", wait for an "ident" and then either
> do a "query" which needs an "answer", or just send an "ok". after two
> "ok"s the handshake is done. we can of course require the above
> ordering, but if we allow both ends to send a package whenever it makes
> sense, then the whole thing might get heavily reordered:
> 
> --- helo   -->   <-- helo   ---
> --- ident  -->   <-- ident  ---
> --- query  -->   <-- ok     ---
>                  <-- answer ---
> --- ok     -->
> 
> as you can see, we can then do things in parallel, which is especially
> important on high-latency links...
> 
> cu  robert
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From hsanson at gmail.com  Thu Oct 23 00:38:54 2008
From: hsanson at gmail.com (Horacio Sanson)
Date: Thu, 23 Oct 2008 09:38:54 +0900
Subject: [ragel-users] Reduce ragel generator time
In-Reply-To: <48FEBE92.3020504@complang.org>
References: <6156dd8b0810210826u2fb60fbs703753a2d4b3fb29@mail.gmail.com>
	<48FEBE92.3020504@complang.org>
Message-ID: <6156dd8b0810221738y747bfcb6t60298106076bd1c5@mail.gmail.com>

Thanks,

Using the link you gave me I was able to find the thread I was looking
for. Here it is if someone is interested.

http://groups.google.com/group/ragel-users/browse_thread/thread/e1179e9756f6eb32/f69f6cd013f9426d?lnk=gst&q=sip+#f69f6cd013f9426d

What I don't understand is why this thread is not stored in my mail
archives... strange.

regards,
Horacio

On Wed, Oct 22, 2008 at 2:48 PM, Adrian Thurston <thurston at complang.org> wrote:
> There was this thread:
>
> http://groups.google.com/group/ragel-users/browse_thread/thread/70232b2c5fd478d0/
>
> I think there have been others but my searching skills suck right now.
>
> A good way to track down state explosions is to rebuild the grammar from
> the bottom up, incrementally, and look for large unruly jumps in the
> size. Just comment out the original main and start doing:
>
> main := <smaller_component>;
>
> Move <smaller_component> "up" the grammar until you get to the original
> main. See chapter 4 of the manual for ways to fix the problems you find.
>
> Cheers,
>  Adrian
>
>
>
> Horacio Sanson wrote:
>> I have this Ragel machine to parse RTSP messages that takes almost 20
>> minutes to generate the C code. I remember reading in the mailing list
>> about someone complaining that Ragel was taking too long to generate
>> his/her SIP parser. In that same thread a solution about a machine
>> that eats the blank spaces or something like that helped reduce the
>> generation time from hours to a few minutes was posted but for some
>> reason I cannot find this email in my email archives.
>>
>> If someone could repost this email or give me a simple example on how
>> this was done I would appreciate it.
>>
>> regards,
>> Horacio
>>
>> _______________________________________________
>> ragel-users mailing list
>> ragel-users at complang.org
>> http://www.complang.org/mailman/listinfo/ragel-users
>
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users
>



From hsanson at gmail.com  Thu Oct 23 02:52:59 2008
From: hsanson at gmail.com (Horacio Sanson)
Date: Thu, 23 Oct 2008 11:52:59 +0900
Subject: [ragel-users] Small help with RTSP + SDP parser
Message-ID: <6156dd8b0810221952h12f13d2axae88954f3e76a98b@mail.gmail.com>

Here is part of my parser that deals with RTSP response body part. As
you can see the message_body is delimited by CRLF that is a simle
("\n"? "\r") expression.
My problem is when the response has a SDP message as part of the
response body. This is because SDP fields are also delimited with CRLF
(see example at the end). In this case the body_read action is called
for each SDP field instead of only once at the end of the body. In
consequence I get several calls to memcpy when in fact I only expect
one at the end of the message body (i.e. 27 times in the example
below).

The end result is still correct, the SDP is completely copied inside
the msg->body buffer, but calling memcpy per SDP field is undesired
for performance reasons. What rule/tip/trick/hack can I use to make
the body_read action be executed only once at the end of the RTSP
message body??

thanks
Horacio

################################################################################
#        Ragel rules
################################################################################

action body_test  { body_offset++ < msg->body_len }
action body_start { body_start = fpc; body_offset = 0 }
action body_end   {body_end = fpc;}
action body_read {
    tmpbuf_len = body_end - body_start;
    memcpy(msg->body, body_start, tmpbuf_len);
}

message_body = any+ >body_start @body_end when body_test %body_read;

Response = (                            # Section 7
     Status_Line
     (
         general_header                 # Section 5
         | response_header              # Section 6.2
         | entity_header                # Section 8.1
         | CSeq                        # Section 12.17
         | Session                       # Section 12.37
         | Transport                     # Section 12.39
         | darwin_header                 # Darwin SS proprietary
     )*
     CRLF
     message_body?                       # Section 4.3
     CRLF %{ msg->finished = 1; SUJMSG("RTSP Finish\n"); }
 );

main := (Request | Response);


################################################################################
# Example RTSP response:
################################################################################
RTSP/1.0 200 OK
Server: DSS/5.5.5 (Build/489.16; Platform/Linux; Release/Darwin;
state/beta; )
Cseq: 411
Last-Modified: Thu, 16 Oct 2008 00:21:52 GMT
Cache-Control: must-revalidate
Content-length: 741
Date: Thu, 23 Oct 2008 02:30:28 GMT
Expires: Thu, 23 Oct 2008 02:30:28 GMT
Content-Type: application/sdp
x-Accept-Retransmit: our-retransmit
x-Accept-Dynamic-Rate: 1
Content-Base: rtsp://www.fake.com:554/BBB.mp4/

v=0
o=StreamingServer 3433717827 1224116512000 IN IP4 218.45.218.150
s=/BBB.mp4
u=http:///
e=admin@
c=IN IP4 0.0.0.0
b=AS:500
t=0 0
a=control:*
a=x-copyright: MP4/3GP File hinted with GPAC 0.4.4 (C)2000-2005 -
http://gpac.sourceforge.net
a=range:npt=0- 596.45800
m=video 0 RTP/AVP 96
b=AS:400
a=rtpmap:96 H264/90000
a=control:trackID=65536
a=fmtp:96 profile-level-id=42C01E; packetization-mode=1;
sprop-parameter-sets=Z0LAHppzgUBf8sIAAAMAAgAAAwBhHixc8A==,aM4yyA==
a=framesize:96 640-360
m=audio 0 RTP/AVP 97
b=AS:100
a=rtpmap:97 mpeg4-generic/48000/2
a=control:trackID=65537
a=fmtp:97 profile-level-id=41; config=1190; streamType=5;
mode=AAC-hbr; objectType=64; sizeLength=13; indexLength=3;
indexDeltaLength=3



From thurston at complang.org  Thu Oct 23 06:52:47 2008
From: thurston at complang.org (Adrian Thurston)
Date: Thu, 23 Oct 2008 02:52:47 -0400
Subject: [ragel-users] Reduce ragel generator time
In-Reply-To: <6156dd8b0810221738y747bfcb6t60298106076bd1c5@mail.gmail.com>
References: <6156dd8b0810210826u2fb60fbs703753a2d4b3fb29@mail.gmail.com>	<48FEBE92.3020504@complang.org>
	<6156dd8b0810221738y747bfcb6t60298106076bd1c5@mail.gmail.com>
Message-ID: <49001F3F.8020006@complang.org>

I just busted this link ... I moved the google group messages into the 
mailman archive and deleted the group. You can now find the thread here:

http://www.complang.org/pipermail/ragel-users/2007-July/000263.html

-Adrian

Horacio Sanson wrote:
> Thanks,
> 
> Using the link you gave me I was able to find the thread I was looking
> for. Here it is if someone is interested.
> 
> http://groups.google.com/group/ragel-users/browse_thread/thread/e1179e9756f6eb32/f69f6cd013f9426d?lnk=gst&q=sip+#f69f6cd013f9426d
> 
> What I don't understand is why this thread is not stored in my mail
> archives... strange.
> 
> regards,
> Horacio
> 
> On Wed, Oct 22, 2008 at 2:48 PM, Adrian Thurston <thurston at complang.org> wrote:
>> There was this thread:
>>
>> http://groups.google.com/group/ragel-users/browse_thread/thread/70232b2c5fd478d0/
>>
>> I think there have been others but my searching skills suck right now.
>>
>> A good way to track down state explosions is to rebuild the grammar from
>> the bottom up, incrementally, and look for large unruly jumps in the
>> size. Just comment out the original main and start doing:
>>
>> main := <smaller_component>;
>>
>> Move <smaller_component> "up" the grammar until you get to the original
>> main. See chapter 4 of the manual for ways to fix the problems you find.
>>
>> Cheers,
>>  Adrian
>>
>>
>>
>> Horacio Sanson wrote:
>>> I have this Ragel machine to parse RTSP messages that takes almost 20
>>> minutes to generate the C code. I remember reading in the mailing list
>>> about someone complaining that Ragel was taking too long to generate
>>> his/her SIP parser. In that same thread a solution about a machine
>>> that eats the blank spaces or something like that helped reduce the
>>> generation time from hours to a few minutes was posted but for some
>>> reason I cannot find this email in my email archives.
>>>
>>> If someone could repost this email or give me a simple example on how
>>> this was done I would appreciate it.
>>>
>>> regards,
>>> Horacio
>>>
>>> _______________________________________________
>>> ragel-users mailing list
>>> ragel-users at complang.org
>>> http://www.complang.org/mailman/listinfo/ragel-users
>> _______________________________________________
>> ragel-users mailing list
>> ragel-users at complang.org
>> http://www.complang.org/mailman/listinfo/ragel-users
>>
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From thurston at complang.org  Thu Oct 23 17:14:59 2008
From: thurston at complang.org (Adrian Thurston)
Date: Thu, 23 Oct 2008 13:14:59 -0400
Subject: [ragel-users] Small help with RTSP + SDP parser
In-Reply-To: <6156dd8b0810221952h12f13d2axae88954f3e76a98b@mail.gmail.com>
References: <6156dd8b0810221952h12f13d2axae88954f3e76a98b@mail.gmail.com>
Message-ID: <4900B113.6090008@complang.org>

You could put %body_read at the end of the final CRLF. It seems you're
parsing only a single request/response at once and you don't need to
separate them. That means that when the input buffer is fully consumed
you're at the end.

Adrian

Horacio Sanson wrote:
> Here is part of my parser that deals with RTSP response body part. As
> you can see the message_body is delimited by CRLF that is a simle
> ("\n"? "\r") expression.
> My problem is when the response has a SDP message as part of the
> response body. This is because SDP fields are also delimited with CRLF
> (see example at the end). In this case the body_read action is called
> for each SDP field instead of only once at the end of the body. In
> consequence I get several calls to memcpy when in fact I only expect
> one at the end of the message body (i.e. 27 times in the example
> below).
> 
> The end result is still correct, the SDP is completely copied inside
> the msg->body buffer, but calling memcpy per SDP field is undesired
> for performance reasons. What rule/tip/trick/hack can I use to make
> the body_read action be executed only once at the end of the RTSP
> message body??
> 
> thanks
> Horacio
> 
> ################################################################################
> #        Ragel rules
> ################################################################################
> 
> action body_test  { body_offset++ < msg->body_len }
> action body_start { body_start = fpc; body_offset = 0 }
> action body_end   {body_end = fpc;}
> action body_read {
>     tmpbuf_len = body_end - body_start;
>     memcpy(msg->body, body_start, tmpbuf_len);
> }
> 
> message_body = any+ >body_start @body_end when body_test %body_read;
> 
> Response = (                            # Section 7
>      Status_Line
>      (
>          general_header                 # Section 5
>          | response_header              # Section 6.2
>          | entity_header                # Section 8.1
>          | CSeq                        # Section 12.17
>          | Session                       # Section 12.37
>          | Transport                     # Section 12.39
>          | darwin_header                 # Darwin SS proprietary
>      )*
>      CRLF
>      message_body?                       # Section 4.3
>      CRLF %{ msg->finished = 1; SUJMSG("RTSP Finish\n"); }
>  );
> 
> main := (Request | Response);
> 
> 
> ################################################################################
> # Example RTSP response:
> ################################################################################
> RTSP/1.0 200 OK
> Server: DSS/5.5.5 (Build/489.16; Platform/Linux; Release/Darwin;
> state/beta; )
> Cseq: 411
> Last-Modified: Thu, 16 Oct 2008 00:21:52 GMT
> Cache-Control: must-revalidate
> Content-length: 741
> Date: Thu, 23 Oct 2008 02:30:28 GMT
> Expires: Thu, 23 Oct 2008 02:30:28 GMT
> Content-Type: application/sdp
> x-Accept-Retransmit: our-retransmit
> x-Accept-Dynamic-Rate: 1
> Content-Base: rtsp://www.fake.com:554/BBB.mp4/
> 
> v=0
> o=StreamingServer 3433717827 1224116512000 IN IP4 218.45.218.150
> s=/BBB.mp4
> u=http:///
> e=admin@
> c=IN IP4 0.0.0.0
> b=AS:500
> t=0 0
> a=control:*
> a=x-copyright: MP4/3GP File hinted with GPAC 0.4.4 (C)2000-2005 -
> http://gpac.sourceforge.net
> a=range:npt=0- 596.45800
> m=video 0 RTP/AVP 96
> b=AS:400
> a=rtpmap:96 H264/90000
> a=control:trackID=65536
> a=fmtp:96 profile-level-id=42C01E; packetization-mode=1;
> sprop-parameter-sets=Z0LAHppzgUBf8sIAAAMAAgAAAwBhHixc8A==,aM4yyA==
> a=framesize:96 640-360
> m=audio 0 RTP/AVP 97
> b=AS:100
> a=rtpmap:97 mpeg4-generic/48000/2
> a=control:trackID=65537
> a=fmtp:97 profile-level-id=41; config=1190; streamType=5;
> mode=AAC-hbr; objectType=64; sizeLength=13; indexLength=3;
> indexDeltaLength=3
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From ribs at acm.org  Fri Oct 31 03:07:44 2008
From: ribs at acm.org (Larry Edelstein)
Date: Thu, 30 Oct 2008 20:07:44 -0700
Subject: [ragel-users] access variable in expression?
Message-ID: <2021f8b20810302007r7907f7f7w9781161da9952c28@mail.gmail.com>

Am I able to use the value of a variable as an expression, and if so, how?

I am trying to parse a language like this:

number = digit+ >start_capture_number_of_names
%end_capture_number_of_names '\n';
name = ^[\n]* '\n';
main := number name{number_of_names}

where number_of_names is the number I captured earlier.

Can I do it this way, or do I need to iterate using actions and the
statements defined in 3.4 of the manual?

Larry Edelstein
San Francisco, CA
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.colm.net/pipermail/ragel/attachments/20081030/8b7c0306/attachment.html>

From thurston at complang.org  Fri Oct 31 06:17:31 2008
From: thurston at complang.org (Adrian Thurston)
Date: Fri, 31 Oct 2008 02:17:31 -0400
Subject: [ragel-users] access variable in expression?
In-Reply-To: <2021f8b20810302007r7907f7f7w9781161da9952c28@mail.gmail.com>
References: <2021f8b20810302007r7907f7f7w9781161da9952c28@mail.gmail.com>
Message-ID: <490AA2FB.2050304@complang.org>

Hi Larry,

Two options: you can use a separate machine instantiation to count items 
and jump back to the main machine when the number of items has been 
consumed like you suggest. The alternative is to use conditions if you 
need the counting to be done in a reusable machine definition. These are 
semantic tests that can be used to check a count. See section 6.5.

Cheers,
  Adrian

Larry Edelstein wrote:
> Am I able to use the value of a variable as an expression, and if so, how?
> 
> I am trying to parse a language like this:
> 
> number = digit+ >start_capture_number_of_names 
> %end_capture_number_of_names '\n';
> name = ^[\n]* '\n';
> main := number name{number_of_names}
> 
> where number_of_names is the number I captured earlier.  
> 
> Can I do it this way, or do I need to iterate using actions and the 
> statements defined in 3.4 of the manual?
> 
> Larry Edelstein
> San Francisco, CA
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From thurs... at cs.queensu.ca  Wed Oct  1 05:09:44 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Wed, 01 Oct 2008 01:09:44 -0400
Subject: [ragel-users] First FSM - is my approach correct?
In-Reply-To: <ec856bd0-d49d-4b3f-9102-4ac373b17784@x41g2000hsb.googlegroups.com>
References: <ec856bd0-d49d-4b3f-9102-4ac373b17784@x41g2000hsb.googlegroups.com>
Message-ID: <48E30618.3010709@cs.queensu.ca>

Hi Nick, it doesn't seem that what you want to do maps to the FSM model.
I think it might be more productive to bang out a mini version of this
without using ragel and then it might become clear if there is any
benefit at all to using ragel.

Adrian

Nick C wrote:
> Hi,
> 
> I would like to use Ragel to build a couple of FSMs based on the same
> machine definition, one handling data validation, and another to
> construct an interface (this would be the first time I use either
> Ragel or FSMs). The data causing state transitions will probably be
> passed in as key-value pairs. The validity of some keys depends on the
> values set for others; so for instance, if a user chooses
> "PublicTransport" as the value for the "FavouriteModeOfTransport" key,
> he will be able to choose from "Bus", "Metro", "Tramway" as possible
> values for the "FavouriteModeOfPublicTransport" key, but if he chooses
> "Motorbike" as the value for "FavouriteModeOfTransport", he won't be
> able to enter a value for "FavouriteModeOfPublicTransport" (validation
> would fail in the data validation routine, and the field wouldn't be
> displayed on the front end). There will be 40-50 different possible
> fields, out of which around 15 or so would be dependent on the values
> chosen for other fields. I can't guarantee the ordering of the keys,
> although I can guarantee that the "FavouriteModeOfPublicTransport" key
> would always be set after the "FavouriteModeOfTransport" key.
> 
> I was thinking as implementing this as a scanner, using conditions to
> determine whether the field is valid or not (for instance, the
> "FavouriteModeOfPublicTransport" field would only be valid if a
> "FavouriteModeOfTransport" field has already been supplied with the
> value set to "PublicTransport"). The disadvantage is that the full set
> of state transitions isn't purely defined in Ragel, which potentially
> makes the FSM hard to read (though if I'm correct defining the
> possible states for 15 conditional fields in Ragel would require 15^15
> different state definitions, which would probably be worse).
> 
> Do you think this approach would work? Am I missing a better way of
> doing this?
> 
> Thanks,
> Nick
> 


From flamee... at gmail.com  Wed Oct  1 14:36:52 2008
From: flamee... at gmail.com (Diego 'Flameeyes' =?utf-8?q?Petten=C3=B2?=)
Date: Wed, 01 Oct 2008 16:36:52 +0200
Subject: [PATCH 2/6] Remove files generated by autotools.
Message-ID: <20081001143647.22980.41584.stgit@yamato>

Remove from the repository the configure and config.h.in files
(generated by autoconf and autoheader respectively).

By removing config.h.in some information is lost (MSC support); to
restore that information, a config.h file might be created
specifically for MSC which only contains its definitions.
---

 common/config.h.in |   40 
 configure          | 4680 ----------------------------------------------------
 2 files changed, 0 insertions(+), 4720 deletions(-)
 delete mode 100644 common/config.h.in
 delete mode 100755 configure

diff --git a/common/config.h.in b/common/config.h.in
deleted file mode 100644
index eaacfb3..0000000
--- a/common/config.h.in
+++ /dev/null
@@ -1,40 +0,0 @@
-/*
- *  Copyright 2001 Adrian Thurston <thurs... at cs.queensu.ca>
- */
-
-/*  This file is part of Ragel.
- *
- *  Ragel is free software; you can redistribute it and/or modify
- *  it under the terms of the GNU General Public License as published by
- *  the Free Software Foundation; either version 2 of the License, or
- *  (at your option) any later version.
- * 
- *  Ragel is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  GNU General Public License for more details.
- * 
- *  You should have received a copy of the GNU General Public License
- *  along with Ragel; if not, write to the Free Software
- *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
- */
-
-#ifndef _CONFIG_H
-#define _CONFIG_H
-
-/* Programs. */
-#undef GDC
-#undef GOBJC
-#undef CXX
-#undef CC
-#undef JAVAC
-#undef TXL
-#undef RUBY
-#undef GMCS
-
-#ifdef _MSC_VER
-#define strtoll _strtoi64
-#pragma warning( disable: 4244 4250 4355 4800 )
-#endif
-
-#endif /* _CONFIG_H */
diff --git a/configure b/configure
deleted file mode 100755
index 47a1e4a..0000000
--- a/configure
+++ /dev/null
@@ -1,4680 +0,0 @@
-#! /bin/sh
-# Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.61.
-#
-# Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
-# 2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.
-# This configure script is free software; the Free Software Foundation
-# gives unlimited permission to copy, distribute and modify it.
-## --------------------- ##
-## M4sh Initialization.  ##
-## --------------------- ##
-
-# Be more Bourne compatible
-DUALCASE=1; export DUALCASE # for MKS sh
-if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
-  emulate sh
-  NULLCMD=:
-  # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
-  # is contrary to our usage.  Disable this feature.
-  alias -g '${1+"$@"}'='"$@"'
-  setopt NO_GLOB_SUBST
-else
-  case `(set -o) 2>/dev/null` in
-  *posix*) set -o posix ;;
-esac
-
-fi
-
-
-
-
-# PATH needs CR
-# Avoid depending upon Character Ranges.
-as_cr_letters='abcdefghijklmnopqrstuvwxyz'
-as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
-as_cr_Letters=$as_cr_letters$as_cr_LETTERS
-as_cr_digits='0123456789'
-as_cr_alnum=$as_cr_Letters$as_cr_digits
-
-# The user is always right.
-if test "${PATH_SEPARATOR+set}" != set; then
-  echo "#! /bin/sh" >conf$$.sh
-  echo  "exit 0"   >>conf$$.sh
-  chmod +x conf$$.sh
-  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
-    PATH_SEPARATOR=';'
-  else
-    PATH_SEPARATOR=:
-  fi
-  rm -f conf$$.sh
-fi
-
-# Support unset when possible.
-if ( (MAIL=60; unset MAIL) || exit) >/dev/null 2>&1; then
-  as_unset=unset
-else
-  as_unset=false
-fi
-
-
-# IFS
-# We need space, tab and new line, in precisely that order.  Quoting is
-# there to prevent editors from complaining about space-tab.
-# (If _AS_PATH_WALK were called with IFS unset, it would disable word
-# splitting by setting IFS to empty value.)
-as_nl='
-'
-IFS=" ""	$as_nl"
-
-# Find who we are.  Look in the path if we contain no directory separator.
-case $0 in
-  *[\\/]* ) as_myself=$0 ;;
-  *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
-done
-IFS=$as_save_IFS
-
-     ;;
-esac
-# We did not find ourselves, most probably we were run as `sh COMMAND'
-# in which case we are not to be found in the path.
-if test "x$as_myself" = x; then
-  as_myself=$0
-fi
-if test ! -f "$as_myself"; then
-  echo "$as_myself: error: cannot find myself; rerun with an absolute file name" >&2
-  { (exit 1); exit 1; }
-fi
-
-# Work around bugs in pre-3.0 UWIN ksh.
-for as_var in ENV MAIL MAILPATH
-do ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
-done
-PS1='$ '
-PS2='> '
-PS4='+ '
-
-# NLS nuisances.
-for as_var in \
-  LANG LANGUAGE LC_ADDRESS LC_ALL LC_COLLATE LC_CTYPE LC_IDENTIFICATION \
-  LC_MEASUREMENT LC_MESSAGES LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER \
-  LC_TELEPHONE LC_TIME
-do
-  if (set +x; test -z "`(eval $as_var=C; export $as_var) 2>&1`"); then
-    eval $as_var=C; export $as_var
-  else
-    ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
-  fi
-done
-
-# Required to use basename.
-if expr a : '\(a\)' >/dev/null 2>&1 &&
-   test "X`expr 00001 : '.*\(...\)'`" = X001; then
-  as_expr=expr
-else
-  as_expr=false
-fi
-
-if (basename -- /) >/dev/null 2>&1 && test "X`basename -- / 2>&1`" = "X/"; then
-  as_basename=basename
-else
-  as_basename=false
-fi
-
-
-# Name of the executable.
-as_me=`$as_basename -- "$0" ||
-$as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
-	 X"$0" : 'X\(//\)$' \| \
-	 X"$0" : 'X\(/\)' \| . 2>/dev/null ||
-echo X/"$0" |
-    sed '/^.*\/\([^/][^/]*\)\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\/\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\/\(\/\).*/{
-	    s//\1/
-	    q
-	  }
-	  s/.*/./; q'`
-
-# CDPATH.
-$as_unset CDPATH
-
-
-if test "x$CONFIG_SHELL" = x; then
-  if (eval ":") 2>/dev/null; then
-  as_have_required=yes
-else
-  as_have_required=no
-fi
-
-  if test $as_have_required = yes && 	 (eval ":
-(as_func_return () {
-  (exit \$1)
-}
-as_func_success () {
-  as_func_return 0
-}
-as_func_failure () {
-  as_func_return 1
-}
-as_func_ret_success () {
-  return 0
-}
-as_func_ret_failure () {
-  return 1
-}
-
-exitcode=0
-if as_func_success; then
-  :
-else
-  exitcode=1
-  echo as_func_success failed.
-fi
-
-if as_func_failure; then
-  exitcode=1
-  echo as_func_failure succeeded.
-fi
-
-if as_func_ret_success; then
-  :
-else
-  exitcode=1
-  echo as_func_ret_success failed.
-fi
-
-if as_func_ret_failure; then
-  exitcode=1
-  echo as_func_ret_failure succeeded.
-fi
-
-if ( set x; as_func_ret_success y && test x = \"\$1\" ); then
-  :
-else
-  exitcode=1
-  echo positional parameters were not saved.
-fi
-
-test \$exitcode = 0) || { (exit 1); exit 1; }
-
-(
-  as_lineno_1=\$LINENO
-  as_lineno_2=\$LINENO
-  test \"x\$as_lineno_1\" != \"x\$as_lineno_2\" &&
-  test \"x\`expr \$as_lineno_1 + 1\`\" = \"x\$as_lineno_2\") || { (exit 1); exit 1; }
-") 2> /dev/null; then
-  :
-else
-  as_candidate_shells=
-    as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in /bin$PATH_SEPARATOR/usr/bin$PATH_SEPARATOR$PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  case $as_dir in
-	 /*)
-	   for as_base in sh bash ksh sh5; do
-	     as_candidate_shells="$as_candidate_shells $as_dir/$as_base"
-	   done;;
-       esac
-done
-IFS=$as_save_IFS
-
-
-      for as_shell in $as_candidate_shells $SHELL; do
-	 # Try only shells that exist, to save several forks.
-	 if { test -f "$as_shell" || test -f "$as_shell.exe"; } &&
-		{ ("$as_shell") 2> /dev/null <<\_ASEOF
-if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
-  emulate sh
-  NULLCMD=:
-  # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
-  # is contrary to our usage.  Disable this feature.
-  alias -g '${1+"$@"}'='"$@"'
-  setopt NO_GLOB_SUBST
-else
-  case `(set -o) 2>/dev/null` in
-  *posix*) set -o posix ;;
-esac
-
-fi
-
-
-:
-_ASEOF
-}; then
-  CONFIG_SHELL=$as_shell
-	       as_have_required=yes
-	       if { "$as_shell" 2> /dev/null <<\_ASEOF
-if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
-  emulate sh
-  NULLCMD=:
-  # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
-  # is contrary to our usage.  Disable this feature.
-  alias -g '${1+"$@"}'='"$@"'
-  setopt NO_GLOB_SUBST
-else
-  case `(set -o) 2>/dev/null` in
-  *posix*) set -o posix ;;
-esac
-
-fi
-
-
-:
-(as_func_return () {
-  (exit $1)
-}
-as_func_success () {
-  as_func_return 0
-}
-as_func_failure () {
-  as_func_return 1
-}
-as_func_ret_success () {
-  return 0
-}
-as_func_ret_failure () {
-  return 1
-}
-
-exitcode=0
-if as_func_success; then
-  :
-else
-  exitcode=1
-  echo as_func_success failed.
-fi
-
-if as_func_failure; then
-  exitcode=1
-  echo as_func_failure succeeded.
-fi
-
-if as_func_ret_success; then
-  :
-else
-  exitcode=1
-  echo as_func_ret_success failed.
-fi
-
-if as_func_ret_failure; then
-  exitcode=1
-  echo as_func_ret_failure succeeded.
-fi
-
-if ( set x; as_func_ret_success y && test x = "$1" ); then
-  :
-else
-  exitcode=1
-  echo positional parameters were not saved.
-fi
-
-test $exitcode = 0) || { (exit 1); exit 1; }
-
-(
-  as_lineno_1=$LINENO
-  as_lineno_2=$LINENO
-  test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x`expr $as_lineno_1 + 1`" = "x$as_lineno_2") || { (exit 1); exit 1; }
-
-_ASEOF
-}; then
-  break
-fi
-
-fi
-
-      done
-
-      if test "x$CONFIG_SHELL" != x; then
-  for as_var in BASH_ENV ENV
-        do ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
-        done
-        export CONFIG_SHELL
-        exec "$CONFIG_SHELL" "$as_myself" ${1+"$@"}
-fi
-
-
-    if test $as_have_required = no; then
-  echo This script requires a shell more modern than all the
-      echo shells that I found on your system.  Please install a
-      echo modern shell, or manually run the script under such a
-      echo shell if you do have one.
-      { (exit 1); exit 1; }
-fi
-
-
-fi
-
-fi
-
-
-
-(eval "as_func_return () {
-  (exit \$1)
-}
-as_func_success () {
-  as_func_return 0
-}
-as_func_failure () {
-  as_func_return 1
-}
-as_func_ret_success () {
-  return 0
-}
-as_func_ret_failure () {
-  return 1
-}
-
-exitcode=0
-if as_func_success; then
-  :
-else
-  exitcode=1
-  echo as_func_success failed.
-fi
-
-if as_func_failure; then
-  exitcode=1
-  echo as_func_failure succeeded.
-fi
-
-if as_func_ret_success; then
-  :
-else
-  exitcode=1
-  echo as_func_ret_success failed.
-fi
-
-if as_func_ret_failure; then
-  exitcode=1
-  echo as_func_ret_failure succeeded.
-fi
-
-if ( set x; as_func_ret_success y && test x = \"\$1\" ); then
-  :
-else
-  exitcode=1
-  echo positional parameters were not saved.
-fi
-
-test \$exitcode = 0") || {
-  echo No shell found that supports shell functions.
-  echo Please tell autoc... at gnu.org about your system,
-  echo including any error possibly output before this
-  echo message
-}
-
-
-
-  as_lineno_1=$LINENO
-  as_lineno_2=$LINENO
-  test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x`expr $as_lineno_1 + 1`" = "x$as_lineno_2" || {
-
-  # Create $as_me.lineno as a copy of $as_myself, but with $LINENO
-  # uniformly replaced by the line number.  The first 'sed' inserts a
-  # line-number line after each line using $LINENO; the second 'sed'
-  # does the real work.  The second script uses 'N' to pair each
-  # line-number line with the line containing $LINENO, and appends
-  # trailing '-' during substitution so that $LINENO is not a special
-  # case at line end.
-  # (Raja R Harinath suggested sed '=', and Paul Eggert wrote the
-  # scripts with optimization help from Paolo Bonzini.  Blame Lee
-  # E. McMahon (1931-1989) for sed's syntax.  :-)
-  sed -n '
-    p
-    /[$]LINENO/=
-  ' <$as_myself |
-    sed '
-      s/[$]LINENO.*/&-/
-      t lineno
-      b
-      :lineno
-      N
-      :loop
-      s/[$]LINENO\([^'$as_cr_alnum'_].*\n\)\(.*\)/\2\1\2/
-      t loop
-      s/-\n.*//
-    ' >$as_me.lineno &&
-  chmod +x "$as_me.lineno" ||
-    { echo "$as_me: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&2
-   { (exit 1); exit 1; }; }
-
-  # Don't try to exec as it changes $[0], causing all sort of problems
-  # (the dirname of $[0] is not the place where we might find the
-  # original and so on.  Autoconf is especially sensitive to this).
-  . "./$as_me.lineno"
-  # Exit status is that of the last command.
-  exit
-}
-
-
-if (as_dir=`dirname -- /` && test "X$as_dir" = X/) >/dev/null 2>&1; then
-  as_dirname=dirname
-else
-  as_dirname=false
-fi
-
-ECHO_C= ECHO_N= ECHO_T=
-case `echo -n x` in
--n*)
-  case `echo 'x\c'` in
-  *c*) ECHO_T='	';;	# ECHO_T is single tab character.
-  *)   ECHO_C='\c';;
-  esac;;
-*)
-  ECHO_N='-n';;
-esac
-
-if expr a : '\(a\)' >/dev/null 2>&1 &&
-   test "X`expr 00001 : '.*\(...\)'`" = X001; then
-  as_expr=expr
-else
-  as_expr=false
-fi
-
-rm -f conf$$ conf$$.exe conf$$.file
-if test -d conf$$.dir; then
-  rm -f conf$$.dir/conf$$.file
-else
-  rm -f conf$$.dir
-  mkdir conf$$.dir
-fi
-echo >conf$$.file
-if ln -s conf$$.file conf$$ 2>/dev/null; then
-  as_ln_s='ln -s'
-  # ... but there are two gotchas:
-  # 1) On MSYS, both `ln -s file dir' and `ln file dir' fail.
-  # 2) DJGPP < 2.04 has no symlinks; `ln -s' creates a wrapper executable.
-  # In both cases, we have to default to `cp -p'.
-  ln -s conf$$.file conf$$.dir 2>/dev/null && test ! -f conf$$.exe ||
-    as_ln_s='cp -p'
-elif ln conf$$.file conf$$ 2>/dev/null; then
-  as_ln_s=ln
-else
-  as_ln_s='cp -p'
-fi
-rm -f conf$$ conf$$.exe conf$$.dir/conf$$.file conf$$.file
-rmdir conf$$.dir 2>/dev/null
-
-if mkdir -p . 2>/dev/null; then
-  as_mkdir_p=:
-else
-  test -d ./-p && rmdir ./-p
-  as_mkdir_p=false
-fi
-
-if test -x / >/dev/null 2>&1; then
-  as_test_x='test -x'
-else
-  if ls -dL / >/dev/null 2>&1; then
-    as_ls_L_option=L
-  else
-    as_ls_L_option=
-  fi
-  as_test_x='
-    eval sh -c '\''
-      if test -d "$1"; then
-        test -d "$1/.";
-      else
-	case $1 in
-        -*)set "./$1";;
-	esac;
-	case `ls -ld'$as_ls_L_option' "$1" 2>/dev/null` in
-	???[sx]*):;;*)false;;esac;fi
-    '\'' sh
-  '
-fi
-as_executable_p=$as_test_x
-
-# Sed expression to map a string onto a valid CPP name.
-as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
-
-# Sed expression to map a string onto a valid variable name.
-as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"
-
-
-
-exec 7<&0 </dev/null 6>&1
-
-# Name of the host.
-# hostname on some systems (SVR3.2, Linux) returns a bogus exit status,
-# so uname gets run too.
-ac_hostname=`(hostname || uname -n) 2>/dev/null | sed 1q`
-
-#
-# Initializations.
-#
-ac_default_prefix=/usr/local
-ac_clean_files=
-ac_config_libobj_dir=.
-LIBOBJS=
-cross_compiling=no
-subdirs=
-MFLAGS=
-MAKEFLAGS=
-SHELL=${CONFIG_SHELL-/bin/sh}
-
-# Identity of this package.
-PACKAGE_NAME=
-PACKAGE_TARNAME=
-PACKAGE_VERSION=
-PACKAGE_STRING=
-PACKAGE_BUGREPORT=
-
-ac_unique_file="ragel/main.cpp"
-ac_subst_vars='SHELL
-PATH_SEPARATOR
-PACKAGE_NAME
-PACKAGE_TARNAME
-PACKAGE_VERSION
-PACKAGE_STRING
-PACKAGE_BUGREPORT
-exec_prefix
-prefix
-program_transform_name
-bindir
-sbindir
-libexecdir
-datarootdir
-datadir
-sysconfdir
-sharedstatedir
-localstatedir
-includedir
-oldincludedir
-docdir
-infodir
-htmldir
-dvidir
-pdfdir
-psdir
-libdir
-localedir
-mandir
-DEFS
-ECHO_C
-ECHO_N
-ECHO_T
-LIBS
-build_alias
-host_alias
-target_alias
-BUILD_PARSERS
-CC
-CFLAGS
-LDFLAGS
-CPPFLAGS
-ac_ct_CC
-EXEEXT
-OBJEXT
-CXX
-CXXFLAGS
-ac_ct_CXX
-AR
-RANLIB
-SET_MAKE
-RAGEL
-GPERF
-KELBT
-GDC
-GOBJC
-JAVAC
-TXL
-RUBY
-GMCS
-LIBOBJS
-LTLIBOBJS'
-ac_subst_files=''
-      ac_precious_vars='build_alias
-host_alias
-target_alias
-CC
-CFLAGS
-LDFLAGS
-LIBS
-CPPFLAGS
-CXX
-CXXFLAGS
-CCC'
-
-
-# Initialize some variables set by options.
-ac_init_help=
-ac_init_version=false
-# The variables have the same names as the options, with
-# dashes changed to underlines.
-cache_file=/dev/null
-exec_prefix=NONE
-no_create=
-no_recursion=
-prefix=NONE
-program_prefix=NONE
-program_suffix=NONE
-program_transform_name=s,x,x,
-silent=
-site=
-srcdir=
-verbose=
-x_includes=NONE
-x_libraries=NONE
-
-# Installation directory options.
-# These are left unexpanded so users can "make install exec_prefix=/foo"
-# and all the variables that are supposed to be based on exec_prefix
-# by default will actually change.
-# Use braces instead of parens because sh, perl, etc. also accept them.
-# (The list follows the same order as the GNU Coding Standards.)
-bindir='${exec_prefix}/bin'
-sbindir='${exec_prefix}/sbin'
-libexecdir='${exec_prefix}/libexec'
-datarootdir='${prefix}/share'
-datadir='${datarootdir}'
-sysconfdir='${prefix}/etc'
-sharedstatedir='${prefix}/com'
-localstatedir='${prefix}/var'
-includedir='${prefix}/include'
-oldincludedir='/usr/include'
-docdir='${datarootdir}/doc/${PACKAGE}'
-infodir='${datarootdir}/info'
-htmldir='${docdir}'
-dvidir='${docdir}'
-pdfdir='${docdir}'
-psdir='${docdir}'
-libdir='${exec_prefix}/lib'
-localedir='${datarootdir}/locale'
-mandir='${datarootdir}/man'
-
-ac_prev=
-ac_dashdash=
-for ac_option
-do
-  # If the previous option needs an argument, assign it.
-  if test -n "$ac_prev"; then
-    eval $ac_prev=\$ac_option
-    ac_prev=
-    continue
-  fi
-
-  case $ac_option in
-  *=*)	ac_optarg=`expr "X$ac_option" : '[^=]*=\(.*\)'` ;;
-  *)	ac_optarg=yes ;;
-  esac
-
-  # Accept the important Cygnus configure options, so we can diagnose typos.
-
-  case $ac_dashdash$ac_option in
-  --)
-    ac_dashdash=yes ;;
-
-  -bindir | --bindir | --bindi | --bind | --bin | --bi)
-    ac_prev=bindir ;;
-  -bindir=* | --bindir=* | --bindi=* | --bind=* | --bin=* | --bi=*)
-    bindir=$ac_optarg ;;
-
-  -build | --build | --buil | --bui | --bu)
-    ac_prev=build_alias ;;
-  -build=* | --build=* | --buil=* | --bui=* | --bu=*)
-    build_alias=$ac_optarg ;;
-
-  -cache-file | --cache-file | --cache-fil | --cache-fi \
-  | --cache-f | --cache- | --cache | --cach | --cac | --ca | --c)
-    ac_prev=cache_file ;;
-  -cache-file=* | --cache-file=* | --cache-fil=* | --cache-fi=* \
-  | --cache-f=* | --cache-=* | --cache=* | --cach=* | --cac=* | --ca=* | --c=*)
-    cache_file=$ac_optarg ;;
-
-  --config-cache | -C)
-    cache_file=config.cache ;;
-
-  -datadir | --datadir | --datadi | --datad)
-    ac_prev=datadir ;;
-  -datadir=* | --datadir=* | --datadi=* | --datad=*)
-    datadir=$ac_optarg ;;
-
-  -datarootdir | --datarootdir | --datarootdi | --datarootd | --dataroot \
-  | --dataroo | --dataro | --datar)
-    ac_prev=datarootdir ;;
-  -datarootdir=* | --datarootdir=* | --datarootdi=* | --datarootd=* \
-  | --dataroot=* | --dataroo=* | --dataro=* | --datar=*)
-    datarootdir=$ac_optarg ;;
-
-  -disable-* | --disable-*)
-    ac_feature=`expr "x$ac_option" : 'x-*disable-\(.*\)'`
-    # Reject names that are not valid shell variable names.
-    expr "x$ac_feature" : ".*[^-._$as_cr_alnum]" >/dev/null &&
-      { echo "$as_me: error: invalid feature name: $ac_feature" >&2
-   { (exit 1); exit 1; }; }
-    ac_feature=`echo $ac_feature | sed 's/[-.]/_/g'`
-    eval enable_$ac_feature=no ;;
-
-  -docdir | --docdir | --docdi | --doc | --do)
-    ac_prev=docdir ;;
-  -docdir=* | --docdir=* | --docdi=* | --doc=* | --do=*)
-    docdir=$ac_optarg ;;
-
-  -dvidir | --dvidir | --dvidi | --dvid | --dvi | --dv)
-    ac_prev=dvidir ;;
-  -dvidir=* | --dvidir=* | --dvidi=* | --dvid=* | --dvi=* | --dv=*)
-    dvidir=$ac_optarg ;;
-
-  -enable-* | --enable-*)
-    ac_feature=`expr "x$ac_option" : 'x-*enable-\([^=]*\)'`
-    # Reject names that are not valid shell variable names.
-    expr "x$ac_feature" : ".*[^-._$as_cr_alnum]" >/dev/null &&
-      { echo "$as_me: error: invalid feature name: $ac_feature" >&2
-   { (exit 1); exit 1; }; }
-    ac_feature=`echo $ac_feature | sed 's/[-.]/_/g'`
-    eval enable_$ac_feature=\$ac_optarg ;;
-
-  -exec-prefix | --exec_prefix | --exec-prefix | --exec-prefi \
-  | --exec-pref | --exec-pre | --exec-pr | --exec-p | --exec- \
-  | --exec | --exe | --ex)
-    ac_prev=exec_prefix ;;
-  -exec-prefix=* | --exec_prefix=* | --exec-prefix=* | --exec-prefi=* \
-  | --exec-pref=* | --exec-pre=* | --exec-pr=* | --exec-p=* | --exec-=* \
-  | --exec=* | --exe=* | --ex=*)
-    exec_prefix=$ac_optarg ;;
-
-  -gas | --gas | --ga | --g)
-    # Obsolete; use --with-gas.
-    with_gas=yes ;;
-
-  -help | --help | --hel | --he | -h)
-    ac_init_help=long ;;
-  -help=r* | --help=r* | --hel=r* | --he=r* | -hr*)
-    ac_init_help=recursive ;;
-  -help=s* | --help=s* | --hel=s* | --he=s* | -hs*)
-    ac_init_help=short ;;
-
-  -host | --host | --hos | --ho)
-    ac_prev=host_alias ;;
-  -host=* | --host=* | --hos=* | --ho=*)
-    host_alias=$ac_optarg ;;
-
-  -htmldir | --htmldir | --htmldi | --htmld | --html | --htm | --ht)
-    ac_prev=htmldir ;;
-  -htmldir=* | --htmldir=* | --htmldi=* | --htmld=* | --html=* | --htm=* \
-  | --ht=*)
-    htmldir=$ac_optarg ;;
-
-  -includedir | --includedir | --includedi | --included | --include \
-  | --includ | --inclu | --incl | --inc)
-    ac_prev=includedir ;;
-  -includedir=* | --includedir=* | --includedi=* | --included=* | --include=* \
-  | --includ=* | --inclu=* | --incl=* | --inc=*)
-    includedir=$ac_optarg ;;
-
-  -infodir | --infodir | --infodi | --infod | --info | --inf)
-    ac_prev=infodir ;;
-  -infodir=* | --infodir=* | --infodi=* | --infod=* | --info=* | --inf=*)
-    infodir=$ac_optarg ;;
-
-  -libdir | --libdir | --libdi | --libd)
-    ac_prev=libdir ;;
-  -libdir=* | --libdir=* | --libdi=* | --libd=*)
-    libdir=$ac_optarg ;;
-
-  -libexecdir | --libexecdir | --libexecdi | --libexecd | --libexec \
-  | --libexe | --libex | --libe)
-    ac_prev=libexecdir ;;
-  -libexecdir=* | --libexecdir=* | --libexecdi=* | --libexecd=* | --libexec=* \
-  | --libexe=* | --libex=* | --libe=*)
-    libexecdir=$ac_optarg ;;
-
-  -localedir | --localedir | --localedi | --localed | --locale)
-    ac_prev=localedir ;;
-  -localedir=* | --localedir=* | --localedi=* | --localed=* | --locale=*)
-    localedir=$ac_optarg ;;
-
-  -localstatedir | --localstatedir | --localstatedi | --localstated \
-  | --localstate | --localstat | --localsta | --localst | --locals)
-    ac_prev=localstatedir ;;
-  -localstatedir=* | --localstatedir=* | --localstatedi=* | --localstated=* \
-  | --localstate=* | --localstat=* | --localsta=* | --localst=* | --locals=*)
-    localstatedir=$ac_optarg ;;
-
-  -mandir | --mandir | --mandi | --mand | --man | --ma | --m)
-    ac_prev=mandir ;;
-  -mandir=* | --mandir=* | --mandi=* | --mand=* | --man=* | --ma=* | --m=*)
-    mandir=$ac_optarg ;;
-
-  -nfp | --nfp | --nf)
-    # Obsolete; use --without-fp.
-    with_fp=no ;;
-
-  -no-create | --no-create | --no-creat | --no-crea | --no-cre \
-  | --no-cr | --no-c | -n)
-    no_create=yes ;;
-
-  -no-recursion | --no-recursion | --no-recursio | --no-recursi \
-  | --no-recurs | --no-recur | --no-recu | --no-rec | --no-re | --no-r)
-    no_recursion=yes ;;
-
-  -oldincludedir | --oldincludedir | --oldincludedi | --oldincluded \
-  | --oldinclude | --oldinclud | --oldinclu | --oldincl | --oldinc \
-  | --oldin | --oldi | --old | --ol | --o)
-    ac_prev=oldincludedir ;;
-  -oldincludedir=* | --oldincludedir=* | --oldincludedi=* | --oldincluded=* \
-  | --oldinclude=* | --oldinclud=* | --oldinclu=* | --oldincl=* | --oldinc=* \
-  | --oldin=* | --oldi=* | --old=* | --ol=* | --o=*)
-    oldincludedir=$ac_optarg ;;
-
-  -prefix | --prefix | --prefi | --pref | --pre | --pr | --p)
-    ac_prev=prefix ;;
-  -prefix=* | --prefix=* | --prefi=* | --pref=* | --pre=* | --pr=* | --p=*)
-    prefix=$ac_optarg ;;
-
-  -program-prefix | --program-prefix | --program-prefi | --program-pref \
-  | --program-pre | --program-pr | --program-p)
-    ac_prev=program_prefix ;;
-  -program-prefix=* | --program-prefix=* | --program-prefi=* \
-  | --program-pref=* | --program-pre=* | --program-pr=* | --program-p=*)
-    program_prefix=$ac_optarg ;;
-
-  -program-suffix | --program-suffix | --program-suffi | --program-suff \
-  | --program-suf | --program-su | --program-s)
-    ac_prev=program_suffix ;;
-  -program-suffix=* | --program-suffix=* | --program-suffi=* \
-  | --program-suff=* | --program-suf=* | --program-su=* | --program-s=*)
-    program_suffix=$ac_optarg ;;
-
-  -program-transform-name | --program-transform-name \
-  | --program-transform-nam | --program-transform-na \
-  | --program-transform-n | --program-transform- \
-  | --program-transform | --program-transfor \
-  | --program-transfo | --program-transf \
-  | --program-trans | --program-tran \
-  | --progr-tra | --program-tr | --program-t)
-    ac_prev=program_transform_name ;;
-  -program-transform-name=* | --program-transform-name=* \
-  | --program-transform-nam=* | --program-transform-na=* \
-  | --program-transform-n=* | --program-transform-=* \
-  | --program-transform=* | --program-transfor=* \
-  | --program-transfo=* | --program-transf=* \
-  | --program-trans=* | --program-tran=* \
-  | --progr-tra=* | --program-tr=* | --program-t=*)
-    program_transform_name=$ac_optarg ;;
-
-  -pdfdir | --pdfdir | --pdfdi | --pdfd | --pdf | --pd)
-    ac_prev=pdfdir ;;
-  -pdfdir=* | --pdfdir=* | --pdfdi=* | --pdfd=* | --pdf=* | --pd=*)
-    pdfdir=$ac_optarg ;;
-
-  -psdir | --psdir | --psdi | --psd | --ps)
-    ac_prev=psdir ;;
-  -psdir=* | --psdir=* | --psdi=* | --psd=* | --ps=*)
-    psdir=$ac_optarg ;;
-
-  -q | -quiet | --quiet | --quie | --qui | --qu | --q \
-  | -silent | --silent | --silen | --sile | --sil)
-    silent=yes ;;
-
-  -sbindir | --sbindir | --sbindi | --sbind | --sbin | --sbi | --sb)
-    ac_prev=sbindir ;;
-  -sbindir=* | --sbindir=* | --sbindi=* | --sbind=* | --sbin=* \
-  | --sbi=* | --sb=*)
-    sbindir=$ac_optarg ;;
-
-  -sharedstatedir | --sharedstatedir | --sharedstatedi \
-  | --sharedstated | --sharedstate | --sharedstat | --sharedsta \
-  | --sharedst | --shareds | --shared | --share | --shar \
-  | --sha | --sh)
-    ac_prev=sharedstatedir ;;
-  -sharedstatedir=* | --sharedstatedir=* | --sharedstatedi=* \
-  | --sharedstated=* | --sharedstate=* | --sharedstat=* | --sharedsta=* \
-  | --sharedst=* | --shareds=* | --shared=* | --share=* | --shar=* \
-  | --sha=* | --sh=*)
-    sharedstatedir=$ac_optarg ;;
-
-  -site | --site | --sit)
-    ac_prev=site ;;
-  -site=* | --site=* | --sit=*)
-    site=$ac_optarg ;;
-
-  -srcdir | --srcdir | --srcdi | --srcd | --src | --sr)
-    ac_prev=srcdir ;;
-  -srcdir=* | --srcdir=* | --srcdi=* | --srcd=* | --src=* | --sr=*)
-    srcdir=$ac_optarg ;;
-
-  -sysconfdir | --sysconfdir | --sysconfdi | --sysconfd | --sysconf \
-  | --syscon | --sysco | --sysc | --sys | --sy)
-    ac_prev=sysconfdir ;;
-  -sysconfdir=* | --sysconfdir=* | --sysconfdi=* | --sysconfd=* | --sysconf=* \
-  | --syscon=* | --sysco=* | --sysc=* | --sys=* | --sy=*)
-    sysconfdir=$ac_optarg ;;
-
-  -target | --target | --targe | --targ | --tar | --ta | --t)
-    ac_prev=target_alias ;;
-  -target=* | --target=* | --targe=* | --targ=* | --tar=* | --ta=* | --t=*)
-    target_alias=$ac_optarg ;;
-
-  -v | -verbose | --verbose | --verbos | --verbo | --verb)
-    verbose=yes ;;
-
-  -version | --version | --versio | --versi | --vers | -V)
-    ac_init_version=: ;;
-
-  -with-* | --with-*)
-    ac_package=`expr "x$ac_option" : 'x-*with-\([^=]*\)'`
-    # Reject names that are not valid shell variable names.
-    expr "x$ac_package" : ".*[^-._$as_cr_alnum]" >/dev/null &&
-      { echo "$as_me: error: invalid package name: $ac_package" >&2
-   { (exit 1); exit 1; }; }
-    ac_package=`echo $ac_package | sed 's/[-.]/_/g'`
-    eval with_$ac_package=\$ac_optarg ;;
-
-  -without-* | --without-*)
-    ac_package=`expr "x$ac_option" : 'x-*without-\(.*\)'`
-    # Reject names that are not valid shell variable names.
-    expr "x$ac_package" : ".*[^-._$as_cr_alnum]" >/dev/null &&
-      { echo "$as_me: error: invalid package name: $ac_package" >&2
-   { (exit 1); exit 1; }; }
-    ac_package=`echo $ac_package | sed 's/[-.]/_/g'`
-    eval with_$ac_package=no ;;
-
-  --x)
-    # Obsolete; use --with-x.
-    with_x=yes ;;
-
-  -x-includes | --x-includes | --x-include | --x-includ | --x-inclu \
-  | --x-incl | --x-inc | --x-in | --x-i)
-    ac_prev=x_includes ;;
-  -x-includes=* | --x-includes=* | --x-include=* | --x-includ=* | --x-inclu=* \
-  | --x-incl=* | --x-inc=* | --x-in=* | --x-i=*)
-    x_includes=$ac_optarg ;;
-
-  -x-libraries | --x-libraries | --x-librarie | --x-librari \
-  | --x-librar | --x-libra | --x-libr | --x-lib | --x-li | --x-l)
-    ac_prev=x_libraries ;;
-  -x-libraries=* | --x-libraries=* | --x-librarie=* | --x-librari=* \
-  | --x-librar=* | --x-libra=* | --x-libr=* | --x-lib=* | --x-li=* | --x-l=*)
-    x_libraries=$ac_optarg ;;
-
-  -*) { echo "$as_me: error: unrecognized option: $ac_option
-Try \`$0 --help' for more information." >&2
-   { (exit 1); exit 1; }; }
-    ;;
-
-  *=*)
-    ac_envvar=`expr "x$ac_option" : 'x\([^=]*\)='`
-    # Reject names that are not valid shell variable names.
-    expr "x$ac_envvar" : ".*[^_$as_cr_alnum]" >/dev/null &&
-      { echo "$as_me: error: invalid variable name: $ac_envvar" >&2
-   { (exit 1); exit 1; }; }
-    eval $ac_envvar=\$ac_optarg
-    export $ac_envvar ;;
-
-  *)
-    # FIXME: should be removed in autoconf 3.0.
-    echo "$as_me: WARNING: you should use --build, --host, --target" >&2
-    expr "x$ac_option" : ".*[^-._$as_cr_alnum]" >/dev/null &&
-      echo "$as_me: WARNING: invalid host type: $ac_option" >&2
-    : ${build_alias=$ac_option} ${host_alias=$ac_option} ${target_alias=$ac_option}
-    ;;
-
-  esac
-done
-
-if test -n "$ac_prev"; then
-  ac_option=--`echo $ac_prev | sed 's/_/-/g'`
-  { echo "$as_me: error: missing argument to $ac_option" >&2
-   { (exit 1); exit 1; }; }
-fi
-
-# Be sure to have absolute directory names.
-for ac_var in	exec_prefix prefix bindir sbindir libexecdir datarootdir \
-		datadir sysconfdir sharedstatedir localstatedir includedir \
-		oldincludedir docdir infodir htmldir dvidir pdfdir psdir \
-		libdir localedir mandir
-do
-  eval ac_val=\$$ac_var
-  case $ac_val in
-    [\\/$]* | ?:[\\/]* )  continue;;
-    NONE | '' ) case $ac_var in *prefix ) continue;; esac;;
-  esac
-  { echo "$as_me: error: expected an absolute directory name for --$ac_var: $ac_val" >&2
-   { (exit 1); exit 1; }; }
-done
-
-# There might be people who depend on the old broken behavior: `$host'
-# used to hold the argument of --host etc.
-# FIXME: To remove some day.
-build=$build_alias
-host=$host_alias
-target=$target_alias
-
-# FIXME: To remove some day.
-if test "x$host_alias" != x; then
-  if test "x$build_alias" = x; then
-    cross_compiling=maybe
-    echo "$as_me: WARNING: If you wanted to set the --build type, don't use --host.
-    If a cross compiler is detected then cross compile mode will be used." >&2
-  elif test "x$build_alias" != "x$host_alias"; then
-    cross_compiling=yes
-  fi
-fi
-
-ac_tool_prefix=
-test -n "$host_alias" && ac_tool_prefix=$host_alias-
-
-test "$silent" = yes && exec 6>/dev/null
-
-
-ac_pwd=`pwd` && test -n "$ac_pwd" &&
-ac_ls_di=`ls -di .` &&
-ac_pwd_ls_di=`cd "$ac_pwd" && ls -di .` ||
-  { echo "$as_me: error: Working directory cannot be determined" >&2
-   { (exit 1); exit 1; }; }
-test "X$ac_ls_di" = "X$ac_pwd_ls_di" ||
-  { echo "$as_me: error: pwd does not report name of working directory" >&2
-   { (exit 1); exit 1; }; }
-
-
-# Find the source files, if location was not specified.
-if test -z "$srcdir"; then
-  ac_srcdir_defaulted=yes
-  # Try the directory containing this script, then the parent directory.
-  ac_confdir=`$as_dirname -- "$0" ||
-$as_expr X"$0" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$0" : 'X\(//\)[^/]' \| \
-	 X"$0" : 'X\(//\)$' \| \
-	 X"$0" : 'X\(/\)' \| . 2>/dev/null ||
-echo X"$0" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)[^/].*/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\).*/{
-	    s//\1/
-	    q
-	  }
-	  s/.*/./; q'`
-  srcdir=$ac_confdir
-  if test ! -r "$srcdir/$ac_unique_file"; then
-    srcdir=..
-  fi
-else
-  ac_srcdir_defaulted=no
-fi
-if test ! -r "$srcdir/$ac_unique_file"; then
-  test "$ac_srcdir_defaulted" = yes && srcdir="$ac_confdir or .."
-  { echo "$as_me: error: cannot find sources ($ac_unique_file) in $srcdir" >&2
-   { (exit 1); exit 1; }; }
-fi
-ac_msg="sources are in $srcdir, but \`cd $srcdir' does not work"
-ac_abs_confdir=`(
-	cd "$srcdir" && test -r "./$ac_unique_file" || { echo "$as_me: error: $ac_msg" >&2
-   { (exit 1); exit 1; }; }
-	pwd)`
-# When building in place, set srcdir=.
-if test "$ac_abs_confdir" = "$ac_pwd"; then
-  srcdir=.
-fi
-# Remove unnecessary trailing slashes from srcdir.
-# Double slashes in file names in object file debugging info
-# mess up M-x gdb in Emacs.
-case $srcdir in
-*/) srcdir=`expr "X$srcdir" : 'X\(.*[^/]\)' \| "X$srcdir" : 'X\(.*\)'`;;
-esac
-for ac_var in $ac_precious_vars; do
-  eval ac_env_${ac_var}_set=\${${ac_var}+set}
-  eval ac_env_${ac_var}_value=\$${ac_var}
-  eval ac_cv_env_${ac_var}_set=\${${ac_var}+set}
-  eval ac_cv_env_${ac_var}_value=\$${ac_var}
-done
-
-#
-# Report the --help message.
-#
-if test "$ac_init_help" = "long"; then
-  # Omit some internal or obsolete options to make the list less imposing.
-  # This message is too long to be a string in the A/UX 3.1 sh.
-  cat <<_ACEOF
-\`configure' configures this package to adapt to many kinds of systems.
-
-Usage: $0 [OPTION]... [VAR=VALUE]...
-
-To assign environment variables (e.g., CC, CFLAGS...), specify them as
-VAR=VALUE.  See below for descriptions of some of the useful variables.
-
-Defaults for the options are specified in brackets.
-
-Configuration:
-  -h, --help              display this help and exit
-      --help=short        display options specific to this package
-      --help=recursive    display the short help of all the included packages
-  -V, --version           display version information and exit
-  -q, --quiet, --silent   do not print \`checking...' messages
-      --cache-file=FILE   cache test results in FILE [disabled]
-  -C, --config-cache      alias for \`--cache-file=config.cache'
-  -n, --no-create         do not create output files
-      --srcdir=DIR        find the sources in DIR [configure dir or \`..']
-
-Installation directories:
-  --prefix=PREFIX         install architecture-independent files in PREFIX
-			  [$ac_default_prefix]
-  --exec-prefix=EPREFIX   install architecture-dependent files in EPREFIX
-			  [PREFIX]
-
-By default, \`make install' will install all the files in
-\`$ac_default_prefix/bin', \`$ac_default_prefix/lib' etc.  You can specify
-an installation prefix other than \`$ac_default_prefix' using \`--prefix',
-for instance \`--prefix=\$HOME'.
-
-For better control, use the options below.
-
-Fine tuning of the installation directories:
-  --bindir=DIR           user executables [EPREFIX/bin]
-  --sbindir=DIR          system admin executables [EPREFIX/sbin]
-  --libexecdir=DIR       program executables [EPREFIX/libexec]
-  --sysconfdir=DIR       read-only single-machine data [PREFIX/etc]
-  --sharedstatedir=DIR   modifiable architecture-independent data [PREFIX/com]
-  --localstatedir=DIR    modifiable single-machine data [PREFIX/var]
-  --libdir=DIR           object code libraries [EPREFIX/lib]
-  --includedir=DIR       C header files [PREFIX/include]
-  --oldincludedir=DIR    C header files for non-gcc [/usr/include]
-  --datarootdir=DIR      read-only arch.-independent data root [PREFIX/share]
-  --datadir=DIR          read-only architecture-independent data [DATAROOTDIR]
-  --infodir=DIR          info documentation [DATAROOTDIR/info]
-  --localedir=DIR        locale-dependent data [DATAROOTDIR/locale]
-  --mandir=DIR           man documentation [DATAROOTDIR/man]
-  --docdir=DIR           documentation root [DATAROOTDIR/doc/PACKAGE]
-  --htmldir=DIR          html documentation [DOCDIR]
-  --dvidir=DIR           dvi documentation [DOCDIR]
-  --pdfdir=DIR           pdf documentation [DOCDIR]
-  --psdir=DIR            ps documentation [DOCDIR]
-_ACEOF
-
-  cat <<\_ACEOF
-_ACEOF
-fi
-
-if test -n "$ac_init_help"; then
-
-  cat <<\_ACEOF
-
-Some influential environment variables:
-  CC          C compiler command
-  CFLAGS      C compiler flags
-  LDFLAGS     linker flags, e.g. -L<lib dir> if you have libraries in a
-              nonstandard directory <lib dir>
-  LIBS        libraries to pass to the linker, e.g. -l<library>
-  CPPFLAGS    C/C++/Objective C preprocessor flags, e.g. -I<include dir> if
-              you have headers in a nonstandard directory <include dir>
-  CXX         C++ compiler command
-  CXXFLAGS    C++ compiler flags
-
-Use these variables to override the choices made by `configure' or to help
-it to find libraries and programs with nonstandard names/locations.
-
-_ACEOF
-ac_status=$?
-fi
-
-if test "$ac_init_help" = "recursive"; then
-  # If there are subdirs, report their specific --help.
-  for ac_dir in : $ac_subdirs_all; do test "x$ac_dir" = x: && continue
-    test -d "$ac_dir" || continue
-    ac_builddir=.
-
-case "$ac_dir" in
-.) ac_dir_suffix= ac_top_builddir_sub=. ac_top_build_prefix= ;;
-*)
-  ac_dir_suffix=/`echo "$ac_dir" | sed 's,^\.[\\/],,'`
-  # A ".." for each directory in $ac_dir_suffix.
-  ac_top_builddir_sub=`echo "$ac_dir_suffix" | sed 's,/[^\\/]*,/..,g;s,/,,'`
-  case $ac_top_builddir_sub in
-  "") ac_top_builddir_sub=. ac_top_build_prefix= ;;
-  *)  ac_top_build_prefix=$ac_top_builddir_sub/ ;;
-  esac ;;
-esac
-ac_abs_top_builddir=$ac_pwd
-ac_abs_builddir=$ac_pwd$ac_dir_suffix
-# for backward compatibility:
-ac_top_builddir=$ac_top_build_prefix
-
-case $srcdir in
-  .)  # We are building in place.
-    ac_srcdir=.
-    ac_top_srcdir=$ac_top_builddir_sub
-    ac_abs_top_srcdir=$ac_pwd ;;
-  [\\/]* | ?:[\\/]* )  # Absolute name.
-    ac_srcdir=$srcdir$ac_dir_suffix;
-    ac_top_srcdir=$srcdir
-    ac_abs_top_srcdir=$srcdir ;;
-  *) # Relative name.
-    ac_srcdir=$ac_top_build_prefix$srcdir$ac_dir_suffix
-    ac_top_srcdir=$ac_top_build_prefix$srcdir
-    ac_abs_top_srcdir=$ac_pwd/$srcdir ;;
-esac
-ac_abs_srcdir=$ac_abs_top_srcdir$ac_dir_suffix
-
-    cd "$ac_dir" || { ac_status=$?; continue; }
-    # Check for guested configure.
-    if test -f "$ac_srcdir/configure.gnu"; then
-      echo &&
-      $SHELL "$ac_srcdir/configure.gnu" --help=recursive
-    elif test -f "$ac_srcdir/configure"; then
-      echo &&
-      $SHELL "$ac_srcdir/configure" --help=recursive
-    else
-      echo "$as_me: WARNING: no configuration information is in $ac_dir" >&2
-    fi || ac_status=$?
-    cd "$ac_pwd" || { ac_status=$?; break; }
-  done
-fi
-
-test -n "$ac_init_help" && exit $ac_status
-if $ac_init_version; then
-  cat <<\_ACEOF
-configure
-generated by GNU Autoconf 2.61
-
-Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
-2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.
-This configure script is free software; the Free Software Foundation
-gives unlimited permission to copy, distribute and modify it.
-_ACEOF
-  exit
-fi
-cat >config.log <<_ACEOF
-This file contains any messages produced by compilers while
-running configure, to aid debugging if configure makes a mistake.
-
-It was created by $as_me, which was
-generated by GNU Autoconf 2.61.  Invocation command line was
-
-  $ $0 $@
-
-_ACEOF
-exec 5>>config.log
-{
-cat <<_ASUNAME
-## --------- ##
-## Platform. ##
-## --------- ##
-
-hostname = `(hostname || uname -n) 2>/dev/null | sed 1q`
-uname -m = `(uname -m) 2>/dev/null || echo unknown`
-uname -r = `(uname -r) 2>/dev/null || echo unknown`
-uname -s = `(uname -s) 2>/dev/null || echo unknown`
-uname -v = `(uname -v) 2>/dev/null || echo unknown`
-
-/usr/bin/uname -p = `(/usr/bin/uname -p) 2>/dev/null || echo unknown`
-/bin/uname -X     = `(/bin/uname -X) 2>/dev/null     || echo unknown`
-
-/bin/arch              = `(/bin/arch) 2>/dev/null              || echo unknown`
-/usr/bin/arch -k       = `(/usr/bin/arch -k) 2>/dev/null       || echo unknown`
-/usr/convex/getsysinfo = `(/usr/convex/getsysinfo) 2>/dev/null || echo unknown`
-/usr/bin/hostinfo      = `(/usr/bin/hostinfo) 2>/dev/null      || echo unknown`
-/bin/machine           = `(/bin/machine) 2>/dev/null           || echo unknown`
-/usr/bin/oslevel       = `(/usr/bin/oslevel) 2>/dev/null       || echo unknown`
-/bin/universe          = `(/bin/universe) 2>/dev/null          || echo unknown`
-
-_ASUNAME
-
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  echo "PATH: $as_dir"
-done
-IFS=$as_save_IFS
-
-} >&5
-
-cat >&5 <<_ACEOF
-
-
-## ----------- ##
-## Core tests. ##
-## ----------- ##
-
-_ACEOF
-
-
-# Keep a trace of the command line.
-# Strip out --no-create and --no-recursion so they do not pile up.
-# Strip out --silent because we don't want to record it for future runs.
-# Also quote any args containing shell meta-characters.
-# Make two passes to allow for proper duplicate-argument suppression.
-ac_configure_args=
-ac_configure_args0=
-ac_configure_args1=
-ac_must_keep_next=false
-for ac_pass in 1 2
-do
-  for ac_arg
-  do
-    case $ac_arg in
-    -no-create | --no-c* | -n | -no-recursion | --no-r*) continue ;;
-    -q | -quiet | --quiet | --quie | --qui | --qu | --q \
-    | -silent | --silent | --silen | --sile | --sil)
-      continue ;;
-    *\'*)
-      ac_arg=`echo "$ac_arg" | sed "s/'/'\\\\\\\\''/g"` ;;
-    esac
-    case $ac_pass in
-    1) ac_configure_args0="$ac_configure_args0 '$ac_arg'" ;;
-    2)
-      ac_configure_args1="$ac_configure_args1 '$ac_arg'"
-      if test $ac_must_keep_next = true; then
-	ac_must_keep_next=false # Got value, back to normal.
-      else
-	case $ac_arg in
-	  *=* | --config-cache | -C | -disable-* | --disable-* \
-	  | -enable-* | --enable-* | -gas | --g* | -nfp | --nf* \
-	  | -q | -quiet | --q* | -silent | --sil* | -v | -verb* \
-	  | -with-* | --with-* | -without-* | --without-* | --x)
-	    case "$ac_configure_args0 " in
-	      "$ac_configure_args1"*" '$ac_arg' "* ) continue ;;
-	    esac
-	    ;;
-	  -* ) ac_must_keep_next=true ;;
-	esac
-      fi
-      ac_configure_args="$ac_configure_args '$ac_arg'"
-      ;;
-    esac
-  done
-done
-$as_unset ac_configure_args0 || test "${ac_configure_args0+set}" != set || { ac_configure_args0=; export ac_configure_args0; }
-$as_unset ac_configure_args1 || test "${ac_configure_args1+set}" != set || { ac_configure_args1=; export ac_configure_args1; }
-
-# When interrupted or exit'd, cleanup temporary files, and complete
-# config.log.  We remove comments because anyway the quotes in there
-# would cause problems or look ugly.
-# WARNING: Use '\'' to represent an apostrophe within the trap.
-# WARNING: Do not start the trap code with a newline, due to a FreeBSD 4.0 bug.
-trap 'exit_status=$?
-  # Save into config.log some information that might help in debugging.
-  {
-    echo
-
-    cat <<\_ASBOX
-## ---------------- ##
-## Cache variables. ##
-## ---------------- ##
-_ASBOX
-    echo
-    # The following way of writing the cache mishandles newlines in values,
-(
-  for ac_var in `(set) 2>&1 | sed -n '\''s/^\([a-zA-Z_][a-zA-Z0-9_]*\)=.*/\1/p'\''`; do
-    eval ac_val=\$$ac_var
-    case $ac_val in #(
-    *${as_nl}*)
-      case $ac_var in #(
-      *_cv_*) { echo "$as_me:$LINENO: WARNING: Cache variable $ac_var contains a newline." >&5
-echo "$as_me: WARNING: Cache variable $ac_var contains a newline." >&2;} ;;
-      esac
-      case $ac_var in #(
-      _ | IFS | as_nl) ;; #(
-      *) $as_unset $ac_var ;;
-      esac ;;
-    esac
-  done
-  (set) 2>&1 |
-    case $as_nl`(ac_space='\'' '\''; set) 2>&1` in #(
-    *${as_nl}ac_space=\ *)
-      sed -n \
-	"s/'\''/'\''\\\\'\'''\''/g;
-	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='\''\\2'\''/p"
-      ;; #(
-    *)
-      sed -n "/^[_$as_cr_alnum]*_cv_[_$as_cr_alnum]*=/p"
-      ;;
-    esac |
-    sort
-)
-    echo
-
-    cat <<\_ASBOX
-## ----------------- ##
-## Output variables. ##
-## ----------------- ##
-_ASBOX
-    echo
-    for ac_var in $ac_subst_vars
-    do
-      eval ac_val=\$$ac_var
-      case $ac_val in
-      *\'\''*) ac_val=`echo "$ac_val" | sed "s/'\''/'\''\\\\\\\\'\'''\''/g"`;;
-      esac
-      echo "$ac_var='\''$ac_val'\''"
-    done | sort
-    echo
-
-    if test -n "$ac_subst_files"; then
-      cat <<\_ASBOX
-## ------------------- ##
-## File substitutions. ##
-## ------------------- ##
-_ASBOX
-      echo
-      for ac_var in $ac_subst_files
-      do
-	eval ac_val=\$$ac_var
-	case $ac_val in
-	*\'\''*) ac_val=`echo "$ac_val" | sed "s/'\''/'\''\\\\\\\\'\'''\''/g"`;;
-	esac
-	echo "$ac_var='\''$ac_val'\''"
-      done | sort
-      echo
-    fi
-
-    if test -s confdefs.h; then
-      cat <<\_ASBOX
-## ----------- ##
-## confdefs.h. ##
-## ----------- ##
-_ASBOX
-      echo
-      cat confdefs.h
-      echo
-    fi
-    test "$ac_signal" != 0 &&
-      echo "$as_me: caught signal $ac_signal"
-    echo "$as_me: exit $exit_status"
-  } >&5
-  rm -f core *.core core.conftest.* &&
-    rm -f -r conftest* confdefs* conf$$* $ac_clean_files &&
-    exit $exit_status
-' 0
-for ac_signal in 1 2 13 15; do
-  trap 'ac_signal='$ac_signal'; { (exit 1); exit 1; }' $ac_signal
-done
-ac_signal=0
-
-# confdefs.h avoids OS command line length limits that DEFS can exceed.
-rm -f -r conftest* confdefs.h
-
-# Predefined preprocessor variables.
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_NAME "$PACKAGE_NAME"
-_ACEOF
-
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_TARNAME "$PACKAGE_TARNAME"
-_ACEOF
-
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_VERSION "$PACKAGE_VERSION"
-_ACEOF
-
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_STRING "$PACKAGE_STRING"
-_ACEOF
-
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_BUGREPORT "$PACKAGE_BUGREPORT"
-_ACEOF
-
-
-# Let the site file select an alternate cache file if it wants to.
-# Prefer explicitly selected file to automatically selected ones.
-if test -n "$CONFIG_SITE"; then
-  set x "$CONFIG_SITE"
-elif test "x$prefix" != xNONE; then
-  set x "$prefix/share/config.site" "$prefix/etc/config.site"
-else
-  set x "$ac_default_prefix/share/config.site" \
-	"$ac_default_prefix/etc/config.site"
-fi
-shift
-for ac_site_file
-do
-  if test -r "$ac_site_file"; then
-    { echo "$as_me:$LINENO: loading site script $ac_site_file" >&5
-echo "$as_me: loading site script $ac_site_file" >&6;}
-    sed 's/^/| /' "$ac_site_file" >&5
-    . "$ac_site_file"
-  fi
-done
-
-if test -r "$cache_file"; then
-  # Some versions of bash will fail to source /dev/null (special
-  # files actually), so we avoid doing that.
-  if test -f "$cache_file"; then
-    { echo "$as_me:$LINENO: loading cache $cache_file" >&5
-echo "$as_me: loading cache $cache_file" >&6;}
-    case $cache_file in
-      [\\/]* | ?:[\\/]* ) . "$cache_file";;
-      *)                      . "./$cache_file";;
-    esac
-  fi
-else
-  { echo "$as_me:$LINENO: creating cache $cache_file" >&5
-echo "$as_me: creating cache $cache_file" >&6;}
-  >$cache_file
-fi
-
-# Check that the precious variables saved in the cache have kept the same
-# value.
-ac_cache_corrupted=false
-for ac_var in $ac_precious_vars; do
-  eval ac_old_set=\$ac_cv_env_${ac_var}_set
-  eval ac_new_set=\$ac_env_${ac_var}_set
-  eval ac_old_val=\$ac_cv_env_${ac_var}_value
-  eval ac_new_val=\$ac_env_${ac_var}_value
-  case $ac_old_set,$ac_new_set in
-    set,)
-      { echo "$as_me:$LINENO: error: \`$ac_var' was set to \`$ac_old_val' in the previous run" >&5
-echo "$as_me: error: \`$ac_var' was set to \`$ac_old_val' in the previous run" >&2;}
-      ac_cache_corrupted=: ;;
-    ,set)
-      { echo "$as_me:$LINENO: error: \`$ac_var' was not set in the previous run" >&5
-echo "$as_me: error: \`$ac_var' was not set in the previous run" >&2;}
-      ac_cache_corrupted=: ;;
-    ,);;
-    *)
-      if test "x$ac_old_val" != "x$ac_new_val"; then
-	{ echo "$as_me:$LINENO: error: \`$ac_var' has changed since the previous run:" >&5
-echo "$as_me: error: \`$ac_var' has changed since the previous run:" >&2;}
-	{ echo "$as_me:$LINENO:   former value:  $ac_old_val" >&5
-echo "$as_me:   former value:  $ac_old_val" >&2;}
-	{ echo "$as_me:$LINENO:   current value: $ac_new_val" >&5
-echo "$as_me:   current value: $ac_new_val" >&2;}
-	ac_cache_corrupted=:
-      fi;;
-  esac
-  # Pass precious variables to config.status.
-  if test "$ac_new_set" = set; then
-    case $ac_new_val in
-    *\'*) ac_arg=$ac_var=`echo "$ac_new_val" | sed "s/'/'\\\\\\\\''/g"` ;;
-    *) ac_arg=$ac_var=$ac_new_val ;;
-    esac
-    case " $ac_configure_args " in
-      *" '$ac_arg' "*) ;; # Avoid dups.  Use of quotes ensures accuracy.
-      *) ac_configure_args="$ac_configure_args '$ac_arg'" ;;
-    esac
-  fi
-done
-if $ac_cache_corrupted; then
-  { echo "$as_me:$LINENO: error: changes in the environment can compromise the build" >&5
-echo "$as_me: error: changes in the environment can compromise the build" >&2;}
-  { { echo "$as_me:$LINENO: error: run \`make distclean' and/or \`rm $cache_file' and start over" >&5
-echo "$as_me: error: run \`make distclean' and/or \`rm $cache_file' and start over" >&2;}
-   { (exit 1); exit 1; }; }
-fi
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-
-ac_config_headers="$ac_config_headers common/config.h"
-
-
-BUILD_PARSERS=true
-
-
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}gcc", so it can be a program name with args.
-set dummy ${ac_tool_prefix}gcc; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_CC="${ac_tool_prefix}gcc"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  { echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-fi
-if test -z "$ac_cv_prog_CC"; then
-  ac_ct_CC=$CC
-  # Extract the first word of "gcc", so it can be a program name with args.
-set dummy gcc; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_ac_ct_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_CC"; then
-  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_ac_ct_CC="gcc"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_CC=$ac_cv_prog_ac_ct_CC
-if test -n "$ac_ct_CC"; then
-  { echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
-echo "${ECHO_T}$ac_ct_CC" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-  if test "x$ac_ct_CC" = x; then
-    CC=""
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoc... at gnu.org." >&5
-echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoc... at gnu.org." >&2;}
-ac_tool_warned=yes ;;
-esac
-    CC=$ac_ct_CC
-  fi
-else
-  CC="$ac_cv_prog_CC"
-fi
-
-if test -z "$CC"; then
-          if test -n "$ac_tool_prefix"; then
-    # Extract the first word of "${ac_tool_prefix}cc", so it can be a program name with args.
-set dummy ${ac_tool_prefix}cc; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_CC="${ac_tool_prefix}cc"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  { echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-  fi
-fi
-if test -z "$CC"; then
-  # Extract the first word of "cc", so it can be a program name with args.
-set dummy cc; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-  ac_prog_rejected=no
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    if test "$as_dir/$ac_word$ac_exec_ext" = "/usr/ucb/cc"; then
-       ac_prog_rejected=yes
-       continue
-     fi
-    ac_cv_prog_CC="cc"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-if test $ac_prog_rejected = yes; then
-  # We found a bogon in the path, so make sure we never use it.
-  set dummy $ac_cv_prog_CC
-  shift
-  if test $# != 0; then
-    # We chose a different compiler from the bogus one.
-    # However, it has the same basename, so the bogon will be chosen
-    # first if we set CC to just the basename; use the full file name.
-    shift
-    ac_cv_prog_CC="$as_dir/$ac_word${1+' '}$@"
-  fi
-fi
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  { echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-fi
-if test -z "$CC"; then
-  if test -n "$ac_tool_prefix"; then
-  for ac_prog in cl.exe
-  do
-    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
-set dummy $ac_tool_prefix$ac_prog; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_CC="$ac_tool_prefix$ac_prog"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  { echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-    test -n "$CC" && break
-  done
-fi
-if test -z "$CC"; then
-  ac_ct_CC=$CC
-  for ac_prog in cl.exe
-do
-  # Extract the first word of "$ac_prog", so it can be a program name with args.
-set dummy $ac_prog; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_ac_ct_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_CC"; then
-  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_ac_ct_CC="$ac_prog"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_CC=$ac_cv_prog_ac_ct_CC
-if test -n "$ac_ct_CC"; then
-  { echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
-echo "${ECHO_T}$ac_ct_CC" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-  test -n "$ac_ct_CC" && break
-done
-
-  if test "x$ac_ct_CC" = x; then
-    CC=""
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoc... at gnu.org." >&5
-echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoc... at gnu.org." >&2;}
-ac_tool_warned=yes ;;
-esac
-    CC=$ac_ct_CC
-  fi
-fi
-
-fi
-
-
-test -z "$CC" && { { echo "$as_me:$LINENO: error: no acceptable C compiler found in \$PATH
-See \`config.log' for more details." >&5
-echo "$as_me: error: no acceptable C compiler found in \$PATH
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }
-
-# Provide some information about the compiler.
-echo "$as_me:$LINENO: checking for C compiler version" >&5
-ac_compiler=`set X $ac_compile; echo $2`
-{ (ac_try="$ac_compiler --version >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compiler --version >&5") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (ac_try="$ac_compiler -v >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compiler -v >&5") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (ac_try="$ac_compiler -V >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compiler -V >&5") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-ac_clean_files_save=$ac_clean_files
-ac_clean_files="$ac_clean_files a.out a.exe b.out"
-# Try to create an executable without -o first, disregard a.out.
-# It will help us diagnose broken compilers, and finding out an intuition
-# of exeext.
-{ echo "$as_me:$LINENO: checking for C compiler default output file name" >&5
-echo $ECHO_N "checking for C compiler default output file name... $ECHO_C" >&6; }
-ac_link_default=`echo "$ac_link" | sed 's/ -o *conftest[^ ]*//'`
-#
-# List of possible output files, starting from the most likely.
-# The algorithm is not robust to junk in `.', hence go to wildcards (a.*)
-# only as a last resort.  b.out is created by i960 compilers.
-ac_files='a_out.exe a.exe conftest.exe a.out conftest a.* conftest.* b.out'
-#
-# The IRIX 6 linker writes into existing files which may not be
-# executable, retaining their permissions.  Remove them first so a
-# subsequent execution test works.
-ac_rmfiles=
-for ac_file in $ac_files
-do
-  case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.o | *.obj ) ;;
-    * ) ac_rmfiles="$ac_rmfiles $ac_file";;
-  esac
-done
-rm -f $ac_rmfiles
-
-if { (ac_try="$ac_link_default"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link_default") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; then
-  # Autoconf-2.13 could set the ac_cv_exeext variable to `no'.
-# So ignore a value of `no', otherwise this would lead to `EXEEXT = no'
-# in a Makefile.  We should not override ac_cv_exeext if it was cached,
-# so that the user can short-circuit this test for compilers unknown to
-# Autoconf.
-for ac_file in $ac_files ''
-do
-  test -f "$ac_file" || continue
-  case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.o | *.obj )
-	;;
-    [ab].out )
-	# We found the default executable, but exeext='' is most
-	# certainly right.
-	break;;
-    *.* )
-        if test "${ac_cv_exeext+set}" = set && test "$ac_cv_exeext" != no;
-	then :; else
-	   ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
-	fi
-	# We set ac_cv_exeext here because the later test for it is not
-	# safe: cross compilers may not add the suffix if given an `-o'
-	# argument, so we may need to know it at that point already.
-	# Even if this section looks crufty: it has the advantage of
-	# actually working.
-	break;;
-    * )
-	break;;
-  esac
-done
-test "$ac_cv_exeext" = no && ac_cv_exeext=
-
-else
-  ac_file=''
-fi
-
-{ echo "$as_me:$LINENO: result: $ac_file" >&5
-echo "${ECHO_T}$ac_file" >&6; }
-if test -z "$ac_file"; then
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-{ { echo "$as_me:$LINENO: error: C compiler cannot create executables
-See \`config.log' for more details." >&5
-echo "$as_me: error: C compiler cannot create executables
-See \`config.log' for more details." >&2;}
-   { (exit 77); exit 77; }; }
-fi
-
-ac_exeext=$ac_cv_exeext
-
-# Check that the compiler produces executables we can run.  If not, either
-# the compiler is broken, or we cross compile.
-{ echo "$as_me:$LINENO: checking whether the C compiler works" >&5
-echo $ECHO_N "checking whether the C compiler works... $ECHO_C" >&6; }
-# FIXME: These cross compiler hacks should be removed for Autoconf 3.0
-# If not cross compiling, check that we can run a simple program.
-if test "$cross_compiling" != yes; then
-  if { ac_try='./$ac_file'
-  { (case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_try") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-    cross_compiling=no
-  else
-    if test "$cross_compiling" = maybe; then
-	cross_compiling=yes
-    else
-	{ { echo "$as_me:$LINENO: error: cannot run C compiled programs.
-If you meant to cross compile, use \`--host'.
-See \`config.log' for more details." >&5
-echo "$as_me: error: cannot run C compiled programs.
-If you meant to cross compile, use \`--host'.
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }
-    fi
-  fi
-fi
-{ echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; }
-
-rm -f a.out a.exe conftest$ac_cv_exeext b.out
-ac_clean_files=$ac_clean_files_save
-# Check that the compiler produces executables we can run.  If not, either
-# the compiler is broken, or we cross compile.
-{ echo "$as_me:$LINENO: checking whether we are cross compiling" >&5
-echo $ECHO_N "checking whether we are cross compiling... $ECHO_C" >&6; }
-{ echo "$as_me:$LINENO: result: $cross_compiling" >&5
-echo "${ECHO_T}$cross_compiling" >&6; }
-
-{ echo "$as_me:$LINENO: checking for suffix of executables" >&5
-echo $ECHO_N "checking for suffix of executables... $ECHO_C" >&6; }
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; then
-  # If both `conftest.exe' and `conftest' are `present' (well, observable)
-# catch `conftest.exe'.  For instance with Cygwin, `ls conftest' will
-# work properly (i.e., refer to `conftest.exe'), while it won't with
-# `rm'.
-for ac_file in conftest.exe conftest conftest.*; do
-  test -f "$ac_file" || continue
-  case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.o | *.obj ) ;;
-    *.* ) ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
-	  break;;
-    * ) break;;
-  esac
-done
-else
-  { { echo "$as_me:$LINENO: error: cannot compute suffix of executables: cannot compile and link
-See \`config.log' for more details." >&5
-echo "$as_me: error: cannot compute suffix of executables: cannot compile and link
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }
-fi
-
-rm -f conftest$ac_cv_exeext
-{ echo "$as_me:$LINENO: result: $ac_cv_exeext" >&5
-echo "${ECHO_T}$ac_cv_exeext" >&6; }
-
-rm -f conftest.$ac_ext
-EXEEXT=$ac_cv_exeext
-ac_exeext=$EXEEXT
-{ echo "$as_me:$LINENO: checking for suffix of object files" >&5
-echo $ECHO_N "checking for suffix of object files... $ECHO_C" >&6; }
-if test "${ac_cv_objext+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.o conftest.obj
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; then
-  for ac_file in conftest.o conftest.obj conftest.*; do
-  test -f "$ac_file" || continue;
-  case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf ) ;;
-    *) ac_cv_objext=`expr "$ac_file" : '.*\.\(.*\)'`
-       break;;
-  esac
-done
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-{ { echo "$as_me:$LINENO: error: cannot compute suffix of object files: cannot compile
-See \`config.log' for more details." >&5
-echo "$as_me: error: cannot compute suffix of object files: cannot compile
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }
-fi
-
-rm -f conftest.$ac_cv_objext conftest.$ac_ext
-fi
-{ echo "$as_me:$LINENO: result: $ac_cv_objext" >&5
-echo "${ECHO_T}$ac_cv_objext" >&6; }
-OBJEXT=$ac_cv_objext
-ac_objext=$OBJEXT
-{ echo "$as_me:$LINENO: checking whether we are using the GNU C compiler" >&5
-echo $ECHO_N "checking whether we are using the GNU C compiler... $ECHO_C" >&6; }
-if test "${ac_cv_c_compiler_gnu+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-#ifndef __GNUC__
-       choke me
-#endif
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_compiler_gnu=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_compiler_gnu=no
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-ac_cv_c_compiler_gnu=$ac_compiler_gnu
-
-fi
-{ echo "$as_me:$LINENO: result: $ac_cv_c_compiler_gnu" >&5
-echo "${ECHO_T}$ac_cv_c_compiler_gnu" >&6; }
-GCC=`test $ac_compiler_gnu = yes && echo yes`
-ac_test_CFLAGS=${CFLAGS+set}
-ac_save_CFLAGS=$CFLAGS
-{ echo "$as_me:$LINENO: checking whether $CC accepts -g" >&5
-echo $ECHO_N "checking whether $CC accepts -g... $ECHO_C" >&6; }
-if test "${ac_cv_prog_cc_g+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_save_c_werror_flag=$ac_c_werror_flag
-   ac_c_werror_flag=yes
-   ac_cv_prog_cc_g=no
-   CFLAGS="-g"
-   cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cc_g=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	CFLAGS=""
-      cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  :
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_c_werror_flag=$ac_save_c_werror_flag
-	 CFLAGS="-g"
-	 cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cc_g=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-   ac_c_werror_flag=$ac_save_c_werror_flag
-fi
-{ echo "$as_me:$LINENO: result: $ac_cv_prog_cc_g" >&5
-echo "${ECHO_T}$ac_cv_prog_cc_g" >&6; }
-if test "$ac_test_CFLAGS" = set; then
-  CFLAGS=$ac_save_CFLAGS
-elif test $ac_cv_prog_cc_g = yes; then
-  if test "$GCC" = yes; then
-    CFLAGS="-g -O2"
-  else
-    CFLAGS="-g"
-  fi
-else
-  if test "$GCC" = yes; then
-    CFLAGS="-O2"
-  else
-    CFLAGS=
-  fi
-fi
-{ echo "$as_me:$LINENO: checking for $CC option to accept ISO C89" >&5
-echo $ECHO_N "checking for $CC option to accept ISO C89... $ECHO_C" >&6; }
-if test "${ac_cv_prog_cc_c89+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_cv_prog_cc_c89=no
-ac_save_CC=$CC
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <stdarg.h>
-#include <stdio.h>
-#include <sys/types.h>
-#include <sys/stat.h>
-/* Most of the following tests are stolen from RCS 5.7's src/conf.sh.  */
-struct buf { int x; };
-FILE * (*rcsopen) (struct buf *, struct stat *, int);
-static char *e (p, i)
-     char **p;
-     int i;
-{
-  return p[i];
-}
-static char *f (char * (*g) (char **, int), char **p, ...)
-{
-  char *s;
-  va_list v;
-  va_start (v,p);
-  s = g (p, va_arg (v,int));
-  va_end (v);
-  return s;
-}
-
-/* OSF 4.0 Compaq cc is some sort of almost-ANSI by default.  It has
-   function prototypes and stuff, but not '\xHH' hex character constants.
-   These don't provoke an error unfortunately, instead are silently treated
-   as 'x'.  The following induces an error, until -std is added to get
-   proper ANSI mode.  Curiously '\x00'!='x' always comes out true, for an
-   array size at least.  It's necessary to write '\x00'==0 to get something
-   that's true only with -std.  */
-int osf4_cc_array ['\x00' == 0 ? 1 : -1];
-
-/* IBM C 6 for AIX is almost-ANSI by default, but it replaces macro parameters
-   inside strings and character constants.  */
-#define FOO(x) 'x'
-int xlc6_cc_array[FOO(a) == 'x' ? 1 : -1];
-
-int test (int i, double x);
-struct s1 {int (*f) (int a);};
-struct s2 {int (*f) (double a);};
-int pairnames (int, char **, FILE *(*)(struct buf *, struct stat *, int), int, int);
-int argc;
-char **argv;
-int
-main ()
-{
-return f (e, argv, 0) != argv[0]  ||  f (e, argv, 1) != argv[1];
-  ;
-  return 0;
-}
-_ACEOF
-for ac_arg in '' -qlanglvl=extc89 -qlanglvl=ansi -std \
-	-Ae "-Aa -D_HPUX_SOURCE" "-Xc -D__EXTENSIONS__"
-do
-  CC="$ac_save_CC $ac_arg"
-  rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cc_c89=$ac_arg
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-
-fi
-
-rm -f core conftest.err conftest.$ac_objext
-  test "x$ac_cv_prog_cc_c89" != "xno" && break
-done
-rm -f conftest.$ac_ext
-CC=$ac_save_CC
-
-fi
-# AC_CACHE_VAL
-case "x$ac_cv_prog_cc_c89" in
-  x)
-    { echo "$as_me:$LINENO: result: none needed" >&5
-echo "${ECHO_T}none needed" >&6; } ;;
-  xno)
-    { echo "$as_me:$LINENO: result: unsupported" >&5
-echo "${ECHO_T}unsupported" >&6; } ;;
-  *)
-    CC="$CC $ac_cv_prog_cc_c89"
-    { echo "$as_me:$LINENO: result: $ac_cv_prog_cc_c89" >&5
-echo "${ECHO_T}$ac_cv_prog_cc_c89" >&6; } ;;
-esac
-
-
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-if test -z "$CXX"; then
-  if test -n "$CCC"; then
-    CXX=$CCC
-  else
-    if test -n "$ac_tool_prefix"; then
-  for ac_prog in g++ c++ gpp aCC CC cxx cc++ cl.exe FCC KCC RCC xlC_r xlC
-  do
-    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
-set dummy $ac_tool_prefix$ac_prog; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_CXX+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$CXX"; then
-  ac_cv_prog_CXX="$CXX" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_CXX="$ac_tool_prefix$ac_prog"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-CXX=$ac_cv_prog_CXX
-if test -n "$CXX"; then
-  { echo "$as_me:$LINENO: result: $CXX" >&5
-echo "${ECHO_T}$CXX" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-    test -n "$CXX" && break
-  done
-fi
-if test -z "$CXX"; then
-  ac_ct_CXX=$CXX
-  for ac_prog in g++ c++ gpp aCC CC cxx cc++ cl.exe FCC KCC RCC xlC_r xlC
-do
-  # Extract the first word of "$ac_prog", so it can be a program name with args.
-set dummy $ac_prog; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_ac_ct_CXX+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_CXX"; then
-  ac_cv_prog_ac_ct_CXX="$ac_ct_CXX" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_ac_ct_CXX="$ac_prog"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_CXX=$ac_cv_prog_ac_ct_CXX
-if test -n "$ac_ct_CXX"; then
-  { echo "$as_me:$LINENO: result: $ac_ct_CXX" >&5
-echo "${ECHO_T}$ac_ct_CXX" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-  test -n "$ac_ct_CXX" && break
-done
-
-  if test "x$ac_ct_CXX" = x; then
-    CXX="g++"
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoc... at gnu.org." >&5
-echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoc... at gnu.org." >&2;}
-ac_tool_warned=yes ;;
-esac
-    CXX=$ac_ct_CXX
-  fi
-fi
-
-  fi
-fi
-# Provide some information about the compiler.
-echo "$as_me:$LINENO: checking for C++ compiler version" >&5
-ac_compiler=`set X $ac_compile; echo $2`
-{ (ac_try="$ac_compiler --version >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compiler --version >&5") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (ac_try="$ac_compiler -v >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compiler -v >&5") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (ac_try="$ac_compiler -V >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compiler -V >&5") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-
-{ echo "$as_me:$LINENO: checking whether we are using the GNU C++ compiler" >&5
-echo $ECHO_N "checking whether we are using the GNU C++ compiler... $ECHO_C" >&6; }
-if test "${ac_cv_cxx_compiler_gnu+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-#ifndef __GNUC__
-       choke me
-#endif
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_compiler_gnu=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_compiler_gnu=no
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-ac_cv_cxx_compiler_gnu=$ac_compiler_gnu
-
-fi
-{ echo "$as_me:$LINENO: result: $ac_cv_cxx_compiler_gnu" >&5
-echo "${ECHO_T}$ac_cv_cxx_compiler_gnu" >&6; }
-GXX=`test $ac_compiler_gnu = yes && echo yes`
-ac_test_CXXFLAGS=${CXXFLAGS+set}
-ac_save_CXXFLAGS=$CXXFLAGS
-{ echo "$as_me:$LINENO: checking whether $CXX accepts -g" >&5
-echo $ECHO_N "checking whether $CXX accepts -g... $ECHO_C" >&6; }
-if test "${ac_cv_prog_cxx_g+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_save_cxx_werror_flag=$ac_cxx_werror_flag
-   ac_cxx_werror_flag=yes
-   ac_cv_prog_cxx_g=no
-   CXXFLAGS="-g"
-   cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cxx_g=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	CXXFLAGS=""
-      cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  :
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_cxx_werror_flag=$ac_save_cxx_werror_flag
-	 CXXFLAGS="-g"
-	 cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cxx_g=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-   ac_cxx_werror_flag=$ac_save_cxx_werror_flag
-fi
-{ echo "$as_me:$LINENO: result: $ac_cv_prog_cxx_g" >&5
-echo "${ECHO_T}$ac_cv_prog_cxx_g" >&6; }
-if test "$ac_test_CXXFLAGS" = set; then
-  CXXFLAGS=$ac_save_CXXFLAGS
-elif test $ac_cv_prog_cxx_g = yes; then
-  if test "$GXX" = yes; then
-    CXXFLAGS="-g -O2"
-  else
-    CXXFLAGS="-g"
-  fi
-else
-  if test "$GXX" = yes; then
-    CXXFLAGS="-O2"
-  else
-    CXXFLAGS=
-  fi
-fi
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}ar", so it can be a program name with args.
-set dummy ${ac_tool_prefix}ar; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_AR+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$AR"; then
-  ac_cv_prog_AR="$AR" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_AR="${ac_tool_prefix}ar"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-AR=$ac_cv_prog_AR
-if test -n "$AR"; then
-  { echo "$as_me:$LINENO: result: $AR" >&5
-echo "${ECHO_T}$AR" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-fi
-if test -z "$ac_cv_prog_AR"; then
-  ac_ct_AR=$AR
-  # Extract the first word of "ar", so it can be a program name with args.
-set dummy ar; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_ac_ct_AR+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_AR"; then
-  ac_cv_prog_ac_ct_AR="$ac_ct_AR" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_ac_ct_AR="ar"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_AR=$ac_cv_prog_ac_ct_AR
-if test -n "$ac_ct_AR"; then
-  { echo "$as_me:$LINENO: result: $ac_ct_AR" >&5
-echo "${ECHO_T}$ac_ct_AR" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-  if test "x$ac_ct_AR" = x; then
-    AR=""
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoc... at gnu.org." >&5
-echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoc... at gnu.org." >&2;}
-ac_tool_warned=yes ;;
-esac
-    AR=$ac_ct_AR
-  fi
-else
-  AR="$ac_cv_prog_AR"
-fi
-
-if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}ranlib", so it can be a program name with args.
-set dummy ${ac_tool_prefix}ranlib; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_RANLIB+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$RANLIB"; then
-  ac_cv_prog_RANLIB="$RANLIB" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_RANLIB="${ac_tool_prefix}ranlib"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-RANLIB=$ac_cv_prog_RANLIB
-if test -n "$RANLIB"; then
-  { echo "$as_me:$LINENO: result: $RANLIB" >&5
-echo "${ECHO_T}$RANLIB" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-fi
-if test -z "$ac_cv_prog_RANLIB"; then
-  ac_ct_RANLIB=$RANLIB
-  # Extract the first word of "ranlib", so it can be a program name with args.
-set dummy ranlib; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_ac_ct_RANLIB+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_RANLIB"; then
-  ac_cv_prog_ac_ct_RANLIB="$ac_ct_RANLIB" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_ac_ct_RANLIB="ranlib"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_RANLIB=$ac_cv_prog_ac_ct_RANLIB
-if test -n "$ac_ct_RANLIB"; then
-  { echo "$as_me:$LINENO: result: $ac_ct_RANLIB" >&5
-echo "${ECHO_T}$ac_ct_RANLIB" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-  if test "x$ac_ct_RANLIB" = x; then
-    RANLIB=":"
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoc... at gnu.org." >&5
-echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoc... at gnu.org." >&2;}
-ac_tool_warned=yes ;;
-esac
-    RANLIB=$ac_ct_RANLIB
-  fi
-else
-  RANLIB="$ac_cv_prog_RANLIB"
-fi
-
-cat >>confdefs.h <<_ACEOF
-#define CC $CC
-_ACEOF
-
-cat >>confdefs.h <<_ACEOF
-#define CXX $CXX
-_ACEOF
-
-cat >>confdefs.h <<_ACEOF
-#define AR $AR
-_ACEOF
-
-cat >>confdefs.h <<_ACEOF
-#define RANLIB $RANLIB
-_ACEOF
-
-
-ac_ext=cpp
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-
-
-{ echo "$as_me:$LINENO: checking whether ${MAKE-make} sets \$(MAKE)" >&5
-echo $ECHO_N "checking whether ${MAKE-make} sets \$(MAKE)... $ECHO_C" >&6; }
-set x ${MAKE-make}; ac_make=`echo "$2" | sed 's/+/p/g; s/[^a-zA-Z0-9_]/_/g'`
-if { as_var=ac_cv_prog_make_${ac_make}_set; eval "test \"\${$as_var+set}\" = set"; }; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.make <<\_ACEOF
-SHELL = /bin/sh
-all:
-	@echo '@@@%%%=$(MAKE)=@@@%%%'
-_ACEOF
-# GNU make sometimes prints "make[1]: Entering...", which would confuse us.
-case `${MAKE-make} -f conftest.make 2>/dev/null` in
-  *@@@%%%=?*=@@@%%%*)
-    eval ac_cv_prog_make_${ac_make}_set=yes;;
-  *)
-    eval ac_cv_prog_make_${ac_make}_set=no;;
-esac
-rm -f conftest.make
-fi
-if eval test \$ac_cv_prog_make_${ac_make}_set = yes; then
-  { echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; }
-  SET_MAKE=
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-  SET_MAKE="MAKE=${MAKE-make}"
-fi
-
-
-if test $BUILD_PARSERS = true; then
-
-# Extract the first word of "ragel", so it can be a program name with args.
-set dummy ragel; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_RAGEL+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$RAGEL"; then
-  ac_cv_prog_RAGEL="$RAGEL" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_RAGEL="ragel"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-RAGEL=$ac_cv_prog_RAGEL
-if test -n "$RAGEL"; then
-  { echo "$as_me:$LINENO: result: $RAGEL" >&5
-echo "${ECHO_T}$RAGEL" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-if test -z "$RAGEL"; then
-	echo
-	echo "error: ragel is required to build the parsers"
-	echo
-	exit 1
-fi
-
-# Extract the first word of "gperf", so it can be a program name with args.
-set dummy gperf; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_GPERF+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$GPERF"; then
-  ac_cv_prog_GPERF="$GPERF" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_GPERF="gperf"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-GPERF=$ac_cv_prog_GPERF
-if test -n "$GPERF"; then
-  { echo "$as_me:$LINENO: result: $GPERF" >&5
-echo "${ECHO_T}$GPERF" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-if test -z "$GPERF"; then
-	echo
-	echo "error: gperf is required to build the parsers"
-	echo
-	exit 1
-fi
-
-# Extract the first word of "kelbt", so it can be a program name with args.
-set dummy kelbt; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_KELBT+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$KELBT"; then
-  ac_cv_prog_KELBT="$KELBT" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_KELBT="kelbt"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-KELBT=$ac_cv_prog_KELBT
-if test -n "$KELBT"; then
-  { echo "$as_me:$LINENO: result: $KELBT" >&5
-echo "${ECHO_T}$KELBT" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-if test -z "$KELBT"; then
-	echo
-	echo "error: kelbt is required to build the parsers"
-	echo
-	exit 1
-fi
-
-fi # BUILD_PARSERS
-
-# Extract the first word of "gdc", so it can be a program name with args.
-set dummy gdc; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_GDC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$GDC"; then
-  ac_cv_prog_GDC="$GDC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_GDC="gdc"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-GDC=$ac_cv_prog_GDC
-if test -n "$GDC"; then
-  { echo "$as_me:$LINENO: result: $GDC" >&5
-echo "${ECHO_T}$GDC" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-if test -n "$GDC"; then
-	cat >>confdefs.h <<_ACEOF
-#define GDC $GDC
-_ACEOF
-
-fi
-
-{ echo "$as_me:$LINENO: checking for the Objective-C compiler" >&5
-echo $ECHO_N "checking for the Objective-C compiler... $ECHO_C" >&6; }
-cat > conftest.m <<EOF
-int main() { return 0; }
-EOF
-GOBJC=""
-if gcc -x objective-c conftest.m -o conftest.bin 2>/dev/null; then
-	GOBJC="gcc -x objective-c"
-	{ echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; }
-	cat >>confdefs.h <<_ACEOF
-#define GOBJC $GOBJC
-_ACEOF
-
-else
-	{ echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-# Extract the first word of "javac", so it can be a program name with args.
-set dummy javac; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_JAVAC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$JAVAC"; then
-  ac_cv_prog_JAVAC="$JAVAC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_JAVAC="javac"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-JAVAC=$ac_cv_prog_JAVAC
-if test -n "$JAVAC"; then
-  { echo "$as_me:$LINENO: result: $JAVAC" >&5
-echo "${ECHO_T}$JAVAC" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-if test -n "$JAVAC"; then
-	cat >>confdefs.h <<_ACEOF
-#define JAVAC $JAVAC
-_ACEOF
-
-fi
-
-# Extract the first word of "txl", so it can be a program name with args.
-set dummy txl; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_TXL+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$TXL"; then
-  ac_cv_prog_TXL="$TXL" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_TXL="txl"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-TXL=$ac_cv_prog_TXL
-if test -n "$TXL"; then
-  { echo "$as_me:$LINENO: result: $TXL" >&5
-echo "${ECHO_T}$TXL" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-if test -n "$TXL"; then
-	cat >>confdefs.h <<_ACEOF
-#define TXL $TXL
-_ACEOF
-
-fi
-
-# Extract the first word of "ruby", so it can be a program name with args.
-set dummy ruby; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_RUBY+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$RUBY"; then
-  ac_cv_prog_RUBY="$RUBY" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_RUBY="ruby"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-RUBY=$ac_cv_prog_RUBY
-if test -n "$RUBY"; then
-  { echo "$as_me:$LINENO: result: $RUBY" >&5
-echo "${ECHO_T}$RUBY" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-if test -n "$RUBY"; then
-	cat >>confdefs.h <<_ACEOF
-#define RUBY $RUBY
-_ACEOF
-
-fi
-
-# Extract the first word of "gmcs", so it can be a program name with args.
-set dummy gmcs; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_GMCS+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$GMCS"; then
-  ac_cv_prog_GMCS="$GMCS" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_GMCS="gmcs"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-GMCS=$ac_cv_prog_GMCS
-if test -n "$GMCS"; then
-  { echo "$as_me:$LINENO: result: $GMCS" >&5
-echo "${ECHO_T}$GMCS" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-if test -n "$GMCS"; then
-	cat >>confdefs.h <<_ACEOF
-#define GMCS $GMCS
-_ACEOF
-
-fi
-
-ac_config_files="$ac_config_files Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile"
-
-cat >confcache <<\_ACEOF
-# This file is a shell script that caches the results of configure
-# tests run on this system so they can be shared between configure
-# scripts and configure runs, see configure's option --config-cache.
-# It is not useful on other systems.  If it contains results you don't
-# want to keep, you may remove or edit it.
-#
-# config.status only pays attention to the cache file if you give it
-# the --recheck option to rerun configure.
-#
-# `ac_cv_env_foo' variables (set or unset) will be overridden when
-# loading this file, other *unset* `ac_cv_foo' will be assigned the
-# following values.
-
-_ACEOF
-
-# The following way of writing the cache mishandles newlines in values,
-# but we know of no workaround that is simple, portable, and efficient.
-# So, we kill variables containing newlines.
-# Ultrix sh set writes to stderr and can't be redirected directly,
-# and sets the high bit in the cache file unless we assign to the vars.
-(
-  for ac_var in `(set) 2>&1 | sed -n 's/^\([a-zA-Z_][a-zA-Z0-9_]*\)=.*/\1/p'`; do
-    eval ac_val=\$$ac_var
-    case $ac_val in #(
-    *${as_nl}*)
-      case $ac_var in #(
-      *_cv_*) { echo "$as_me:$LINENO: WARNING: Cache variable $ac_var contains a newline." >&5
-echo "$as_me: WARNING: Cache variable $ac_var contains a newline." >&2;} ;;
-      esac
-      case $ac_var in #(
-      _ | IFS | as_nl) ;; #(
-      *) $as_unset $ac_var ;;
-      esac ;;
-    esac
-  done
-
-  (set) 2>&1 |
-    case $as_nl`(ac_space=' '; set) 2>&1` in #(
-    *${as_nl}ac_space=\ *)
-      # `set' does not quote correctly, so add quotes (double-quote
-      # substitution turns \\\\ into \\, and sed turns \\ into \).
-      sed -n \
-	"s/'/'\\\\''/g;
-	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='\\2'/p"
-      ;; #(
-    *)
-      # `set' quotes correctly as required by POSIX, so do not add quotes.
-      sed -n "/^[_$as_cr_alnum]*_cv_[_$as_cr_alnum]*=/p"
-      ;;
-    esac |
-    sort
-) |
-  sed '
-     /^ac_cv_env_/b end
-     t clear
-     :clear
-     s/^\([^=]*\)=\(.*[{}].*\)$/test "${\1+set}" = set || &/
-     t end
-     s/^\([^=]*\)=\(.*\)$/\1=${\1=\2}/
-     :end' >>confcache
-if diff "$cache_file" confcache >/dev/null 2>&1; then :; else
-  if test -w "$cache_file"; then
-    test "x$cache_file" != "x/dev/null" &&
-      { echo "$as_me:$LINENO: updating cache $cache_file" >&5
-echo "$as_me: updating cache $cache_file" >&6;}
-    cat confcache >$cache_file
-  else
-    { echo "$as_me:$LINENO: not updating unwritable cache $cache_file" >&5
-echo "$as_me: not updating unwritable cache $cache_file" >&6;}
-  fi
-fi
-rm -f confcache
-
-test "x$prefix" = xNONE && prefix=$ac_default_prefix
-# Let make expand exec_prefix.
-test "x$exec_prefix" = xNONE && exec_prefix='${prefix}'
-
-DEFS=-DHAVE_CONFIG_H
-
-ac_libobjs=
-ac_ltlibobjs=
-for ac_i in : $LIBOBJS; do test "x$ac_i" = x: && continue
-  # 1. Remove the extension, and $U if already installed.
-  ac_script='s/\$U\././;s/\.o$//;s/\.obj$//'
-  ac_i=`echo "$ac_i" | sed "$ac_script"`
-  # 2. Prepend LIBOBJDIR.  When used with automake>=1.10 LIBOBJDIR
-  #    will be set to the directory where LIBOBJS objects are built.
-  ac_libobjs="$ac_libobjs \${LIBOBJDIR}$ac_i\$U.$ac_objext"
-  ac_ltlibobjs="$ac_ltlibobjs \${LIBOBJDIR}$ac_i"'$U.lo'
-done
-LIBOBJS=$ac_libobjs
-
-LTLIBOBJS=$ac_ltlibobjs
-
-
-
-: ${CONFIG_STATUS=./config.status}
-ac_clean_files_save=$ac_clean_files
-ac_clean_files="$ac_clean_files $CONFIG_STATUS"
-{ echo "$as_me:$LINENO: creating $CONFIG_STATUS" >&5
-echo "$as_me: creating $CONFIG_STATUS" >&6;}
-cat >$CONFIG_STATUS <<_ACEOF
-#! $SHELL
-# Generated by $as_me.
-# Run this file to recreate the current configuration.
-# Compiler output produced by configure, useful for debugging
-# configure, is in config.log if it exists.
-
-debug=false
-ac_cs_recheck=false
-ac_cs_silent=false
-SHELL=\${CONFIG_SHELL-$SHELL}
-_ACEOF
-
-cat >>$CONFIG_STATUS <<\_ACEOF
-## --------------------- ##
-## M4sh Initialization.  ##
-## --------------------- ##
-
-# Be more Bourne compatible
-DUALCASE=1; export DUALCASE # for MKS sh
-if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
-  emulate sh
-  NULLCMD=:
-  # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
-  # is contrary to our usage.  Disable this feature.
-  alias -g '${1+"$@"}'='"$@"'
-  setopt NO_GLOB_SUBST
-else
-  case `(set -o) 2>/dev/null` in
-  *posix*) set -o posix ;;
-esac
-
-fi
-
-
-
-
-# PATH needs CR
-# Avoid depending upon Character Ranges.
-as_cr_letters='abcdefghijklmnopqrstuvwxyz'
-as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
-as_cr_Letters=$as_cr_letters$as_cr_LETTERS
-as_cr_digits='0123456789'
-as_cr_alnum=$as_cr_Letters$as_cr_digits
-
-# The user is always right.
-if test "${PATH_SEPARATOR+set}" != set; then
-  echo "#! /bin/sh" >conf$$.sh
-  echo  "exit 0"   >>conf$$.sh
-  chmod +x conf$$.sh
-  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
-    PATH_SEPARATOR=';'
-  else
-    PATH_SEPARATOR=:
-  fi
-  rm -f conf$$.sh
-fi
-
-# Support unset when possible.
-if ( (MAIL=60; unset MAIL) || exit) >/dev/null 2>&1; then
-  as_unset=unset
-else
-  as_unset=false
-fi
-
-
-# IFS
-# We need space, tab and new line, in precisely that order.  Quoting is
-# there to prevent editors from complaining about space-tab.
-# (If _AS_PATH_WALK were called with IFS unset, it would disable word
-# splitting by setting IFS to empty value.)
-as_nl='
-'
-IFS=" ""	$as_nl"
-
-# Find who we are.  Look in the path if we contain no directory separator.
-case $0 in
-  *[\\/]* ) as_myself=$0 ;;
-  *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
-done
-IFS=$as_save_IFS
-
-     ;;
-esac
-# We did not find ourselves, most probably we were run as `sh COMMAND'
-# in which case we are not to be found in the path.
-if test "x$as_myself" = x; then
-  as_myself=$0
-fi
-if test ! -f "$as_myself"; then
-  echo "$as_myself: error: cannot find myself; rerun with an absolute file name" >&2
-  { (exit 1); exit 1; }
-fi
-
-# Work around bugs in pre-3.0 UWIN ksh.
-for as_var in ENV MAIL MAILPATH
-do ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
-done
-PS1='$ '
-PS2='> '
-PS4='+ '
-
-# NLS nuisances.
-for as_var in \
-  LANG LANGUAGE LC_ADDRESS LC_ALL LC_COLLATE LC_CTYPE LC_IDENTIFICATION \
-  LC_MEASUREMENT LC_MESSAGES LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER \
-  LC_TELEPHONE LC_TIME
-do
-  if (set +x; test -z "`(eval $as_var=C; export $as_var) 2>&1`"); then
-    eval $as_var=C; export $as_var
-  else
-    ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
-  fi
-done
-
-# Required to use basename.
-if expr a : '\(a\)' >/dev/null 2>&1 &&
-   test "X`expr 00001 : '.*\(...\)'`" = X001; then
-  as_expr=expr
-else
-  as_expr=false
-fi
-
-if (basename -- /) >/dev/null 2>&1 && test "X`basename -- / 2>&1`" = "X/"; then
-  as_basename=basename
-else
-  as_basename=false
-fi
-
-
-# Name of the executable.
-as_me=`$as_basename -- "$0" ||
-$as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
-	 X"$0" : 'X\(//\)$' \| \
-	 X"$0" : 'X\(/\)' \| . 2>/dev/null ||
-echo X/"$0" |
-    sed '/^.*\/\([^/][^/]*\)\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\/\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\/\(\/\).*/{
-	    s//\1/
-	    q
-	  }
-	  s/.*/./; q'`
-
-# CDPATH.
-$as_unset CDPATH
-
-
-
-  as_lineno_1=$LINENO
-  as_lineno_2=$LINENO
-  test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x`expr $as_lineno_1 + 1`" = "x$as_lineno_2" || {
-
-  # Create $as_me.lineno as a copy of $as_myself, but with $LINENO
-  # uniformly replaced by the line number.  The first 'sed' inserts a
-  # line-number line after each line using $LINENO; the second 'sed'
-  # does the real work.  The second script uses 'N' to pair each
-  # line-number line with the line containing $LINENO, and appends
-  # trailing '-' during substitution so that $LINENO is not a special
-  # case at line end.
-  # (Raja R Harinath suggested sed '=', and Paul Eggert wrote the
-  # scripts with optimization help from Paolo Bonzini.  Blame Lee
-  # E. McMahon (1931-1989) for sed's syntax.  :-)
-  sed -n '
-    p
-    /[$]LINENO/=
-  ' <$as_myself |
-    sed '
-      s/[$]LINENO.*/&-/
-      t lineno
-      b
-      :lineno
-      N
-      :loop
-      s/[$]LINENO\([^'$as_cr_alnum'_].*\n\)\(.*\)/\2\1\2/
-      t loop
-      s/-\n.*//
-    ' >$as_me.lineno &&
-  chmod +x "$as_me.lineno" ||
-    { echo "$as_me: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&2
-   { (exit 1); exit 1; }; }
-
-  # Don't try to exec as it changes $[0], causing all sort of problems
-  # (the dirname of $[0] is not the place where we might find the
-  # original and so on.  Autoconf is especially sensitive to this).
-  . "./$as_me.lineno"
-  # Exit status is that of the last command.
-  exit
-}
-
-
-if (as_dir=`dirname -- /` && test "X$as_dir" = X/) >/dev/null 2>&1; then
-  as_dirname=dirname
-else
-  as_dirname=false
-fi
-
-ECHO_C= ECHO_N= ECHO_T=
-case `echo -n x` in
--n*)
-  case `echo 'x\c'` in
-  *c*) ECHO_T='	';;	# ECHO_T is single tab character.
-  *)   ECHO_C='\c';;
-  esac;;
-*)
-  ECHO_N='-n';;
-esac
-
-if expr a : '\(a\)' >/dev/null 2>&1 &&
-   test "X`expr 00001 : '.*\(...\)'`" = X001; then
-  as_expr=expr
-else
-  as_expr=false
-fi
-
-rm -f conf$$ conf$$.exe conf$$.file
-if test -d conf$$.dir; then
-  rm -f conf$$.dir/conf$$.file
-else
-  rm -f conf$$.dir
-  mkdir conf$$.dir
-fi
-echo >conf$$.file
-if ln -s conf$$.file conf$$ 2>/dev/null; then
-  as_ln_s='ln -s'
-  # ... but there are two gotchas:
-  # 1) On MSYS, both `ln -s file dir' and `ln file dir' fail.
-  # 2) DJGPP < 2.04 has no symlinks; `ln -s' creates a wrapper executable.
-  # In both cases, we have to default to `cp -p'.
-  ln -s conf$$.file conf$$.dir 2>/dev/null && test ! -f conf$$.exe ||
-    as_ln_s='cp -p'
-elif ln conf$$.file conf$$ 2>/dev/null; then
-  as_ln_s=ln
-else
-  as_ln_s='cp -p'
-fi
-rm -f conf$$ conf$$.exe conf$$.dir/conf$$.file conf$$.file
-rmdir conf$$.dir 2>/dev/null
-
-if mkdir -p . 2>/dev/null; then
-  as_mkdir_p=:
-else
-  test -d ./-p && rmdir ./-p
-  as_mkdir_p=false
-fi
-
-if test -x / >/dev/null 2>&1; then
-  as_test_x='test -x'
-else
-  if ls -dL / >/dev/null 2>&1; then
-    as_ls_L_option=L
-  else
-    as_ls_L_option=
-  fi
-  as_test_x='
-    eval sh -c '\''
-      if test -d "$1"; then
-        test -d "$1/.";
-      else
-	case $1 in
-        -*)set "./$1";;
-	esac;
-	case `ls -ld'$as_ls_L_option' "$1" 2>/dev/null` in
-	???[sx]*):;;*)false;;esac;fi
-    '\'' sh
-  '
-fi
-as_executable_p=$as_test_x
-
-# Sed expression to map a string onto a valid CPP name.
-as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
-
-# Sed expression to map a string onto a valid variable name.
-as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"
-
-
-exec 6>&1
-
-# Save the log message, to keep $[0] and so on meaningful, and to
-# report actual input values of CONFIG_FILES etc. instead of their
-# values after options handling.
-ac_log="
-This file was extended by $as_me, which was
-generated by GNU Autoconf 2.61.  Invocation command line was
-
-  CONFIG_FILES    = $CONFIG_FILES
-  CONFIG_HEADERS  = $CONFIG_HEADERS
-  CONFIG_LINKS    = $CONFIG_LINKS
-  CONFIG_COMMANDS = $CONFIG_COMMANDS
-  $ $0 $@
-
-on `(hostname || uname -n) 2>/dev/null | sed 1q`
-"
-
-_ACEOF
-
-cat >>$CONFIG_STATUS <<_ACEOF
-# Files that config.status was made for.
-config_files="$ac_config_files"
-config_headers="$ac_config_headers"
-
-_ACEOF
-
-cat >>$CONFIG_STATUS <<\_ACEOF
-ac_cs_usage="\
-\`$as_me' instantiates files from templates according to the
-current configuration.
-
-Usage: $0 [OPTIONS] [FILE]...
-
-  -h, --help       print this help, then exit
-  -V, --version    print version number and configuration settings, then exit
-  -q, --quiet      do not print progress messages
-  -d, --debug      don't remove temporary files
-      --recheck    update $as_me by reconfiguring in the same conditions
-  --file=FILE[:TEMPLATE]
-		   instantiate the configuration file FILE
-  --header=FILE[:TEMPLATE]
-		   instantiate the configuration header FILE
-
-Configuration files:
-$config_files
-
-Configuration headers:
-$config_headers
-
-Report bugs to <bug-autoc... at gnu.org>."
-
-_ACEOF
-cat >>$CONFIG_STATUS <<_ACEOF
-ac_cs_version="\\
-config.status
-configured by $0, generated by GNU Autoconf 2.61,
-  with options \\"`echo "$ac_configure_args" | sed 's/^ //; s/[\\""\`\$]/\\\\&/g'`\\"
-
-Copyright (C) 2006 Free Software Foundation, Inc.
-This config.status script is free software; the Free Software Foundation
-gives unlimited permission to copy, distribute and modify it."
-
-ac_pwd='$ac_pwd'
-srcdir='$srcdir'
-_ACEOF
-
-cat >>$CONFIG_STATUS <<\_ACEOF
-# If no file are specified by the user, then we need to provide default
-# value.  By we need to know if files were specified by the user.
-ac_need_defaults=:
-while test $# != 0
-do
-  case $1 in
-  --*=*)
-    ac_option=`expr "X$1" : 'X\([^=]*\)='`
-    ac_optarg=`expr "X$1" : 'X[^=]*=\(.*\)'`
-    ac_shift=:
-    ;;
-  *)
-    ac_option=$1
-    ac_optarg=$2
-    ac_shift=shift
-    ;;
-  esac
-
-  case $ac_option in
-  # Handling of the options.
-  -recheck | --recheck | --rechec | --reche | --rech | --rec | --re | --r)
-    ac_cs_recheck=: ;;
-  --version | --versio | --versi | --vers | --ver | --ve | --v | -V )
-    echo "$ac_cs_version"; exit ;;
-  --debug | --debu | --deb | --de | --d | -d )
-    debug=: ;;
-  --file | --fil | --fi | --f )
-    $ac_shift
-    CONFIG_FILES="$CONFIG_FILES $ac_optarg"
-    ac_need_defaults=false;;
-  --header | --heade | --head | --hea )
-    $ac_shift
-    CONFIG_HEADERS="$CONFIG_HEADERS $ac_optarg"
-    ac_need_defaults=false;;
-  --he | --h)
-    # Conflict between --help and --header
-    { echo "$as_me: error: ambiguous option: $1
-Try \`$0 --help' for more information." >&2
-   { (exit 1); exit 1; }; };;
-  --help | --hel | -h )
-    echo "$ac_cs_usage"; exit ;;
-  -q | -quiet | --quiet | --quie | --qui | --qu | --q \
-  | -silent | --silent | --silen | --sile | --sil | --si | --s)
-    ac_cs_silent=: ;;
-
-  # This is an error.
-  -*) { echo "$as_me: error: unrecognized option: $1
-Try \`$0 --help' for more information." >&2
-   { (exit 1); exit 1; }; } ;;
-
-  *) ac_config_targets="$ac_config_targets $1"
-     ac_need_defaults=false ;;
-
-  esac
-  shift
-done
-
-ac_configure_extra_args=
-
-if $ac_cs_silent; then
-  exec 6>/dev/null
-  ac_configure_extra_args="$ac_configure_extra_args --silent"
-fi
-
-_ACEOF
-cat >>$CONFIG_STATUS <<_ACEOF
-if \$ac_cs_recheck; then
-  echo "running CONFIG_SHELL=$SHELL $SHELL $0 "$ac_configure_args \$ac_configure_extra_args " --no-create --no-recursion" >&6
-  CONFIG_SHELL=$SHELL
-  export CONFIG_SHELL
-  exec $SHELL "$0"$ac_configure_args \$ac_configure_extra_args --no-create --no-recursion
-fi
-
-_ACEOF
-cat >>$CONFIG_STATUS <<\_ACEOF
-exec 5>>config.log
-{
-  echo
-  sed 'h;s/./-/g;s/^.../## /;s/...$/ ##/;p;x;p;x' <<_ASBOX
-## Running $as_me. ##
-_ASBOX
-  echo "$ac_log"
-} >&5
-
-_ACEOF
-cat >>$CONFIG_STATUS <<_ACEOF
-_ACEOF
-
-cat >>$CONFIG_STATUS <<\_ACEOF
-
-# Handling of arguments.
-for ac_config_target in $ac_config_targets
-do
-  case $ac_config_target in
-    "common/config.h") CONFIG_HEADERS="$CONFIG_HEADERS common/config.h" ;;
-    "Makefile") CONFIG_FILES="$CONFIG_FILES Makefile" ;;
-    "common/Makefile") CONFIG_FILES="$CONFIG_FILES common/Makefile" ;;
-    "ragel/Makefile") CONFIG_FILES="$CONFIG_FILES ragel/Makefile" ;;
-    "redfsm/Makefile") CONFIG_FILES="$CONFIG_FILES redfsm/Makefile" ;;
-    "rlgen-cd/Makefile") CONFIG_FILES="$CONFIG_FILES rlgen-cd/Makefile" ;;
-    "rlgen-java/Makefile") CONFIG_FILES="$CONFIG_FILES rlgen-java/Makefile" ;;
-    "rlgen-ruby/Makefile") CONFIG_FILES="$CONFIG_FILES rlgen-ruby/Makefile" ;;
-    "rlgen-dot/Makefile") CONFIG_FILES="$CONFIG_FILES rlgen-dot/Makefile" ;;
-    "rlgen-csharp/Makefile") CONFIG_FILES="$CONFIG_FILES rlgen-csharp/Makefile" ;;
-    "doc/Makefile") CONFIG_FILES="$CONFIG_FILES doc/Makefile" ;;
-    "test/Makefile") CONFIG_FILES="$CONFIG_FILES test/Makefile" ;;
-
-  *) { { echo "$as_me:$LINENO: error: invalid argument: $ac_config_target" >&5
-echo "$as_me: error: invalid argument: $ac_config_target" >&2;}
-   { (exit 1); exit 1; }; };;
-  esac
-done
-
-
-# If the user did not use the arguments to specify the items to instantiate,
-# then the envvar interface is used.  Set only those that are not.
-# We use the long form for the default assignment because of an extremely
-# bizarre bug on SunOS 4.1.3.
-if $ac_need_defaults; then
-  test "${CONFIG_FILES+set}" = set || CONFIG_FILES=$config_files
-  test "${CONFIG_HEADERS+set}" = set || CONFIG_HEADERS=$config_headers
-fi
-
-# Have a temporary directory for convenience.  Make it in the build tree
-# simply because there is no reason against having it here, and in addition,
-# creating and moving files from /tmp can sometimes cause problems.
-# Hook for its removal unless debugging.
-# Note that there is a small window in which the directory will not be cleaned:
-# after its creation but before its name has been assigned to `$tmp'.
-$debug ||
-{
-  tmp=
-  trap 'exit_status=$?
-  { test -z "$tmp" || test ! -d "$tmp" || rm -fr "$tmp"; } && exit $exit_status
-' 0
-  trap '{ (exit 1); exit 1; }' 1 2 13 15
-}
-# Create a (secure) tmp directory for tmp files.
-
-{
-  tmp=`(umask 077 && mktemp -d "./confXXXXXX") 2>/dev/null` &&
-  test -n "$tmp" && test -d "$tmp"
-}  ||
-{
-  tmp=./conf$$-$RANDOM
-  (umask 077 && mkdir "$tmp")
-} ||
-{
-   echo "$me: cannot create a temporary directory in ." >&2
-   { (exit 1); exit 1; }
-}
-
-#
-# Set up the sed scripts for CONFIG_FILES section.
-#
-
-# No need to generate the scripts if there are no CONFIG_FILES.
-# This happens for instance when ./config.status config.h
-if test -n "$CONFIG_FILES"; then
-
-_ACEOF
-
-
-
-ac_delim='%!_!# '
-for ac_last_try in false false false false false :; do
-  cat >conf$$subs.sed <<_ACEOF
-SHELL!$SHELL$ac_delim
-PATH_SEPARATOR!$PATH_SEPARATOR$ac_delim
-PACKAGE_NAME!$PACKAGE_NAME$ac_delim
-PACKAGE_TARNAME!$PACKAGE_TARNAME$ac_delim
-PACKAGE_VERSION!$PACKAGE_VERSION$ac_delim
-PACKAGE_STRING!$PACKAGE_STRING$ac_delim
-PACKAGE_BUGREPORT!$PACKAGE_BUGREPORT$ac_delim
-exec_prefix!$exec_prefix$ac_delim
-prefix!$prefix$ac_delim
-program_transform_name!$program_transform_name$ac_delim
-bindir!$bindir$ac_delim
-sbindir!$sbindir$ac_delim
-libexecdir!$libexecdir$ac_delim
-datarootdir!$datarootdir$ac_delim
-datadir!$datadir$ac_delim
-sysconfdir!$sysconfdir$ac_delim
-sharedstatedir!$sharedstatedir$ac_delim
-localstatedir!$localstatedir$ac_delim
-includedir!$includedir$ac_delim
-oldincludedir!$oldincludedir$ac_delim
-docdir!$docdir$ac_delim
-infodir!$infodir$ac_delim
-htmldir!$htmldir$ac_delim
-dvidir!$dvidir$ac_delim
-pdfdir!$pdfdir$ac_delim
-psdir!$psdir$ac_delim
-libdir!$libdir$ac_delim
-localedir!$localedir$ac_delim
-mandir!$mandir$ac_delim
-DEFS!$DEFS$ac_delim
-ECHO_C!$ECHO_C$ac_delim
-ECHO_N!$ECHO_N$ac_delim
-ECHO_T!$ECHO_T$ac_delim
-LIBS!$LIBS$ac_delim
-build_alias!$build_alias$ac_delim
-host_alias!$host_alias$ac_delim
-target_alias!$target_alias$ac_delim
-BUILD_PARSERS!$BUILD_PARSERS$ac_delim
-CC!$CC$ac_delim
-CFLAGS!$CFLAGS$ac_delim
-LDFLAGS!$LDFLAGS$ac_delim
-CPPFLAGS!$CPPFLAGS$ac_delim
-ac_ct_CC!$ac_ct_CC$ac_delim
-EXEEXT!$EXEEXT$ac_delim
-OBJEXT!$OBJEXT$ac_delim
-CXX!$CXX$ac_delim
-CXXFLAGS!$CXXFLAGS$ac_delim
-ac_ct_CXX!$ac_ct_CXX$ac_delim
-AR!$AR$ac_delim
-RANLIB!$RANLIB$ac_delim
-SET_MAKE!$SET_MAKE$ac_delim
-RAGEL!$RAGEL$ac_delim
-GPERF!$GPERF$ac_delim
-KELBT!$KELBT$ac_delim
-GDC!$GDC$ac_delim
-GOBJC!$GOBJC$ac_delim
-JAVAC!$JAVAC$ac_delim
-TXL!$TXL$ac_delim
-RUBY!$RUBY$ac_delim
-GMCS!$GMCS$ac_delim
-LIBOBJS!$LIBOBJS$ac_delim
-LTLIBOBJS!$LTLIBOBJS$ac_delim
-_ACEOF
-
-  if test `sed -n "s/.*$ac_delim\$/X/p" conf$$subs.sed | grep -c X` = 62; then
-    break
-  elif $ac_last_try; then
-    { { echo "$as_me:$LINENO: error: could not make $CONFIG_STATUS" >&5
-echo "$as_me: error: could not make $CONFIG_STATUS" >&2;}
-   { (exit 1); exit 1; }; }
-  else
-    ac_delim="$ac_delim!$ac_delim _$ac_delim!! "
-  fi
-done
-
-ac_eof=`sed -n '/^CEOF[0-9]*$/s/CEOF/0/p' conf$$subs.sed`
-if test -n "$ac_eof"; then
-  ac_eof=`echo "$ac_eof" | sort -nru | sed 1q`
-  ac_eof=`expr $ac_eof + 1`
-fi
-
-cat >>$CONFIG_STATUS <<_ACEOF
-cat >"\$tmp/subs-1.sed" <<\CEOF$ac_eof
-/@[a-zA-Z_][a-zA-Z_0-9]*@/!b end
-_ACEOF
-sed '
-s/[,\\&]/\\&/g; s/@/@|#_!!_#|/g
-s/^/s,@/; s/!/@,|#_!!_#|/
-:n
-t n
-s/'"$ac_delim"'$/,g/; t
-s/$/\\/; p
-N; s/^.*\n//; s/[,\\&]/\\&/g; s/@/@|#_!!_#|/g; b n
-' >>$CONFIG_STATUS <conf$$subs.sed
-rm -f conf$$subs.sed
-cat >>$CONFIG_STATUS <<_ACEOF
-:end
-s/|#_!!_#|//g
-CEOF$ac_eof
-_ACEOF
-
-
-# VPATH may cause trouble with some makes, so we remove $(srcdir),
-# ${srcdir} and @srcdir@ from VPATH if srcdir is ".", strip leading and
-# trailing colons and then remove the whole line if VPATH becomes empty
-# (actually we leave an empty line to preserve line numbers).
-if test "x$srcdir" = x.; then
-  ac_vpsub='/^[	 ]*VPATH[	 ]*=/{
-s/:*\$(srcdir):*/:/
-s/:*\${srcdir}:*/:/
-s/:*@srcdir@:*/:/
-s/^\([^=]*=[	 ]*\):*/\1/
-s/:*$//
-s/^[^=]*=[	 ]*$//
-}'
-fi
-
-cat >>$CONFIG_STATUS <<\_ACEOF
-fi # test -n "$CONFIG_FILES"
-
-
-for ac_tag in  :F $CONFIG_FILES  :H $CONFIG_HEADERS
-do
-  case $ac_tag in
-  :[FHLC]) ac_mode=$ac_tag; continue;;
-  esac
-  case $ac_mode$ac_tag in
-  :[FHL]*:*);;
-  :L* | :C*:*) { { echo "$as_me:$LINENO: error: Invalid tag $ac_tag." >&5
-echo "$as_me: error: Invalid tag $ac_tag." >&2;}
-   { (exit 1); exit 1; }; };;
-  :[FH]-) ac_tag=-:-;;
-  :[FH]*) ac_tag=$ac_tag:$ac_tag.in;;
-  esac
-  ac_save_IFS=$IFS
-  IFS=:
-  set x $ac_tag
-  IFS=$ac_save_IFS
-  shift
-  ac_file=$1
-  shift
-
-  case $ac_mode in
-  :L) ac_source=$1;;
-  :[FH])
-    ac_file_inputs=
-    for ac_f
-    do
-      case $ac_f in
-      -) ac_f="$tmp/stdin";;
-      *) # Look for the file first in the build tree, then in the source tree
-	 # (if the path is not absolute).  The absolute path cannot be DOS-style,
-	 # because $ac_f cannot contain `:'.
-	 test -f "$ac_f" ||
-	   case $ac_f in
-	   [\\/$]*) false;;
-	   *) test -f "$srcdir/$ac_f" && ac_f="$srcdir/$ac_f";;
-	   esac ||
-	   { { echo "$as_me:$LINENO: error: cannot find input file: $ac_f" >&5
-echo "$as_me: error: cannot find input file: $ac_f" >&2;}
-   { (exit 1); exit 1; }; };;
-      esac
-      ac_file_inputs="$ac_file_inputs $ac_f"
-    done
-
-    # Let's still pretend it is `configure' which instantiates (i.e., don't
-    # use $as_me), people would be surprised to read:
-    #    /* config.h.  Generated by config.status.  */
-    configure_input="Generated from "`IFS=:
-	  echo $* | sed 's|^[^:]*/||;s|:[^:]*/|, |g'`" by configure."
-    if test x"$ac_file" != x-; then
-      configure_input="$ac_file.  $configure_input"
-      { echo "$as_me:$LINENO: creating $ac_file" >&5
-echo "$as_me: creating $ac_file" >&6;}
-    fi
-
-    case $ac_tag in
-    *:-:* | *:-) cat >"$tmp/stdin";;
-    esac
-    ;;
-  esac
-
-  ac_dir=`$as_dirname -- "$ac_file" ||
-$as_expr X"$ac_file" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$ac_file" : 'X\(//\)[^/]' \| \
-	 X"$ac_file" : 'X\(//\)$' \| \
-	 X"$ac_file" : 'X\(/\)' \| . 2>/dev/null ||
-echo X"$ac_file" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)[^/].*/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\).*/{
-	    s//\1/
-	    q
-	  }
-	  s/.*/./; q'`
-  { as_dir="$ac_dir"
-  case $as_dir in #(
-  -*) as_dir=./$as_dir;;
-  esac
-  test -d "$as_dir" || { $as_mkdir_p && mkdir -p "$as_dir"; } || {
-    as_dirs=
-    while :; do
-      case $as_dir in #(
-      *\'*) as_qdir=`echo "$as_dir" | sed "s/'/'\\\\\\\\''/g"`;; #(
-      *) as_qdir=$as_dir;;
-      esac
-      as_dirs="'$as_qdir' $as_dirs"
-      as_dir=`$as_dirname -- "$as_dir" ||
-$as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$as_dir" : 'X\(//\)[^/]' \| \
-	 X"$as_dir" : 'X\(//\)$' \| \
-	 X"$as_dir" : 'X\(/\)' \| . 2>/dev/null ||
-echo X"$as_dir" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)[^/].*/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\).*/{
-	    s//\1/
-	    q
-	  }
-	  s/.*/./; q'`
-      test -d "$as_dir" && break
-    done
-    test -z "$as_dirs" || eval "mkdir $as_dirs"
-  } || test -d "$as_dir" || { { echo "$as_me:$LINENO: error: cannot create directory $as_dir" >&5
-echo "$as_me: error: cannot create directory $as_dir" >&2;}
-   { (exit 1); exit 1; }; }; }
-  ac_builddir=.
-
-case "$ac_dir" in
-.) ac_dir_suffix= ac_top_builddir_sub=. ac_top_build_prefix= ;;
-*)
-  ac_dir_suffix=/`echo "$ac_dir" | sed 's,^\.[\\/],,'`
-  # A ".." for each directory in $ac_dir_suffix.
-  ac_top_builddir_sub=`echo "$ac_dir_suffix" | sed 's,/[^\\/]*,/..,g;s,/,,'`
-  case $ac_top_builddir_sub in
-  "") ac_top_builddir_sub=. ac_top_build_prefix= ;;
-  *)  ac_top_build_prefix=$ac_top_builddir_sub/ ;;
-  esac ;;
-esac
-ac_abs_top_builddir=$ac_pwd
-ac_abs_builddir=$ac_pwd$ac_dir_suffix
-# for backward compatibility:
-ac_top_builddir=$ac_top_build_prefix
-
-case $srcdir in
-  .)  # We are building in place.
-    ac_srcdir=.
-    ac_top_srcdir=$ac_top_builddir_sub
-    ac_abs_top_srcdir=$ac_pwd ;;
-  [\\/]* | ?:[\\/]* )  # Absolute name.
-    ac_srcdir=$srcdir$ac_dir_suffix;
-    ac_top_srcdir=$srcdir
-    ac_abs_top_srcdir=$srcdir ;;
-  *) # Relative name.
-    ac_srcdir=$ac_top_build_prefix$srcdir$ac_dir_suffix
-    ac_top_srcdir=$ac_top_build_prefix$srcdir
-    ac_abs_top_srcdir=$ac_pwd/$srcdir ;;
-esac
-ac_abs_srcdir=$ac_abs_top_srcdir$ac_dir_suffix
-
-
-  case $ac_mode in
-  :F)
-  #
-  # CONFIG_FILE
-  #
-
-_ACEOF
-
-cat >>$CONFIG_STATUS <<\_ACEOF
-# If the template does not know about datarootdir, expand it.
-# FIXME: This hack should be removed a few years after 2.60.
-ac_datarootdir_hack=; ac_datarootdir_seen=
-
-case `sed -n '/datarootdir/ {
-  p
-  q
-}
-/@datadir@/p
-/@docdir@/p
-/@infodir@/p
-/@localedir@/p
-/@mandir@/p
-' $ac_file_inputs` in
-*datarootdir*) ac_datarootdir_seen=yes;;
-*@datadir@*|*@docdir@*|*@infodir@*|*@localedir@*|*@mandir@*)
-  { echo "$as_me:$LINENO: WARNING: $ac_file_inputs seems to ignore the --datarootdir setting" >&5
-echo "$as_me: WARNING: $ac_file_inputs seems to ignore the --datarootdir setting" >&2;}
-_ACEOF
-cat >>$CONFIG_STATUS <<_ACEOF
-  ac_datarootdir_hack='
-  s&@datadir@&$datadir&g
-  s&@docdir@&$docdir&g
-  s&@infodir@&$infodir&g
-  s&@localedir@&$localedir&g
-  s&@mandir@&$mandir&g
-    s&\\\${datarootdir}&$datarootdir&g' ;;
-esac
-_ACEOF
-
-# Neutralize VPATH when `$srcdir' = `.'.
-# Shell code in configure.ac might set extrasub.
-# FIXME: do we really want to maintain this feature?
-cat >>$CONFIG_STATUS <<_ACEOF
-  sed "$ac_vpsub
-$extrasub
-_ACEOF
-cat >>$CONFIG_STATUS <<\_ACEOF
-:t
-/@[a-zA-Z_][a-zA-Z_0-9]*@/!b
-s&@configure_input@&$configure_input&;t t
-s&@top_builddir@&$ac_top_builddir_sub&;t t
-s&@srcdir@&$ac_srcdir&;t t
-s&@abs_srcdir@&$ac_abs_srcdir&;t t
-s&@top_srcdir@&$ac_top_srcdir&;t t
-s&@abs_top_srcdir@&$ac_abs_top_srcdir&;t t
-s&@builddir@&$ac_builddir&;t t
-s&@abs_builddir@&$ac_abs_builddir&;t t
-s&@abs_top_builddir@&$ac_abs_top_builddir&;t t
-$ac_datarootdir_hack
-" $ac_file_inputs | sed -f "$tmp/subs-1.sed" >$tmp/out
-
-test -z "$ac_datarootdir_hack$ac_datarootdir_seen" &&
-  { ac_out=`sed -n '/\${datarootdir}/p' "$tmp/out"`; test -n "$ac_out"; } &&
-  { ac_out=`sed -n '/^[	 ]*datarootdir[	 ]*:*=/p' "$tmp/out"`; test -z "$ac_out"; } &&
-  { echo "$as_me:$LINENO: WARNING: $ac_file contains a reference to the variable \`datarootdir'
-which seems to be undefined.  Please make sure it is defined." >&5
-echo "$as_me: WARNING: $ac_file contains a reference to the variable \`datarootdir'
-which seems to be undefined.  Please make sure it is defined." >&2;}
-
-  rm -f "$tmp/stdin"
-  case $ac_file in
-  -) cat "$tmp/out"; rm -f "$tmp/out";;
-  *) rm -f "$ac_file"; mv "$tmp/out" $ac_file;;
-  esac
- ;;
-  :H)
-  #
-  # CONFIG_HEADER
-  #
-_ACEOF
-
-# Transform confdefs.h into a sed script `conftest.defines', that
-# substitutes the proper values into config.h.in to produce config.h.
-rm -f conftest.defines conftest.tail
-# First, append a space to every undef/define line, to ease matching.
-echo 's/$/ /' >conftest.defines
-# Then, protect against being on the right side of a sed subst, or in
-# an unquoted here document, in config.status.  If some macros were
-# called several times there might be several #defines for the same
-# symbol, which is useless.  But do not sort them, since the last
-# AC_DEFINE must be honored.
-ac_word_re=[_$as_cr_Letters][_$as_cr_alnum]*
-# These sed commands are passed to sed as "A NAME B PARAMS C VALUE D", where
-# NAME is the cpp macro being defined, VALUE is the value it is being given.
-# PARAMS is the parameter list in the macro definition--in most cases, it's
-# just an empty string.
-ac_dA='s,^\\([	 #]*\\)[^	 ]*\\([	 ]*'
-ac_dB='\\)[	 (].*,\\1define\\2'
-ac_dC=' '
-ac_dD=' ,'
-
-uniq confdefs.h |
-  sed -n '
-	t rset
-	:rset
-	s/^[	 ]*#[	 ]*define[	 ][	 ]*//
-	t ok
-	d
-	:ok
-	s/[\\&,]/\\&/g
-	s/^\('"$ac_word_re"'\)\(([^()]*)\)[	 ]*\(.*\)/ '"$ac_dA"'\1'"$ac_dB"'\2'"${ac_dC}"'\3'"$ac_dD"'/p
-	s/^\('"$ac_word_re"'\)[	 ]*\(.*\)/'"$ac_dA"'\1'"$ac_dB$ac_dC"'\2'"$ac_dD"'/p
-  ' >>conftest.defines
-
-# Remove the space that was appended to ease matching.
-# Then replace #undef with comments.  This is necessary, for
-# example, in the case of _POSIX_SOURCE, which is predefined and required
-# on some systems where configure will not decide to define it.
-# (The regexp can be short, since the line contains either #define or #undef.)
-echo 's/ $//
-s,^[	 #]*u.*,/* & */,' >>conftest.defines
-
-# Break up conftest.defines:
-ac_max_sed_lines=50
-
-# First sed command is:	 sed -f defines.sed $ac_file_inputs >"$tmp/out1"
-# Second one is:	 sed -f defines.sed "$tmp/out1" >"$tmp/out2"
-# Third one will be:	 sed -f defines.sed "$tmp/out2" >"$tmp/out1"
-# et cetera.
-ac_in='$ac_file_inputs'
-ac_out='"$tmp/out1"'
-ac_nxt='"$tmp/out2"'
-
-while :
-do
-  # Write a here document:
-    cat >>$CONFIG_STATUS <<_ACEOF
-    # First, check the format of the line:
-    cat >"\$tmp/defines.sed" <<\\CEOF
-/^[	 ]*#[	 ]*undef[	 ][	 ]*$ac_word_re[	 ]*\$/b def
-/^[	 ]*#[	 ]*define[	 ][	 ]*$ac_word_re[(	 ]/b def
-b
-:def
-_ACEOF
-  sed ${ac_max_sed_lines}q conftest.defines >>$CONFIG_STATUS
-  echo 'CEOF
-    sed -f "$tmp/defines.sed"' "$ac_in >$ac_out" >>$CONFIG_STATUS
-  ac_in=$ac_out; ac_out=$ac_nxt; ac_nxt=$ac_in
-  sed 1,${ac_max_sed_lines}d conftest.defines >conftest.tail
-  grep . conftest.tail >/dev/null || break
-  rm -f conftest.defines
-  mv conftest.tail conftest.defines
-done
-rm -f conftest.defines conftest.tail
-
-echo "ac_result=$ac_in" >>$CONFIG_STATUS
-cat >>$CONFIG_STATUS <<\_ACEOF
-  if test x"$ac_file" != x-; then
-    echo "/* $configure_input  */" >"$tmp/config.h"
-    cat "$ac_result" >>"$tmp/config.h"
-    if diff $ac_file "$tmp/config.h" >/dev/null 2>&1; then
-      { echo "$as_me:$LINENO: $ac_file is unchanged" >&5
-echo "$as_me: $ac_file is unchanged" >&6;}
-    else
-      rm -f $ac_file
-      mv "$tmp/config.h" $ac_file
-    fi
-  else
-    echo "/* $configure_input  */"
-    cat "$ac_result"
-  fi
-  rm -f "$tmp/out12"
- ;;
-
-
-  esac
-
-done # for ac_tag
-
-
-{ (exit 0); exit 0; }
-_ACEOF
-chmod +x $CONFIG_STATUS
-ac_clean_files=$ac_clean_files_save
-
-
-# configure is writing to config.log, and then calls config.status.
-# config.status does its own redirection, appending to config.log.
-# Unfortunately, on DOS this fails, as config.log is still kept open
-# by configure, so config.status won't be able to write to it; its
-# output is simply discarded.  So we exec the FD to /dev/null,
-# effectively closing config.log, so it can be properly (re)opened and
-# appended to by config.status.  When coming back to configure, we
-# need to make the FD available again.
-if test "$no_create" != yes; then
-  ac_cs_success=:
-  ac_config_status_args=
-  test "$silent" = yes &&
-    ac_config_status_args="$ac_config_status_args --quiet"
-  exec 5>/dev/null
-  $SHELL $CONFIG_STATUS $ac_config_status_args || ac_cs_success=false
-  exec 5>>config.log
-  # Use ||, not &&, to avoid exiting from the if with $? = 1, which
-  # would make configure fail if this is the last instruction.
-  $ac_cs_success || { (exit 1); exit 1; }
-fi
-
-
-echo "configuration of ragel complete"


From flamee... at gmail.com  Wed Oct  1 14:37:39 2008
From: flamee... at gmail.com (Diego 'Flameeyes' =?utf-8?q?Petten=C3=B2?=)
Date: Wed, 01 Oct 2008 16:37:39 +0200
Subject: [PATCH 5/6] Replace custom makefiles with automake.
Message-ID: <20081001143739.22980.34660.stgit@yamato>

Since there are a lot of limitations with the current custon
makefiles, move to use proper GNU automake, that will allow for a
quite easier life for package maintainers too.
---

 Makefile.am               |   21 +++++
 Makefile.in               |   76 -------------------
 common/Makefile.am        |   12 +++
 common/Makefile.in        |   68 -----------------
 configure.in              |    8 +-
 doc/Makefile.am           |   13 +++
 doc/Makefile.in           |   71 -----------------
 examples/Makefile         |  142 -----------------------------------
 examples/Makefile.am      |   38 +++++++++
 examples/cppscan.lex      |  143 -----------------------------------
 examples/cppscan.rec      |  183 ---------------------------------------------
 examples/lex-cppscan.l    |  143 +++++++++++++++++++++++++++++++++++
 examples/re2c-cppscan.rec |  183 +++++++++++++++++++++++++++++++++++++++++++++
 ragel/Makefile.am         |   38 +++++++++
 ragel/Makefile.in         |  101 -------------------------
 redfsm/Makefile.am        |   29 +++++++
 redfsm/Makefile.in        |   85 ---------------------
 rlgen-cd/Makefile.am      |   12 +++
 rlgen-cd/Makefile.in      |   69 -----------------
 rlgen-csharp/Makefile.am  |   12 +++
 rlgen-csharp/Makefile.in  |   69 -----------------
 rlgen-dot/Makefile.am     |    7 ++
 rlgen-dot/Makefile.in     |   66 ----------------
 rlgen-java/Makefile.am    |    8 ++
 rlgen-java/Makefile.in    |   66 ----------------
 rlgen-ruby/Makefile.am    |   11 +++
 rlgen-ruby/Makefile.in    |   67 ----------------
 test/Makefile.am          |   23 ++++++
 test/Makefile.in          |   30 -------
 29 files changed, 555 insertions(+), 1239 deletions(-)
 create mode 100644 Makefile.am
 delete mode 100644 Makefile.in
 create mode 100644 common/Makefile.am
 delete mode 100644 common/Makefile.in
 create mode 100644 doc/Makefile.am
 delete mode 100644 doc/Makefile.in
 delete mode 100644 examples/Makefile
 create mode 100644 examples/Makefile.am
 delete mode 100644 examples/cppscan.lex
 delete mode 100644 examples/cppscan.rec
 create mode 100644 examples/lex-cppscan.l
 create mode 100644 examples/re2c-cppscan.rec
 create mode 100644 ragel/Makefile.am
 delete mode 100644 ragel/Makefile.in
 create mode 100644 redfsm/Makefile.am
 delete mode 100644 redfsm/Makefile.in
 create mode 100644 rlgen-cd/Makefile.am
 delete mode 100644 rlgen-cd/Makefile.in
 create mode 100644 rlgen-csharp/Makefile.am
 delete mode 100644 rlgen-csharp/Makefile.in
 create mode 100644 rlgen-dot/Makefile.am
 delete mode 100644 rlgen-dot/Makefile.in
 create mode 100644 rlgen-java/Makefile.am
 delete mode 100644 rlgen-java/Makefile.in
 create mode 100644 rlgen-ruby/Makefile.am
 delete mode 100644 rlgen-ruby/Makefile.in
 create mode 100644 test/Makefile.am
 delete mode 100644 test/Makefile.in

diff --git a/Makefile.am b/Makefile.am
new file mode 100644
index 0000000..3dd8634
--- /dev/null
+++ b/Makefile.am
@@ -0,0 +1,21 @@
+# aapl headers and docs
+noinst_HEADERS = aapl/avlbasic.h aapl/avlimel.h aapl/avlmap.h		\
+	aapl/bstcommon.h aapl/compare.h aapl/insertsort.h		\
+	aapl/sbstset.h aapl/avlcommon.h aapl/avlimelkey.h		\
+	aapl/avlmel.h aapl/bstmap.h aapl/dlcommon.h aapl/mergesort.h	\
+	aapl/sbsttable.h aapl/avlibasic.h aapl/avliset.h		\
+	aapl/avlmelkey.h aapl/bstset.h aapl/dlist.h aapl/quicksort.h	\
+	aapl/svector.h aapl/avlikeyless.h aapl/avlitree.h		\
+	aapl/avlset.h aapl/bsttable.h aapl/dlistmel.h aapl/resize.h	\
+	aapl/table.h aapl/avlimap.h aapl/avlkeyless.h aapl/avltree.h	\
+	aapl/bubblesort.h aapl/dlistval.h aapl/sbstmap.h aapl/vector.h
+EXTRA_DIST = aapl/README aapl/COPYING
+
+BUILD_COMMON = common redfsm rlgen-cd rlgen-java rlgen-ruby rlgen-csharp rlgen-dot
+BUILD_SUBDIRS = ragel 
+ALL_SUBDIRS = $(BUILD_COMMON) $(BUILD_SUBDIRS) test examples doc
+
+SUBDIRS = common redfsm \
+	rlgen-cd rlgen-java rlgen-ruby rlgen-csharp rlgen-dot \
+	ragel \
+	test examples doc
diff --git a/Makefile.in b/Makefile.in
deleted file mode 100644
index 4619bb5..0000000
--- a/Makefile.in
+++ /dev/null
@@ -1,76 +0,0 @@
-#
-#   Copyright 2001-2007 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-BUILD_COMMON = common redfsm rlgen-cd rlgen-java rlgen-ruby rlgen-csharp rlgen-dot
-BUILD_SUBDIRS = ragel 
-ALL_SUBDIRS = $(BUILD_COMMON) $(BUILD_SUBDIRS) test examples doc
-
-#*************************************
-
-# Programs
-CXX = @CXX@
-
-
-# build targets
-all: $(BUILD_SUBDIRS)
-
-.PHONY: $(ALL_SUBDIRS)
-
-$(BUILD_COMMON):
-	@cd $@ && $(MAKE)
-
-$(BUILD_SUBDIRS): $(BUILD_COMMON)
-	@cd $@ && $(MAKE)
-
-# clean targets.
-
-CLEAN_SUBDIRS = $(ALL_SUBDIRS:%=%-clean)
-
-.PHONY: $(CLEAN_SUBDIRS)
-
-$(CLEAN_SUBDIRS):
-	@cd $(@:%-clean=%) && $(MAKE) clean
-
-clean: $(CLEAN_SUBDIRS)
-	rm -f tags
-
-# distcleaan targets
-
-DISTCLEAN_SUBDIRS = $(ALL_SUBDIRS:%=%-distclean)
-
-.PHONY: $(DISTCLEAN_SUBDIRS)
-
-$(DISTCLEAN_SUBDIRS):
-	@cd $(@:%-distclean=%) && $(MAKE) distclean
-
-distclean: $(DISTCLEAN_SUBDIRS)
-	rm -f Makefile config.cache config.status config.log
-
-#install targets
-
-INSTALL_SUBDIRS = $(BUILD_SUBDIRS:%=%-install)
-
-.PHONY: $(INSTALL_SUBDIRS)
-
-$(INSTALL_SUBDIRS):
-	@cd $(@:%-install=%) && $(MAKE) install
-
-install: $(INSTALL_SUBDIRS)
-
diff --git a/common/Makefile.am b/common/Makefile.am
new file mode 100644
index 0000000..5a82a1b
--- /dev/null
+++ b/common/Makefile.am
@@ -0,0 +1,12 @@
+INCLUDES = -I$(top_srcdir)/aapl
+
+AM_CXXFLAGS = -g -Wall
+
+noinst_LIBRARIES = libcommon.a
+
+libcommon_a_SOURCES = common.h common.cpp version.h buffer.h pcheck.h
+
+BUILT_SOURCES = version.h
+
+version.h:
+	echo '#define PREFIX "$(prefix)"' >> version.h
diff --git a/common/Makefile.in b/common/Makefile.in
deleted file mode 100644
index e79d6a4..0000000
--- a/common/Makefile.in
+++ /dev/null
@@ -1,68 +0,0 @@
-#
-#   Copyright 2001-2006 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-INCS += -I../aapl
-DEFS +=
-
-CXXFLAGS += -g -Wall
-LDFLAGS +=
-
-CC_SRCS = common.cpp
-
-GEN_SRC = version.h
-
-#*************************************
-prefix = @prefix@
-
-# Programs
-CXX = @CXX@
-AR = @AR@
-RANLIB = @RANLIB@
-
-# Get objects and dependencies from sources.
-OBJS = $(CC_SRCS:%.cpp=%.o)
-DEPS = $(CC_SRCS:%.cpp=.%.d)
-
-
-# rules
-
-all: common.a
-
-common.a: $(GEN_SRC) $(OBJS)
-	$(AR) -cr $@ $(OBJS) 
-	$(RANLIB) $@
-
-version.h:
-	echo '#define PREFIX "$(prefix)"' >> version.h
-
-%.o: %.cpp
-	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
-
-distclean: clean
-	rm -f Makefile config.h
-
-clean:
-	rm -f tags version.h .*.d *.o common.a
-
-install:
-	@true
-
--include $(DEPS)
diff --git a/configure.in b/configure.in
index 85e93b0..0b9fa44 100644
--- a/configure.in
+++ b/configure.in
@@ -21,6 +21,8 @@ dnl   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 AC_INIT(ragel/main.cpp, 6.3)
 AC_CONFIG_HEADER(common/config.h)
 
+AM_INIT_AUTOMAKE([1.10 foreign])
+
 PACKAGE_PUBDATE="August 2008"
 AC_SUBST(PACKAGE_PUBDATE)
 AC_DEFINE_UNQUOTED([PACKAGE_PUBDATE], ["$PACKAGE_PUBDATE"], [Package publication date])
@@ -30,13 +32,13 @@ dnl and don't need to be built.
 AC_ARG_ENABLE([parsers],
   AS_HELP_STRING([--disable-parsers], [Disable building of parsers with ragel, kelbt and gperf]),
   [], [enable_parsers=yes])
-AC_SUBST([enable_parsers])
+AM_CONDITIONAL([BUILD_PARSERS], [test "x$enable_parsers" = "xyes"])
 
 dnl Checks for programs.
 AC_PROG_CC
 AC_PROG_CXX
-AC_CHECK_TOOL(AR, ar)
 AC_PROG_RANLIB
+AM_PROG_LEX
 
 dnl Set test on c++ compiler.
 AC_LANG_CPLUSPLUS
@@ -111,6 +113,6 @@ AC_CHECK_PROG(GMCS, gmcs, gmcs)
 AC_SUBST(GMCS)
 
 dnl write output files
-AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile test/runtests doc/ragel.1 doc/rlgen-cd.1 doc/rlgen-java.1 doc/rlgen-ruby.1 doc/rlgen-dot.1 doc/version.tex)
+AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile examples/Makefile test/runtests doc/ragel.1 doc/rlgen-cd.1 doc/rlgen-java.1 doc/rlgen-ruby.1 doc/rlgen-dot.1 doc/version.tex)
 
 echo "configuration of ragel complete"
diff --git a/doc/Makefile.am b/doc/Makefile.am
new file mode 100644
index 0000000..816a279
--- /dev/null
+++ b/doc/Makefile.am
@@ -0,0 +1,13 @@
+.fig.pdf:
+	fig2dev -L pdf $< $@
+
+.tex.pdf:
+	pdflatex -interaction=nonstopmode $<
+	pdflatex -interaction=nonstopmode $<
+	pdflatex -interaction=nonstopmode $<
+
+man_MANS = ragel.1 rlgen-cd.1 rlgen-java.1 rlgen-ruby.1 rlgen-dot.1
+
+#dist_doc_DATA = ragel-guide.pdf
+
+doc_DATA = ../ChangeLog
diff --git a/doc/Makefile.in b/doc/Makefile.in
deleted file mode 100644
index 6178f0d..0000000
--- a/doc/Makefile.in
+++ /dev/null
@@ -1,71 +0,0 @@
-#
-#   Copyright 2001-2007 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-INPUT = version.tex ragel-guide.tex
-
-# Pick up all the figures in the current dir.
-FIGURES = $(wildcard *.fig)
-PDFFIGS = $(FIGURES:%.fig=%.pdf)
-
-
-# Installation locations.
-PACKAGE     = ragel
-prefix      = @prefix@
-datarootdir = @datarootdir@
-docdir      = @docdir@
-mandir      = @mandir@
-
-MANPAGES = ragel.1 rlgen-cd.1 rlgen-java.1 rlgen-ruby.1 rlgen-dot.1
-
-# Rules.
-all: ragel-guide.pdf $(MANPAGES)
-
-ragel-guide.pdf: $(PDFFIGS) $(INPUT)
-
-%.pdf: %.fig
-	fig2dev -L pdf $< $@
-
-%.pdf: %.tex
-	pdflatex -interaction=nonstopmode $< >/dev/null
-	pdflatex -interaction=nonstopmode $< >/dev/null
-	pdflatex -interaction=nonstopmode $< >/dev/null
-
-clean:
-	rm -f *.bak *.aux *.dvi *.log *.toc *.pdf
-
-distclean: clean
-	rm -f Makefile $(MANPAGES) version.tex
-
-man: $(MANPAGES)
-
-man-install: man
-	install -d $(DESTDIR)$(mandir)/man1
-	install -m 644 ragel.1      (DESTDIR)$(mandir)/man1/ragel.1
-	install -m 644 rlgen-dot.1  (DESTDIR)$(mandir)/man1/rlgen-dot.1
-	install -m 644 rlgen-cd.1   (DESTDIR)$(mandir)/man1/rlgen-cd.1
-	install -m 644 rlgen-java.1 (DESTDIR)$(mandir)/man1/rlgen-java.1
-	install -m 644 rlgen-ruby.1 (DESTDIR)$(mandir)/man1/rlgen-ruby.1
-
-install: all man-install
-	install -d $(DESTDIR)$(docdir)
-	install -m 644 ragel-guide.pdf $(DESTDIR)$(docdir)/ragel-guide.pdf
-	gzip -c ../ChangeLog > ChangeLog.gz
-	install -m 644 ChangeLog.gz $(DESTDIR)$(docdir)/ChangeLog.gz
-	rm ChangeLog.gz
diff --git a/examples/Makefile b/examples/Makefile
deleted file mode 100644
index b9fcc21..0000000
--- a/examples/Makefile
+++ /dev/null
@@ -1,142 +0,0 @@
-#
-#   Copyright 2002-2007 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-RAGEL = ../ragel/ragel
-FLEX = flex
-RE2C = re2c
-
-TARGS = \
-	atoi awkemu clang concurrent cppscan format gotocallret mailbox params \
-	pullscan rlscan statechart 
-
-#########################################
-
-all: $(TARGS)
-
-distclean clean:
-	rm -Rf *.o *.c *.cpp $(TARGS)
-
-%.o: %.c
-	gcc $(CFLAGS) -Wall -g -c -O3 -o $@ $<
-
-%.o: %.cpp
-	g++ $(CXXFLAGS) -Wall -g -c -O3 -o $@ $<
-
-#########################################
-
-gotocallret: gotocallret.o
-	g++ -g -o gotocallret gotocallret.o 
-
-gotocallret.cpp: gotocallret.rl
-	$(RAGEL) -G2 -o gotocallret.cpp gotocallret.rl 
-
-gotocallret.o: gotocallret.cpp
-	g++ -Wall -g -c -O3 -o $@ $<
-
-
-pullscan: pullscan.o
-	gcc -g -o $@ $<
-
-pullscan.c: pullscan.rl $(RAGEL) 
-	$(RAGEL) -G2 -o $@ pullscan.rl
-
-concurrent: concurrent.o
-	g++ -g -o concurrent concurrent.o 
-
-concurrent.cpp: concurrent.rl $(RAGEL)
-	$(RAGEL) -G2 -o concurrent.cpp concurrent.rl
-
-rlscan: rlscan.o
-	g++ -g -o rlscan rlscan.o 
-
-rlscan.cpp: rlscan.rl 
-	$(RAGEL) -G2 -o rlscan.cpp rlscan.rl
-
-statechart: statechart.o
-	g++ -g -o statechart statechart.o 
-
-statechart.cpp: statechart.rl 
-	$(RAGEL) -G2 -o statechart.cpp statechart.rl
-
-statechart.o: statechart.cpp
-	g++ -Wall -g -c -O3 -o $@ $<
-
-params: params.o 
-	gcc -g -o params params.o
-
-params.c: params.rl
-	$(RAGEL) -G2 -o params.c params.rl
-
-clang: clang.o 
-	gcc -g -o clang clang.o
-
-clang.c: clang.rl 
-	$(RAGEL) -G2 -o clang.c clang.rl
-
-optional: lex-cppscan re2c-cppscan
-
-cppscan: cppscan.o
-	g++ -g -o $@ $<
-
-lex-cppscan: lex-cppscan.o
-	g++ -g -o $@ $<
-	
-re2c-cppscan: re2c-cppscan.o
-	g++ -g -o $@ $<
-	
-cppscan.cpp: cppscan.rl 
-	$(RAGEL) -G2 -o $@ cppscan.rl
-
-lex-cppscan.cpp: cppscan.lex
-	$(FLEX) -f -o $@ $<
-
-re2c-cppscan.cpp: cppscan.rec
-	$(RE2C) -s $< > $@
-
-example.cpp: example.rec
-	$(RE2C) -s $< > $@
-
-format: format.o 
-	gcc -g -o format format.o
-
-format.c: format.rl
-	$(RAGEL) -G2 -o format.c format.rl
-
-awkemu: awkemu.o
-	gcc -g -o awkemu awkemu.o
-
-awkemu.c: awkemu.rl
-	$(RAGEL) -G2 -o awkemu.c awkemu.rl
-
-
-mailbox: mailbox.o
-	g++ -g -o mailbox mailbox.o 
-
-mailbox.cpp: mailbox.rl
-	$(RAGEL) -G2 -o mailbox.cpp mailbox.rl
-
-atoi: atoi.o
-	g++ -g -o atoi atoi.o 
-
-atoi.cpp: atoi.rl
-	$(RAGEL) -G2 -o atoi.cpp atoi.rl
-
-atoi.o: atoi.cpp
-	g++ -Wall -g -c -O3 -o $@ $<
diff --git a/examples/Makefile.am b/examples/Makefile.am
new file mode 100644
index 0000000..3950fc6
--- /dev/null
+++ b/examples/Makefile.am
@@ -0,0 +1,38 @@
+.rl.cpp:
+	../ragel/ragel -G2 -o $@ $<
+
+.rl.c:
+	../ragel/ragel -G2 -o $@ $<
+
+.rec.cpp:
+	re2c -s $< > $@
+
+RAGEL_EXAMPLES = atoi awkemu clang concurrent cppscan format	\
+	gotocallret mailbox params pullscan rlscan statechart
+
+EXTRA_PROGRAMS = $(RAGEL_EXAMPLES) lex-cppscan re2c-cppscan
+
+examples: $(RAGEL_EXAMPLES)
+
+atoi_SOURCES = atoi.cpp
+awkemu_SOURCES = awkemu.c
+clang_SOURCES = clang.c
+concurrent_SOURCES = concurrent.cpp
+cppscan_SOURCES = cppscan.cpp
+format_SOURCES = format.c
+gotocallret_SOURCES = gotocallret.cpp
+mailbox_SOURCES = mailbox.cpp
+params_SOURCES = params.c
+pullscan_SOURCES = pullscan.c
+rlscan_SOURCES = rlscan.cpp
+statechart_SOURCES = statechart.cpp
+
+lex_cppscan_SOURCES = lex-cppscan.l
+re2c_cppscan_SOURCES = re2c-cppscan.cpp
+
+BUILT_SOURCES = $(atoi_SOURCES) $(awkemu_SOURCES) $(clang_SOURCES)	\
+	$(concurrent_SOURCES) $(cppscan_SOURCES) $(format_SOURCES)	\
+	$(gotocallret_SOURCES) $(mailbox_SOURCES) $(params_SOURCES)	\
+	$(pullscan_SOURCES) $(rlscan_SOURCES) $(statechart_SOURCES)	\
+	$(lex_cppscan_SOURCES) $(re2c_cppscan_SOURCES)
+
diff --git a/examples/cppscan.lex b/examples/cppscan.lex
deleted file mode 100644
index fb66253..0000000
--- a/examples/cppscan.lex
+++ /dev/null
@@ -1,143 +0,0 @@
-/*
- * flex equivalent to cppscan.rl
- */
-
-%{
-
-#include <stdio.h>
-
-#define TK_Dlit 256
-#define TK_Slit 257
-#define TK_Float 258
-#define TK_Id 259
-#define TK_NameSep 260
-#define TK_Arrow 261
-#define TK_PlusPlus 262
-#define TK_MinusMinus 263
-#define TK_ArrowStar 264
-#define TK_DotStar 265
-#define TK_ShiftLeft 266
-#define TK_ShiftRight 267
-#define TK_IntegerDecimal 268
-#define TK_IntegerOctal 269
-#define TK_IntegerHex 270
-#define TK_EqualsEquals 271
-#define TK_NotEquals 272
-#define TK_AndAnd 273
-#define TK_OrOr 274
-#define TK_MultAssign 275
-#define TK_DivAssign 276
-#define TK_PercentAssign 277
-#define TK_PlusAssign 278
-#define TK_MinusAssign 279
-#define TK_AmpAssign 280
-#define TK_CaretAssign 281
-#define TK_BarAssign 282
-#define TK_DotDotDot 283
-#define TK_Whitespace 284
-#define TK_Comment 285
-
-int line = 1, col = 1;
-
-void token( int tok, char *data, int len )
-{
-	printf( "<%i> ", tok );
-	for ( int i = 0; i < len; i++ )
-		fputc( data[i], stdout );
-	fputc( '\n', stdout );
-
-	/* Count newlines and columns. This code is here mainly for having some
-	 * code in the token routine when commenting out the above output during
-	 * performance testing. */
-	for ( int i = 0; i < len; i ++ ) {
-		if ( data[i] == '\n' ) {
-			line += 1;
-			col = 1;
-		}
-		else {
-			col += 1;
-		}
-	}
-}
-
-
-%}
-
-%x COMMENT
-
-FRACT_CONST		[0-9]*\.[0-9]+|[0-9]+\.
-EXPONENT		[eE][+\-]?[0-9]+
-FLOAT_SUFFIX	[flFL]
-
-%%
-
-	/* Single and double literals. */
-L?\'([^\'\\\n]|\\.)*\' {
-	token( TK_Slit, yytext, yyleng );
-}
-
-L?\"([^\"\\\n]|\\.)*\" {
-	token( TK_Dlit, yytext, yyleng );
-}
-
-[a-zA-Z_][a-zA-Z0-9_]* {
-	token( TK_Id, yytext, yyleng );
-}
-
-{FRACT_CONST}{EXPONENT}?{FLOAT_SUFFIX}?|[0-9]+{EXPONENT}{FLOAT_SUFFIX}? {
-	token( TK_Float, yytext, yyleng );
-}
-
-(0|[1-9][0-9]*)[ulUL]{0,3} {
-	token( TK_IntegerDecimal, yytext, yyleng );
-}
-
-0[0-9]+[ulUL]{0,2} {
-	token( TK_IntegerOctal, yytext, yyleng );
-}
-
-0x[0-9a-fA-F]+[ulUL]{0,2} {
-	token( TK_IntegerHex, yytext, yyleng );
-}
-
-:: token( TK_NameSep, yytext, yyleng );
-== token( TK_EqualsEquals, yytext, yyleng );
-!= token( TK_NotEquals, yytext, yyleng );
-&& token( TK_AndAnd, yytext, yyleng );
-\|\| token( TK_OrOr, yytext, yyleng );
-\*= token( TK_MultAssign, yytext, yyleng );
-\/= token( TK_DivAssign, yytext, yyleng );
-%= token( TK_PercentAssign, yytext, yyleng );
-\+= token( TK_PlusAssign, yytext, yyleng );
--= token( TK_MinusAssign, yytext, yyleng );
-&= token( TK_AmpAssign, yytext, yyleng );
-^= token( TK_CaretAssign, yytext, yyleng );
-\|= token( TK_BarAssign, yytext, yyleng );
-\+\+ token( TK_PlusPlus, yytext, yyleng );
--- token( TK_MinusMinus, yytext, yyleng );
--> token( TK_Arrow, yytext, yyleng );
-->\* token( TK_ArrowStar, yytext, yyleng );
-\.\* token( TK_DotStar, yytext, yyleng );
-\.\.\. token( TK_DotDotDot, yytext, yyleng );
-
-\/\*				BEGIN(COMMENT);
-<COMMENT>\*\/		BEGIN(INITIAL);
-<COMMENT>(.|\n)		{ }
-
-\/\/.*\n			{}
-[^!-~]+				{}
-
-[!-/:-@\[-`{-~] token( yytext[0], yytext, yyleng );
-	
-%%
-
-int yywrap()
-{
-	/* Once the input is done, no more. */
-	return 1;
-}
-
-int main()
-{
-	yylex();
-}
diff --git a/examples/cppscan.rec b/examples/cppscan.rec
deleted file mode 100644
index 43f297d..0000000
--- a/examples/cppscan.rec
+++ /dev/null
@@ -1,183 +0,0 @@
-#include <stdio.h>
-#include <string.h>
-#include <stdlib.h>
-
-#define TK_Dlit 256
-#define TK_Slit 257
-#define TK_Float 258
-#define TK_Id 259
-#define TK_NameSep 260
-#define TK_Arrow 261
-#define TK_PlusPlus 262
-#define TK_MinusMinus 263
-#define TK_ArrowStar 264
-#define TK_DotStar 265
-#define TK_ShiftLeft 266
-#define TK_ShiftRight 267
-#define TK_IntegerDecimal 268
-#define TK_IntegerOctal 269
-#define TK_IntegerHex 270
-#define TK_EqualsEquals 271
-#define TK_NotEquals 272
-#define TK_AndAnd 273
-#define TK_OrOr 274
-#define TK_MultAssign 275
-#define TK_DivAssign 276
-#define TK_PercentAssign 277
-#define TK_PlusAssign 278
-#define TK_MinusAssign 279
-#define TK_AmpAssign 280
-#define TK_CaretAssign 281
-#define TK_BarAssign 282
-#define TK_DotDotDot 283
-#define TK_Whitespace 284
-#define TK_Comment 285
-
-int line = 1, col = 1;
-
-void token( int tok, char *data, int len )
-{
-	printf( "<%i> ", tok );
-	for ( int i = 0; i < len; i++ )
-		fputc( data[i], stdout );
-	fputc( '\n', stdout );
-
-	/* Count newlines and columns. This code is here mainly for having some
-	 * code in the token routine when commenting out the above output during
-	 * performance testing. */
-	for ( int i = 0; i < len; i ++ ) {
-		if ( data[i] == '\n' ) {
-			line += 1;
-			col = 1;
-		}
-		else {
-			col += 1;
-		}
-	}
-}
-
-#define BUFSIZE 8192
-char buf[BUFSIZE];
-
-void fill( int n )
-{
-	printf("fill(%i)\n", n);
-	exit(1);
-}
-
-int main()
-{
-	char *start, *p = buf, *lim = buf, *marker;
-	int len, have, want, shift;
-	int done = 0;
-	
-#define YYCTYPE         char
-
-#define YYCURSOR        p
-#define YYLIMIT         lim
-#define YYMARKER        marker
-
-#define YYFILL(n)      { \
-		if ( ! done ) { \
-			have = lim-start; \
-			if ( start > buf ) { \
-				shift = start-buf; \
-				memmove( buf, start, have ); \
-				start -= shift; \
-				p -= shift; \
-				lim -= shift; \
-				marker -= shift; \
-			} \
-			want = BUFSIZE - have - 1; \
-			len = fread( lim, 1, want, stdin ); \
-			lim += len; \
-			if ( len < want ) { \
-				*lim++ = 0; \
-				done = 1; \
-			} \
-		} \
-	}
-
-again:
-	start = p;
-
-/*!re2c
-
-ANY				= [\000-\377];
-FRACTCONST		= ( [0-9]* "." [0-9]+ ) | [0-9]+ ".";
-EXPONENT		= [eE] [+\-]? [0-9]+;
-FLOATSUFFIX		= [flFL];
-
-	"L"? "\'" ( ANY \ [\'\\\n] | "\\" ANY )* "\'" {
-		token( TK_Slit, start, p-start );
-		goto again;
-	}
-
-	"L"? "\"" ( ANY \ [\"\\\n] | "\\" ANY )* "\"" {
-		token( TK_Dlit, start, p-start );
-		goto again;
-	}
-
-	[a-zA-Z_][a-zA-Z0-9_]* {
-		token( TK_Id, start, p-start );
-		goto again;
-	}
-
-	( FRACTCONST EXPONENT? FLOATSUFFIX? ) | ( [0-9]+ EXPONENT FLOATSUFFIX? ) {
-		token( TK_Float, start, p-start );
-		goto again;
-	}
-
-
-	( "0" | [1-9][0-9]* ) [ulUL]* {
-		token( TK_IntegerDecimal, start, p-start );
-		goto again;
-	}
-
-	"0" [0-9]+ [ulUL]* {
-		token( TK_IntegerOctal, start, p-start );
-		goto again;
-	}
-
-	"0x" [0-9a-fA-F]+[ulUL]* {
-		token( TK_IntegerHex, start, p-start );
-		goto again;
-	}
-
-	"::"	{ token( TK_NameSep, start, p-start ); goto again; }
-	"=="	{ token( TK_EqualsEquals, start, p-start ); goto again; }
-	"!="	{ token( TK_NotEquals, start, p-start ); goto again; }
-	"&&"	{ token( TK_AndAnd, start, p-start ); goto again; }
-	"||"	{ token( TK_OrOr, start, p-start ); goto again; }
-	"*="	{ token( TK_MultAssign, start, p-start ); goto again; }
-	"/="	{ token( TK_DivAssign, start, p-start ); goto again; }
-	"%="	{ token( TK_PercentAssign, start, p-start ); goto again; }
-	"+="	{ token( TK_PlusAssign, start, p-start ); goto again; }
-	"-="	{ token( TK_MinusAssign, start, p-start ); goto again; }
-	"&="	{ token( TK_AmpAssign, start, p-start ); goto again; }
-	"^="	{ token( TK_CaretAssign, start, p-start ); goto again; }
-	"|="	{ token( TK_BarAssign, start, p-start ); goto again; }
-	"++"	{ token( TK_PlusPlus, start, p-start ); goto again; }
-	"--"	{ token( TK_MinusMinus, start, p-start ); goto again; }
-	"->"	{ token( TK_Arrow, start, p-start ); goto again; }
-	"->*"	{ token( TK_ArrowStar, start, p-start ); goto again; }
-	".*"	{ token( TK_DotStar, start, p-start ); goto again; }
-	"..."	{ token( TK_DotDotDot, start, p-start ); goto again; }
-
-	"/*" { goto comment; }
-	"//" (ANY\"\n")* "\n"	{ goto again; }
-	[\001-\040\177]+		{ goto again; }
-
-	[\041-\057\072-\100\133-\140\173-\176]	{
-		token( *start, start, p-start );
-		goto again;
-	}
-	"\000"					{ return 0; }
-*/
-
-comment:
-/*!re2c
-	"*/"					{ goto again; }
-	ANY						{ goto comment; }
-*/
-}
diff --git a/examples/lex-cppscan.l b/examples/lex-cppscan.l
new file mode 100644
index 0000000..fb66253
--- /dev/null
+++ b/examples/lex-cppscan.l
@@ -0,0 +1,143 @@
+/*
+ * flex equivalent to cppscan.rl
+ */
+
+%{
+
+#include <stdio.h>
+
+#define TK_Dlit 256
+#define TK_Slit 257
+#define TK_Float 258
+#define TK_Id 259
+#define TK_NameSep 260
+#define TK_Arrow 261
+#define TK_PlusPlus 262
+#define TK_MinusMinus 263
+#define TK_ArrowStar 264
+#define TK_DotStar 265
+#define TK_ShiftLeft 266
+#define TK_ShiftRight 267
+#define TK_IntegerDecimal 268
+#define TK_IntegerOctal 269
+#define TK_IntegerHex 270
+#define TK_EqualsEquals 271
+#define TK_NotEquals 272
+#define TK_AndAnd 273
+#define TK_OrOr 274
+#define TK_MultAssign 275
+#define TK_DivAssign 276
+#define TK_PercentAssign 277
+#define TK_PlusAssign 278
+#define TK_MinusAssign 279
+#define TK_AmpAssign 280
+#define TK_CaretAssign 281
+#define TK_BarAssign 282
+#define TK_DotDotDot 283
+#define TK_Whitespace 284
+#define TK_Comment 285
+
+int line = 1, col = 1;
+
+void token( int tok, char *data, int len )
+{
+	printf( "<%i> ", tok );
+	for ( int i = 0; i < len; i++ )
+		fputc( data[i], stdout );
+	fputc( '\n', stdout );
+
+	/* Count newlines and columns. This code is here mainly for having some
+	 * code in the token routine when commenting out the above output during
+	 * performance testing. */
+	for ( int i = 0; i < len; i ++ ) {
+		if ( data[i] == '\n' ) {
+			line += 1;
+			col = 1;
+		}
+		else {
+			col += 1;
+		}
+	}
+}
+
+
+%}
+
+%x COMMENT
+
+FRACT_CONST		[0-9]*\.[0-9]+|[0-9]+\.
+EXPONENT		[eE][+\-]?[0-9]+
+FLOAT_SUFFIX	[flFL]
+
+%%
+
+	/* Single and double literals. */
+L?\'([^\'\\\n]|\\.)*\' {
+	token( TK_Slit, yytext, yyleng );
+}
+
+L?\"([^\"\\\n]|\\.)*\" {
+	token( TK_Dlit, yytext, yyleng );
+}
+
+[a-zA-Z_][a-zA-Z0-9_]* {
+	token( TK_Id, yytext, yyleng );
+}
+
+{FRACT_CONST}{EXPONENT}?{FLOAT_SUFFIX}?|[0-9]+{EXPONENT}{FLOAT_SUFFIX}? {
+	token( TK_Float, yytext, yyleng );
+}
+
+(0|[1-9][0-9]*)[ulUL]{0,3} {
+	token( TK_IntegerDecimal, yytext, yyleng );
+}
+
+0[0-9]+[ulUL]{0,2} {
+	token( TK_IntegerOctal, yytext, yyleng );
+}
+
+0x[0-9a-fA-F]+[ulUL]{0,2} {
+	token( TK_IntegerHex, yytext, yyleng );
+}
+
+:: token( TK_NameSep, yytext, yyleng );
+== token( TK_EqualsEquals, yytext, yyleng );
+!= token( TK_NotEquals, yytext, yyleng );
+&& token( TK_AndAnd, yytext, yyleng );
+\|\| token( TK_OrOr, yytext, yyleng );
+\*= token( TK_MultAssign, yytext, yyleng );
+\/= token( TK_DivAssign, yytext, yyleng );
+%= token( TK_PercentAssign, yytext, yyleng );
+\+= token( TK_PlusAssign, yytext, yyleng );
+-= token( TK_MinusAssign, yytext, yyleng );
+&= token( TK_AmpAssign, yytext, yyleng );
+^= token( TK_CaretAssign, yytext, yyleng );
+\|= token( TK_BarAssign, yytext, yyleng );
+\+\+ token( TK_PlusPlus, yytext, yyleng );
+-- token( TK_MinusMinus, yytext, yyleng );
+-> token( TK_Arrow, yytext, yyleng );
+->\* token( TK_ArrowStar, yytext, yyleng );
+\.\* token( TK_DotStar, yytext, yyleng );
+\.\.\. token( TK_DotDotDot, yytext, yyleng );
+
+\/\*				BEGIN(COMMENT);
+<COMMENT>\*\/		BEGIN(INITIAL);
+<COMMENT>(.|\n)		{ }
+
+\/\/.*\n			{}
+[^!-~]+				{}
+
+[!-/:-@\[-`{-~] token( yytext[0], yytext, yyleng );
+	
+%%
+
+int yywrap()
+{
+	/* Once the input is done, no more. */
+	return 1;
+}
+
+int main()
+{
+	yylex();
+}
diff --git a/examples/re2c-cppscan.rec b/examples/re2c-cppscan.rec
new file mode 100644
index 0000000..43f297d
--- /dev/null
+++ b/examples/re2c-cppscan.rec
@@ -0,0 +1,183 @@
+#include <stdio.h>
+#include <string.h>
+#include <stdlib.h>
+
+#define TK_Dlit 256
+#define TK_Slit 257
+#define TK_Float 258
+#define TK_Id 259
+#define TK_NameSep 260
+#define TK_Arrow 261
+#define TK_PlusPlus 262
+#define TK_MinusMinus 263
+#define TK_ArrowStar 264
+#define TK_DotStar 265
+#define TK_ShiftLeft 266
+#define TK_ShiftRight 267
+#define TK_IntegerDecimal 268
+#define TK_IntegerOctal 269
+#define TK_IntegerHex 270
+#define TK_EqualsEquals 271
+#define TK_NotEquals 272
+#define TK_AndAnd 273
+#define TK_OrOr 274
+#define TK_MultAssign 275
+#define TK_DivAssign 276
+#define TK_PercentAssign 277
+#define TK_PlusAssign 278
+#define TK_MinusAssign 279
+#define TK_AmpAssign 280
+#define TK_CaretAssign 281
+#define TK_BarAssign 282
+#define TK_DotDotDot 283
+#define TK_Whitespace 284
+#define TK_Comment 285
+
+int line = 1, col = 1;
+
+void token( int tok, char *data, int len )
+{
+	printf( "<%i> ", tok );
+	for ( int i = 0; i < len; i++ )
+		fputc( data[i], stdout );
+	fputc( '\n', stdout );
+
+	/* Count newlines and columns. This code is here mainly for having some
+	 * code in the token routine when commenting out the above output during
+	 * performance testing. */
+	for ( int i = 0; i < len; i ++ ) {
+		if ( data[i] == '\n' ) {
+			line += 1;
+			col = 1;
+		}
+		else {
+			col += 1;
+		}
+	}
+}
+
+#define BUFSIZE 8192
+char buf[BUFSIZE];
+
+void fill( int n )
+{
+	printf("fill(%i)\n", n);
+	exit(1);
+}
+
+int main()
+{
+	char *start, *p = buf, *lim = buf, *marker;
+	int len, have, want, shift;
+	int done = 0;
+	
+#define YYCTYPE         char
+
+#define YYCURSOR        p
+#define YYLIMIT         lim
+#define YYMARKER        marker
+
+#define YYFILL(n)      { \
+		if ( ! done ) { \
+			have = lim-start; \
+			if ( start > buf ) { \
+				shift = start-buf; \
+				memmove( buf, start, have ); \
+				start -= shift; \
+				p -= shift; \
+				lim -= shift; \
+				marker -= shift; \
+			} \
+			want = BUFSIZE - have - 1; \
+			len = fread( lim, 1, want, stdin ); \
+			lim += len; \
+			if ( len < want ) { \
+				*lim++ = 0; \
+				done = 1; \
+			} \
+		} \
+	}
+
+again:
+	start = p;
+
+/*!re2c
+
+ANY				= [\000-\377];
+FRACTCONST		= ( [0-9]* "." [0-9]+ ) | [0-9]+ ".";
+EXPONENT		= [eE] [+\-]? [0-9]+;
+FLOATSUFFIX		= [flFL];
+
+	"L"? "\'" ( ANY \ [\'\\\n] | "\\" ANY )* "\'" {
+		token( TK_Slit, start, p-start );
+		goto again;
+	}
+
+	"L"? "\"" ( ANY \ [\"\\\n] | "\\" ANY )* "\"" {
+		token( TK_Dlit, start, p-start );
+		goto again;
+	}
+
+	[a-zA-Z_][a-zA-Z0-9_]* {
+		token( TK_Id, start, p-start );
+		goto again;
+	}
+
+	( FRACTCONST EXPONENT? FLOATSUFFIX? ) | ( [0-9]+ EXPONENT FLOATSUFFIX? ) {
+		token( TK_Float, start, p-start );
+		goto again;
+	}
+
+
+	( "0" | [1-9][0-9]* ) [ulUL]* {
+		token( TK_IntegerDecimal, start, p-start );
+		goto again;
+	}
+
+	"0" [0-9]+ [ulUL]* {
+		token( TK_IntegerOctal, start, p-start );
+		goto again;
+	}
+
+	"0x" [0-9a-fA-F]+[ulUL]* {
+		token( TK_IntegerHex, start, p-start );
+		goto again;
+	}
+
+	"::"	{ token( TK_NameSep, start, p-start ); goto again; }
+	"=="	{ token( TK_EqualsEquals, start, p-start ); goto again; }
+	"!="	{ token( TK_NotEquals, start, p-start ); goto again; }
+	"&&"	{ token( TK_AndAnd, start, p-start ); goto again; }
+	"||"	{ token( TK_OrOr, start, p-start ); goto again; }
+	"*="	{ token( TK_MultAssign, start, p-start ); goto again; }
+	"/="	{ token( TK_DivAssign, start, p-start ); goto again; }
+	"%="	{ token( TK_PercentAssign, start, p-start ); goto again; }
+	"+="	{ token( TK_PlusAssign, start, p-start ); goto again; }
+	"-="	{ token( TK_MinusAssign, start, p-start ); goto again; }
+	"&="	{ token( TK_AmpAssign, start, p-start ); goto again; }
+	"^="	{ token( TK_CaretAssign, start, p-start ); goto again; }
+	"|="	{ token( TK_BarAssign, start, p-start ); goto again; }
+	"++"	{ token( TK_PlusPlus, start, p-start ); goto again; }
+	"--"	{ token( TK_MinusMinus, start, p-start ); goto again; }
+	"->"	{ token( TK_Arrow, start, p-start ); goto again; }
+	"->*"	{ token( TK_ArrowStar, start, p-start ); goto again; }
+	".*"	{ token( TK_DotStar, start, p-start ); goto again; }
+	"..."	{ token( TK_DotDotDot, start, p-start ); goto again; }
+
+	"/*" { goto comment; }
+	"//" (ANY\"\n")* "\n"	{ goto again; }
+	[\001-\040\177]+		{ goto again; }
+
+	[\041-\057\072-\100\133-\140\173-\176]	{
+		token( *start, start, p-start );
+		goto again;
+	}
+	"\000"					{ return 0; }
+*/
+
+comment:
+/*!re2c
+	"*/"					{ goto again; }
+	ANY						{ goto comment; }
+*/
+}
diff --git a/ragel/Makefile.am b/ragel/Makefile.am
new file mode 100644
index 0000000..bbe85ce
--- /dev/null
+++ b/ragel/Makefile.am
@@ -0,0 +1,38 @@
+INCLUDES = -I$(top_srcdir)/common -I$(top_srcdir)/redfsm -I$(top_builddir)/redfsm -I$(top_srcdir)/aapl
+
+AM_CXXFLAGS = -g -Wall
+
+BUILT_SOURCES = rlscan.cpp rlparse.h rlparse.cpp
+EXTRA_DIST = $(BUILT_SOURCES) rlscan.rl rlparse.kl rlparse.kh
+
+bin_PROGRAMS = ragel
+
+ragel_SOURCES = ragel.h main.cpp parsetree.h parsetree.cpp parsedata.h	\
+	parsedata.cpp fsmstate.cpp fsmbase.cpp fsmattach.cpp		\
+	fsmmin.cpp fsmgraph.h fsmgraph.cpp fsmap.cpp xmlcodegen.h	\
+	xmlcodegen.cpp rlscan.h $(BUILT_SOURCES)
+
+ragel_LDADD = ../common/libcommon.a \
+	../redfsm/libredfsm.a \
+	../rlgen-cd/librlgen-cd.a \
+	../rlgen-java/librlgen-java.a \
+	../rlgen-ruby/librlgen-ruby.a \
+	../rlgen-csharp/librlgen-csharp.a \
+	../rlgen-dot/librlgen-dot.a
+
+if BUILD_PARSERS
+rlparse.h: rlparse.kh
+	kelbt -o $@ $<
+
+rlparse.cpp: rlparse.kl rlparse.kh
+	(cd "${srcdir}"; kelbt -o "${abs_builddir}"/$@ "${abs_builddir}"/$<; )
+
+# This dependency comes from the import of the parser defines
+# into the scanner.
+rlscan.cpp: rlparse.h
+
+rlscan.cpp: rlscan.rl
+	ragel -G2 -I. -o $@ $<
+
+CLEANFILES = $(BUILT_SOURCES)
+endif
diff --git a/ragel/Makefile.in b/ragel/Makefile.in
deleted file mode 100644
index 2a6b5da..0000000
--- a/ragel/Makefile.in
+++ /dev/null
@@ -1,101 +0,0 @@
-#
-#   Copyright 2001-2007 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-INCS += -I../common -I../aapl -I../redfsm
-DEFS +=
-
-CXXFLAGS += -g -Wall
-LDFLAGS +=
-
-CC_SRCS = \
-	main.cpp parsetree.cpp parsedata.cpp fsmstate.cpp fsmbase.cpp \
-	fsmattach.cpp fsmmin.cpp fsmgraph.cpp fsmap.cpp xmlcodegen.cpp \
-	rlscan.cpp rlparse.cpp
-
-GEN_SRC = rlscan.cpp rlparse.h rlparse.cpp
-
-RAGEL_LIBS = ../common/common.a \
-	../redfsm/redfsm.a \
-	../rlgen-cd/rlgen-cd.a \
-	../rlgen-java/rlgen-java.a \
-	../rlgen-ruby/rlgen-ruby.a \
-	../rlgen-csharp/rlgen-csharp.a \
-	../rlgen-dot/rlgen-dot.a
-
-LIBS = $(RAGEL_LIBS)
-MINGW_LIBS = -lpsapi
-
-#*************************************
-
-prefix = @prefix@
-BUILD_PARSERS = @enable_parsers@
-EXEEXT = @EXEEXT@
-CXX = @CXX@
-
-ifeq ($(EXEEXT), .exe)
-LIBS += $(MINGW_LIBS)
-endif
-
-# Get objects and dependencies from sources.
-OBJS = $(CC_SRCS:%.cpp=%.o)
-DEPS = $(CC_SRCS:%.cpp=.%.d)
-
-# Rules.
-all: ragel$(EXEEXT)
-
-ragel$(EXEEXT): $(GEN_SRC) $(OBJS) $(RAGEL_LIBS)
-	$(CXX) $(LDFLAGS) -o $@ $(OBJS) $(LIBS)
-
-ifeq ($(BUILD_PARSERS),yes)
-
-rlparse.h: rlparse.kh
-	kelbt -o $@ $<
-
-rlparse.cpp: rlparse.kl rlparse.kh
-	kelbt -o $@ $<
-
-# This dependency comes from the import of the parser defines
-# into the scanner.
-rlscan.cpp: rlparse.h
-
-rlscan.cpp: rlscan.rl
-	ragel -G2 -o $@ $<
-
-endif
-
-%.o: %.cpp
-	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
-
-distclean: clean
-	rm -f Makefile 
-
-ifeq ($(BUILD_PARSERS),yes)
-EXTRA_CLEAN = $(GEN_SRC)
-endif
-
-clean:
-	rm -f tags .*.d *.o ragel $(EXTRA_CLEAN)
-
-install: all
-	install -d $(DESTDIR)$(prefix)/bin
-	install ragel $(DESTDIR)$(prefix)/bin/ragel
-
--include $(DEPS)
diff --git a/redfsm/Makefile.am b/redfsm/Makefile.am
new file mode 100644
index 0000000..ae625d9
--- /dev/null
+++ b/redfsm/Makefile.am
@@ -0,0 +1,29 @@
+INCLUDES = -I$(top_srcdir)/common -I$(top_srcdir)/aapl
+
+AM_CXXFLAGS = -g -Wall
+
+noinst_LIBRARIES = libredfsm.a
+
+BUILT_SOURCES = xmltags.cpp xmlscan.cpp xmlparse.cpp xmlparse.h
+EXTRA_DIST = $(BUILT_SOURCES) xmltags.gperf xmlscan.rl xmlparse.kl	\
+	xmlparse.kh
+
+libredfsm_a_SOURCES = redfsm.h redfsm.cpp gendata.h gendata.cpp	\
+	xmltags.cpp xmlscan.cpp xmlparse.cpp $(BUILT_SOURCES)
+
+if BUILD_PARSERS
+xmlparse.h: xmlparse.kh
+	kelbt -o $@ $<
+
+xmlparse.cpp: xmlparse.kl xmlparse.kh
+	(cd "${srcdir}"; kelbt -o "${abs_builddir}"/$@ "${abs_builddir}"/$<; )
+
+xmlscan.cpp: xmlscan.rl
+	ragel -G2 -o $@ $<
+
+xmltags.cpp: xmltags.gperf
+	gperf -L C++ -t $< > $@
+
+
+CLEANFILES = $(BUILT_SOURCES)
+endif
diff --git a/redfsm/Makefile.in b/redfsm/Makefile.in
deleted file mode 100644
index 8e67233..0000000
--- a/redfsm/Makefile.in
+++ /dev/null
@@ -1,85 +0,0 @@
-#
-#   Copyright 2001-2006 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-INCS += -I../common -I../aapl
-DEFS +=
-
-CXXFLAGS += -g -Wall
-LDFLAGS +=
-
-CC_SRCS = redfsm.cpp gendata.cpp xmltags.cpp xmlscan.cpp xmlparse.cpp
-
-GEN_SRC = xmltags.cpp xmlscan.cpp xmlparse.cpp xmlparse.h
-
-BUILD_PARSERS = @enable_parsers@
-
-#*************************************
-
-# Programs
-CXX = @CXX@
-AR = @AR@
-RANLIB = @RANLIB@
-
-# Get objects and dependencies from sources.
-OBJS = $(CC_SRCS:%.cpp=%.o)
-DEPS = $(CC_SRCS:%.cpp=.%.d)
-
-
-# Rules.
-all: redfsm.a
-
-redfsm.a: $(GEN_SRC) $(OBJS)
-	$(AR) -cr $@ $(OBJS) 
-	$(RANLIB) $@
-
-ifeq ($(BUILD_PARSERS),true)
-
-xmlparse.h: xmlparse.kh
-	kelbt -o $@ $<
-
-xmlparse.cpp: xmlparse.kl xmlparse.kh
-	kelbt -o $@ $<
-
-xmlscan.cpp: xmlscan.rl
-	ragel -G2 -o xmlscan.cpp xmlscan.rl
-
-xmltags.cpp: xmltags.gperf
-	gperf -L C++ -t $< > $@
-
-endif
-
-%.o: %.cpp
-	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
-
-distclean: clean
-	rm -f Makefile
-
-ifeq ($(BUILD_PARSERS),true)
-EXTRA_CLEAN = $(GEN_SRC)
-endif
-
-clean:
-	rm -f tags .*.d *.o rlgen-cd $(EXTRA_CLEAN)
-
-install:
-	@true
-
--include $(DEPS)
diff --git a/rlgen-cd/Makefile.am b/rlgen-cd/Makefile.am
new file mode 100644
index 0000000..cd5e46f
--- /dev/null
+++ b/rlgen-cd/Makefile.am
@@ -0,0 +1,12 @@
+INCLUDES = -I$(top_srcdir)/common -I$(top_srcdir)/redfsm -I$(top_builddir)/redfsm -I$(top_srcdir)/aapl
+
+AM_CXXFLAGS = -g -Wall
+
+noinst_LIBRARIES = librlgen-cd.a
+
+librlgen_cd_a_SOURCES = rlgen-cd.h main.cpp fsmcodegen.h		\
+	fsmcodegen.cpp tabcodegen.h tabcodegen.cpp ftabcodegen.h	\
+	ftabcodegen.cpp flatcodegen.h flatcodegen.cpp fflatcodegen.h	\
+	fflatcodegen.cpp gotocodegen.h gotocodegen.cpp fgotocodegen.h	\
+	fgotocodegen.cpp ipgotocodegen.h ipgotocodegen.cpp		\
+	splitcodegen.h splitcodegen.cpp
diff --git a/rlgen-cd/Makefile.in b/rlgen-cd/Makefile.in
deleted file mode 100644
index 7b06285..0000000
--- a/rlgen-cd/Makefile.in
+++ /dev/null
@@ -1,69 +0,0 @@
-#
-#   Copyright 2001-2006 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-INCS += -I../common -I../redfsm -I../aapl
-DEFS +=
-
-CXXFLAGS += -g -Wall
-LDFLAGS +=
-
-CC_SRCS = main.cpp fsmcodegen.cpp \
-	tabcodegen.cpp ftabcodegen.cpp flatcodegen.cpp \
-	fflatcodegen.cpp gotocodegen.cpp fgotocodegen.cpp \
-	ipgotocodegen.cpp splitcodegen.cpp 
-
-GEN_SRC = xmltags.cpp xmlscan.cpp xmlparse.cpp xmlparse.h
-
-LIBS = ../common/common.a ../redfsm/redfsm.a
-
-#*************************************
-
-prefix = @prefix@
-EXEEXT = @EXEEXT@
-CXX = @CXX@
-AR = @AR@
-RANLIB = @RANLIB@
-
-# Get objects and dependencies from sources.
-OBJS = $(CC_SRCS:%.cpp=%.o)
-DEPS = $(CC_SRCS:%.cpp=.%.d)
-
-
-# Rules.
-all: rlgen-cd.a
-
-rlgen-cd.a: $(LIBS) $(OBJS)
-	$(AR) -cr $@ $(OBJS) 
-	$(RANLIB) $@
-
-%.o: %.cpp
-	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
-
-distclean: clean
-	rm -f Makefile
-
-clean:
-	rm -f tags .*.d *.o rlgen-cd.a $(EXTRA_CLEAN)
-
-install:
-	@true
-
--include $(DEPS)
diff --git a/rlgen-csharp/Makefile.am b/rlgen-csharp/Makefile.am
new file mode 100644
index 0000000..ebdf08c
--- /dev/null
+++ b/rlgen-csharp/Makefile.am
@@ -0,0 +1,12 @@
+INCLUDES = -I$(top_srcdir)/common -I$(top_srcdir)/redfsm -I$(top_builddir)/redfsm -I$(top_srcdir)/aapl
+
+AM_CXXFLAGS = -g -Wall
+
+noinst_LIBRARIES = librlgen-csharp.a
+
+librlgen_csharp_a_SOURCES = rlgen-csharp.h main.cpp fsmcodegen.h	\
+	fsmcodegen.cpp tabcodegen.h tabcodegen.cpp ftabcodegen.h	\
+	ftabcodegen.cpp flatcodegen.h flatcodegen.cpp fflatcodegen.h	\
+	fflatcodegen.cpp gotocodegen.h gotocodegen.cpp fgotocodegen.h	\
+	fgotocodegen.cpp ipgotocodegen.h ipgotocodegen.cpp		\
+	splitcodegen.h splitcodegen.cpp
diff --git a/rlgen-csharp/Makefile.in b/rlgen-csharp/Makefile.in
deleted file mode 100644
index fc5380f..0000000
--- a/rlgen-csharp/Makefile.in
+++ /dev/null
@@ -1,69 +0,0 @@
-#
-#   Copyright 2001-2006 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-INCS += -I../common -I../redfsm -I../aapl
-DEFS +=
-
-CXXFLAGS += -g -Wall
-LDFLAGS +=
-
-CC_SRCS = main.cpp fsmcodegen.cpp \
-	tabcodegen.cpp ftabcodegen.cpp flatcodegen.cpp \
-	fflatcodegen.cpp gotocodegen.cpp fgotocodegen.cpp \
-	ipgotocodegen.cpp splitcodegen.cpp 
-
-GEN_SRC = xmltags.cpp xmlscan.cpp xmlparse.cpp xmlparse.h
-
-LIBS = ../common/common.a ../redfsm/redfsm.a
-
-#*************************************
-
-prefix = @prefix@
-EXEEXT = @EXEEXT@
-CXX = @CXX@
-AR = @AR@
-RANLIB = @RANLIB@
-
-# Get objects and dependencies from sources.
-OBJS = $(CC_SRCS:%.cpp=%.o)
-DEPS = $(CC_SRCS:%.cpp=.%.d)
-
-
-# Rules.
-all: rlgen-csharp.a
-
-rlgen-csharp.a: $(LIBS) $(OBJS)
-	$(AR) -cr $@ $(OBJS) 
-	$(RANLIB) $@
-
-%.o: %.cpp
-	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
-
-distclean: clean
-	rm -f Makefile
-
-clean:
-	rm -f tags .*.d *.o rlgen-csharp.a $(EXTRA_CLEAN)
-
-install:
-	@true
-
--include $(DEPS)
diff --git a/rlgen-dot/Makefile.am b/rlgen-dot/Makefile.am
new file mode 100644
index 0000000..025d6f3
--- /dev/null
+++ b/rlgen-dot/Makefile.am
@@ -0,0 +1,7 @@
+INCLUDES = -I$(top_srcdir)/common -I$(top_srcdir)/redfsm -I$(top_builddir)/redfsm -I$(top_srcdir)/aapl
+
+AM_CXXFLAGS = -g -Wall
+
+noinst_LIBRARIES = librlgen-dot.a
+
+librlgen_dot_a_SOURCES = rlgen-dot.h main.cpp gvdotgen.h gvdotgen.cpp
diff --git a/rlgen-dot/Makefile.in b/rlgen-dot/Makefile.in
deleted file mode 100644
index c5611c2..0000000
--- a/rlgen-dot/Makefile.in
+++ /dev/null
@@ -1,66 +0,0 @@
-#
-#   Copyright 2001-2007 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-INCS += -I../common -I../redfsm -I../aapl
-DEFS +=
-
-CXXFLAGS += -g -Wall
-LDFLAGS +=
-
-CC_SRCS = main.cpp gvdotgen.cpp 
-
-LIBS = ../common/common.a ../redfsm/redfsm.a
-
-
-#*************************************
-
-prefix = @prefix@
-EXEEXT = @EXEEXT@
-CXX = @CXX@
-AR = @AR@
-RANLIB = @RANLIB@
-
-# Get objects and dependencies from sources.
-OBJS = $(CC_SRCS:%.cpp=%.o)
-DEPS = $(CC_SRCS:%.cpp=.%.d)
-
-
-# Rules.
-all: rlgen-dot.a
-
-rlgen-dot.a: $(LIBS) $(OBJS)
-	$(AR) -cr $@ $(OBJS) 
-	$(RANLIB) $@
-
-%.o: %.cpp
-	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
-
-distclean: clean
-	rm -f Makefile
-
-clean:
-	rm -f tags .*.d *.o rlgen-dot $(EXTRA_CLEAN)
-
-install: all
-	install -d $(DESTDIR)$(prefix)/bin
-	install rlgen-dot $(DESTDIR)$(prefix)/bin/rlgen-dot
-
--include $(DEPS)
diff --git a/rlgen-java/Makefile.am b/rlgen-java/Makefile.am
new file mode 100644
index 0000000..c15b720
--- /dev/null
+++ b/rlgen-java/Makefile.am
@@ -0,0 +1,8 @@
+INCLUDES = -I$(top_srcdir)/common -I$(top_srcdir)/redfsm -I$(top_builddir)/redfsm -I$(top_srcdir)/aapl
+
+AM_CXXFLAGS = -g -Wall
+
+noinst_LIBRARIES = librlgen-java.a
+
+librlgen_java_a_SOURCES = rlgen-java.h main.cpp javacodegen.h	\
+	javacodegen.cpp
diff --git a/rlgen-java/Makefile.in b/rlgen-java/Makefile.in
deleted file mode 100644
index c429dde..0000000
--- a/rlgen-java/Makefile.in
+++ /dev/null
@@ -1,66 +0,0 @@
-#
-#   Copyright 2007 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-INCS += -I../common -I../redfsm -I../aapl
-DEFS +=
-
-CXXFLAGS += -g -Wall
-LDFLAGS +=
-
-CC_SRCS = main.cpp javacodegen.cpp
-
-LIBS = ../common/common.a ../redfsm/redfsm.a
-
-LIBS += @LIBS@
-
-#*************************************
-
-prefix = @prefix@
-EXEEXT = @EXEEXT@
-CXX = @CXX@
-AR = @AR@
-RANLIB = @RANLIB@
-
-# Get objects and dependencies from sources.
-OBJS = $(CC_SRCS:%.cpp=%.o)
-DEPS = $(CC_SRCS:%.cpp=.%.d)
-
-
-# Rules.
-all: rlgen-java.a
-
-rlgen-java.a: $(LIBS) $(OBJS)
-	$(AR) -cr $@ $(OBJS) 
-	$(RANLIB) $@
-
-%.o: %.cpp
-	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
-
-distclean: clean
-	rm -f Makefile
-
-clean:
-	rm -f tags .*.d *.o rlgen-java.a
-
-install: all
-	@true
-
--include $(DEPS)
diff --git a/rlgen-ruby/Makefile.am b/rlgen-ruby/Makefile.am
new file mode 100644
index 0000000..a64f2c6
--- /dev/null
+++ b/rlgen-ruby/Makefile.am
@@ -0,0 +1,11 @@
+INCLUDES = -I$(top_srcdir)/common -I$(top_srcdir)/redfsm -I$(top_builddir)/redfsm -I$(top_srcdir)/aapl
+
+AM_CXXFLAGS = -g -Wall
+
+noinst_LIBRARIES = librlgen-ruby.a
+
+librlgen_ruby_a_SOURCES = rlgen-ruby.h main.cpp ruby-codegen.h		\
+	ruby-codegen.cpp ruby-tabcodegen.h ruby-tabcodegen.cpp		\
+	ruby-ftabcodegen.h ruby-ftabcodegen.cpp ruby-flatcodegen.h	\
+	ruby-flatcodegen.cpp ruby-fflatcodegen.h ruby-fflatcodegen.cpp	\
+	rbx-gotocodegen.h rbx-gotocodegen.cpp
diff --git a/rlgen-ruby/Makefile.in b/rlgen-ruby/Makefile.in
deleted file mode 100644
index 96d5399..0000000
--- a/rlgen-ruby/Makefile.in
+++ /dev/null
@@ -1,67 +0,0 @@
-#
-#   Copyright 2007 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-INCS += -I../common -I../redfsm -I../aapl
-DEFS +=
-
-CXXFLAGS += -g -Wall
-LDFLAGS +=
-
-CC_SRCS = main.cpp ruby-codegen.cpp ruby-tabcodegen.cpp ruby-ftabcodegen.cpp \
-	ruby-flatcodegen.cpp ruby-fflatcodegen.cpp rbx-gotocodegen.cpp
-
-LIBS = ../common/common.a ../redfsm/redfsm.a
-
-LIBS += @LIBS@
-
-#*************************************
-
-prefix = @prefix@
-EXEEXT = @EXEEXT@
-CXX = @CXX@
-AR = @AR@
-RANLIB = @RANLIB@
-
-# Get objects and dependencies from sources.
-OBJS = $(CC_SRCS:%.cpp=%.o)
-DEPS = $(CC_SRCS:%.cpp=.%.d)
-
-
-# Rules.
-all: rlgen-ruby.a
-
-rlgen-ruby.a: $(LIBS) $(OBJS)
-	$(AR) -cr $@ $(OBJS) 
-	$(RANLIB) $@
-
-%.o: %.cpp
-	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
-
-distclean: clean
-	rm -f Makefile
-
-clean:
-	rm -f tags .*.d *.o rlgen-ruby.a
-
-install:
-	@true
-
--include $(DEPS)
diff --git a/test/Makefile.am b/test/Makefile.am
new file mode 100644
index 0000000..7689bf7
--- /dev/null
+++ b/test/Makefile.am
@@ -0,0 +1,23 @@
+#TESTS = runtests
+
+EXTRA_DIST = atoi1.rl cppscan1.rl export2.rl langtrans_c.txl		\
+	repetition.rl atoi2.rl cppscan2.rl export3.rl langtrans_d.sh	\
+	rlscan.rl atoi3.rl cppscan3.rl export4.rl langtrans_d.txl	\
+	ruby1.rl awkemu.rl cppscan4.rl fnext1.rl langtrans_java.sh	\
+	builtin.rl cppscan5.rl forder1.rl langtrans_java.txl scan1.rl	\
+	call1.rl cppscan6.rl forder2.rl langtrans_ruby.sh scan2.rl	\
+	call2.rl element1.rl forder3.rl langtrans_ruby.txl scan3.rl	\
+	call3.rl element2.rl gotocallret1.rl lmgoto.rl scan4.rl		\
+	checkeofact.txl element3.rl gotocallret2.rl mailbox1.h		\
+	stateact1.rl clang1.rl eofact.h high1.rl mailbox1.rl		\
+	statechart1.rl clang2.rl eofact.rl high2.rl mailbox2.rl		\
+	strings1.rl clang3.rl erract1.rl high3.rl mailbox3.rl		\
+	strings2.h clang4.rl erract2.rl import1.rl strings2.rl		\
+	cond1.rl erract3.rl include1.rl testcase.txl cond2.rl		\
+	erract4.rl include2.rl minimize1.rl tokstart1.rl cond3.rl	\
+	erract5.rl java1.rl patact.rl union.rl cond4.rl erract6.rl	\
+	java2.rl range.rl xmlcommon.rl cond5.rl erract7.rl keller1.rl	\
+	README xml.rl cond6.rl erract8.rl langtrans_c.sh		\
+	recdescent1.rl cond7.rl erract9.rl langtrans_csharp.sh		\
+	recdescent2.rl cppscan1.h export1.rl langtrans_csharp.txl	\
+	recdescent3.rl
\ No newline at end of file
diff --git a/test/Makefile.in b/test/Makefile.in
deleted file mode 100644
index fe49856..0000000
--- a/test/Makefile.in
+++ /dev/null
@@ -1,30 +0,0 @@
-#
-#   Copyright 2002-2006 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-
-test:
-	@./runtests
-
-clean:
-	rm -f *.c *.cpp *.m *.d *.java *.bin *.class *.exp \
-		*.out *_c.rl *_d.rl *_java.rl *_ruby.rl *_csharp.rl *.cs *.exe
-
-distclean: clean
-	rm -f Makefile


From flamee... at gmail.com  Wed Oct  1 15:06:14 2008
From: flamee... at gmail.com (Diego 'Flameeyes' =?utf-8?q?Petten=C3=B2?=)
Date: Wed, 01 Oct 2008 17:06:14 +0200
Subject: [PATCH] Make the configure.in look more like an autoconf script.
Message-ID: <20081001150614.23241.87348.stgit@yamato>


---

 configure.in |   61 +++++++++++++++++++++++++++++-----------------------------
 1 files changed, 31 insertions(+), 30 deletions(-)

diff --git a/configure.in b/configure.in
index 0b9fa44..df70e9c 100644
--- a/configure.in
+++ b/configure.in
@@ -18,7 +18,8 @@ dnl   You should have received a copy of the GNU General Public License
 dnl   along with Ragel; if not, write to the Free Software
 dnl   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 
-AC_INIT(ragel/main.cpp, 6.3)
+AC_PREREQ([2.60])
+AC_INIT(ragel, 6.3)
 AC_CONFIG_HEADER(common/config.h)
 
 AM_INIT_AUTOMAKE([1.10 foreign])
@@ -46,36 +47,16 @@ AC_LANG_CPLUSPLUS
 dnl Check for definition of MAKE.
 AC_PROG_MAKE_SET
 
-if test $enable_parsers = yes; then
+AS_IF([test "x$enable_parsres" = "xyes"], [
+  AC_CHECK_PROG(RAGEL, ragel, ragel)
+  AS_IF([test -z "$RAGEL"], [AC_MSG_ERROR([ragel is required to build the parsers])])
 
-dnl Check for Ragel
-AC_CHECK_PROG(RAGEL, ragel, ragel)
-if test -z "$RAGEL"; then
-	echo
-	echo "error: ragel is required to build the parsers"
-	echo
-	exit 1
-fi
-
-dnl Check for gperf
-AC_CHECK_PROG(GPERF, gperf, gperf)
-if test -z "$GPERF"; then
-	echo
-	echo "error: gperf is required to build the parsers"
-	echo
-	exit 1
-fi
-
-dnl Check for Kelbt
-AC_CHECK_PROG(KELBT, kelbt, kelbt)
-if test -z "$KELBT"; then
-	echo
-	echo "error: kelbt is required to build the parsers"
-	echo
-	exit 1
-fi
+  AC_CHECK_PROG(GPERF, gperf, gperf)
+  AS_IF([test -z "$GPERF"], [AC_MSG_ERROR([gperf is required to build the parsers])])
 
-fi # BUILD_PARSERS
+  AC_CHECK_PROG(KELBT, kelbt, kelbt)
+  AS_IF([test -z "$KELBT"], [AC_MSG_ERROR([kelbt is required to build the parsers])])
+])
 
 dnl Check for the D compiler
 AC_CHECK_PROG(GDC, gdc, gdc)
@@ -113,6 +94,26 @@ AC_CHECK_PROG(GMCS, gmcs, gmcs)
 AC_SUBST(GMCS)
 
 dnl write output files
-AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile examples/Makefile test/runtests doc/ragel.1 doc/rlgen-cd.1 doc/rlgen-java.1 doc/rlgen-ruby.1 doc/rlgen-dot.1 doc/version.tex)
+AC_OUTPUT([
+	Makefile
+	common/Makefile
+	doc/Makefile
+	doc/ragel.1
+	doc/rlgen-cd.1
+	doc/rlgen-dot.1
+	doc/rlgen-java.1
+	doc/rlgen-ruby.1
+	doc/version.tex
+	examples/Makefile
+	ragel/Makefile
+	redfsm/Makefile
+	rlgen-cd/Makefile
+	rlgen-csharp/Makefile
+	rlgen-dot/Makefile
+	rlgen-java/Makefile
+	rlgen-ruby/Makefile
+	test/Makefile
+	test/runtests
+])
 
 echo "configuration of ragel complete"


From thurs... at cs.queensu.ca  Thu Oct  2 17:41:17 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Thu, 02 Oct 2008 13:41:17 -0400
Subject: ragel has a new home
Message-ID: <48E507BD.6030903@cs.queensu.ca>

Hey Everyone,

I'm going to be graduating soon (woohoo) and that means it's time for
ragel to get a new home.

http://www.complang.org/ragel/

Cheers,
 Adrian


From flamee... at gmail.com  Wed Oct  1 11:12:34 2008
From: flamee... at gmail.com (Diego 'Flameeyes' =?utf-8?q?Petten=C3=B2?=)
Date: Wed, 01 Oct 2008 13:12:34 +0200
Subject: [PATCH 0/3] Making the buildsystem more distribution-friendly
Message-ID: <20081001110922.10537.90259.stgit@yamato>

Hello,

I'm a Gentoo Linux developer (but not limited to that), I'm interested
in using ragel for a few projects, but looking at updating it in our
tree, I've seen that the build system requires quite a few quirks that
makes it a bit unfriendly.

I'm sending a few patches that makes it slightly more friendly (two
out of three apply over 6.3 version too, one just applies to trunk).

I'm also wondering why it doesn't use directly automake and whether
that could be considered (if so, I'll be glad to help by porting it to
automake myself).

At any rate, I hope this can be of help.

Thanks,
Diego 'Flameeyes' Petten

---

Diego 'Flameeyes' Petten (3):
      Add support for DESTDIR variable for offset installation.
      Use CXXFLAGS for compiling rather than CFLAGS.
      Don't use install -s to strip files during install.


 common/Makefile.in       |    4 ++--
 doc/Makefile.in          |   18 +++++++++---------
 examples/Makefile        |    3 +--
 ragel/Makefile.in        |    8 ++++----
 redfsm/Makefile.in       |    4 ++--
 rlgen-cd/Makefile.in     |    4 ++--
 rlgen-csharp/Makefile.in |    4 ++--
 rlgen-dot/Makefile.in    |    8 ++++----
 rlgen-java/Makefile.in   |    4 ++--
 rlgen-ruby/Makefile.in   |    4 ++--
 10 files changed, 30 insertions(+), 31 deletions(-)


From flamee... at gmail.com  Wed Oct  1 11:12:48 2008
From: flamee... at gmail.com (Diego 'Flameeyes' =?utf-8?q?Petten=C3=B2?=)
Date: Wed, 01 Oct 2008 13:12:48 +0200
Subject: [PATCH 1/3] Don't use install -s to strip files during install.
In-Reply-To: <20081001110922.10537.90259.stgit@yamato>
References: <20081001110922.10537.90259.stgit@yamato>
Message-ID: <20081001111243.10537.46949.stgit@yamato>

Allow the user to decide whether to strip files or not, by using
install -s the user has no choice but to install stripped files, which
will be a problem to debug; most distributions will also not want
files to be stripped during install, and would rather take care of
stripping them through their own packaging toolchain (so that debug
packages may also be provided, for instance).
---

 ragel/Makefile.in     |    2 +-
 rlgen-dot/Makefile.in |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/ragel/Makefile.in b/ragel/Makefile.in
index 6190a5f..daa42e7 100644
--- a/ragel/Makefile.in
+++ b/ragel/Makefile.in
@@ -96,6 +96,6 @@ clean:
 
 install: all
 	install -d $(prefix)/bin
-	install -s ragel $(prefix)/bin/ragel
+	install ragel $(prefix)/bin/ragel
 
 -include $(DEPS)
diff --git a/rlgen-dot/Makefile.in b/rlgen-dot/Makefile.in
index 3f7b7f6..7cd4ee6 100644
--- a/rlgen-dot/Makefile.in
+++ b/rlgen-dot/Makefile.in
@@ -63,6 +63,6 @@ clean:
 
 install: all
 	install -d $(prefix)/bin
-	install -s rlgen-dot $(prefix)/bin/rlgen-dot
+	install rlgen-dot $(prefix)/bin/rlgen-dot
 
 -include $(DEPS)


From flamee... at gmail.com  Wed Oct  1 11:12:56 2008
From: flamee... at gmail.com (Diego 'Flameeyes' =?utf-8?q?Petten=C3=B2?=)
Date: Wed, 01 Oct 2008 13:12:56 +0200
Subject: [PATCH 2/3] Use CXXFLAGS for compiling rather than CFLAGS.
In-Reply-To: <20081001110922.10537.90259.stgit@yamato>
References: <20081001110922.10537.90259.stgit@yamato>
Message-ID: <20081001111256.10537.14923.stgit@yamato>

Most buildsystem divide flags on a per-language basis, since all
compilers support some flags only for one particular language.

The CFLAGS variable is reserved for C compiler flags, while C++
compiler flags are usually passed through CXXFLAGS variables; autoconf
supports this, and will help the user to use those.
---

 common/Makefile.in       |    4 ++--
 examples/Makefile        |    3 +--
 ragel/Makefile.in        |    4 ++--
 redfsm/Makefile.in       |    4 ++--
 rlgen-cd/Makefile.in     |    4 ++--
 rlgen-csharp/Makefile.in |    4 ++--
 rlgen-dot/Makefile.in    |    4 ++--
 rlgen-java/Makefile.in   |    4 ++--
 rlgen-ruby/Makefile.in   |    4 ++--
 9 files changed, 17 insertions(+), 18 deletions(-)

diff --git a/common/Makefile.in b/common/Makefile.in
index 54ed940..112e59c 100644
--- a/common/Makefile.in
+++ b/common/Makefile.in
@@ -21,7 +21,7 @@
 INCS += -I../aapl
 DEFS +=
 
-CFLAGS += -g -Wall
+CXXFLAGS += -g -Wall
 LDFLAGS +=
 
 CC_SRCS = common.cpp
@@ -58,7 +58,7 @@ version.h: ../version.mk
 
 %.o: %.cpp
 	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
+	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
 
 distclean: clean
 	rm -f Makefile config.h
diff --git a/examples/Makefile b/examples/Makefile
index a392aa8..b9fcc21 100644
--- a/examples/Makefile
+++ b/examples/Makefile
@@ -21,7 +21,6 @@
 RAGEL = ../ragel/ragel
 FLEX = flex
 RE2C = re2c
-CFLAGS = -Wall -g -O3
 
 TARGS = \
 	atoi awkemu clang concurrent cppscan format gotocallret mailbox params \
@@ -38,7 +37,7 @@ distclean clean:
 	gcc $(CFLAGS) -Wall -g -c -O3 -o $@ $<
 
 %.o: %.cpp
-	g++ $(CFLAGS) -Wall -g -c -O3 -o $@ $<
+	g++ $(CXXFLAGS) -Wall -g -c -O3 -o $@ $<
 
 #########################################
 
diff --git a/ragel/Makefile.in b/ragel/Makefile.in
index daa42e7..3a23267 100644
--- a/ragel/Makefile.in
+++ b/ragel/Makefile.in
@@ -21,7 +21,7 @@
 INCS += -I../common -I../aapl -I../redfsm
 DEFS +=
 
-CFLAGS += -g -Wall
+CXXFLAGS += -g -Wall
 LDFLAGS +=
 
 CC_SRCS = \
@@ -82,7 +82,7 @@ endif
 
 %.o: %.cpp
 	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
+	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
 
 distclean: clean
 	rm -f Makefile 
diff --git a/redfsm/Makefile.in b/redfsm/Makefile.in
index fc28171..a4c6737 100644
--- a/redfsm/Makefile.in
+++ b/redfsm/Makefile.in
@@ -21,7 +21,7 @@
 INCS += -I../common -I../aapl
 DEFS +=
 
-CFLAGS += -g -Wall
+CXXFLAGS += -g -Wall
 LDFLAGS +=
 
 CC_SRCS = redfsm.cpp gendata.cpp xmltags.cpp xmlscan.cpp xmlparse.cpp
@@ -69,7 +69,7 @@ endif
 
 %.o: %.cpp
 	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
+	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
 
 distclean: clean
 	rm -f Makefile
diff --git a/rlgen-cd/Makefile.in b/rlgen-cd/Makefile.in
index 6d4a293..49031e3 100644
--- a/rlgen-cd/Makefile.in
+++ b/rlgen-cd/Makefile.in
@@ -21,7 +21,7 @@
 INCS += -I../common -I../redfsm -I../aapl
 DEFS +=
 
-CFLAGS += -g -Wall
+CXXFLAGS += -g -Wall
 LDFLAGS +=
 
 CC_SRCS = main.cpp fsmcodegen.cpp \
@@ -57,7 +57,7 @@ rlgen-cd.a: $(LIBS) $(OBJS)
 
 %.o: %.cpp
 	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
+	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
 
 distclean: clean
 	rm -f Makefile
diff --git a/rlgen-csharp/Makefile.in b/rlgen-csharp/Makefile.in
index 24d992b..fa57e49 100644
--- a/rlgen-csharp/Makefile.in
+++ b/rlgen-csharp/Makefile.in
@@ -21,7 +21,7 @@
 INCS += -I../common -I../redfsm -I../aapl
 DEFS +=
 
-CFLAGS += -g -Wall
+CXXFLAGS += -g -Wall
 LDFLAGS +=
 
 CC_SRCS = main.cpp fsmcodegen.cpp \
@@ -57,7 +57,7 @@ rlgen-csharp.a: $(LIBS) $(OBJS)
 
 %.o: %.cpp
 	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
+	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
 
 distclean: clean
 	rm -f Makefile
diff --git a/rlgen-dot/Makefile.in b/rlgen-dot/Makefile.in
index 7cd4ee6..8decf2b 100644
--- a/rlgen-dot/Makefile.in
+++ b/rlgen-dot/Makefile.in
@@ -21,7 +21,7 @@
 INCS += -I../common -I../redfsm -I../aapl
 DEFS +=
 
-CFLAGS += -g -Wall
+CXXFLAGS += -g -Wall
 LDFLAGS +=
 
 CC_SRCS = main.cpp gvdotgen.cpp 
@@ -53,7 +53,7 @@ rlgen-dot.a: $(LIBS) $(OBJS)
 
 %.o: %.cpp
 	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
+	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
 
 distclean: clean
 	rm -f Makefile
diff --git a/rlgen-java/Makefile.in b/rlgen-java/Makefile.in
index e242a64..2fe5cd7 100644
--- a/rlgen-java/Makefile.in
+++ b/rlgen-java/Makefile.in
@@ -21,7 +21,7 @@
 INCS += -I../common -I../redfsm -I../aapl
 DEFS +=
 
-CFLAGS += -g -Wall
+CXXFLAGS += -g -Wall
 LDFLAGS +=
 
 CC_SRCS = main.cpp javacodegen.cpp
@@ -54,7 +54,7 @@ rlgen-java.a: $(LIBS) $(OBJS)
 
 %.o: %.cpp
 	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
+	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
 
 distclean: clean
 	rm -f Makefile
diff --git a/rlgen-ruby/Makefile.in b/rlgen-ruby/Makefile.in
index c9bd4f1..a0a2d52 100644
--- a/rlgen-ruby/Makefile.in
+++ b/rlgen-ruby/Makefile.in
@@ -21,7 +21,7 @@
 INCS += -I../common -I../redfsm -I../aapl
 DEFS +=
 
-CFLAGS += -g -Wall
+CXXFLAGS += -g -Wall
 LDFLAGS +=
 
 CC_SRCS = main.cpp ruby-codegen.cpp ruby-tabcodegen.cpp ruby-ftabcodegen.cpp \
@@ -55,7 +55,7 @@ rlgen-ruby.a: $(LIBS) $(OBJS)
 
 %.o: %.cpp
 	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
-	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
+	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
 
 distclean: clean
 	rm -f Makefile


From flamee... at gmail.com  Wed Oct  1 11:13:11 2008
From: flamee... at gmail.com (Diego 'Flameeyes' =?utf-8?q?Petten=C3=B2?=)
Date: Wed, 01 Oct 2008 13:13:11 +0200
Subject: [PATCH 3/3] Add support for DESTDIR variable for offset installation.
In-Reply-To: <20081001110922.10537.90259.stgit@yamato>
References: <20081001110922.10537.90259.stgit@yamato>
Message-ID: <20081001111311.10537.57009.stgit@yamato>

Most distributions use the DESTDIR variable to install the package
just built in a temporary tree used to build the package; such an
option can also be used to test that the software is getting installed
properly.

Add support for this variable by prefixing all paths used during
installation with $(DESTDIR).
---

 doc/Makefile.in       |   18 +++++++++---------
 ragel/Makefile.in     |    4 ++--
 rlgen-dot/Makefile.in |    4 ++--
 3 files changed, 13 insertions(+), 13 deletions(-)

diff --git a/doc/Makefile.in b/doc/Makefile.in
index 9d2ded2..a6ff456 100644
--- a/doc/Makefile.in
+++ b/doc/Makefile.in
@@ -66,16 +66,16 @@ distclean: clean
 man: $(MANPAGES)
 
 man-install: man
-	install -d $(mandir)/man1
-	install -m 644 ragel.1      $(mandir)/man1/ragel.1
-	install -m 644 rlgen-dot.1  $(mandir)/man1/rlgen-dot.1
-	install -m 644 rlgen-cd.1   $(mandir)/man1/rlgen-cd.1
-	install -m 644 rlgen-java.1 $(mandir)/man1/rlgen-java.1
-	install -m 644 rlgen-ruby.1 $(mandir)/man1/rlgen-ruby.1
+	install -d $(DESTDIR)$(mandir)/man1
+	install -m 644 ragel.1      (DESTDIR)$(mandir)/man1/ragel.1
+	install -m 644 rlgen-dot.1  (DESTDIR)$(mandir)/man1/rlgen-dot.1
+	install -m 644 rlgen-cd.1   (DESTDIR)$(mandir)/man1/rlgen-cd.1
+	install -m 644 rlgen-java.1 (DESTDIR)$(mandir)/man1/rlgen-java.1
+	install -m 644 rlgen-ruby.1 (DESTDIR)$(mandir)/man1/rlgen-ruby.1
 
 install: all man-install
-	install -d $(docdir)
-	install -m 644 ragel-guide.pdf $(docdir)/ragel-guide.pdf
+	install -d $(DESTDIR)$(docdir)
+	install -m 644 ragel-guide.pdf $(DESTDIR)$(docdir)/ragel-guide.pdf
 	gzip -c ../ChangeLog > ChangeLog.gz
-	install -m 644 ChangeLog.gz $(docdir)/ChangeLog.gz
+	install -m 644 ChangeLog.gz $(DESTDIR)$(docdir)/ChangeLog.gz
 	rm ChangeLog.gz
diff --git a/ragel/Makefile.in b/ragel/Makefile.in
index 3a23267..b6397dc 100644
--- a/ragel/Makefile.in
+++ b/ragel/Makefile.in
@@ -95,7 +95,7 @@ clean:
 	rm -f tags .*.d *.o ragel $(EXTRA_CLEAN)
 
 install: all
-	install -d $(prefix)/bin
-	install ragel $(prefix)/bin/ragel
+	install -d $(DESTDIR)$(prefix)/bin
+	install ragel $(DESTDIR)$(prefix)/bin/ragel
 
 -include $(DEPS)
diff --git a/rlgen-dot/Makefile.in b/rlgen-dot/Makefile.in
index 8decf2b..5d33931 100644
--- a/rlgen-dot/Makefile.in
+++ b/rlgen-dot/Makefile.in
@@ -62,7 +62,7 @@ clean:
 	rm -f tags .*.d *.o rlgen-dot $(EXTRA_CLEAN)
 
 install: all
-	install -d $(prefix)/bin
-	install rlgen-dot $(prefix)/bin/rlgen-dot
+	install -d $(DESTDIR)$(prefix)/bin
+	install rlgen-dot $(DESTDIR)$(prefix)/bin/rlgen-dot
 
 -include $(DEPS)


From thurs... at cs.queensu.ca  Mon Oct  6 03:16:50 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Sun, 05 Oct 2008 23:16:50 -0400
Subject: [ragel-users] [PATCH 0/3] Making the buildsystem more distribution-friendly
In-Reply-To: <20081001110922.10537.90259.stgit@yamato>
References: <20081001110922.10537.90259.stgit@yamato>
Message-ID: <48E98322.7080608@cs.queensu.ca>

Hey Diego,

I'll be looking at your patches soon! I've been a little tied up lately.

I'm not a fan of automake. I find it a little too much 'auto.' Just my
personal taste.

-Adrian

Diego 'Flameeyes' Petten wrote:
> Hello,
> 
> I'm a Gentoo Linux developer (but not limited to that), I'm interested
> in using ragel for a few projects, but looking at updating it in our
> tree, I've seen that the build system requires quite a few quirks that
> makes it a bit unfriendly.
> 
> I'm sending a few patches that makes it slightly more friendly (two
> out of three apply over 6.3 version too, one just applies to trunk).
> 
> I'm also wondering why it doesn't use directly automake and whether
> that could be considered (if so, I'll be glad to help by porting it to
> automake myself).
> 
> At any rate, I hope this can be of help.
> 
> Thanks,
> Diego 'Flameeyes' Petten
> 
> ---
> 
> Diego 'Flameeyes' Petten (3):
>       Add support for DESTDIR variable for offset installation.
>       Use CXXFLAGS for compiling rather than CFLAGS.
>       Don't use install -s to strip files during install.
> 
> 
>  common/Makefile.in       |    4 ++--
>  doc/Makefile.in          |   18 +++++++++---------
>  examples/Makefile        |    3 +--
>  ragel/Makefile.in        |    8 ++++----
>  redfsm/Makefile.in       |    4 ++--
>  rlgen-cd/Makefile.in     |    4 ++--
>  rlgen-csharp/Makefile.in |    4 ++--
>  rlgen-dot/Makefile.in    |    8 ++++----
>  rlgen-java/Makefile.in   |    4 ++--
>  rlgen-ruby/Makefile.in   |    4 ++--
>  10 files changed, 30 insertions(+), 31 deletions(-)
> 
> 


From thurs... at cs.queensu.ca  Mon Oct  6 16:36:14 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Mon, 06 Oct 2008 12:36:14 -0400
Subject: [ragel-users] [PATCH 1/3] Don't use install -s to strip files
 during install.
In-Reply-To: <20081001111243.10537.46949.stgit@yamato>
References: <20081001110922.10537.90259.stgit@yamato> <20081001111243.10537.46949.stgit@yamato>
Message-ID: <48EA3E7E.4070002@cs.queensu.ca>

Hmmm, I thought it was more common to install and strip the files. Maybe 
another target, install-debug, would be better?

-Adrian

Diego 'Flameeyes' Petten wrote:
> Allow the user to decide whether to strip files or not, by using
> install -s the user has no choice but to install stripped files, which
> will be a problem to debug; most distributions will also not want
> files to be stripped during install, and would rather take care of
> stripping them through their own packaging toolchain (so that debug
> packages may also be provided, for instance).
> ---
> 
>  ragel/Makefile.in     |    2 +-
>  rlgen-dot/Makefile.in |    2 +-
>  2 files changed, 2 insertions(+), 2 deletions(-)
> 
> diff --git a/ragel/Makefile.in b/ragel/Makefile.in
> index 6190a5f..daa42e7 100644
> --- a/ragel/Makefile.in
> +++ b/ragel/Makefile.in
> @@ -96,6 +96,6 @@ clean:
>  
>  install: all
>  	install -d $(prefix)/bin
> -	install -s ragel $(prefix)/bin/ragel
> +	install ragel $(prefix)/bin/ragel
>  
>  -include $(DEPS)
> diff --git a/rlgen-dot/Makefile.in b/rlgen-dot/Makefile.in
> index 3f7b7f6..7cd4ee6 100644
> --- a/rlgen-dot/Makefile.in
> +++ b/rlgen-dot/Makefile.in
> @@ -63,6 +63,6 @@ clean:
>  
>  install: all
>  	install -d $(prefix)/bin
> -	install -s rlgen-dot $(prefix)/bin/rlgen-dot
> +	install rlgen-dot $(prefix)/bin/rlgen-dot
>  
>  -include $(DEPS)
> 
> 
> 


From thurs... at cs.queensu.ca  Mon Oct  6 16:46:11 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Mon, 06 Oct 2008 12:46:11 -0400
Subject: [ragel-users] [PATCH 2/3] Use CXXFLAGS for compiling rather than
 CFLAGS.
In-Reply-To: <20081001111256.10537.14923.stgit@yamato>
References: <20081001110922.10537.90259.stgit@yamato> <20081001111256.10537.14923.stgit@yamato>
Message-ID: <48EA40D3.9060605@cs.queensu.ca>

Applied.

-Adrian

Diego 'Flameeyes' Petten wrote:
> Most buildsystem divide flags on a per-language basis, since all
> compilers support some flags only for one particular language.
> 
> The CFLAGS variable is reserved for C compiler flags, while C++
> compiler flags are usually passed through CXXFLAGS variables; autoconf
> supports this, and will help the user to use those.
> ---
> 
>  common/Makefile.in       |    4 ++--
>  examples/Makefile        |    3 +--
>  ragel/Makefile.in        |    4 ++--
>  redfsm/Makefile.in       |    4 ++--
>  rlgen-cd/Makefile.in     |    4 ++--
>  rlgen-csharp/Makefile.in |    4 ++--
>  rlgen-dot/Makefile.in    |    4 ++--
>  rlgen-java/Makefile.in   |    4 ++--
>  rlgen-ruby/Makefile.in   |    4 ++--
>  9 files changed, 17 insertions(+), 18 deletions(-)
> 
> diff --git a/common/Makefile.in b/common/Makefile.in
> index 54ed940..112e59c 100644
> --- a/common/Makefile.in
> +++ b/common/Makefile.in
> @@ -21,7 +21,7 @@
>  INCS += -I../aapl
>  DEFS +=
>  
> -CFLAGS += -g -Wall
> +CXXFLAGS += -g -Wall
>  LDFLAGS +=
>  
>  CC_SRCS = common.cpp
> @@ -58,7 +58,7 @@ version.h: ../version.mk
>  
>  %.o: %.cpp
>  	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
> -	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
> +	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
>  
>  distclean: clean
>  	rm -f Makefile config.h
> diff --git a/examples/Makefile b/examples/Makefile
> index a392aa8..b9fcc21 100644
> --- a/examples/Makefile
> +++ b/examples/Makefile
> @@ -21,7 +21,6 @@
>  RAGEL = ../ragel/ragel
>  FLEX = flex
>  RE2C = re2c
> -CFLAGS = -Wall -g -O3
>  
>  TARGS = \
>  	atoi awkemu clang concurrent cppscan format gotocallret mailbox params \
> @@ -38,7 +37,7 @@ distclean clean:
>  	gcc $(CFLAGS) -Wall -g -c -O3 -o $@ $<
>  
>  %.o: %.cpp
> -	g++ $(CFLAGS) -Wall -g -c -O3 -o $@ $<
> +	g++ $(CXXFLAGS) -Wall -g -c -O3 -o $@ $<
>  
>  #########################################
>  
> diff --git a/ragel/Makefile.in b/ragel/Makefile.in
> index daa42e7..3a23267 100644
> --- a/ragel/Makefile.in
> +++ b/ragel/Makefile.in
> @@ -21,7 +21,7 @@
>  INCS += -I../common -I../aapl -I../redfsm
>  DEFS +=
>  
> -CFLAGS += -g -Wall
> +CXXFLAGS += -g -Wall
>  LDFLAGS +=
>  
>  CC_SRCS = \
> @@ -82,7 +82,7 @@ endif
>  
>  %.o: %.cpp
>  	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
> -	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
> +	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
>  
>  distclean: clean
>  	rm -f Makefile 
> diff --git a/redfsm/Makefile.in b/redfsm/Makefile.in
> index fc28171..a4c6737 100644
> --- a/redfsm/Makefile.in
> +++ b/redfsm/Makefile.in
> @@ -21,7 +21,7 @@
>  INCS += -I../common -I../aapl
>  DEFS +=
>  
> -CFLAGS += -g -Wall
> +CXXFLAGS += -g -Wall
>  LDFLAGS +=
>  
>  CC_SRCS = redfsm.cpp gendata.cpp xmltags.cpp xmlscan.cpp xmlparse.cpp
> @@ -69,7 +69,7 @@ endif
>  
>  %.o: %.cpp
>  	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
> -	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
> +	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
>  
>  distclean: clean
>  	rm -f Makefile
> diff --git a/rlgen-cd/Makefile.in b/rlgen-cd/Makefile.in
> index 6d4a293..49031e3 100644
> --- a/rlgen-cd/Makefile.in
> +++ b/rlgen-cd/Makefile.in
> @@ -21,7 +21,7 @@
>  INCS += -I../common -I../redfsm -I../aapl
>  DEFS +=
>  
> -CFLAGS += -g -Wall
> +CXXFLAGS += -g -Wall
>  LDFLAGS +=
>  
>  CC_SRCS = main.cpp fsmcodegen.cpp \
> @@ -57,7 +57,7 @@ rlgen-cd.a: $(LIBS) $(OBJS)
>  
>  %.o: %.cpp
>  	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
> -	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
> +	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
>  
>  distclean: clean
>  	rm -f Makefile
> diff --git a/rlgen-csharp/Makefile.in b/rlgen-csharp/Makefile.in
> index 24d992b..fa57e49 100644
> --- a/rlgen-csharp/Makefile.in
> +++ b/rlgen-csharp/Makefile.in
> @@ -21,7 +21,7 @@
>  INCS += -I../common -I../redfsm -I../aapl
>  DEFS +=
>  
> -CFLAGS += -g -Wall
> +CXXFLAGS += -g -Wall
>  LDFLAGS +=
>  
>  CC_SRCS = main.cpp fsmcodegen.cpp \
> @@ -57,7 +57,7 @@ rlgen-csharp.a: $(LIBS) $(OBJS)
>  
>  %.o: %.cpp
>  	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
> -	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
> +	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
>  
>  distclean: clean
>  	rm -f Makefile
> diff --git a/rlgen-dot/Makefile.in b/rlgen-dot/Makefile.in
> index 7cd4ee6..8decf2b 100644
> --- a/rlgen-dot/Makefile.in
> +++ b/rlgen-dot/Makefile.in
> @@ -21,7 +21,7 @@
>  INCS += -I../common -I../redfsm -I../aapl
>  DEFS +=
>  
> -CFLAGS += -g -Wall
> +CXXFLAGS += -g -Wall
>  LDFLAGS +=
>  
>  CC_SRCS = main.cpp gvdotgen.cpp 
> @@ -53,7 +53,7 @@ rlgen-dot.a: $(LIBS) $(OBJS)
>  
>  %.o: %.cpp
>  	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
> -	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
> +	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
>  
>  distclean: clean
>  	rm -f Makefile
> diff --git a/rlgen-java/Makefile.in b/rlgen-java/Makefile.in
> index e242a64..2fe5cd7 100644
> --- a/rlgen-java/Makefile.in
> +++ b/rlgen-java/Makefile.in
> @@ -21,7 +21,7 @@
>  INCS += -I../common -I../redfsm -I../aapl
>  DEFS +=
>  
> -CFLAGS += -g -Wall
> +CXXFLAGS += -g -Wall
>  LDFLAGS +=
>  
>  CC_SRCS = main.cpp javacodegen.cpp
> @@ -54,7 +54,7 @@ rlgen-java.a: $(LIBS) $(OBJS)
>  
>  %.o: %.cpp
>  	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
> -	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
> +	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
>  
>  distclean: clean
>  	rm -f Makefile
> diff --git a/rlgen-ruby/Makefile.in b/rlgen-ruby/Makefile.in
> index c9bd4f1..a0a2d52 100644
> --- a/rlgen-ruby/Makefile.in
> +++ b/rlgen-ruby/Makefile.in
> @@ -21,7 +21,7 @@
>  INCS += -I../common -I../redfsm -I../aapl
>  DEFS +=
>  
> -CFLAGS += -g -Wall
> +CXXFLAGS += -g -Wall
>  LDFLAGS +=
>  
>  CC_SRCS = main.cpp ruby-codegen.cpp ruby-tabcodegen.cpp ruby-ftabcodegen.cpp \
> @@ -55,7 +55,7 @@ rlgen-ruby.a: $(LIBS) $(OBJS)
>  
>  %.o: %.cpp
>  	@$(CXX) -M $(DEFS) $(INCS) $< > .$*.d
> -	$(CXX) -c $(CFLAGS) $(DEFS) $(INCS) -o $@ $<
> +	$(CXX) -c $(CXXFLAGS) $(DEFS) $(INCS) -o $@ $<
>  
>  distclean: clean
>  	rm -f Makefile
> 
> 
> 


From thurs... at cs.queensu.ca  Mon Oct  6 17:12:19 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Mon, 06 Oct 2008 13:12:19 -0400
Subject: [ragel-users] [PATCH 3/3] Add support for DESTDIR variable for
 offset installation.
In-Reply-To: <20081001111311.10537.57009.stgit@yamato>
References: <20081001110922.10537.90259.stgit@yamato> <20081001111311.10537.57009.stgit@yamato>
Message-ID: <48EA46F3.9050203@cs.queensu.ca>

Applied.

Diego 'Flameeyes' Petten wrote:
> Most distributions use the DESTDIR variable to install the package
> just built in a temporary tree used to build the package; such an
> option can also be used to test that the software is getting installed
> properly.
> 
> Add support for this variable by prefixing all paths used during
> installation with $(DESTDIR).
> ---
> 
>  doc/Makefile.in       |   18 +++++++++---------
>  ragel/Makefile.in     |    4 ++--
>  rlgen-dot/Makefile.in |    4 ++--
>  3 files changed, 13 insertions(+), 13 deletions(-)
> 
> diff --git a/doc/Makefile.in b/doc/Makefile.in
> index 9d2ded2..a6ff456 100644
> --- a/doc/Makefile.in
> +++ b/doc/Makefile.in
> @@ -66,16 +66,16 @@ distclean: clean
>  man: $(MANPAGES)
>  
>  man-install: man
> -	install -d $(mandir)/man1
> -	install -m 644 ragel.1      $(mandir)/man1/ragel.1
> -	install -m 644 rlgen-dot.1  $(mandir)/man1/rlgen-dot.1
> -	install -m 644 rlgen-cd.1   $(mandir)/man1/rlgen-cd.1
> -	install -m 644 rlgen-java.1 $(mandir)/man1/rlgen-java.1
> -	install -m 644 rlgen-ruby.1 $(mandir)/man1/rlgen-ruby.1
> +	install -d $(DESTDIR)$(mandir)/man1
> +	install -m 644 ragel.1      (DESTDIR)$(mandir)/man1/ragel.1
> +	install -m 644 rlgen-dot.1  (DESTDIR)$(mandir)/man1/rlgen-dot.1
> +	install -m 644 rlgen-cd.1   (DESTDIR)$(mandir)/man1/rlgen-cd.1
> +	install -m 644 rlgen-java.1 (DESTDIR)$(mandir)/man1/rlgen-java.1
> +	install -m 644 rlgen-ruby.1 (DESTDIR)$(mandir)/man1/rlgen-ruby.1
>  
>  install: all man-install
> -	install -d $(docdir)
> -	install -m 644 ragel-guide.pdf $(docdir)/ragel-guide.pdf
> +	install -d $(DESTDIR)$(docdir)
> +	install -m 644 ragel-guide.pdf $(DESTDIR)$(docdir)/ragel-guide.pdf
>  	gzip -c ../ChangeLog > ChangeLog.gz
> -	install -m 644 ChangeLog.gz $(docdir)/ChangeLog.gz
> +	install -m 644 ChangeLog.gz $(DESTDIR)$(docdir)/ChangeLog.gz
>  	rm ChangeLog.gz
> diff --git a/ragel/Makefile.in b/ragel/Makefile.in
> index 3a23267..b6397dc 100644
> --- a/ragel/Makefile.in
> +++ b/ragel/Makefile.in
> @@ -95,7 +95,7 @@ clean:
>  	rm -f tags .*.d *.o ragel $(EXTRA_CLEAN)
>  
>  install: all
> -	install -d $(prefix)/bin
> -	install ragel $(prefix)/bin/ragel
> +	install -d $(DESTDIR)$(prefix)/bin
> +	install ragel $(DESTDIR)$(prefix)/bin/ragel
>  
>  -include $(DEPS)
> diff --git a/rlgen-dot/Makefile.in b/rlgen-dot/Makefile.in
> index 8decf2b..5d33931 100644
> --- a/rlgen-dot/Makefile.in
> +++ b/rlgen-dot/Makefile.in
> @@ -62,7 +62,7 @@ clean:
>  	rm -f tags .*.d *.o rlgen-dot $(EXTRA_CLEAN)
>  
>  install: all
> -	install -d $(prefix)/bin
> -	install rlgen-dot $(prefix)/bin/rlgen-dot
> +	install -d $(DESTDIR)$(prefix)/bin
> +	install rlgen-dot $(DESTDIR)$(prefix)/bin/rlgen-dot
>  
>  -include $(DEPS)
> 
> 
> 


From flamee... at gmail.com  Wed Oct  1 14:37:20 2008
From: flamee... at gmail.com (Diego 'Flameeyes' =?utf-8?q?Petten=C3=B2?=)
Date: Wed, 01 Oct 2008 16:37:20 +0200
Subject: [PATCH 3/6] Make it possible to enable/disable parsers generation at
	./configure
Message-ID: <20081001143720.22980.87619.stgit@yamato>

Instead of having to edit the configure.in file to disable parsers,
make it possible to disable it at ./configure stage, like any good
autoconf project should do.
---

 configure.in       |   12 +++++++-----
 ragel/Makefile.in  |    6 +++---
 redfsm/Makefile.in |    2 +-
 3 files changed, 11 insertions(+), 9 deletions(-)

diff --git a/configure.in b/configure.in
index cc25f2e..3995551 100644
--- a/configure.in
+++ b/configure.in
@@ -21,10 +21,12 @@ dnl   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 AC_INIT(ragel/main.cpp)
 AC_CONFIG_HEADER(common/config.h)
 
-dnl Set to true if build system should generate parsers from ragel, kelbt, and
-dnl gperf sources. Set to false if generated files are included and not to be
-dnl built (production).
-AC_SUBST(BUILD_PARSERS,true)
+dnl You need to enable this unless the generated files are included
+dnl and don't need to be built.
+AC_ARG_ENABLE([parsers],
+  AS_HELP_STRING([--disable-parsers], [Disable building of parsers with ragel, kelbt and gperf]),
+  [], [enable_parsers=yes])
+AC_SUBST([enable_parsers])
 
 dnl Checks for programs.
 AC_PROG_CC
@@ -38,7 +40,7 @@ AC_LANG_CPLUSPLUS
 dnl Check for definition of MAKE.
 AC_PROG_MAKE_SET
 
-if test $BUILD_PARSERS = true; then
+if test $enable_parsers = yes; then
 
 dnl Check for Ragel
 AC_CHECK_PROG(RAGEL, ragel, ragel)
diff --git a/ragel/Makefile.in b/ragel/Makefile.in
index b6397dc..2a6b5da 100644
--- a/ragel/Makefile.in
+++ b/ragel/Makefile.in
@@ -45,7 +45,7 @@ MINGW_LIBS = -lpsapi
 #*************************************
 
 prefix = @prefix@
-BUILD_PARSERS = @BUILD_PARSERS@
+BUILD_PARSERS = @enable_parsers@
 EXEEXT = @EXEEXT@
 CXX = @CXX@
 
@@ -63,7 +63,7 @@ all: ragel$(EXEEXT)
 ragel$(EXEEXT): $(GEN_SRC) $(OBJS) $(RAGEL_LIBS)
 	$(CXX) $(LDFLAGS) -o $@ $(OBJS) $(LIBS)
 
-ifeq ($(BUILD_PARSERS),true)
+ifeq ($(BUILD_PARSERS),yes)
 
 rlparse.h: rlparse.kh
 	kelbt -o $@ $<
@@ -87,7 +87,7 @@ endif
 distclean: clean
 	rm -f Makefile 
 
-ifeq ($(BUILD_PARSERS),true)
+ifeq ($(BUILD_PARSERS),yes)
 EXTRA_CLEAN = $(GEN_SRC)
 endif
 
diff --git a/redfsm/Makefile.in b/redfsm/Makefile.in
index a4c6737..951de79 100644
--- a/redfsm/Makefile.in
+++ b/redfsm/Makefile.in
@@ -28,7 +28,7 @@ CC_SRCS = redfsm.cpp gendata.cpp xmltags.cpp xmlscan.cpp xmlparse.cpp
 
 GEN_SRC = xmltags.cpp xmlscan.cpp xmlparse.cpp xmlparse.h
 
-BUILD_PARSERS = @BUILD_PARSERS@
+BUILD_PARSERS = @enable_parsers@
 
 #*************************************
 


From thurs... at cs.queensu.ca  Mon Oct  6 17:24:05 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Mon, 06 Oct 2008 13:24:05 -0400
Subject: [ragel-users] [PATCH 3/6] Make it possible to enable/disable
 parsers generation at ./configure
In-Reply-To: <20081001143720.22980.87619.stgit@yamato>
References: <20081001143720.22980.87619.stgit@yamato>
Message-ID: <48EA49B5.7080002@cs.queensu.ca>

I don't see why anyone would need to use this. Either you're doing 
development on ragel and you're working out of SVN or you're grabbing a 
release for building and installing. Maybe someone might want to do 
development on an older version but I think that would be pretty rare.

Adrian

Diego 'Flameeyes' Petten wrote:
> Instead of having to edit the configure.in file to disable parsers,
> make it possible to disable it at ./configure stage, like any good
> autoconf project should do.
> ---
> 
>  configure.in       |   12 +++++++-----
>  ragel/Makefile.in  |    6 +++---
>  redfsm/Makefile.in |    2 +-
>  3 files changed, 11 insertions(+), 9 deletions(-)
> 
> diff --git a/configure.in b/configure.in
> index cc25f2e..3995551 100644
> --- a/configure.in
> +++ b/configure.in
> @@ -21,10 +21,12 @@ dnl   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
>  AC_INIT(ragel/main.cpp)
>  AC_CONFIG_HEADER(common/config.h)
>  
> -dnl Set to true if build system should generate parsers from ragel, kelbt, and
> -dnl gperf sources. Set to false if generated files are included and not to be
> -dnl built (production).
> -AC_SUBST(BUILD_PARSERS,true)
> +dnl You need to enable this unless the generated files are included
> +dnl and don't need to be built.
> +AC_ARG_ENABLE([parsers],
> +  AS_HELP_STRING([--disable-parsers], [Disable building of parsers with ragel, kelbt and gperf]),
> +  [], [enable_parsers=yes])
> +AC_SUBST([enable_parsers])
>  
>  dnl Checks for programs.
>  AC_PROG_CC
> @@ -38,7 +40,7 @@ AC_LANG_CPLUSPLUS
>  dnl Check for definition of MAKE.
>  AC_PROG_MAKE_SET
>  
> -if test $BUILD_PARSERS = true; then
> +if test $enable_parsers = yes; then
>  
>  dnl Check for Ragel
>  AC_CHECK_PROG(RAGEL, ragel, ragel)
> diff --git a/ragel/Makefile.in b/ragel/Makefile.in
> index b6397dc..2a6b5da 100644
> --- a/ragel/Makefile.in
> +++ b/ragel/Makefile.in
> @@ -45,7 +45,7 @@ MINGW_LIBS = -lpsapi
>  #*************************************
>  
>  prefix = @prefix@
> -BUILD_PARSERS = @BUILD_PARSERS@
> +BUILD_PARSERS = @enable_parsers@
>  EXEEXT = @EXEEXT@
>  CXX = @CXX@
>  
> @@ -63,7 +63,7 @@ all: ragel$(EXEEXT)
>  ragel$(EXEEXT): $(GEN_SRC) $(OBJS) $(RAGEL_LIBS)
>  	$(CXX) $(LDFLAGS) -o $@ $(OBJS) $(LIBS)
>  
> -ifeq ($(BUILD_PARSERS),true)
> +ifeq ($(BUILD_PARSERS),yes)
>  
>  rlparse.h: rlparse.kh
>  	kelbt -o $@ $<
> @@ -87,7 +87,7 @@ endif
>  distclean: clean
>  	rm -f Makefile 
>  
> -ifeq ($(BUILD_PARSERS),true)
> +ifeq ($(BUILD_PARSERS),yes)
>  EXTRA_CLEAN = $(GEN_SRC)
>  endif
>  
> diff --git a/redfsm/Makefile.in b/redfsm/Makefile.in
> index a4c6737..951de79 100644
> --- a/redfsm/Makefile.in
> +++ b/redfsm/Makefile.in
> @@ -28,7 +28,7 @@ CC_SRCS = redfsm.cpp gendata.cpp xmltags.cpp xmlscan.cpp xmlparse.cpp
>  
>  GEN_SRC = xmltags.cpp xmlscan.cpp xmlparse.cpp xmlparse.h
>  
> -BUILD_PARSERS = @BUILD_PARSERS@
> +BUILD_PARSERS = @enable_parsers@
>  
>  #*************************************
>  
> 
> 
> 


From flamee... at gmail.com  Wed Oct  1 14:36:16 2008
From: flamee... at gmail.com (Diego 'Flameeyes' =?utf-8?q?Petten=C3=B2?=)
Date: Wed, 01 Oct 2008 16:36:16 +0200
Subject: [PATCH 0/6] Port the build system to autotools
Message-ID: <20081001143058.22980.51881.stgit@yamato>

Since I found quite a few problems trying to put ragel inside a chain
of packages to build for a project, I decided to go on and port it to
automake already.

The attached patches (which might require a bit of work to apply on
SVN because of removed and renamed files) replace the custom tailored
build system with a much more stable autotools-based one; it's not
perfect yet but it's certainly better than it was before for most
distribution and end-user uses.

I guess I'd have to do the same to kelbt (as wella s fixing one code
generation problem: char * vs const char const*), so that I can put
all in a single chain, and it's going to be a bit of a problem to get
ragel to bootstrap as it needs itself.

I'll also see if I can get something better for the tests.

Testing of these patches is very welcome by everybody, I can improve
them if I missed something.

---

Diego 'Flameeyes' Petten (6):
      Make the configure.in look more like an autoconf script.
      Replace custom makefiles with automake.
      Remove need for version.mk file.
      Make it possible to enable/disable parsers generation at ./configure
      Remove files generated by autotools.
      Don't use AC_DEFINE to pass the commands for the compilers to the runtest script.


 Makefile.am               |   21 
 Makefile.in               |   78 -
 common/Makefile.am        |   12 
 common/Makefile.in        |   72 -
 common/config.h.in        |   40 
 configure                 | 4680 ---------------------------------------------
 configure.in              |  109 +
 doc/Makefile.am           |   13 
 doc/Makefile.in           |   81 -
 doc/ragel.1.in            |    2 
 doc/rlgen-cd.1.in         |    2 
 doc/rlgen-dot.1.in        |    2 
 doc/rlgen-java.1.in       |    2 
 doc/rlgen-ruby.1.in       |    2 
 doc/version.tex.in        |    2 
 examples/Makefile         |  142 -
 examples/Makefile.am      |   38 
 examples/cppscan.lex      |  143 -
 examples/cppscan.rec      |  183 --
 examples/lex-cppscan.l    |  143 +
 examples/re2c-cppscan.rec |  183 ++
 ragel/Makefile.am         |   38 
 ragel/Makefile.in         |  101 -
 ragel/main.cpp            |    2 
 ragel/parsedata.cpp       |    4 
 redfsm/Makefile.am        |   29 
 redfsm/Makefile.in        |   87 -
 redfsm/xmlparse.kl        |    2 
 rlgen-cd/Makefile.am      |   12 
 rlgen-cd/Makefile.in      |   71 -
 rlgen-csharp/Makefile.am  |   12 
 rlgen-csharp/Makefile.in  |   71 -
 rlgen-csharp/main.cpp     |    2 
 rlgen-dot/Makefile.am     |    7 
 rlgen-dot/Makefile.in     |   68 -
 rlgen-java/Makefile.am    |    8 
 rlgen-java/Makefile.in    |   68 -
 rlgen-ruby/Makefile.am    |   11 
 rlgen-ruby/Makefile.in    |   69 -
 test/Makefile.am          |   23 
 test/Makefile.in          |   30 
 test/runtests             |  320 ---
 test/runtests.in          |  320 +++
 version.mk                |    2 
 44 files changed, 934 insertions(+), 6373 deletions(-)
 create mode 100644 Makefile.am
 delete mode 100644 Makefile.in
 create mode 100644 common/Makefile.am
 delete mode 100644 common/Makefile.in
 delete mode 100644 common/config.h.in
 delete mode 100755 configure
 create mode 100644 doc/Makefile.am
 delete mode 100644 doc/Makefile.in
 create mode 100644 doc/version.tex.in
 delete mode 100644 examples/Makefile
 create mode 100644 examples/Makefile.am
 delete mode 100644 examples/cppscan.lex
 delete mode 100644 examples/cppscan.rec
 create mode 100644 examples/lex-cppscan.l
 create mode 100644 examples/re2c-cppscan.rec
 create mode 100644 ragel/Makefile.am
 delete mode 100644 ragel/Makefile.in
 create mode 100644 redfsm/Makefile.am
 delete mode 100644 redfsm/Makefile.in
 create mode 100644 rlgen-cd/Makefile.am
 delete mode 100644 rlgen-cd/Makefile.in
 create mode 100644 rlgen-csharp/Makefile.am
 delete mode 100644 rlgen-csharp/Makefile.in
 create mode 100644 rlgen-dot/Makefile.am
 delete mode 100644 rlgen-dot/Makefile.in
 create mode 100644 rlgen-java/Makefile.am
 delete mode 100644 rlgen-java/Makefile.in
 create mode 100644 rlgen-ruby/Makefile.am
 delete mode 100644 rlgen-ruby/Makefile.in
 create mode 100644 test/Makefile.am
 delete mode 100644 test/Makefile.in
 delete mode 100755 test/runtests
 create mode 100755 test/runtests.in
 delete mode 100644 version.mk


From thurs... at cs.queensu.ca  Mon Oct  6 17:25:02 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Mon, 06 Oct 2008 13:25:02 -0400
Subject: [ragel-users] [PATCH 0/6] Port the build system to autotools
In-Reply-To: <20081001143058.22980.51881.stgit@yamato>
References: <20081001143058.22980.51881.stgit@yamato>
Message-ID: <48EA49EE.1020004@cs.queensu.ca>

Sorry I don't want to use automake for ragel.

Adrian

Diego 'Flameeyes' Petten wrote:
> Since I found quite a few problems trying to put ragel inside a chain
> of packages to build for a project, I decided to go on and port it to
> automake already.
> 
> The attached patches (which might require a bit of work to apply on
> SVN because of removed and renamed files) replace the custom tailored
> build system with a much more stable autotools-based one; it's not
> perfect yet but it's certainly better than it was before for most
> distribution and end-user uses.
> 
> I guess I'd have to do the same to kelbt (as wella s fixing one code
> generation problem: char * vs const char const*), so that I can put
> all in a single chain, and it's going to be a bit of a problem to get
> ragel to bootstrap as it needs itself.
> 
> I'll also see if I can get something better for the tests.
> 
> Testing of these patches is very welcome by everybody, I can improve
> them if I missed something.
> 
> ---
> 
> Diego 'Flameeyes' Petten (6):
>       Make the configure.in look more like an autoconf script.
>       Replace custom makefiles with automake.
>       Remove need for version.mk file.
>       Make it possible to enable/disable parsers generation at ./configure
>       Remove files generated by autotools.
>       Don't use AC_DEFINE to pass the commands for the compilers to the runtest script.
> 
> 
>  Makefile.am               |   21 
>  Makefile.in               |   78 -
>  common/Makefile.am        |   12 
>  common/Makefile.in        |   72 -
>  common/config.h.in        |   40 
>  configure                 | 4680 ---------------------------------------------
>  configure.in              |  109 +
>  doc/Makefile.am           |   13 
>  doc/Makefile.in           |   81 -
>  doc/ragel.1.in            |    2 
>  doc/rlgen-cd.1.in         |    2 
>  doc/rlgen-dot.1.in        |    2 
>  doc/rlgen-java.1.in       |    2 
>  doc/rlgen-ruby.1.in       |    2 
>  doc/version.tex.in        |    2 
>  examples/Makefile         |  142 -
>  examples/Makefile.am      |   38 
>  examples/cppscan.lex      |  143 -
>  examples/cppscan.rec      |  183 --
>  examples/lex-cppscan.l    |  143 +
>  examples/re2c-cppscan.rec |  183 ++
>  ragel/Makefile.am         |   38 
>  ragel/Makefile.in         |  101 -
>  ragel/main.cpp            |    2 
>  ragel/parsedata.cpp       |    4 
>  redfsm/Makefile.am        |   29 
>  redfsm/Makefile.in        |   87 -
>  redfsm/xmlparse.kl        |    2 
>  rlgen-cd/Makefile.am      |   12 
>  rlgen-cd/Makefile.in      |   71 -
>  rlgen-csharp/Makefile.am  |   12 
>  rlgen-csharp/Makefile.in  |   71 -
>  rlgen-csharp/main.cpp     |    2 
>  rlgen-dot/Makefile.am     |    7 
>  rlgen-dot/Makefile.in     |   68 -
>  rlgen-java/Makefile.am    |    8 
>  rlgen-java/Makefile.in    |   68 -
>  rlgen-ruby/Makefile.am    |   11 
>  rlgen-ruby/Makefile.in    |   69 -
>  test/Makefile.am          |   23 
>  test/Makefile.in          |   30 
>  test/runtests             |  320 ---
>  test/runtests.in          |  320 +++
>  version.mk                |    2 
>  44 files changed, 934 insertions(+), 6373 deletions(-)
>  create mode 100644 Makefile.am
>  delete mode 100644 Makefile.in
>  create mode 100644 common/Makefile.am
>  delete mode 100644 common/Makefile.in
>  delete mode 100644 common/config.h.in
>  delete mode 100755 configure
>  create mode 100644 doc/Makefile.am
>  delete mode 100644 doc/Makefile.in
>  create mode 100644 doc/version.tex.in
>  delete mode 100644 examples/Makefile
>  create mode 100644 examples/Makefile.am
>  delete mode 100644 examples/cppscan.lex
>  delete mode 100644 examples/cppscan.rec
>  create mode 100644 examples/lex-cppscan.l
>  create mode 100644 examples/re2c-cppscan.rec
>  create mode 100644 ragel/Makefile.am
>  delete mode 100644 ragel/Makefile.in
>  create mode 100644 redfsm/Makefile.am
>  delete mode 100644 redfsm/Makefile.in
>  create mode 100644 rlgen-cd/Makefile.am
>  delete mode 100644 rlgen-cd/Makefile.in
>  create mode 100644 rlgen-csharp/Makefile.am
>  delete mode 100644 rlgen-csharp/Makefile.in
>  create mode 100644 rlgen-dot/Makefile.am
>  delete mode 100644 rlgen-dot/Makefile.in
>  create mode 100644 rlgen-java/Makefile.am
>  delete mode 100644 rlgen-java/Makefile.in
>  create mode 100644 rlgen-ruby/Makefile.am
>  delete mode 100644 rlgen-ruby/Makefile.in
>  create mode 100644 test/Makefile.am
>  delete mode 100644 test/Makefile.in
>  delete mode 100755 test/runtests
>  create mode 100755 test/runtests.in
>  delete mode 100644 version.mk
> 
> 


From flamee... at gmail.com  Wed Oct  1 14:36:36 2008
From: flamee... at gmail.com (Diego 'Flameeyes' =?utf-8?q?Petten=C3=B2?=)
Date: Wed, 01 Oct 2008 16:36:36 +0200
Subject: [PATCH 1/6] Don't use AC_DEFINE to pass the commands for the
	compilers to the runtest script.
Message-ID: <20081001143631.22980.46335.stgit@yamato>

Instead of parsing the config.h header from runtest, make it use
proper autoconf by generating it at the end of the configure run.
---

 configure.in     |   28 +----
 test/runtests    |  320 ------------------------------------------------------
 test/runtests.in |  320 ++++++++++++++++++++++++++++++++++++++++++++++++++++++
 3 files changed, 327 insertions(+), 341 deletions(-)
 delete mode 100755 test/runtests
 create mode 100755 test/runtests.in

diff --git a/configure.in b/configure.in
index a257a70..cc25f2e 100644
--- a/configure.in
+++ b/configure.in
@@ -31,10 +31,6 @@ AC_PROG_CC
 AC_PROG_CXX
 AC_CHECK_TOOL(AR, ar)
 AC_PROG_RANLIB
-AC_DEFINE_UNQUOTED(CC,$CC)
-AC_DEFINE_UNQUOTED(CXX,$CXX)
-AC_DEFINE_UNQUOTED(AR,$AR)
-AC_DEFINE_UNQUOTED(RANLIB,$RANLIB)
 
 dnl Set test on c++ compiler.
 AC_LANG_CPLUSPLUS
@@ -75,9 +71,7 @@ fi # BUILD_PARSERS
 
 dnl Check for the D compiler
 AC_CHECK_PROG(GDC, gdc, gdc)
-if test -n "$GDC"; then
-	AC_DEFINE_UNQUOTED(GDC,$GDC)
-fi
+AC_SUBST(GDC)
 
 dnl Check for the Objective-C compiler
 AC_MSG_CHECKING([for the Objective-C compiler])
@@ -88,7 +82,7 @@ GOBJC=""
 if gcc -x objective-c conftest.m -o conftest.bin 2>/dev/null; then
 	GOBJC="gcc -x objective-c"
 	AC_MSG_RESULT([yes])
-	AC_DEFINE_UNQUOTED(GOBJC,$GOBJC)
+	AC_SUBST(GOBJC)
 else
 	AC_MSG_RESULT([no])
 fi
@@ -96,29 +90,21 @@ AC_SUBST(GOBJC)
 
 dnl Check for the Java compiler.
 AC_CHECK_PROG(JAVAC, javac, javac)
-if test -n "$JAVAC"; then
-	AC_DEFINE_UNQUOTED(JAVAC,$JAVAC)
-fi
+AC_SUBST(JAVAC)
 
 dnl Check for TXL.
 AC_CHECK_PROG(TXL, txl, txl)
-if test -n "$TXL"; then
-	AC_DEFINE_UNQUOTED(TXL,$TXL)
-fi
+AC_SUBST(TXL)
 
 dnl Check for Ruby.
 AC_CHECK_PROG(RUBY, ruby, ruby)
-if test -n "$RUBY"; then
-	AC_DEFINE_UNQUOTED(RUBY,$RUBY)
-fi
+AC_SUBST(RUBY)
 
 dnl Check for the C# compiler.
 AC_CHECK_PROG(GMCS, gmcs, gmcs)
-if test -n "$GMCS"; then
-	AC_DEFINE_UNQUOTED(GMCS,$GMCS)
-fi
+AC_SUBST(GMCS)
 
 dnl write output files
-AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile)
+AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile test/runtests)
 
 echo "configuration of ragel complete"
diff --git a/test/runtests b/test/runtests
deleted file mode 100755
index a50c7c9..0000000
--- a/test/runtests
+++ /dev/null
@@ -1,320 +0,0 @@
-#!/bin/bash
-
-#
-#   Copyright 2006 Adrian Thurston <thurs... at cs.queensu.ca>
-#
-
-#   This file is part of Ragel.
-#
-#   Ragel is free software; you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   Ragel is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with Ragel; if not, write to the Free Software
-#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-
-while getopts "gcnmleT:F:G:P:CDJRA" opt; do
-	case $opt in
-		T|F|G|P) 
-			genflags="$genflags -$opt$OPTARG"
-			options="$options -$opt$OPTARG"
-			;;
-		n|m|l|e) 
-			minflags="$minflags -$opt"
-			options="$options -$opt"
-			;;
-		c) 
-			compile_only="true"
-			options="$options -$opt"
-			;;
-		g) 
-			allow_generated="true"
-			;;
-		C|D|J|R|A) 
-			langflags="$langflags -$opt"
-			;;
-	esac
-done
-
-[ -z "$minflags" ] && minflags="-n -m -l -e"
-[ -z "$genflags" ] && genflags="-T0 -T1 -F0 -F1 -G0 -G1 -G2"
-[ -z "$langflags" ] && langflags="-C -D -J -R -A"
-
-shift $((OPTIND - 1));
-
-[ -z "$*" ] && set -- *.rl
-
-config=../common/config.h
-ragel=../ragel/ragel
-
-cxx_compiler=`sed '/^#define CXX/s/#define CXX *//p;d' $config`
-c_compiler=`sed '/^#define CC/s/#define CC *//p;d' $config`
-objc_compiler=`sed '/^#define GOBJC/s/#define GOBJC *//p;d' $config`
-d_compiler=`sed '/^#define GDC/s/#define GDC *//p;d' $config`
-java_compiler=`sed '/#define JAVAC/s/#define JAVAC *//p;d' $config`
-txl_engine=`sed '/^#define TXL/s/#define TXL *//p;d' $config`
-ruby_engine=`sed '/^#define RUBY/s/#define RUBY *//p;d' $config`
-csharp_compiler=`sed '/#define GMCS/s/#define GMCS *//p;d' $config`
-
-function test_error
-{
-	exit 1;
-}
-
-#	split_objs=""
-#	if test $split_iters != "$gen_opt"; then
-#		n=0;
-#		while test $n -lt $split_iters; do
-#			part_root=${root}_`awk 'BEGIN {
-#				width = 0;
-#				high = '$split_iters' - 1;
-#				while ( high > 0 ) {
-#					width = width + 1;
-#					high = int(high / 10);
-#				}
-#				suffFormat = "%" width "." width "d\n";
-#				printf( suffFormat, '$n' );
-#				exit 0;
-#			}'`
-#			part_src=${part_root}.c
-#			part_bin=${part_root}.o
-#			echo "$compiler -c $cflags -o $part_bin $part_src"
-#			if ! $compiler -c $cflags -o $part_bin $part_src; then
-#				test_error;
-#			fi
-#			split_objs="$split_objs $part_bin"
-#			n=$((n+1))
-#		done
-#	fi
-
-function run_test()
-{
-	echo "$ragel $lang_opt $min_opt $gen_opt -o $code_src $test_case"
-	if ! $ragel $lang_opt $min_opt $gen_opt -o $code_src $test_case; then
-		test_error;
-	fi
-
-	out_args=""
-	[ $lang != java ] && out_args="-o ${binary}";
-    [ $lang == csharp ] && out_args="-out:${binary}";
-
-	# Ruby doesn't need to be compiled.
-	if [ $lang != ruby ]; then
-		echo "$compiler ${cflags} ${out_args} ${code_src}"
-		if ! $compiler ${cflags} ${out_args} ${code_src}; then
-			test_error;
-		fi
-	fi
-
-	if [ "$compile_only" != "true" ]; then
-		echo -n "running $root ... ";
-		
-		exec_cmd=./$binary
-		[ $lang = java ] && exec_cmd="java ${root}"
-		[ $lang = ruby ] && exec_cmd="ruby ${code_src}"
-		[ $lang = csharp ] && exec_cmd="mono ${exec_cmd}"
-
-		$exec_cmd 2>&1 > $output;
-		if diff $expected_out $output > /dev/null; then
-			echo "passed";
-		else
-			echo "FAILED";
-			test_error;
-		fi;
-	fi
-}
-
-for test_case; do
-	root=${test_case%.rl};
-
-	if ! [ -f "$test_case" ]; then
-		echo "runtests: not a file: $test_case"; >&2
-		exit 1;
-	fi
-
-	# Check if we should ignore the test case
-	ignore=`sed '/@IGNORE:/s/^.*: *//p;d' $test_case`
-    if [ "$ignore" = yes ]; then
-        continue;
-    fi
-
-	# If the generated flag is given make sure that the test case is generated.
-	is_generated=`sed '/@GENERATED:/s/^.*: *//p;d' $test_case`
-	if [ "$is_generated" = yes ] && [ "$allow_generated" != true ]; then
-		continue;
-	fi
-
-	expected_out=$root.exp;
-	sed '1,/_____OUTPUT_____/d;$d' $test_case > $expected_out
-
-	lang=`sed '/@LANG:/s/^.*: *//p;d' $test_case`
-	if [ -z "$lang" ]; then
-		echo "$test_case: language unset"; >&2
-		exit 1;
-	fi
-
-	case $lang in
-		c++)
-			lang_opt=-C;
-			codegen=../rlgen-cd/rlgen-cd;
-			code_suffix=cpp;
-			compiler=$cxx_compiler;
-			cflags="-pedantic -ansi -Wall -O3"
-		;;
-		d)
-			lang_opt=-D;
-			codegen=../rlgen-cd/rlgen-cd;
-			code_suffix=d;
-			compiler=$d_compiler;
-			cflags="-Wall -O3"
-		;;
-		c)
-			lang_opt=-C;
-			codegen=../rlgen-cd/rlgen-cd;
-			code_suffix=c;
-			compiler=$c_compiler;
-			cflags="-pedantic -ansi -Wall -O3"
-		;;
-		obj-c)
-			lang_opt=-C;
-			codegen=../rlgen-cd/rlgen-cd;
-			code_suffix=m;
-			compiler=$objc_compiler
-			cflags="-Wall -O3 -fno-strict-aliasing -lobjc"
-		;;
-		java)
-			lang_opt=-J;
-			codegen=../rlgen-java/rlgen-java;
-			code_suffix=java;
-			compiler=$java_compiler
-			cflags=""
-		;;
-		ruby)
-			lang_opt=-R;
-			codegen=../rlgen-ruby/rlgen-ruby;
-			code_suffix=rb;
-			compiler=$ruby_engine
-			cflags=""
-		;;
-        csharp)
-            lang_opt="-A";
-            codegen=../rlgen-csharp/rlgen-csharp;
-            code_suffix=cs;
-            compiler=$csharp_compiler
-            cflags=""
-        ;;
-		indep)
-			lang_opt="";
-
-			# If we have no txl engine then skip this test.
-			[ -z "$txl_engine" ] && continue
-			for lang in c d java ruby csharp; do
-				case $lang in 
-					c) lf="-C";;
-					d) lf="-D";;
-					java) lf="-J";;
-					ruby) lf="-R";;
-                    csharp) lf="-A";;
-				esac
-
-				echo "$langflags" | grep -e $lf >/dev/null || continue
-
-				targ=${root}_$lang.rl
-				echo "./langtrans_$lang.sh $test_case > $targ"
-				if ! ./langtrans_$lang.sh $test_case > $targ; then
-					test_error
-				fi
-				echo "./runtests -g $options $targ"
-				if !  ./runtests -g $options $targ; then
-					test_error
-				fi
-			done
-			continue;
-		;;
-		*)
-			echo "$test_case: unknown language type $lang" >&2
-			exit 1;
-		;;
-	esac
-
-	# Make sure that we are interested in the host language.
-	echo "$langflags" | grep -e $lang_opt >/dev/null || continue
-
-	code_src=$root.$code_suffix;
-	binary=$root.bin;
-	output=$root.out;
-
-	# If we have no compiler for the source program then skip it.
-	[ -z "$compiler" ] && continue
-
-	additional_cflags=`sed '/@CFLAGS:/s/^.*: *//p;d' $test_case`
-	[ -n "$additional_cflags" ] && cflags="$cflags $additional_cflags"
-
-	allow_minflags=`sed '/@ALLOW_MINFLAGS:/s/^.*: *//p;d' $test_case`
-	[ -z "$allow_minflags" ] && allow_minflags="-n -m -l -e"
-
-	case $lang in
-	c|c++|d)
-		# Using genflags, get the allowed gen flags from the test case. If the
-		# test case doesn't specify assume that all gen flags are allowed.
-		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
-		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1 -G0 -G1 -G2"
-
-		for min_opt in $minflags; do
-			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
-			for gen_opt in $genflags; do
-				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
-				run_test
-			done
-		done
-	;;
-
-	java) 
-		# Not interested in gen opt.
-		gen_opt=""
-		for min_opt in $minflags; do
-			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
-			run_test
-		done
-	;;
-
-	ruby) 
-		# Using genflags, get the allowed gen flags from the test case. If the
-		# test case doesn't specify assume that all gen flags are allowed.
-		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
-		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1"
-
-		for min_opt in $minflags; do
-			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
-
-			for gen_opt in $genflags; do
-				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
-				run_test
-			done
-		done
-	;;
-
-	csharp)
-		# Using genflags, get the allowed gen flags from the test case. If the
-		# test case doesn't specify assume that all gen flags are allowed.
-		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
-		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1 -G0 -G1"
-
-		for min_opt in $minflags; do
-			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
-			for gen_opt in $genflags; do
-				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
-				run_test
-			done
-		done
-	;;
-	esac
-
-done
diff --git a/test/runtests.in b/test/runtests.in
new file mode 100755
index 0000000..ee14f6a
--- /dev/null
+++ b/test/runtests.in
@@ -0,0 +1,320 @@
+#!/bin/bash
+
+#
+#   Copyright 2006 Adrian Thurston <thurs... at cs.queensu.ca>
+#
+
+#   This file is part of Ragel.
+#
+#   Ragel is free software; you can redistribute it and/or modify
+#   it under the terms of the GNU General Public License as published by
+#   the Free Software Foundation; either version 2 of the License, or
+#   (at your option) any later version.
+#
+#   Ragel is distributed in the hope that it will be useful,
+#   but WITHOUT ANY WARRANTY; without even the implied warranty of
+#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+#   GNU General Public License for more details.
+#
+#   You should have received a copy of the GNU General Public License
+#   along with Ragel; if not, write to the Free Software
+#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
+
+while getopts "gcnmleT:F:G:P:CDJRA" opt; do
+	case $opt in
+		T|F|G|P) 
+			genflags="$genflags -$opt$OPTARG"
+			options="$options -$opt$OPTARG"
+			;;
+		n|m|l|e) 
+			minflags="$minflags -$opt"
+			options="$options -$opt"
+			;;
+		c) 
+			compile_only="true"
+			options="$options -$opt"
+			;;
+		g) 
+			allow_generated="true"
+			;;
+		C|D|J|R|A) 
+			langflags="$langflags -$opt"
+			;;
+	esac
+done
+
+[ -z "$minflags" ] && minflags="-n -m -l -e"
+[ -z "$genflags" ] && genflags="-T0 -T1 -F0 -F1 -G0 -G1 -G2"
+[ -z "$langflags" ] && langflags="-C -D -J -R -A"
+
+shift $((OPTIND - 1));
+
+[ -z "$*" ] && set -- *.rl
+
+config=../common/config.h
+ragel=../ragel/ragel
+
+cxx_compiler=@CXX@
+c_compiler=@CC@
+objc_compiler=@GOBJC@
+d_compiler=@GDC@
+java_compiler=@JAVAC@
+txl_engine=@TXL@
+ruby_engine=@RUBY@
+csharp_compiler=@GMCS@
+
+function test_error
+{
+	exit 1;
+}
+
+#	split_objs=""
+#	if test $split_iters != "$gen_opt"; then
+#		n=0;
+#		while test $n -lt $split_iters; do
+#			part_root=${root}_`awk 'BEGIN {
+#				width = 0;
+#				high = '$split_iters' - 1;
+#				while ( high > 0 ) {
+#					width = width + 1;
+#					high = int(high / 10);
+#				}
+#				suffFormat = "%" width "." width "d\n";
+#				printf( suffFormat, '$n' );
+#				exit 0;
+#			}'`
+#			part_src=${part_root}.c
+#			part_bin=${part_root}.o
+#			echo "$compiler -c $cflags -o $part_bin $part_src"
+#			if ! $compiler -c $cflags -o $part_bin $part_src; then
+#				test_error;
+#			fi
+#			split_objs="$split_objs $part_bin"
+#			n=$((n+1))
+#		done
+#	fi
+
+function run_test()
+{
+	echo "$ragel $lang_opt $min_opt $gen_opt -o $code_src $test_case"
+	if ! $ragel $lang_opt $min_opt $gen_opt -o $code_src $test_case; then
+		test_error;
+	fi
+
+	out_args=""
+	[ $lang != java ] && out_args="-o ${binary}";
+    [ $lang == csharp ] && out_args="-out:${binary}";
+
+	# Ruby doesn't need to be compiled.
+	if [ $lang != ruby ]; then
+		echo "$compiler ${cflags} ${out_args} ${code_src}"
+		if ! $compiler ${cflags} ${out_args} ${code_src}; then
+			test_error;
+		fi
+	fi
+
+	if [ "$compile_only" != "true" ]; then
+		echo -n "running $root ... ";
+		
+		exec_cmd=./$binary
+		[ $lang = java ] && exec_cmd="java ${root}"
+		[ $lang = ruby ] && exec_cmd="ruby ${code_src}"
+		[ $lang = csharp ] && exec_cmd="mono ${exec_cmd}"
+
+		$exec_cmd 2>&1 > $output;
+		if diff $expected_out $output > /dev/null; then
+			echo "passed";
+		else
+			echo "FAILED";
+			test_error;
+		fi;
+	fi
+}
+
+for test_case; do
+	root=${test_case%.rl};
+
+	if ! [ -f "$test_case" ]; then
+		echo "runtests: not a file: $test_case"; >&2
+		exit 1;
+	fi
+
+	# Check if we should ignore the test case
+	ignore=`sed '/@IGNORE:/s/^.*: *//p;d' $test_case`
+    if [ "$ignore" = yes ]; then
+        continue;
+    fi
+
+	# If the generated flag is given make sure that the test case is generated.
+	is_generated=`sed '/@GENERATED:/s/^.*: *//p;d' $test_case`
+	if [ "$is_generated" = yes ] && [ "$allow_generated" != true ]; then
+		continue;
+	fi
+
+	expected_out=$root.exp;
+	sed '1,/_____OUTPUT_____/d;$d' $test_case > $expected_out
+
+	lang=`sed '/@LANG:/s/^.*: *//p;d' $test_case`
+	if [ -z "$lang" ]; then
+		echo "$test_case: language unset"; >&2
+		exit 1;
+	fi
+
+	case $lang in
+		c++)
+			lang_opt=-C;
+			codegen=../rlgen-cd/rlgen-cd;
+			code_suffix=cpp;
+			compiler=$cxx_compiler;
+			cflags="-pedantic -ansi -Wall -O3"
+		;;
+		d)
+			lang_opt=-D;
+			codegen=../rlgen-cd/rlgen-cd;
+			code_suffix=d;
+			compiler=$d_compiler;
+			cflags="-Wall -O3"
+		;;
+		c)
+			lang_opt=-C;
+			codegen=../rlgen-cd/rlgen-cd;
+			code_suffix=c;
+			compiler=$c_compiler;
+			cflags="-pedantic -ansi -Wall -O3"
+		;;
+		obj-c)
+			lang_opt=-C;
+			codegen=../rlgen-cd/rlgen-cd;
+			code_suffix=m;
+			compiler=$objc_compiler
+			cflags="-Wall -O3 -fno-strict-aliasing -lobjc"
+		;;
+		java)
+			lang_opt=-J;
+			codegen=../rlgen-java/rlgen-java;
+			code_suffix=java;
+			compiler=$java_compiler
+			cflags=""
+		;;
+		ruby)
+			lang_opt=-R;
+			codegen=../rlgen-ruby/rlgen-ruby;
+			code_suffix=rb;
+			compiler=$ruby_engine
+			cflags=""
+		;;
+        csharp)
+            lang_opt="-A";
+            codegen=../rlgen-csharp/rlgen-csharp;
+            code_suffix=cs;
+            compiler=$csharp_compiler
+            cflags=""
+        ;;
+		indep)
+			lang_opt="";
+
+			# If we have no txl engine then skip this test.
+			[ -z "$txl_engine" ] && continue
+			for lang in c d java ruby csharp; do
+				case $lang in 
+					c) lf="-C";;
+					d) lf="-D";;
+					java) lf="-J";;
+					ruby) lf="-R";;
+                    csharp) lf="-A";;
+				esac
+
+				echo "$langflags" | grep -e $lf >/dev/null || continue
+
+				targ=${root}_$lang.rl
+				echo "./langtrans_$lang.sh $test_case > $targ"
+				if ! ./langtrans_$lang.sh $test_case > $targ; then
+					test_error
+				fi
+				echo "./runtests -g $options $targ"
+				if !  ./runtests -g $options $targ; then
+					test_error
+				fi
+			done
+			continue;
+		;;
+		*)
+			echo "$test_case: unknown language type $lang" >&2
+			exit 1;
+		;;
+	esac
+
+	# Make sure that we are interested in the host language.
+	echo "$langflags" | grep -e $lang_opt >/dev/null || continue
+
+	code_src=$root.$code_suffix;
+	binary=$root.bin;
+	output=$root.out;
+
+	# If we have no compiler for the source program then skip it.
+	[ -z "$compiler" ] && continue
+
+	additional_cflags=`sed '/@CFLAGS:/s/^.*: *//p;d' $test_case`
+	[ -n "$additional_cflags" ] && cflags="$cflags $additional_cflags"
+
+	allow_minflags=`sed '/@ALLOW_MINFLAGS:/s/^.*: *//p;d' $test_case`
+	[ -z "$allow_minflags" ] && allow_minflags="-n -m -l -e"
+
+	case $lang in
+	c|c++|d)
+		# Using genflags, get the allowed gen flags from the test case. If the
+		# test case doesn't specify assume that all gen flags are allowed.
+		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
+		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1 -G0 -G1 -G2"
+
+		for min_opt in $minflags; do
+			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
+			for gen_opt in $genflags; do
+				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
+				run_test
+			done
+		done
+	;;
+
+	java) 
+		# Not interested in gen opt.
+		gen_opt=""
+		for min_opt in $minflags; do
+			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
+			run_test
+		done
+	;;
+
+	ruby) 
+		# Using genflags, get the allowed gen flags from the test case. If the
+		# test case doesn't specify assume that all gen flags are allowed.
+		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
+		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1"
+
+		for min_opt in $minflags; do
+			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
+
+			for gen_opt in $genflags; do
+				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
+				run_test
+			done
+		done
+	;;
+
+	csharp)
+		# Using genflags, get the allowed gen flags from the test case. If the
+		# test case doesn't specify assume that all gen flags are allowed.
+		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
+		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1 -G0 -G1"
+
+		for min_opt in $minflags; do
+			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
+			for gen_opt in $genflags; do
+				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
+				run_test
+			done
+		done
+	;;
+	esac
+
+done


From thurs... at cs.queensu.ca  Mon Oct  6 17:33:07 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Mon, 06 Oct 2008 13:33:07 -0400
Subject: [ragel-users] [PATCH 1/6] Don't use AC_DEFINE to pass the commands
 for the compilers to the runtest script.
In-Reply-To: <20081001143631.22980.46335.stgit@yamato>
References: <20081001143631.22980.46335.stgit@yamato>
Message-ID: <48EA4BD3.5010604@cs.queensu.ca>

Any reason? The effect of both approaches seems to be the same.

-Adrian

Diego 'Flameeyes' Petten wrote:
> Instead of parsing the config.h header from runtest, make it use
> proper autoconf by generating it at the end of the configure run.
> ---
> 
>  configure.in     |   28 +----
>  test/runtests    |  320 ------------------------------------------------------
>  test/runtests.in |  320 ++++++++++++++++++++++++++++++++++++++++++++++++++++++
>  3 files changed, 327 insertions(+), 341 deletions(-)
>  delete mode 100755 test/runtests
>  create mode 100755 test/runtests.in
> 
> diff --git a/configure.in b/configure.in
> index a257a70..cc25f2e 100644
> --- a/configure.in
> +++ b/configure.in
> @@ -31,10 +31,6 @@ AC_PROG_CC
>  AC_PROG_CXX
>  AC_CHECK_TOOL(AR, ar)
>  AC_PROG_RANLIB
> -AC_DEFINE_UNQUOTED(CC,$CC)
> -AC_DEFINE_UNQUOTED(CXX,$CXX)
> -AC_DEFINE_UNQUOTED(AR,$AR)
> -AC_DEFINE_UNQUOTED(RANLIB,$RANLIB)
>  
>  dnl Set test on c++ compiler.
>  AC_LANG_CPLUSPLUS
> @@ -75,9 +71,7 @@ fi # BUILD_PARSERS
>  
>  dnl Check for the D compiler
>  AC_CHECK_PROG(GDC, gdc, gdc)
> -if test -n "$GDC"; then
> -	AC_DEFINE_UNQUOTED(GDC,$GDC)
> -fi
> +AC_SUBST(GDC)
>  
>  dnl Check for the Objective-C compiler
>  AC_MSG_CHECKING([for the Objective-C compiler])
> @@ -88,7 +82,7 @@ GOBJC=""
>  if gcc -x objective-c conftest.m -o conftest.bin 2>/dev/null; then
>  	GOBJC="gcc -x objective-c"
>  	AC_MSG_RESULT([yes])
> -	AC_DEFINE_UNQUOTED(GOBJC,$GOBJC)
> +	AC_SUBST(GOBJC)
>  else
>  	AC_MSG_RESULT([no])
>  fi
> @@ -96,29 +90,21 @@ AC_SUBST(GOBJC)
>  
>  dnl Check for the Java compiler.
>  AC_CHECK_PROG(JAVAC, javac, javac)
> -if test -n "$JAVAC"; then
> -	AC_DEFINE_UNQUOTED(JAVAC,$JAVAC)
> -fi
> +AC_SUBST(JAVAC)
>  
>  dnl Check for TXL.
>  AC_CHECK_PROG(TXL, txl, txl)
> -if test -n "$TXL"; then
> -	AC_DEFINE_UNQUOTED(TXL,$TXL)
> -fi
> +AC_SUBST(TXL)
>  
>  dnl Check for Ruby.
>  AC_CHECK_PROG(RUBY, ruby, ruby)
> -if test -n "$RUBY"; then
> -	AC_DEFINE_UNQUOTED(RUBY,$RUBY)
> -fi
> +AC_SUBST(RUBY)
>  
>  dnl Check for the C# compiler.
>  AC_CHECK_PROG(GMCS, gmcs, gmcs)
> -if test -n "$GMCS"; then
> -	AC_DEFINE_UNQUOTED(GMCS,$GMCS)
> -fi
> +AC_SUBST(GMCS)
>  
>  dnl write output files
> -AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile)
> +AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile test/runtests)
>  
>  echo "configuration of ragel complete"
> diff --git a/test/runtests b/test/runtests
> deleted file mode 100755
> index a50c7c9..0000000
> --- a/test/runtests
> +++ /dev/null
> @@ -1,320 +0,0 @@
> -#!/bin/bash
> -
> -#
> -#   Copyright 2006 Adrian Thurston <thurs... at cs.queensu.ca>
> -#
> -
> -#   This file is part of Ragel.
> -#
> -#   Ragel is free software; you can redistribute it and/or modify
> -#   it under the terms of the GNU General Public License as published by
> -#   the Free Software Foundation; either version 2 of the License, or
> -#   (at your option) any later version.
> -#
> -#   Ragel is distributed in the hope that it will be useful,
> -#   but WITHOUT ANY WARRANTY; without even the implied warranty of
> -#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
> -#   GNU General Public License for more details.
> -#
> -#   You should have received a copy of the GNU General Public License
> -#   along with Ragel; if not, write to the Free Software
> -#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
> -
> -while getopts "gcnmleT:F:G:P:CDJRA" opt; do
> -	case $opt in
> -		T|F|G|P) 
> -			genflags="$genflags -$opt$OPTARG"
> -			options="$options -$opt$OPTARG"
> -			;;
> -		n|m|l|e) 
> -			minflags="$minflags -$opt"
> -			options="$options -$opt"
> -			;;
> -		c) 
> -			compile_only="true"
> -			options="$options -$opt"
> -			;;
> -		g) 
> -			allow_generated="true"
> -			;;
> -		C|D|J|R|A) 
> -			langflags="$langflags -$opt"
> -			;;
> -	esac
> -done
> -
> -[ -z "$minflags" ] && minflags="-n -m -l -e"
> -[ -z "$genflags" ] && genflags="-T0 -T1 -F0 -F1 -G0 -G1 -G2"
> -[ -z "$langflags" ] && langflags="-C -D -J -R -A"
> -
> -shift $((OPTIND - 1));
> -
> -[ -z "$*" ] && set -- *.rl
> -
> -config=../common/config.h
> -ragel=../ragel/ragel
> -
> -cxx_compiler=`sed '/^#define CXX/s/#define CXX *//p;d' $config`
> -c_compiler=`sed '/^#define CC/s/#define CC *//p;d' $config`
> -objc_compiler=`sed '/^#define GOBJC/s/#define GOBJC *//p;d' $config`
> -d_compiler=`sed '/^#define GDC/s/#define GDC *//p;d' $config`
> -java_compiler=`sed '/#define JAVAC/s/#define JAVAC *//p;d' $config`
> -txl_engine=`sed '/^#define TXL/s/#define TXL *//p;d' $config`
> -ruby_engine=`sed '/^#define RUBY/s/#define RUBY *//p;d' $config`
> -csharp_compiler=`sed '/#define GMCS/s/#define GMCS *//p;d' $config`
> -
> -function test_error
> -{
> -	exit 1;
> -}
> -
> -#	split_objs=""
> -#	if test $split_iters != "$gen_opt"; then
> -#		n=0;
> -#		while test $n -lt $split_iters; do
> -#			part_root=${root}_`awk 'BEGIN {
> -#				width = 0;
> -#				high = '$split_iters' - 1;
> -#				while ( high > 0 ) {
> -#					width = width + 1;
> -#					high = int(high / 10);
> -#				}
> -#				suffFormat = "%" width "." width "d\n";
> -#				printf( suffFormat, '$n' );
> -#				exit 0;
> -#			}'`
> -#			part_src=${part_root}.c
> -#			part_bin=${part_root}.o
> -#			echo "$compiler -c $cflags -o $part_bin $part_src"
> -#			if ! $compiler -c $cflags -o $part_bin $part_src; then
> -#				test_error;
> -#			fi
> -#			split_objs="$split_objs $part_bin"
> -#			n=$((n+1))
> -#		done
> -#	fi
> -
> -function run_test()
> -{
> -	echo "$ragel $lang_opt $min_opt $gen_opt -o $code_src $test_case"
> -	if ! $ragel $lang_opt $min_opt $gen_opt -o $code_src $test_case; then
> -		test_error;
> -	fi
> -
> -	out_args=""
> -	[ $lang != java ] && out_args="-o ${binary}";
> -    [ $lang == csharp ] && out_args="-out:${binary}";
> -
> -	# Ruby doesn't need to be compiled.
> -	if [ $lang != ruby ]; then
> -		echo "$compiler ${cflags} ${out_args} ${code_src}"
> -		if ! $compiler ${cflags} ${out_args} ${code_src}; then
> -			test_error;
> -		fi
> -	fi
> -
> -	if [ "$compile_only" != "true" ]; then
> -		echo -n "running $root ... ";
> -		
> -		exec_cmd=./$binary
> -		[ $lang = java ] && exec_cmd="java ${root}"
> -		[ $lang = ruby ] && exec_cmd="ruby ${code_src}"
> -		[ $lang = csharp ] && exec_cmd="mono ${exec_cmd}"
> -
> -		$exec_cmd 2>&1 > $output;
> -		if diff $expected_out $output > /dev/null; then
> -			echo "passed";
> -		else
> -			echo "FAILED";
> -			test_error;
> -		fi;
> -	fi
> -}
> -
> -for test_case; do
> -	root=${test_case%.rl};
> -
> -	if ! [ -f "$test_case" ]; then
> -		echo "runtests: not a file: $test_case"; >&2
> -		exit 1;
> -	fi
> -
> -	# Check if we should ignore the test case
> -	ignore=`sed '/@IGNORE:/s/^.*: *//p;d' $test_case`
> -    if [ "$ignore" = yes ]; then
> -        continue;
> -    fi
> -
> -	# If the generated flag is given make sure that the test case is generated.
> -	is_generated=`sed '/@GENERATED:/s/^.*: *//p;d' $test_case`
> -	if [ "$is_generated" = yes ] && [ "$allow_generated" != true ]; then
> -		continue;
> -	fi
> -
> -	expected_out=$root.exp;
> -	sed '1,/_____OUTPUT_____/d;$d' $test_case > $expected_out
> -
> -	lang=`sed '/@LANG:/s/^.*: *//p;d' $test_case`
> -	if [ -z "$lang" ]; then
> -		echo "$test_case: language unset"; >&2
> -		exit 1;
> -	fi
> -
> -	case $lang in
> -		c++)
> -			lang_opt=-C;
> -			codegen=../rlgen-cd/rlgen-cd;
> -			code_suffix=cpp;
> -			compiler=$cxx_compiler;
> -			cflags="-pedantic -ansi -Wall -O3"
> -		;;
> -		d)
> -			lang_opt=-D;
> -			codegen=../rlgen-cd/rlgen-cd;
> -			code_suffix=d;
> -			compiler=$d_compiler;
> -			cflags="-Wall -O3"
> -		;;
> -		c)
> -			lang_opt=-C;
> -			codegen=../rlgen-cd/rlgen-cd;
> -			code_suffix=c;
> -			compiler=$c_compiler;
> -			cflags="-pedantic -ansi -Wall -O3"
> -		;;
> -		obj-c)
> -			lang_opt=-C;
> -			codegen=../rlgen-cd/rlgen-cd;
> -			code_suffix=m;
> -			compiler=$objc_compiler
> -			cflags="-Wall -O3 -fno-strict-aliasing -lobjc"
> -		;;
> -		java)
> -			lang_opt=-J;
> -			codegen=../rlgen-java/rlgen-java;
> -			code_suffix=java;
> -			compiler=$java_compiler
> -			cflags=""
> -		;;
> -		ruby)
> -			lang_opt=-R;
> -			codegen=../rlgen-ruby/rlgen-ruby;
> -			code_suffix=rb;
> -			compiler=$ruby_engine
> -			cflags=""
> -		;;
> -        csharp)
> -            lang_opt="-A";
> -            codegen=../rlgen-csharp/rlgen-csharp;
> -            code_suffix=cs;
> -            compiler=$csharp_compiler
> -            cflags=""
> -        ;;
> -		indep)
> -			lang_opt="";
> -
> -			# If we have no txl engine then skip this test.
> -			[ -z "$txl_engine" ] && continue
> -			for lang in c d java ruby csharp; do
> -				case $lang in 
> -					c) lf="-C";;
> -					d) lf="-D";;
> -					java) lf="-J";;
> -					ruby) lf="-R";;
> -                    csharp) lf="-A";;
> -				esac
> -
> -				echo "$langflags" | grep -e $lf >/dev/null || continue
> -
> -				targ=${root}_$lang.rl
> -				echo "./langtrans_$lang.sh $test_case > $targ"
> -				if ! ./langtrans_$lang.sh $test_case > $targ; then
> -					test_error
> -				fi
> -				echo "./runtests -g $options $targ"
> -				if !  ./runtests -g $options $targ; then
> -					test_error
> -				fi
> -			done
> -			continue;
> -		;;
> -		*)
> -			echo "$test_case: unknown language type $lang" >&2
> -			exit 1;
> -		;;
> -	esac
> -
> -	# Make sure that we are interested in the host language.
> -	echo "$langflags" | grep -e $lang_opt >/dev/null || continue
> -
> -	code_src=$root.$code_suffix;
> -	binary=$root.bin;
> -	output=$root.out;
> -
> -	# If we have no compiler for the source program then skip it.
> -	[ -z "$compiler" ] && continue
> -
> -	additional_cflags=`sed '/@CFLAGS:/s/^.*: *//p;d' $test_case`
> -	[ -n "$additional_cflags" ] && cflags="$cflags $additional_cflags"
> -
> -	allow_minflags=`sed '/@ALLOW_MINFLAGS:/s/^.*: *//p;d' $test_case`
> -	[ -z "$allow_minflags" ] && allow_minflags="-n -m -l -e"
> -
> -	case $lang in
> -	c|c++|d)
> -		# Using genflags, get the allowed gen flags from the test case. If the
> -		# test case doesn't specify assume that all gen flags are allowed.
> -		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
> -		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1 -G0 -G1 -G2"
> -
> -		for min_opt in $minflags; do
> -			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
> -			for gen_opt in $genflags; do
> -				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
> -				run_test
> -			done
> -		done
> -	;;
> -
> -	java) 
> -		# Not interested in gen opt.
> -		gen_opt=""
> -		for min_opt in $minflags; do
> -			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
> -			run_test
> -		done
> -	;;
> -
> -	ruby) 
> -		# Using genflags, get the allowed gen flags from the test case. If the
> -		# test case doesn't specify assume that all gen flags are allowed.
> -		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
> -		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1"
> -
> -		for min_opt in $minflags; do
> -			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
> -
> -			for gen_opt in $genflags; do
> -				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
> -				run_test
> -			done
> -		done
> -	;;
> -
> -	csharp)
> -		# Using genflags, get the allowed gen flags from the test case. If the
> -		# test case doesn't specify assume that all gen flags are allowed.
> -		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
> -		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1 -G0 -G1"
> -
> -		for min_opt in $minflags; do
> -			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
> -			for gen_opt in $genflags; do
> -				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
> -				run_test
> -			done
> -		done
> -	;;
> -	esac
> -
> -done
> diff --git a/test/runtests.in b/test/runtests.in
> new file mode 100755
> index 0000000..ee14f6a
> --- /dev/null
> +++ b/test/runtests.in
> @@ -0,0 +1,320 @@
> +#!/bin/bash
> +
> +#
> +#   Copyright 2006 Adrian Thurston <thurs... at cs.queensu.ca>
> +#
> +
> +#   This file is part of Ragel.
> +#
> +#   Ragel is free software; you can redistribute it and/or modify
> +#   it under the terms of the GNU General Public License as published by
> +#   the Free Software Foundation; either version 2 of the License, or
> +#   (at your option) any later version.
> +#
> +#   Ragel is distributed in the hope that it will be useful,
> +#   but WITHOUT ANY WARRANTY; without even the implied warranty of
> +#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
> +#   GNU General Public License for more details.
> +#
> +#   You should have received a copy of the GNU General Public License
> +#   along with Ragel; if not, write to the Free Software
> +#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
> +
> +while getopts "gcnmleT:F:G:P:CDJRA" opt; do
> +	case $opt in
> +		T|F|G|P) 
> +			genflags="$genflags -$opt$OPTARG"
> +			options="$options -$opt$OPTARG"
> +			;;
> +		n|m|l|e) 
> +			minflags="$minflags -$opt"
> +			options="$options -$opt"
> +			;;
> +		c) 
> +			compile_only="true"
> +			options="$options -$opt"
> +			;;
> +		g) 
> +			allow_generated="true"
> +			;;
> +		C|D|J|R|A) 
> +			langflags="$langflags -$opt"
> +			;;
> +	esac
> +done
> +
> +[ -z "$minflags" ] && minflags="-n -m -l -e"
> +[ -z "$genflags" ] && genflags="-T0 -T1 -F0 -F1 -G0 -G1 -G2"
> +[ -z "$langflags" ] && langflags="-C -D -J -R -A"
> +
> +shift $((OPTIND - 1));
> +
> +[ -z "$*" ] && set -- *.rl
> +
> +config=../common/config.h
> +ragel=../ragel/ragel
> +
> +cxx_compiler=@CXX@
> +c_compiler=@CC@
> +objc_compiler=@GOBJC@
> +d_compiler=@GDC@
> +java_compiler=@JAVAC@
> +txl_engine=@TXL@
> +ruby_engine=@RUBY@
> +csharp_compiler=@GMCS@
> +
> +function test_error
> +{
> +	exit 1;
> +}
> +
> +#	split_objs=""
> +#	if test $split_iters != "$gen_opt"; then
> +#		n=0;
> +#		while test $n -lt $split_iters; do
> +#			part_root=${root}_`awk 'BEGIN {
> +#				width = 0;
> +#				high = '$split_iters' - 1;
> +#				while ( high > 0 ) {
> +#					width = width + 1;
> +#					high = int(high / 10);
> +#				}
> +#				suffFormat = "%" width "." width "d\n";
> +#				printf( suffFormat, '$n' );
> +#				exit 0;
> +#			}'`
> +#			part_src=${part_root}.c
> +#			part_bin=${part_root}.o
> +#			echo "$compiler -c $cflags -o $part_bin $part_src"
> +#			if ! $compiler -c $cflags -o $part_bin $part_src; then
> +#				test_error;
> +#			fi
> +#			split_objs="$split_objs $part_bin"
> +#			n=$((n+1))
> +#		done
> +#	fi
> +
> +function run_test()
> +{
> +	echo "$ragel $lang_opt $min_opt $gen_opt -o $code_src $test_case"
> +	if ! $ragel $lang_opt $min_opt $gen_opt -o $code_src $test_case; then
> +		test_error;
> +	fi
> +
> +	out_args=""
> +	[ $lang != java ] && out_args="-o ${binary}";
> +    [ $lang == csharp ] && out_args="-out:${binary}";
> +
> +	# Ruby doesn't need to be compiled.
> +	if [ $lang != ruby ]; then
> +		echo "$compiler ${cflags} ${out_args} ${code_src}"
> +		if ! $compiler ${cflags} ${out_args} ${code_src}; then
> +			test_error;
> +		fi
> +	fi
> +
> +	if [ "$compile_only" != "true" ]; then
> +		echo -n "running $root ... ";
> +		
> +		exec_cmd=./$binary
> +		[ $lang = java ] && exec_cmd="java ${root}"
> +		[ $lang = ruby ] && exec_cmd="ruby ${code_src}"
> +		[ $lang = csharp ] && exec_cmd="mono ${exec_cmd}"
> +
> +		$exec_cmd 2>&1 > $output;
> +		if diff $expected_out $output > /dev/null; then
> +			echo "passed";
> +		else
> +			echo "FAILED";
> +			test_error;
> +		fi;
> +	fi
> +}
> +
> +for test_case; do
> +	root=${test_case%.rl};
> +
> +	if ! [ -f "$test_case" ]; then
> +		echo "runtests: not a file: $test_case"; >&2
> +		exit 1;
> +	fi
> +
> +	# Check if we should ignore the test case
> +	ignore=`sed '/@IGNORE:/s/^.*: *//p;d' $test_case`
> +    if [ "$ignore" = yes ]; then
> +        continue;
> +    fi
> +
> +	# If the generated flag is given make sure that the test case is generated.
> +	is_generated=`sed '/@GENERATED:/s/^.*: *//p;d' $test_case`
> +	if [ "$is_generated" = yes ] && [ "$allow_generated" != true ]; then
> +		continue;
> +	fi
> +
> +	expected_out=$root.exp;
> +	sed '1,/_____OUTPUT_____/d;$d' $test_case > $expected_out
> +
> +	lang=`sed '/@LANG:/s/^.*: *//p;d' $test_case`
> +	if [ -z "$lang" ]; then
> +		echo "$test_case: language unset"; >&2
> +		exit 1;
> +	fi
> +
> +	case $lang in
> +		c++)
> +			lang_opt=-C;
> +			codegen=../rlgen-cd/rlgen-cd;
> +			code_suffix=cpp;
> +			compiler=$cxx_compiler;
> +			cflags="-pedantic -ansi -Wall -O3"
> +		;;
> +		d)
> +			lang_opt=-D;
> +			codegen=../rlgen-cd/rlgen-cd;
> +			code_suffix=d;
> +			compiler=$d_compiler;
> +			cflags="-Wall -O3"
> +		;;
> +		c)
> +			lang_opt=-C;
> +			codegen=../rlgen-cd/rlgen-cd;
> +			code_suffix=c;
> +			compiler=$c_compiler;
> +			cflags="-pedantic -ansi -Wall -O3"
> +		;;
> +		obj-c)
> +			lang_opt=-C;
> +			codegen=../rlgen-cd/rlgen-cd;
> +			code_suffix=m;
> +			compiler=$objc_compiler
> +			cflags="-Wall -O3 -fno-strict-aliasing -lobjc"
> +		;;
> +		java)
> +			lang_opt=-J;
> +			codegen=../rlgen-java/rlgen-java;
> +			code_suffix=java;
> +			compiler=$java_compiler
> +			cflags=""
> +		;;
> +		ruby)
> +			lang_opt=-R;
> +			codegen=../rlgen-ruby/rlgen-ruby;
> +			code_suffix=rb;
> +			compiler=$ruby_engine
> +			cflags=""
> +		;;
> +        csharp)
> +            lang_opt="-A";
> +            codegen=../rlgen-csharp/rlgen-csharp;
> +            code_suffix=cs;
> +            compiler=$csharp_compiler
> +            cflags=""
> +        ;;
> +		indep)
> +			lang_opt="";
> +
> +			# If we have no txl engine then skip this test.
> +			[ -z "$txl_engine" ] && continue
> +			for lang in c d java ruby csharp; do
> +				case $lang in 
> +					c) lf="-C";;
> +					d) lf="-D";;
> +					java) lf="-J";;
> +					ruby) lf="-R";;
> +                    csharp) lf="-A";;
> +				esac
> +
> +				echo "$langflags" | grep -e $lf >/dev/null || continue
> +
> +				targ=${root}_$lang.rl
> +				echo "./langtrans_$lang.sh $test_case > $targ"
> +				if ! ./langtrans_$lang.sh $test_case > $targ; then
> +					test_error
> +				fi
> +				echo "./runtests -g $options $targ"
> +				if !  ./runtests -g $options $targ; then
> +					test_error
> +				fi
> +			done
> +			continue;
> +		;;
> +		*)
> +			echo "$test_case: unknown language type $lang" >&2
> +			exit 1;
> +		;;
> +	esac
> +
> +	# Make sure that we are interested in the host language.
> +	echo "$langflags" | grep -e $lang_opt >/dev/null || continue
> +
> +	code_src=$root.$code_suffix;
> +	binary=$root.bin;
> +	output=$root.out;
> +
> +	# If we have no compiler for the source program then skip it.
> +	[ -z "$compiler" ] && continue
> +
> +	additional_cflags=`sed '/@CFLAGS:/s/^.*: *//p;d' $test_case`
> +	[ -n "$additional_cflags" ] && cflags="$cflags $additional_cflags"
> +
> +	allow_minflags=`sed '/@ALLOW_MINFLAGS:/s/^.*: *//p;d' $test_case`
> +	[ -z "$allow_minflags" ] && allow_minflags="-n -m -l -e"
> +
> +	case $lang in
> +	c|c++|d)
> +		# Using genflags, get the allowed gen flags from the test case. If the
> +		# test case doesn't specify assume that all gen flags are allowed.
> +		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
> +		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1 -G0 -G1 -G2"
> +
> +		for min_opt in $minflags; do
> +			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
> +			for gen_opt in $genflags; do
> +				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
> +				run_test
> +			done
> +		done
> +	;;
> +
> +	java) 
> +		# Not interested in gen opt.
> +		gen_opt=""
> +		for min_opt in $minflags; do
> +			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
> +			run_test
> +		done
> +	;;
> +
> +	ruby) 
> +		# Using genflags, get the allowed gen flags from the test case. If the
> +		# test case doesn't specify assume that all gen flags are allowed.
> +		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
> +		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1"
> +
> +		for min_opt in $minflags; do
> +			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
> +
> +			for gen_opt in $genflags; do
> +				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
> +				run_test
> +			done
> +		done
> +	;;
> +
> +	csharp)
> +		# Using genflags, get the allowed gen flags from the test case. If the
> +		# test case doesn't specify assume that all gen flags are allowed.
> +		allow_genflags=`sed '/@ALLOW_GENFLAGS:/s/^.*: *//p;d' $test_case`
> +		[ -z "$allow_genflags" ] && allow_genflags="-T0 -T1 -F0 -F1 -G0 -G1"
> +
> +		for min_opt in $minflags; do
> +			echo "$allow_minflags" | grep -e $min_opt >/dev/null || continue
> +			for gen_opt in $genflags; do
> +				echo "$allow_genflags" | grep -e $gen_opt >/dev/null || continue
> +				run_test
> +			done
> +		done
> +	;;
> +	esac
> +
> +done
> 
> 
> 


From flamee... at gmail.com  Wed Oct  1 14:37:30 2008
From: flamee... at gmail.com (Diego 'Flameeyes' =?utf-8?q?Petten=C3=B2?=)
Date: Wed, 01 Oct 2008 16:37:30 +0200
Subject: [PATCH 4/6] Remove need for version.mk file.
Message-ID: <20081001143729.22980.85186.stgit@yamato>

Use autoconf to generate version.tex and the man pages, instead of
using Makefile and version.mk. Also define PACKAGE_PUBDATE and
PACKAGE_VERSION through autoconf/autoheader.
---

 Makefile.in              |    2 --
 common/Makefile.in       |    6 +-----
 configure.in             |   12 ++++++++----
 doc/Makefile.in          |   14 ++------------
 doc/ragel.1.in           |    2 +-
 doc/rlgen-cd.1.in        |    2 +-
 doc/rlgen-dot.1.in       |    2 +-
 doc/rlgen-java.1.in      |    2 +-
 doc/rlgen-ruby.1.in      |    2 +-
 doc/version.tex.in       |    2 ++
 ragel/main.cpp           |    2 +-
 ragel/parsedata.cpp      |    4 ++--
 redfsm/Makefile.in       |    2 --
 redfsm/xmlparse.kl       |    2 +-
 rlgen-cd/Makefile.in     |    2 --
 rlgen-csharp/Makefile.in |    2 --
 rlgen-csharp/main.cpp    |    2 +-
 rlgen-dot/Makefile.in    |    2 --
 rlgen-java/Makefile.in   |    2 --
 rlgen-ruby/Makefile.in   |    2 --
 version.mk               |    2 --
 21 files changed, 23 insertions(+), 47 deletions(-)
 create mode 100644 doc/version.tex.in
 delete mode 100644 version.mk

diff --git a/Makefile.in b/Makefile.in
index 2666c48..4619bb5 100644
--- a/Makefile.in
+++ b/Makefile.in
@@ -27,8 +27,6 @@ ALL_SUBDIRS = $(BUILD_COMMON) $(BUILD_SUBDIRS) test examples doc
 # Programs
 CXX = @CXX@
 
-# Get the version info.
-include version.mk
 
 # build targets
 all: $(BUILD_SUBDIRS)
diff --git a/common/Makefile.in b/common/Makefile.in
index 112e59c..e79d6a4 100644
--- a/common/Makefile.in
+++ b/common/Makefile.in
@@ -40,8 +40,6 @@ RANLIB = @RANLIB@
 OBJS = $(CC_SRCS:%.cpp=%.o)
 DEPS = $(CC_SRCS:%.cpp=.%.d)
 
-# Get the version info.
-include ../version.mk
 
 # rules
 
@@ -51,9 +49,7 @@ common.a: $(GEN_SRC) $(OBJS)
 	$(AR) -cr $@ $(OBJS) 
 	$(RANLIB) $@
 
-version.h: ../version.mk
-	echo '#define VERSION "$(VERSION)"' > version.h
-	echo '#define PUBDATE "$(PUBDATE)"' >> version.h
+version.h:
 	echo '#define PREFIX "$(prefix)"' >> version.h
 
 %.o: %.cpp
diff --git a/configure.in b/configure.in
index 3995551..85e93b0 100644
--- a/configure.in
+++ b/configure.in
@@ -16,11 +16,15 @@ dnl   GNU General Public License for more details.
 dnl   
 dnl   You should have received a copy of the GNU General Public License
 dnl   along with Ragel; if not, write to the Free Software
-dnl   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
-  
-AC_INIT(ragel/main.cpp)
+dnl   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+
+AC_INIT(ragel/main.cpp, 6.3)
 AC_CONFIG_HEADER(common/config.h)
 
+PACKAGE_PUBDATE="August 2008"
+AC_SUBST(PACKAGE_PUBDATE)
+AC_DEFINE_UNQUOTED([PACKAGE_PUBDATE], ["$PACKAGE_PUBDATE"], [Package publication date])
+
 dnl You need to enable this unless the generated files are included
 dnl and don't need to be built.
 AC_ARG_ENABLE([parsers],
@@ -107,6 +111,6 @@ AC_CHECK_PROG(GMCS, gmcs, gmcs)
 AC_SUBST(GMCS)
 
 dnl write output files
-AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile test/runtests)
+AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile test/runtests doc/ragel.1 doc/rlgen-cd.1 doc/rlgen-java.1 doc/rlgen-ruby.1 doc/rlgen-dot.1 doc/version.tex)
 
 echo "configuration of ragel complete"
diff --git a/doc/Makefile.in b/doc/Makefile.in
index a6ff456..6178f0d 100644
--- a/doc/Makefile.in
+++ b/doc/Makefile.in
@@ -24,8 +24,6 @@ INPUT = version.tex ragel-guide.tex
 FIGURES = $(wildcard *.fig)
 PDFFIGS = $(FIGURES:%.fig=%.pdf)
 
-# Get the version info.
-include ../version.mk
 
 # Installation locations.
 PACKAGE     = ragel
@@ -49,19 +47,11 @@ ragel-guide.pdf: $(PDFFIGS) $(INPUT)
 	pdflatex -interaction=nonstopmode $< >/dev/null
 	pdflatex -interaction=nonstopmode $< >/dev/null
 
-version.tex: ../version.mk
-	echo '|def|version{$(VERSION)}' | tr '|' '\\' > version.tex
-	echo '|def|pubdate{$(PUBDATE)}' | tr '|' '\\' >> version.tex
-
-%.1: %.1.in ../version.mk
-	cat $< | sed 's/@PUBDATE@/$(PUBDATE)/' \
-		| sed 's/@VERSION@/$(VERSION)/' > $@
-
 clean:
-	rm -f $(MANPAGES) *.bak *.aux *.dvi *.log *.toc *.pdf
+	rm -f *.bak *.aux *.dvi *.log *.toc *.pdf
 
 distclean: clean
-	rm -f Makefile
+	rm -f Makefile $(MANPAGES) version.tex
 
 man: $(MANPAGES)
 
diff --git a/doc/ragel.1.in b/doc/ragel.1.in
index 68142e2..66753cc 100644
--- a/doc/ragel.1.in
+++ b/doc/ragel.1.in
@@ -21,7 +21,7 @@
 .\"   Process this file with
 .\"   groff -man -Tascii ragel.1
 .\"
-.TH RAGEL 1 "@PUBDATE@" "Ragel @VERSION@" "Ragel State Machine Compiler"
+.TH RAGEL 1 "@PACKAGE_PUBDATE@" "Ragel @PACKAGE_VERSION@" "Ragel State Machine Compiler"
 .SH NAME
 ragel \- compile regular languages into executable state machines 
 .SH SYNOPSIS
diff --git a/doc/rlgen-cd.1.in b/doc/rlgen-cd.1.in
index 33cc088..0d0087f 100644
--- a/doc/rlgen-cd.1.in
+++ b/doc/rlgen-cd.1.in
@@ -21,7 +21,7 @@
 .\"   Process this file with
 .\"   groff -man -Tascii rlgen-cd.1
 .\"
-.TH RLGEN-CD 1 "@PUBDATE@" "Ragel @VERSION@" "Ragel State Machine Compiler"
+.TH RLGEN-CD 1 "@PACKAGE_PUBDATE@" "Ragel @PACKAGE_VERSION@" "Ragel State Machine Compiler"
 .SH NAME
 rlgen-cd \- code generator for Ragel State Machine Compiler
 .SH SYNOPSIS
diff --git a/doc/rlgen-dot.1.in b/doc/rlgen-dot.1.in
index 5c24091..c7a7cbe 100644
--- a/doc/rlgen-dot.1.in
+++ b/doc/rlgen-dot.1.in
@@ -21,7 +21,7 @@
 .\"   Process this file with
 .\"   groff -man -Tascii rlgen-dot.1
 .\"
-.TH RLGEN-DOT 1 "@PUBDATE@" "Ragel @VERSION@" "Ragel State Machine Compiler"
+.TH RLGEN-DOT 1 "@PACKAGE_PUBDATE@" "Ragel @PACKAGE_VERSION@" "Ragel State Machine Compiler"
 .SH NAME
 rlgen-dot \- Dotfile generator for Ragel State Machine Compiler
 .SH SYNOPSIS
diff --git a/doc/rlgen-java.1.in b/doc/rlgen-java.1.in
index c143d15..5528a2f 100644
--- a/doc/rlgen-java.1.in
+++ b/doc/rlgen-java.1.in
@@ -21,7 +21,7 @@
 .\"   Process this file with
 .\"   groff -man -Tascii rlgen-java.1
 .\"
-.TH RLGEN-JAVA 1 "@PUBDATE@" "Ragel @VERSION@" "Ragel State Machine Compiler"
+.TH RLGEN-JAVA 1 "@PACKAGE_PUBDATE@" "Ragel @PACKAGE_VERSION@" "Ragel State Machine Compiler"
 .SH NAME
 rlgen-java \- code generator for Ragel State Machine Compiler
 .SH SYNOPSIS
diff --git a/doc/rlgen-ruby.1.in b/doc/rlgen-ruby.1.in
index 9aecfe2..08f1dce 100644
--- a/doc/rlgen-ruby.1.in
+++ b/doc/rlgen-ruby.1.in
@@ -21,7 +21,7 @@
 .\"   Process this file with
 .\"   groff -man -Tascii rlgen-ruby.1
 .\"
-.TH RLGEN-RUBY 1 "@PUBDATE@" "Ragel @VERSION@" "Ragel State Machine Compiler"
+.TH RLGEN-RUBY 1 "@PACKAGE_PUBDATE@" "Ragel @PACKAGE_VERSION@" "Ragel State Machine Compiler"
 .SH NAME
 rlgen-ruby \- code generator for Ragel State Machine Compiler
 .SH SYNOPSIS
diff --git a/doc/version.tex.in b/doc/version.tex.in
new file mode 100644
index 0000000..3c0fc35
--- /dev/null
+++ b/doc/version.tex.in
@@ -0,0 +1,2 @@
+\def\version{@PACKAGE_VERSION@}
+\def\pubdate{@PACKAGE_PUBDATE@}
diff --git a/ragel/main.cpp b/ragel/main.cpp
index 1e7ccc0..56095db 100644
--- a/ragel/main.cpp
+++ b/ragel/main.cpp
@@ -153,7 +153,7 @@ void usage()
 /* Print version information and exit. */
 void version()
 {
-	cout << "Ragel State Machine Compiler version " VERSION << " " PUBDATE << endl <<
+	cout << "Ragel State Machine Compiler version " PACKAGE_VERSION " " PACKAGE_PUBDATE << endl <<
 			"Copyright (c) 2001-2007 by Adrian Thurston" << endl;
 	exit(0);
 }
diff --git a/ragel/parsedata.cpp b/ragel/parsedata.cpp
index 73f52c6..3985b2f 100644
--- a/ragel/parsedata.cpp
+++ b/ragel/parsedata.cpp
@@ -1482,7 +1482,7 @@ void writeMachines( std::ostream &out, std::string hostData,
 		}
 
 		if ( gblErrorCount == 0 ) {
-			out << "<ragel version=\"" VERSION "\" filename=\"" << inputFileName << "\"";
+			out << "<ragel version=\"" PACKAGE_VERSION "\" filename=\"" << inputFileName << "\"";
 			writeLanguage( out );
 			out << ">\n";
 			for ( ParserDict::Iter parser = parserDict; parser.lte(); parser++ ) {
@@ -1523,7 +1523,7 @@ void writeMachines( std::ostream &out, std::string hostData,
 			/* Section/Machine to emit was found. Prepare and emit it. */
 			parseData->prepareMachineGen( graphDictEl );
 			if ( gblErrorCount == 0 ) {
-				out << "<ragel version=\"" VERSION "\" filename=\"" << inputFileName << "\"";
+				out << "<ragel version=\"" PACKAGE_VERSION "\" filename=\"" << inputFileName << "\"";
 				writeLanguage( out );
 				out << ">\n";
 				parseData->generateXML( out );
diff --git a/redfsm/Makefile.in b/redfsm/Makefile.in
index 951de79..8e67233 100644
--- a/redfsm/Makefile.in
+++ b/redfsm/Makefile.in
@@ -41,8 +41,6 @@ RANLIB = @RANLIB@
 OBJS = $(CC_SRCS:%.cpp=%.o)
 DEPS = $(CC_SRCS:%.cpp=.%.d)
 
-# Get the version info.
-include ../version.mk
 
 # Rules.
 all: redfsm.a
diff --git a/redfsm/xmlparse.kl b/redfsm/xmlparse.kl
index e725fcc..6ce677a 100644
--- a/redfsm/xmlparse.kl
+++ b/redfsm/xmlparse.kl
@@ -108,7 +108,7 @@ tag_ragel_head: TAG_ragel
 		Attribute *versionAttr = $1->tag->findAttr( "version" );
 		if ( versionAttr == 0 )
 			error($1->loc) << "tag <ragel> requires a version attribute" << endp;
-		if ( strcmp( versionAttr->value, VERSION ) != 0 )
+		if ( strcmp( versionAttr->value, PACKAGE_VERSION ) != 0 )
 			error($1->loc) << "version mismatch between frontend and backend" << endp;
 
 		/* Check for file name attribute. */
diff --git a/rlgen-cd/Makefile.in b/rlgen-cd/Makefile.in
index 49031e3..7b06285 100644
--- a/rlgen-cd/Makefile.in
+++ b/rlgen-cd/Makefile.in
@@ -45,8 +45,6 @@ RANLIB = @RANLIB@
 OBJS = $(CC_SRCS:%.cpp=%.o)
 DEPS = $(CC_SRCS:%.cpp=.%.d)
 
-# Get the version info.
-include ../version.mk
 
 # Rules.
 all: rlgen-cd.a
diff --git a/rlgen-csharp/Makefile.in b/rlgen-csharp/Makefile.in
index fa57e49..fc5380f 100644
--- a/rlgen-csharp/Makefile.in
+++ b/rlgen-csharp/Makefile.in
@@ -45,8 +45,6 @@ RANLIB = @RANLIB@
 OBJS = $(CC_SRCS:%.cpp=%.o)
 DEPS = $(CC_SRCS:%.cpp=.%.d)
 
-# Get the version info.
-include ../version.mk
 
 # Rules.
 all: rlgen-csharp.a
diff --git a/rlgen-csharp/main.cpp b/rlgen-csharp/main.cpp
index 1a78848..8a6fa4b 100644
--- a/rlgen-csharp/main.cpp
+++ b/rlgen-csharp/main.cpp
@@ -92,7 +92,7 @@ void csharp_usage()
 void csharp_version()
 {
 	cout << "Ragel Code Generator for C#" << endl <<
-			"Version " VERSION << ", " PUBDATE << endl <<
+			"Version " PACKAGE_VERSION ", " PACKAGE_PUBDATE << endl <<
 			"Copyright (c) 2001-2007 by Adrian Thurston" << endl;
 }
 
diff --git a/rlgen-dot/Makefile.in b/rlgen-dot/Makefile.in
index 5d33931..c5611c2 100644
--- a/rlgen-dot/Makefile.in
+++ b/rlgen-dot/Makefile.in
@@ -41,8 +41,6 @@ RANLIB = @RANLIB@
 OBJS = $(CC_SRCS:%.cpp=%.o)
 DEPS = $(CC_SRCS:%.cpp=.%.d)
 
-# Get the version info.
-include ../version.mk
 
 # Rules.
 all: rlgen-dot.a
diff --git a/rlgen-java/Makefile.in b/rlgen-java/Makefile.in
index 2fe5cd7..c429dde 100644
--- a/rlgen-java/Makefile.in
+++ b/rlgen-java/Makefile.in
@@ -42,8 +42,6 @@ RANLIB = @RANLIB@
 OBJS = $(CC_SRCS:%.cpp=%.o)
 DEPS = $(CC_SRCS:%.cpp=.%.d)
 
-# Get the version info.
-include ../version.mk
 
 # Rules.
 all: rlgen-java.a
diff --git a/rlgen-ruby/Makefile.in b/rlgen-ruby/Makefile.in
index a0a2d52..96d5399 100644
--- a/rlgen-ruby/Makefile.in
+++ b/rlgen-ruby/Makefile.in
@@ -43,8 +43,6 @@ RANLIB = @RANLIB@
 OBJS = $(CC_SRCS:%.cpp=%.o)
 DEPS = $(CC_SRCS:%.cpp=.%.d)
 
-# Get the version info.
-include ../version.mk
 
 # Rules.
 all: rlgen-ruby.a
diff --git a/version.mk b/version.mk
deleted file mode 100644
index 12353fa..0000000
--- a/version.mk
+++ /dev/null
@@ -1,2 +0,0 @@
-VERSION = 6.3
-PUBDATE = August 2008


From thurs... at cs.queensu.ca  Mon Oct  6 17:34:21 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Mon, 06 Oct 2008 13:34:21 -0400
Subject: [ragel-users] [PATCH 4/6] Remove need for version.mk file.
In-Reply-To: <20081001143729.22980.85186.stgit@yamato>
References: <20081001143729.22980.85186.stgit@yamato>
Message-ID: <48EA4C1D.3000806@cs.queensu.ca>

Again, is there a reason why this is better?

-Adrian

Diego 'Flameeyes' Petten wrote:
> Use autoconf to generate version.tex and the man pages, instead of
> using Makefile and version.mk. Also define PACKAGE_PUBDATE and
> PACKAGE_VERSION through autoconf/autoheader.
> ---
> 
>  Makefile.in              |    2 --
>  common/Makefile.in       |    6 +-----
>  configure.in             |   12 ++++++++----
>  doc/Makefile.in          |   14 ++------------
>  doc/ragel.1.in           |    2 +-
>  doc/rlgen-cd.1.in        |    2 +-
>  doc/rlgen-dot.1.in       |    2 +-
>  doc/rlgen-java.1.in      |    2 +-
>  doc/rlgen-ruby.1.in      |    2 +-
>  doc/version.tex.in       |    2 ++
>  ragel/main.cpp           |    2 +-
>  ragel/parsedata.cpp      |    4 ++--
>  redfsm/Makefile.in       |    2 --
>  redfsm/xmlparse.kl       |    2 +-
>  rlgen-cd/Makefile.in     |    2 --
>  rlgen-csharp/Makefile.in |    2 --
>  rlgen-csharp/main.cpp    |    2 +-
>  rlgen-dot/Makefile.in    |    2 --
>  rlgen-java/Makefile.in   |    2 --
>  rlgen-ruby/Makefile.in   |    2 --
>  version.mk               |    2 --
>  21 files changed, 23 insertions(+), 47 deletions(-)
>  create mode 100644 doc/version.tex.in
>  delete mode 100644 version.mk
> 
> diff --git a/Makefile.in b/Makefile.in
> index 2666c48..4619bb5 100644
> --- a/Makefile.in
> +++ b/Makefile.in
> @@ -27,8 +27,6 @@ ALL_SUBDIRS = $(BUILD_COMMON) $(BUILD_SUBDIRS) test examples doc
>  # Programs
>  CXX = @CXX@
>  
> -# Get the version info.
> -include version.mk
>  
>  # build targets
>  all: $(BUILD_SUBDIRS)
> diff --git a/common/Makefile.in b/common/Makefile.in
> index 112e59c..e79d6a4 100644
> --- a/common/Makefile.in
> +++ b/common/Makefile.in
> @@ -40,8 +40,6 @@ RANLIB = @RANLIB@
>  OBJS = $(CC_SRCS:%.cpp=%.o)
>  DEPS = $(CC_SRCS:%.cpp=.%.d)
>  
> -# Get the version info.
> -include ../version.mk
>  
>  # rules
>  
> @@ -51,9 +49,7 @@ common.a: $(GEN_SRC) $(OBJS)
>  	$(AR) -cr $@ $(OBJS) 
>  	$(RANLIB) $@
>  
> -version.h: ../version.mk
> -	echo '#define VERSION "$(VERSION)"' > version.h
> -	echo '#define PUBDATE "$(PUBDATE)"' >> version.h
> +version.h:
>  	echo '#define PREFIX "$(prefix)"' >> version.h
>  
>  %.o: %.cpp
> diff --git a/configure.in b/configure.in
> index 3995551..85e93b0 100644
> --- a/configure.in
> +++ b/configure.in
> @@ -16,11 +16,15 @@ dnl   GNU General Public License for more details.
>  dnl   
>  dnl   You should have received a copy of the GNU General Public License
>  dnl   along with Ragel; if not, write to the Free Software
> -dnl   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
> -  
> -AC_INIT(ragel/main.cpp)
> +dnl   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
> +
> +AC_INIT(ragel/main.cpp, 6.3)
>  AC_CONFIG_HEADER(common/config.h)
>  
> +PACKAGE_PUBDATE="August 2008"
> +AC_SUBST(PACKAGE_PUBDATE)
> +AC_DEFINE_UNQUOTED([PACKAGE_PUBDATE], ["$PACKAGE_PUBDATE"], [Package publication date])
> +
>  dnl You need to enable this unless the generated files are included
>  dnl and don't need to be built.
>  AC_ARG_ENABLE([parsers],
> @@ -107,6 +111,6 @@ AC_CHECK_PROG(GMCS, gmcs, gmcs)
>  AC_SUBST(GMCS)
>  
>  dnl write output files
> -AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile test/runtests)
> +AC_OUTPUT(Makefile common/Makefile ragel/Makefile redfsm/Makefile rlgen-cd/Makefile rlgen-java/Makefile rlgen-ruby/Makefile rlgen-dot/Makefile rlgen-csharp/Makefile doc/Makefile test/Makefile test/runtests doc/ragel.1 doc/rlgen-cd.1 doc/rlgen-java.1 doc/rlgen-ruby.1 doc/rlgen-dot.1 doc/version.tex)
>  
>  echo "configuration of ragel complete"
> diff --git a/doc/Makefile.in b/doc/Makefile.in
> index a6ff456..6178f0d 100644
> --- a/doc/Makefile.in
> +++ b/doc/Makefile.in
> @@ -24,8 +24,6 @@ INPUT = version.tex ragel-guide.tex
>  FIGURES = $(wildcard *.fig)
>  PDFFIGS = $(FIGURES:%.fig=%.pdf)
>  
> -# Get the version info.
> -include ../version.mk
>  
>  # Installation locations.
>  PACKAGE     = ragel
> @@ -49,19 +47,11 @@ ragel-guide.pdf: $(PDFFIGS) $(INPUT)
>  	pdflatex -interaction=nonstopmode $< >/dev/null
>  	pdflatex -interaction=nonstopmode $< >/dev/null
>  
> -version.tex: ../version.mk
> -	echo '|def|version{$(VERSION)}' | tr '|' '\\' > version.tex
> -	echo '|def|pubdate{$(PUBDATE)}' | tr '|' '\\' >> version.tex
> -
> -%.1: %.1.in ../version.mk
> -	cat $< | sed 's/@PUBDATE@/$(PUBDATE)/' \
> -		| sed 's/@VERSION@/$(VERSION)/' > $@
> -
>  clean:
> -	rm -f $(MANPAGES) *.bak *.aux *.dvi *.log *.toc *.pdf
> +	rm -f *.bak *.aux *.dvi *.log *.toc *.pdf
>  
>  distclean: clean
> -	rm -f Makefile
> +	rm -f Makefile $(MANPAGES) version.tex
>  
>  man: $(MANPAGES)
>  
> diff --git a/doc/ragel.1.in b/doc/ragel.1.in
> index 68142e2..66753cc 100644
> --- a/doc/ragel.1.in
> +++ b/doc/ragel.1.in
> @@ -21,7 +21,7 @@
>  .\"   Process this file with
>  .\"   groff -man -Tascii ragel.1
>  .\"
> -.TH RAGEL 1 "@PUBDATE@" "Ragel @VERSION@" "Ragel State Machine Compiler"
> +.TH RAGEL 1 "@PACKAGE_PUBDATE@" "Ragel @PACKAGE_VERSION@" "Ragel State Machine Compiler"
>  .SH NAME
>  ragel \- compile regular languages into executable state machines 
>  .SH SYNOPSIS
> diff --git a/doc/rlgen-cd.1.in b/doc/rlgen-cd.1.in
> index 33cc088..0d0087f 100644
> --- a/doc/rlgen-cd.1.in
> +++ b/doc/rlgen-cd.1.in
> @@ -21,7 +21,7 @@
>  .\"   Process this file with
>  .\"   groff -man -Tascii rlgen-cd.1
>  .\"
> -.TH RLGEN-CD 1 "@PUBDATE@" "Ragel @VERSION@" "Ragel State Machine Compiler"
> +.TH RLGEN-CD 1 "@PACKAGE_PUBDATE@" "Ragel @PACKAGE_VERSION@" "Ragel State Machine Compiler"
>  .SH NAME
>  rlgen-cd \- code generator for Ragel State Machine Compiler
>  .SH SYNOPSIS
> diff --git a/doc/rlgen-dot.1.in b/doc/rlgen-dot.1.in
> index 5c24091..c7a7cbe 100644
> --- a/doc/rlgen-dot.1.in
> +++ b/doc/rlgen-dot.1.in
> @@ -21,7 +21,7 @@
>  .\"   Process this file with
>  .\"   groff -man -Tascii rlgen-dot.1
>  .\"
> -.TH RLGEN-DOT 1 "@PUBDATE@" "Ragel @VERSION@" "Ragel State Machine Compiler"
> +.TH RLGEN-DOT 1 "@PACKAGE_PUBDATE@" "Ragel @PACKAGE_VERSION@" "Ragel State Machine Compiler"
>  .SH NAME
>  rlgen-dot \- Dotfile generator for Ragel State Machine Compiler
>  .SH SYNOPSIS
> diff --git a/doc/rlgen-java.1.in b/doc/rlgen-java.1.in
> index c143d15..5528a2f 100644
> --- a/doc/rlgen-java.1.in
> +++ b/doc/rlgen-java.1.in
> @@ -21,7 +21,7 @@
>  .\"   Process this file with
>  .\"   groff -man -Tascii rlgen-java.1
>  .\"
> -.TH RLGEN-JAVA 1 "@PUBDATE@" "Ragel @VERSION@" "Ragel State Machine Compiler"
> +.TH RLGEN-JAVA 1 "@PACKAGE_PUBDATE@" "Ragel @PACKAGE_VERSION@" "Ragel State Machine Compiler"
>  .SH NAME
>  rlgen-java \- code generator for Ragel State Machine Compiler
>  .SH SYNOPSIS
> diff --git a/doc/rlgen-ruby.1.in b/doc/rlgen-ruby.1.in
> index 9aecfe2..08f1dce 100644
> --- a/doc/rlgen-ruby.1.in
> +++ b/doc/rlgen-ruby.1.in
> @@ -21,7 +21,7 @@
>  .\"   Process this file with
>  .\"   groff -man -Tascii rlgen-ruby.1
>  .\"
> -.TH RLGEN-RUBY 1 "@PUBDATE@" "Ragel @VERSION@" "Ragel State Machine Compiler"
> +.TH RLGEN-RUBY 1 "@PACKAGE_PUBDATE@" "Ragel @PACKAGE_VERSION@" "Ragel State Machine Compiler"
>  .SH NAME
>  rlgen-ruby \- code generator for Ragel State Machine Compiler
>  .SH SYNOPSIS
> diff --git a/doc/version.tex.in b/doc/version.tex.in
> new file mode 100644
> index 0000000..3c0fc35
> --- /dev/null
> +++ b/doc/version.tex.in
> @@ -0,0 +1,2 @@
> +\def\version{@PACKAGE_VERSION@}
> +\def\pubdate{@PACKAGE_PUBDATE@}
> diff --git a/ragel/main.cpp b/ragel/main.cpp
> index 1e7ccc0..56095db 100644
> --- a/ragel/main.cpp
> +++ b/ragel/main.cpp
> @@ -153,7 +153,7 @@ void usage()
>  /* Print version information and exit. */
>  void version()
>  {
> -	cout << "Ragel State Machine Compiler version " VERSION << " " PUBDATE << endl <<
> +	cout << "Ragel State Machine Compiler version " PACKAGE_VERSION " " PACKAGE_PUBDATE << endl <<
>  			"Copyright (c) 2001-2007 by Adrian Thurston" << endl;
>  	exit(0);
>  }
> diff --git a/ragel/parsedata.cpp b/ragel/parsedata.cpp
> index 73f52c6..3985b2f 100644
> --- a/ragel/parsedata.cpp
> +++ b/ragel/parsedata.cpp
> @@ -1482,7 +1482,7 @@ void writeMachines( std::ostream &out, std::string hostData,
>  		}
>  
>  		if ( gblErrorCount == 0 ) {
> -			out << "<ragel version=\"" VERSION "\" filename=\"" << inputFileName << "\"";
> +			out << "<ragel version=\"" PACKAGE_VERSION "\" filename=\"" << inputFileName << "\"";
>  			writeLanguage( out );
>  			out << ">\n";
>  			for ( ParserDict::Iter parser = parserDict; parser.lte(); parser++ ) {
> @@ -1523,7 +1523,7 @@ void writeMachines( std::ostream &out, std::string hostData,
>  			/* Section/Machine to emit was found. Prepare and emit it. */
>  			parseData->prepareMachineGen( graphDictEl );
>  			if ( gblErrorCount == 0 ) {
> -				out << "<ragel version=\"" VERSION "\" filename=\"" << inputFileName << "\"";
> +				out << "<ragel version=\"" PACKAGE_VERSION "\" filename=\"" << inputFileName << "\"";
>  				writeLanguage( out );
>  				out << ">\n";
>  				parseData->generateXML( out );
> diff --git a/redfsm/Makefile.in b/redfsm/Makefile.in
> index 951de79..8e67233 100644
> --- a/redfsm/Makefile.in
> +++ b/redfsm/Makefile.in
> @@ -41,8 +41,6 @@ RANLIB = @RANLIB@
>  OBJS = $(CC_SRCS:%.cpp=%.o)
>  DEPS = $(CC_SRCS:%.cpp=.%.d)
>  
> -# Get the version info.
> -include ../version.mk
>  
>  # Rules.
>  all: redfsm.a
> diff --git a/redfsm/xmlparse.kl b/redfsm/xmlparse.kl
> index e725fcc..6ce677a 100644
> --- a/redfsm/xmlparse.kl
> +++ b/redfsm/xmlparse.kl
> @@ -108,7 +108,7 @@ tag_ragel_head: TAG_ragel
>  		Attribute *versionAttr = $1->tag->findAttr( "version" );
>  		if ( versionAttr == 0 )
>  			error($1->loc) << "tag <ragel> requires a version attribute" << endp;
> -		if ( strcmp( versionAttr->value, VERSION ) != 0 )
> +		if ( strcmp( versionAttr->value, PACKAGE_VERSION ) != 0 )
>  			error($1->loc) << "version mismatch between frontend and backend" << endp;
>  
>  		/* Check for file name attribute. */
> diff --git a/rlgen-cd/Makefile.in b/rlgen-cd/Makefile.in
> index 49031e3..7b06285 100644
> --- a/rlgen-cd/Makefile.in
> +++ b/rlgen-cd/Makefile.in
> @@ -45,8 +45,6 @@ RANLIB = @RANLIB@
>  OBJS = $(CC_SRCS:%.cpp=%.o)
>  DEPS = $(CC_SRCS:%.cpp=.%.d)
>  
> -# Get the version info.
> -include ../version.mk
>  
>  # Rules.
>  all: rlgen-cd.a
> diff --git a/rlgen-csharp/Makefile.in b/rlgen-csharp/Makefile.in
> index fa57e49..fc5380f 100644
> --- a/rlgen-csharp/Makefile.in
> +++ b/rlgen-csharp/Makefile.in
> @@ -45,8 +45,6 @@ RANLIB = @RANLIB@
>  OBJS = $(CC_SRCS:%.cpp=%.o)
>  DEPS = $(CC_SRCS:%.cpp=.%.d)
>  
> -# Get the version info.
> -include ../version.mk
>  
>  # Rules.
>  all: rlgen-csharp.a
> diff --git a/rlgen-csharp/main.cpp b/rlgen-csharp/main.cpp
> index 1a78848..8a6fa4b 100644
> --- a/rlgen-csharp/main.cpp
> +++ b/rlgen-csharp/main.cpp
> @@ -92,7 +92,7 @@ void csharp_usage()
>  void csharp_version()
>  {
>  	cout << "Ragel Code Generator for C#" << endl <<
> -			"Version " VERSION << ", " PUBDATE << endl <<
> +			"Version " PACKAGE_VERSION ", " PACKAGE_PUBDATE << endl <<
>  			"Copyright (c) 2001-2007 by Adrian Thurston" << endl;
>  }
>  
> diff --git a/rlgen-dot/Makefile.in b/rlgen-dot/Makefile.in
> index 5d33931..c5611c2 100644
> --- a/rlgen-dot/Makefile.in
> +++ b/rlgen-dot/Makefile.in
> @@ -41,8 +41,6 @@ RANLIB = @RANLIB@
>  OBJS = $(CC_SRCS:%.cpp=%.o)
>  DEPS = $(CC_SRCS:%.cpp=.%.d)
>  
> -# Get the version info.
> -include ../version.mk
>  
>  # Rules.
>  all: rlgen-dot.a
> diff --git a/rlgen-java/Makefile.in b/rlgen-java/Makefile.in
> index 2fe5cd7..c429dde 100644
> --- a/rlgen-java/Makefile.in
> +++ b/rlgen-java/Makefile.in
> @@ -42,8 +42,6 @@ RANLIB = @RANLIB@
>  OBJS = $(CC_SRCS:%.cpp=%.o)
>  DEPS = $(CC_SRCS:%.cpp=.%.d)
>  
> -# Get the version info.
> -include ../version.mk
>  
>  # Rules.
>  all: rlgen-java.a
> diff --git a/rlgen-ruby/Makefile.in b/rlgen-ruby/Makefile.in
> index a0a2d52..96d5399 100644
> --- a/rlgen-ruby/Makefile.in
> +++ b/rlgen-ruby/Makefile.in
> @@ -43,8 +43,6 @@ RANLIB = @RANLIB@
>  OBJS = $(CC_SRCS:%.cpp=%.o)
>  DEPS = $(CC_SRCS:%.cpp=.%.d)
>  
> -# Get the version info.
> -include ../version.mk
>  
>  # Rules.
>  all: rlgen-ruby.a
> diff --git a/version.mk b/version.mk
> deleted file mode 100644
> index 12353fa..0000000
> --- a/version.mk
> +++ /dev/null
> @@ -1,2 +0,0 @@
> -VERSION = 6.3
> -PUBDATE = August 2008
> 
> 
> 


From rober... at semistable.com  Thu Oct  2 10:07:10 2008
From: rober... at semistable.com (robertle)
Date: Thu, 2 Oct 2008 03:07:10 -0700 (PDT)
Subject: multiple output files
Message-ID: <eba28db2-9b38-4cd6-babd-6dc252906a3f@m3g2000hsc.googlegroups.com>

hi folks,

i asked this on irc, but wasn't able to stick around, sorry for the
duplication.

anyway: is there a way to generate multiple output files from one
ragel file? i am generating c++ classes that encapsulate a state
machine, and in the moment i have one .rl file and one .h file for
each machine. this is ok, but it would be very neat if i could just
include the .h declarations in the .rl file...


From thurs... at cs.queensu.ca  Mon Oct  6 17:39:37 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Mon, 06 Oct 2008 13:39:37 -0400
Subject: [ragel-users] multiple output files
In-Reply-To: <eba28db2-9b38-4cd6-babd-6dc252906a3f@m3g2000hsc.googlegroups.com>
References: <eba28db2-9b38-4cd6-babd-6dc252906a3f@m3g2000hsc.googlegroups.com>
Message-ID: <48EA4D59.4000904@cs.queensu.ca>

Hi Robert,

Ragel used to behave that way. You had one .rl file and it would spit 
out code and a header for you, but I fond it to be a pain to write 
makefiles. Now the model is one input file, one output file.

-Adrian

robertle wrote:
> hi folks,
> 
> i asked this on irc, but wasn't able to stick around, sorry for the
> duplication.
> 
> anyway: is there a way to generate multiple output files from one
> ragel file? i am generating c++ classes that encapsulate a state
> machine, and in the moment i have one .rl file and one .h file for
> each machine. this is ok, but it would be very neat if i could just
> include the .h declarations in the .rl file...
> 
> thanks  robert
> 


From thurs... at cs.queensu.ca  Tue Oct  7 04:59:56 2008
From: thurs... at cs.queensu.ca (Adrian Thurston)
Date: Tue, 07 Oct 2008 00:59:56 -0400
Subject: new mailing list
Message-ID: <48EAECCC.1080403@cs.queensu.ca>

Hi Everyone,

As many of you have noticed Ragel has a new home at:

http://www.complang.org/ragel/

This is a new machine for me and I can put anything I want on it, 
including mailing lists. A number of people have expressed an interest 
in a mailing list that is 'independent' and so it is time to move the 
list to this new server. The web home of the new list is at:

http://www.complang.org/mailman/listinfo/ragel-users

I have not subscribed anyone to this list.

Regards,
  Adrian


From thurston at complang.org  Tue Oct  7 04:28:31 2008
From: thurston at complang.org (Adrian Thurston)
Date: Tue, 07 Oct 2008 00:28:31 -0400
Subject: [ragel-users] first message
Message-ID: <48EAE56F.1000209@complang.org>

first message



From thurston at complang.org  Tue Oct  7 04:36:33 2008
From: thurston at complang.org (Adrian Thurston)
Date: Tue, 07 Oct 2008 00:36:33 -0400
Subject: [ragel-users] second message
Message-ID: <48EAE751.9080504@complang.org>

second message
[reply-to should be set]



From spider.karma+ragel-users at gmail.com  Fri Oct 10 21:16:10 2008
From: spider.karma+ragel-users at gmail.com (Gordon Smith)
Date: Fri, 10 Oct 2008 15:16:10 -0600
Subject: [ragel-users] fcall/fret operator error?
In-Reply-To: <2df568dc0810101415gec6a2dbh7faf2daac163d386@mail.gmail.com>
References: <2df568dc0810101415gec6a2dbh7faf2daac163d386@mail.gmail.com>
Message-ID: <2df568dc0810101416iada0e09t83bea2678349c06@mail.gmail.com>

Hello all -

Having a bit of trouble with fcall/fret.

I need to read a number in a string that indicates the number of bytes to
follow. I do this correctly with a complete string, but also reach a final
state with an incomplete string that includes some of the binary data. I'm
using fcall into another machine to read the binary data.

Have I missed something obvious?

Thanks,
Gordon

%%{
    machine TEST;
    alphtype char;

    action binary_data_length_check {
        fsm.binary_data_count++;
        if ( fsm.binary_data_count >= fsm.byte_count ) {
            //fhold;
            fret;
        }
    }

    action binary_data_init { fsm.binary_data_count = 0; }

    binary_data_machine := any+ $binary_data_length_check >binary_data_init;

    # We're trying to do this:
    # any{fsm.byte_count}
    action binary_data_action {
        fcall binary_data_machine;
    }

    binary_payload = 'r.' @binary_data_action;

    # b:<NumBytes>:<NumBytes of chars>:<CRC><CR>
    bridge_packet =
        'b:'
        ( xdigit @{ AddXDigit( fsm.byte_count, * p ); } )+
        ':'
        binary_payload
        ':'
        xdigit+
        '\r';

    main := bridge_packet;
}%%

%% write data;

void init() {
    %% write init;
    fsm.byte_count = 0;
}

void parse(char * payload, char * payloadEnd) {
    const char * p = payload;
    const char * pe = payloadEnd;

    %% access fsm.;
    %% write exec;

    if ( fsm.cs == TEST_error ) {
        std::cout << "FINISH_ERROR\n";
    } else if ( fsm.cs >= TEST_first_final ) {
        std::cout << "FINISH_FINAL\n";
    } else {
        std::cout << "FINISH_NOT_FINAL\n";
    }
}

int main() {
    init();
    {
        // Complete
        char * t1 = "b:0004:r.abcd:a0\r";
        parse(t1, t1 + strlen( t1 ) );
    }

    init();
    {
        // Incomplete
        char * t1 = "b:0004:r.ab";
        parse(t1, t1 + strlen( t1 ) );
    }

    return 0;
}

----------
Output is:
{{{
FINISH_FINAL
FINISH_FINAL
}}}

and I expect
{{{
FINISH_FINAL
FINISH_NOT_FINAL
}}}

AddXDigit( unsigned target, char c ) adds value of hexadecimal digit to
target.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.colm.net/pipermail/ragel-users/attachments/20081010/c351e260/attachment-0001.html>

From spiderkarma at gmail.com  Fri Oct 10 21:15:25 2008
From: spiderkarma at gmail.com (Gordon Smith)
Date: Fri, 10 Oct 2008 15:15:25 -0600
Subject: [ragel-users] fcall/fret operator error?
Message-ID: <2df568dc0810101415gec6a2dbh7faf2daac163d386@mail.gmail.com>

Hello all -

Having a bit of trouble with fcall/fret.

I need to read a number in a string that indicates the number of bytes to
follow. I do this correctly with a complete string, but also reach a final
state with an incomplete string that includes some of the binary data. I'm
using fcall into another machine to read the binary data.

Have I missed something obvious?

Thanks,
Gordon

%%{
    machine TEST;
    alphtype char;

    action binary_data_length_check {
        fsm.binary_data_count++;
        if ( fsm.binary_data_count >= fsm.byte_count ) {
            //fhold;
            fret;
        }
    }

    action binary_data_init { fsm.binary_data_count = 0; }

    binary_data_machine := any+ $binary_data_length_check >binary_data_init;

    # We're trying to do this:
    # any{fsm.byte_count}
    action binary_data_action {
        fcall binary_data_machine;
    }

    binary_payload = 'r.' @binary_data_action;

    # b:<NumBytes>:<NumBytes of chars>:<CRC><CR>
    bridge_packet =
        'b:'
        ( xdigit @{ AddXDigit( fsm.byte_count, * p ); } )+
        ':'
        binary_payload
        ':'
        xdigit+
        '\r';

    main := bridge_packet;
}%%

%% write data;

void init() {
    %% write init;
    fsm.byte_count = 0;
}

void parse(char * payload, char * payloadEnd) {
    const char * p = payload;
    const char * pe = payloadEnd;

    %% access fsm.;
    %% write exec;

    if ( fsm.cs == TEST_error ) {
        std::cout << "FINISH_ERROR\n";
    } else if ( fsm.cs >= TEST_first_final ) {
        std::cout << "FINISH_FINAL\n";
    } else {
        std::cout << "FINISH_NOT_FINAL\n";
    }
}

int main() {
    init();
    {
        // Complete
        char * t1 = "b:0004:r.abcd:a0\r";
        parse(t1, t1 + strlen( t1 ) );
    }

    init();
    {
        // Incomplete
        char * t1 = "b:0004:r.ab";
        parse(t1, t1 + strlen( t1 ) );
    }

    return 0;
}

----------
Output is:
{{{
FINISH_FINAL
FINISH_FINAL
}}}

and I expect
{{{
FINISH_FINAL
FINISH_NOT_FINAL
}}}

AddXDigit( unsigned target, char c ) adds value of hexadecimal digit to
target.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.colm.net/pipermail/ragel-users/attachments/20081010/74e63ad8/attachment-0001.html>

From thurston at complang.org  Fri Oct 10 21:36:04 2008
From: thurston at complang.org (Adrian Thurston)
Date: Fri, 10 Oct 2008 17:36:04 -0400
Subject: [ragel-users] fcall/fret operator error?
In-Reply-To: <2df568dc0810101416iada0e09t83bea2678349c06@mail.gmail.com>
References: <2df568dc0810101415gec6a2dbh7faf2daac163d386@mail.gmail.com>
	<2df568dc0810101416iada0e09t83bea2678349c06@mail.gmail.com>
Message-ID: <48EFCAC4.7050807@complang.org>

Hi Gordon,

That's happening because each machine instantiation has a set of final
states. When you pass an incomplete string the binary_data_machine ends
up in a final state. You can use an EOF action to catch this and raise
an error.

Adrian

P.S. sorry for the double posting of the question -- I approved the
non-member post at the same time as Gordon resent using his subscribed
address.

Gordon Smith wrote:
> Hello all -
> 
> Having a bit of trouble with fcall/fret.
> 
> I need to read a number in a string that indicates the number of bytes
> to follow. I do this correctly with a complete string, but also reach a
> final state with an incomplete string that includes some of the binary
> data. I'm using fcall into another machine to read the binary data.
> 
> Have I missed something obvious?
> 
> Thanks,
> Gordon
> 
> %%{
>     machine TEST;
>     alphtype char;
> 
>     action binary_data_length_check {
>         fsm.binary_data_count++;
>         if ( fsm.binary_data_count >= fsm.byte_count ) {
>             //fhold;
>             fret;
>         }
>     }
> 
>     action binary_data_init { fsm.binary_data_count = 0; }
> 
>     binary_data_machine := any+ $binary_data_length_check >binary_data_init;
> 
>     # We're trying to do this:
>     # any{fsm.byte_count}
>     action binary_data_action {
>         fcall binary_data_machine;
>     }
> 
>     binary_payload = 'r.' @binary_data_action;
> 
>     # b:<NumBytes>:<NumBytes of chars>:<CRC><CR>
>     bridge_packet =
>         'b:'
>         ( xdigit @{ AddXDigit( fsm.byte_count, * p ); } )+
>         ':'
>         binary_payload
>         ':'
>         xdigit+
>         '\r';
> 
>     main := bridge_packet;
> }%%
> 
> %% write data;
> 
> void init() {
>     %% write init;
>     fsm.byte_count = 0;
> }
> 
> void parse(char * payload, char * payloadEnd) {
>     const char * p = payload;
>     const char * pe = payloadEnd;
> 
>     %% access fsm.;
>     %% write exec;
> 
>     if ( fsm.cs == TEST_error ) {
>         std::cout << "FINISH_ERROR\n";
>     } else if ( fsm.cs >= TEST_first_final ) {
>         std::cout << "FINISH_FINAL\n";
>     } else {
>         std::cout << "FINISH_NOT_FINAL\n";
>     }
> }
> 
> int main() {
>     init();
>     {
>         // Complete
>         char * t1 = "b:0004:r.abcd:a0\r";
>         parse(t1, t1 + strlen( t1 ) );
>     }
>    
>     init();
>     {
>         // Incomplete
>         char * t1 = "b:0004:r.ab";
>         parse(t1, t1 + strlen( t1 ) );
>     }
>    
>     return 0;
> }
> 
> ----------
> Output is:
> {{{
> FINISH_FINAL
> FINISH_FINAL
> }}}
> 
> and I expect
> {{{
> FINISH_FINAL
> FINISH_NOT_FINAL
> }}}
> 
> AddXDigit( unsigned target, char c ) adds value of hexadecimal digit to
> target.
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From thurston at complang.org  Sat Oct 11 04:11:25 2008
From: thurston at complang.org (Adrian Thurston)
Date: Sat, 11 Oct 2008 00:11:25 -0400
Subject: [ragel-users] new subversion repository
Message-ID: <48F0276D.1080404@complang.org>

Hey Everyone,

The Ragel subversion repository has been moved to the new machine:

svn://xform.complang.org/ragel/trunk/

Cheers,
  Adrian



From ragel-user at jgoettgens.de  Sun Oct 12 13:50:39 2008
From: ragel-user at jgoettgens.de (RU)
Date: Sun, 12 Oct 2008 15:50:39 +0200
Subject: [ragel-users] vs. 6.3 4 Windows
Message-ID: <F4BCEA6B7A3F4B5A95D49A38E631C029@lynx>

I have packaged vs. 6.3 for Visual Studio 2008:

  http://www.jgoettgens.de/Meine_Bilder_und_Dateien/ragel-vs2008.7z

The 7-zip archive contains (the slightly changed) sources, x86 and AMD64 
binaries.

Happy scanning!




From hsanson at gmail.com  Tue Oct 21 15:26:35 2008
From: hsanson at gmail.com (Horacio Sanson)
Date: Wed, 22 Oct 2008 00:26:35 +0900
Subject: [ragel-users] Reduce ragel generator time
Message-ID: <6156dd8b0810210826u2fb60fbs703753a2d4b3fb29@mail.gmail.com>

I have this Ragel machine to parse RTSP messages that takes almost 20
minutes to generate the C code. I remember reading in the mailing list
about someone complaining that Ragel was taking too long to generate
his/her SIP parser. In that same thread a solution about a machine
that eats the blank spaces or something like that helped reduce the
generation time from hours to a few minutes was posted but for some
reason I cannot find this email in my email archives.

If someone could repost this email or give me a simple example on how
this was done I would appreciate it.

regards,
Horacio



From thurston at complang.org  Wed Oct 22 05:48:02 2008
From: thurston at complang.org (Adrian Thurston)
Date: Wed, 22 Oct 2008 01:48:02 -0400
Subject: [ragel-users] Reduce ragel generator time
In-Reply-To: <6156dd8b0810210826u2fb60fbs703753a2d4b3fb29@mail.gmail.com>
References: <6156dd8b0810210826u2fb60fbs703753a2d4b3fb29@mail.gmail.com>
Message-ID: <48FEBE92.3020504@complang.org>

There was this thread:

http://groups.google.com/group/ragel-users/browse_thread/thread/70232b2c5fd478d0/

I think there have been others but my searching skills suck right now.

A good way to track down state explosions is to rebuild the grammar from 
the bottom up, incrementally, and look for large unruly jumps in the 
size. Just comment out the original main and start doing:

main := <smaller_component>;

Move <smaller_component> "up" the grammar until you get to the original 
main. See chapter 4 of the manual for ways to fix the problems you find.

Cheers,
  Adrian



Horacio Sanson wrote:
> I have this Ragel machine to parse RTSP messages that takes almost 20
> minutes to generate the C code. I remember reading in the mailing list
> about someone complaining that Ragel was taking too long to generate
> his/her SIP parser. In that same thread a solution about a machine
> that eats the blank spaces or something like that helped reduce the
> generation time from hours to a few minutes was posted but for some
> reason I cannot find this email in my email archives.
> 
> If someone could repost this email or give me a simple example on how
> this was done I would appreciate it.
> 
> regards,
> Horacio
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From robertle at semistable.com  Wed Oct 22 13:38:02 2008
From: robertle at semistable.com (Robert Lemmen)
Date: Wed, 22 Oct 2008 14:38:02 +0100
Subject: [ragel-users] interleaving two machines
Message-ID: <20081022133802.GA12780@semistable.com>

hi folks,

i need a way to combine two machines in an interleaved way, so optimally
i would have an operator ?? that if used like this:

'abcd' ?? 'AB'

would match:

abcdAB
ABabcd
aABbcd
abAcBd

i have so far not managed to construct such a machine without
explicitely stating all the ordering possibilities, which get a bit
cumbersome as the two machines get longer...

thanks  robert

-- 
Robert Lemmen                               http://www.semistable.com 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <http://www.colm.net/pipermail/ragel-users/attachments/20081022/8ccafc69/attachment-0001.sig>

From thurston at complang.org  Wed Oct 22 14:58:37 2008
From: thurston at complang.org (Adrian Thurston)
Date: Wed, 22 Oct 2008 10:58:37 -0400
Subject: [ragel-users] interleaving two machines
In-Reply-To: <20081022133802.GA12780@semistable.com>
References: <20081022133802.GA12780@semistable.com>
Message-ID: <48FF3F9D.3030603@complang.org>

I think this has been requested before, or something similar to it. Is
this a language of your making, or some existing language? I'm
interested in an example use.

-Adrian

Robert Lemmen wrote:
> hi folks,
> 
> i need a way to combine two machines in an interleaved way, so optimally
> i would have an operator ?? that if used like this:
> 
> 'abcd' ?? 'AB'
> 
> would match:
> 
> abcdAB
> ABabcd
> aABbcd
> abAcBd
> 
> i have so far not managed to construct such a machine without
> explicitely stating all the ordering possibilities, which get a bit
> cumbersome as the two machines get longer...
> 
> thanks  robert
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From robertle at semistable.com  Wed Oct 22 15:25:58 2008
From: robertle at semistable.com (Robert Lemmen)
Date: Wed, 22 Oct 2008 16:25:58 +0100
Subject: [ragel-users] interleaving two machines
In-Reply-To: <48FF3F9D.3030603@complang.org>
References: <20081022133802.GA12780@semistable.com>
	<48FF3F9D.3030603@complang.org>
Message-ID: <20081022152558.GA14866@semistable.com>

On Wed, Oct 22, 2008 at 10:58:37AM -0400, Adrian Thurston wrote:
> I think this has been requested before, or something similar to it. Is
> this a language of your making, or some existing language? I'm
> interested in an example use.

it is a language of my making, but i think it is a quite neat feature.
in my case it is a handshake protocol over the network. you could work
your way around it by specifying the exact order, i.e. one end (the
server) moderates the whole protocol, the other end just answers. it is
however much more efficient and neat if you could avoid that. a really
simple example:

--- helo   -->
<-- helo   ---
--- ident  -->
<-- ident  ---
--- query  -->
<-- answer ---
--- ok     -->
<-- ok     ---

basically, both ends send a "helo", wait for an "ident" and then either
do a "query" which needs an "answer", or just send an "ok". after two
"ok"s the handshake is done. we can of course require the above
ordering, but if we allow both ends to send a package whenever it makes
sense, then the whole thing might get heavily reordered:

--- helo   -->   <-- helo   ---
--- ident  -->   <-- ident  ---
--- query  -->   <-- ok     ---
                 <-- answer ---
--- ok     -->

as you can see, we can then do things in parallel, which is especially
important on high-latency links...

cu  robert

-- 
Robert Lemmen                               http://www.semistable.com 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <http://www.colm.net/pipermail/ragel-users/attachments/20081022/c7c62be6/attachment-0001.sig>

From thurston at complang.org  Wed Oct 22 23:28:43 2008
From: thurston at complang.org (Adrian Thurston)
Date: Wed, 22 Oct 2008 19:28:43 -0400
Subject: [ragel-users] interleaving two machines
In-Reply-To: <20081022152558.GA14866@semistable.com>
References: <20081022133802.GA12780@semistable.com>	<48FF3F9D.3030603@complang.org>
	<20081022152558.GA14866@semistable.com>
Message-ID: <48FFB72B.2060307@complang.org>

Right, I see how that would be useful. I'm pretty sure this has been 
asked for in the past but I didn't get it.

-Adrian

Robert Lemmen wrote:
> On Wed, Oct 22, 2008 at 10:58:37AM -0400, Adrian Thurston wrote:
>> I think this has been requested before, or something similar to it. Is
>> this a language of your making, or some existing language? I'm
>> interested in an example use.
> 
> it is a language of my making, but i think it is a quite neat feature.
> in my case it is a handshake protocol over the network. you could work
> your way around it by specifying the exact order, i.e. one end (the
> server) moderates the whole protocol, the other end just answers. it is
> however much more efficient and neat if you could avoid that. a really
> simple example:
> 
> --- helo   -->
> <-- helo   ---
> --- ident  -->
> <-- ident  ---
> --- query  -->
> <-- answer ---
> --- ok     -->
> <-- ok     ---
> 
> basically, both ends send a "helo", wait for an "ident" and then either
> do a "query" which needs an "answer", or just send an "ok". after two
> "ok"s the handshake is done. we can of course require the above
> ordering, but if we allow both ends to send a package whenever it makes
> sense, then the whole thing might get heavily reordered:
> 
> --- helo   -->   <-- helo   ---
> --- ident  -->   <-- ident  ---
> --- query  -->   <-- ok     ---
>                  <-- answer ---
> --- ok     -->
> 
> as you can see, we can then do things in parallel, which is especially
> important on high-latency links...
> 
> cu  robert
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From hsanson at gmail.com  Thu Oct 23 00:38:54 2008
From: hsanson at gmail.com (Horacio Sanson)
Date: Thu, 23 Oct 2008 09:38:54 +0900
Subject: [ragel-users] Reduce ragel generator time
In-Reply-To: <48FEBE92.3020504@complang.org>
References: <6156dd8b0810210826u2fb60fbs703753a2d4b3fb29@mail.gmail.com>
	<48FEBE92.3020504@complang.org>
Message-ID: <6156dd8b0810221738y747bfcb6t60298106076bd1c5@mail.gmail.com>

Thanks,

Using the link you gave me I was able to find the thread I was looking
for. Here it is if someone is interested.

http://groups.google.com/group/ragel-users/browse_thread/thread/e1179e9756f6eb32/f69f6cd013f9426d?lnk=gst&q=sip+#f69f6cd013f9426d

What I don't understand is why this thread is not stored in my mail
archives... strange.

regards,
Horacio

On Wed, Oct 22, 2008 at 2:48 PM, Adrian Thurston <thurston at complang.org> wrote:
> There was this thread:
>
> http://groups.google.com/group/ragel-users/browse_thread/thread/70232b2c5fd478d0/
>
> I think there have been others but my searching skills suck right now.
>
> A good way to track down state explosions is to rebuild the grammar from
> the bottom up, incrementally, and look for large unruly jumps in the
> size. Just comment out the original main and start doing:
>
> main := <smaller_component>;
>
> Move <smaller_component> "up" the grammar until you get to the original
> main. See chapter 4 of the manual for ways to fix the problems you find.
>
> Cheers,
>  Adrian
>
>
>
> Horacio Sanson wrote:
>> I have this Ragel machine to parse RTSP messages that takes almost 20
>> minutes to generate the C code. I remember reading in the mailing list
>> about someone complaining that Ragel was taking too long to generate
>> his/her SIP parser. In that same thread a solution about a machine
>> that eats the blank spaces or something like that helped reduce the
>> generation time from hours to a few minutes was posted but for some
>> reason I cannot find this email in my email archives.
>>
>> If someone could repost this email or give me a simple example on how
>> this was done I would appreciate it.
>>
>> regards,
>> Horacio
>>
>> _______________________________________________
>> ragel-users mailing list
>> ragel-users at complang.org
>> http://www.complang.org/mailman/listinfo/ragel-users
>
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users
>



From hsanson at gmail.com  Thu Oct 23 02:52:59 2008
From: hsanson at gmail.com (Horacio Sanson)
Date: Thu, 23 Oct 2008 11:52:59 +0900
Subject: [ragel-users] Small help with RTSP + SDP parser
Message-ID: <6156dd8b0810221952h12f13d2axae88954f3e76a98b@mail.gmail.com>

Here is part of my parser that deals with RTSP response body part. As
you can see the message_body is delimited by CRLF that is a simle
("\n"? "\r") expression.
My problem is when the response has a SDP message as part of the
response body. This is because SDP fields are also delimited with CRLF
(see example at the end). In this case the body_read action is called
for each SDP field instead of only once at the end of the body. In
consequence I get several calls to memcpy when in fact I only expect
one at the end of the message body (i.e. 27 times in the example
below).

The end result is still correct, the SDP is completely copied inside
the msg->body buffer, but calling memcpy per SDP field is undesired
for performance reasons. What rule/tip/trick/hack can I use to make
the body_read action be executed only once at the end of the RTSP
message body??

thanks
Horacio

################################################################################
#        Ragel rules
################################################################################

action body_test  { body_offset++ < msg->body_len }
action body_start { body_start = fpc; body_offset = 0 }
action body_end   {body_end = fpc;}
action body_read {
    tmpbuf_len = body_end - body_start;
    memcpy(msg->body, body_start, tmpbuf_len);
}

message_body = any+ >body_start @body_end when body_test %body_read;

Response = (                            # Section 7
     Status_Line
     (
         general_header                 # Section 5
         | response_header              # Section 6.2
         | entity_header                # Section 8.1
         | CSeq                        # Section 12.17
         | Session                       # Section 12.37
         | Transport                     # Section 12.39
         | darwin_header                 # Darwin SS proprietary
     )*
     CRLF
     message_body?                       # Section 4.3
     CRLF %{ msg->finished = 1; SUJMSG("RTSP Finish\n"); }
 );

main := (Request | Response);


################################################################################
# Example RTSP response:
################################################################################
RTSP/1.0 200 OK
Server: DSS/5.5.5 (Build/489.16; Platform/Linux; Release/Darwin;
state/beta; )
Cseq: 411
Last-Modified: Thu, 16 Oct 2008 00:21:52 GMT
Cache-Control: must-revalidate
Content-length: 741
Date: Thu, 23 Oct 2008 02:30:28 GMT
Expires: Thu, 23 Oct 2008 02:30:28 GMT
Content-Type: application/sdp
x-Accept-Retransmit: our-retransmit
x-Accept-Dynamic-Rate: 1
Content-Base: rtsp://www.fake.com:554/BBB.mp4/

v=0
o=StreamingServer 3433717827 1224116512000 IN IP4 218.45.218.150
s=/BBB.mp4
u=http:///
e=admin@
c=IN IP4 0.0.0.0
b=AS:500
t=0 0
a=control:*
a=x-copyright: MP4/3GP File hinted with GPAC 0.4.4 (C)2000-2005 -
http://gpac.sourceforge.net
a=range:npt=0- 596.45800
m=video 0 RTP/AVP 96
b=AS:400
a=rtpmap:96 H264/90000
a=control:trackID=65536
a=fmtp:96 profile-level-id=42C01E; packetization-mode=1;
sprop-parameter-sets=Z0LAHppzgUBf8sIAAAMAAgAAAwBhHixc8A==,aM4yyA==
a=framesize:96 640-360
m=audio 0 RTP/AVP 97
b=AS:100
a=rtpmap:97 mpeg4-generic/48000/2
a=control:trackID=65537
a=fmtp:97 profile-level-id=41; config=1190; streamType=5;
mode=AAC-hbr; objectType=64; sizeLength=13; indexLength=3;
indexDeltaLength=3



From thurston at complang.org  Thu Oct 23 06:52:47 2008
From: thurston at complang.org (Adrian Thurston)
Date: Thu, 23 Oct 2008 02:52:47 -0400
Subject: [ragel-users] Reduce ragel generator time
In-Reply-To: <6156dd8b0810221738y747bfcb6t60298106076bd1c5@mail.gmail.com>
References: <6156dd8b0810210826u2fb60fbs703753a2d4b3fb29@mail.gmail.com>	<48FEBE92.3020504@complang.org>
	<6156dd8b0810221738y747bfcb6t60298106076bd1c5@mail.gmail.com>
Message-ID: <49001F3F.8020006@complang.org>

I just busted this link ... I moved the google group messages into the 
mailman archive and deleted the group. You can now find the thread here:

http://www.complang.org/pipermail/ragel-users/2007-July/000263.html

-Adrian

Horacio Sanson wrote:
> Thanks,
> 
> Using the link you gave me I was able to find the thread I was looking
> for. Here it is if someone is interested.
> 
> http://groups.google.com/group/ragel-users/browse_thread/thread/e1179e9756f6eb32/f69f6cd013f9426d?lnk=gst&q=sip+#f69f6cd013f9426d
> 
> What I don't understand is why this thread is not stored in my mail
> archives... strange.
> 
> regards,
> Horacio
> 
> On Wed, Oct 22, 2008 at 2:48 PM, Adrian Thurston <thurston at complang.org> wrote:
>> There was this thread:
>>
>> http://groups.google.com/group/ragel-users/browse_thread/thread/70232b2c5fd478d0/
>>
>> I think there have been others but my searching skills suck right now.
>>
>> A good way to track down state explosions is to rebuild the grammar from
>> the bottom up, incrementally, and look for large unruly jumps in the
>> size. Just comment out the original main and start doing:
>>
>> main := <smaller_component>;
>>
>> Move <smaller_component> "up" the grammar until you get to the original
>> main. See chapter 4 of the manual for ways to fix the problems you find.
>>
>> Cheers,
>>  Adrian
>>
>>
>>
>> Horacio Sanson wrote:
>>> I have this Ragel machine to parse RTSP messages that takes almost 20
>>> minutes to generate the C code. I remember reading in the mailing list
>>> about someone complaining that Ragel was taking too long to generate
>>> his/her SIP parser. In that same thread a solution about a machine
>>> that eats the blank spaces or something like that helped reduce the
>>> generation time from hours to a few minutes was posted but for some
>>> reason I cannot find this email in my email archives.
>>>
>>> If someone could repost this email or give me a simple example on how
>>> this was done I would appreciate it.
>>>
>>> regards,
>>> Horacio
>>>
>>> _______________________________________________
>>> ragel-users mailing list
>>> ragel-users at complang.org
>>> http://www.complang.org/mailman/listinfo/ragel-users
>> _______________________________________________
>> ragel-users mailing list
>> ragel-users at complang.org
>> http://www.complang.org/mailman/listinfo/ragel-users
>>
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From thurston at complang.org  Thu Oct 23 17:14:59 2008
From: thurston at complang.org (Adrian Thurston)
Date: Thu, 23 Oct 2008 13:14:59 -0400
Subject: [ragel-users] Small help with RTSP + SDP parser
In-Reply-To: <6156dd8b0810221952h12f13d2axae88954f3e76a98b@mail.gmail.com>
References: <6156dd8b0810221952h12f13d2axae88954f3e76a98b@mail.gmail.com>
Message-ID: <4900B113.6090008@complang.org>

You could put %body_read at the end of the final CRLF. It seems you're
parsing only a single request/response at once and you don't need to
separate them. That means that when the input buffer is fully consumed
you're at the end.

Adrian

Horacio Sanson wrote:
> Here is part of my parser that deals with RTSP response body part. As
> you can see the message_body is delimited by CRLF that is a simle
> ("\n"? "\r") expression.
> My problem is when the response has a SDP message as part of the
> response body. This is because SDP fields are also delimited with CRLF
> (see example at the end). In this case the body_read action is called
> for each SDP field instead of only once at the end of the body. In
> consequence I get several calls to memcpy when in fact I only expect
> one at the end of the message body (i.e. 27 times in the example
> below).
> 
> The end result is still correct, the SDP is completely copied inside
> the msg->body buffer, but calling memcpy per SDP field is undesired
> for performance reasons. What rule/tip/trick/hack can I use to make
> the body_read action be executed only once at the end of the RTSP
> message body??
> 
> thanks
> Horacio
> 
> ################################################################################
> #        Ragel rules
> ################################################################################
> 
> action body_test  { body_offset++ < msg->body_len }
> action body_start { body_start = fpc; body_offset = 0 }
> action body_end   {body_end = fpc;}
> action body_read {
>     tmpbuf_len = body_end - body_start;
>     memcpy(msg->body, body_start, tmpbuf_len);
> }
> 
> message_body = any+ >body_start @body_end when body_test %body_read;
> 
> Response = (                            # Section 7
>      Status_Line
>      (
>          general_header                 # Section 5
>          | response_header              # Section 6.2
>          | entity_header                # Section 8.1
>          | CSeq                        # Section 12.17
>          | Session                       # Section 12.37
>          | Transport                     # Section 12.39
>          | darwin_header                 # Darwin SS proprietary
>      )*
>      CRLF
>      message_body?                       # Section 4.3
>      CRLF %{ msg->finished = 1; SUJMSG("RTSP Finish\n"); }
>  );
> 
> main := (Request | Response);
> 
> 
> ################################################################################
> # Example RTSP response:
> ################################################################################
> RTSP/1.0 200 OK
> Server: DSS/5.5.5 (Build/489.16; Platform/Linux; Release/Darwin;
> state/beta; )
> Cseq: 411
> Last-Modified: Thu, 16 Oct 2008 00:21:52 GMT
> Cache-Control: must-revalidate
> Content-length: 741
> Date: Thu, 23 Oct 2008 02:30:28 GMT
> Expires: Thu, 23 Oct 2008 02:30:28 GMT
> Content-Type: application/sdp
> x-Accept-Retransmit: our-retransmit
> x-Accept-Dynamic-Rate: 1
> Content-Base: rtsp://www.fake.com:554/BBB.mp4/
> 
> v=0
> o=StreamingServer 3433717827 1224116512000 IN IP4 218.45.218.150
> s=/BBB.mp4
> u=http:///
> e=admin@
> c=IN IP4 0.0.0.0
> b=AS:500
> t=0 0
> a=control:*
> a=x-copyright: MP4/3GP File hinted with GPAC 0.4.4 (C)2000-2005 -
> http://gpac.sourceforge.net
> a=range:npt=0- 596.45800
> m=video 0 RTP/AVP 96
> b=AS:400
> a=rtpmap:96 H264/90000
> a=control:trackID=65536
> a=fmtp:96 profile-level-id=42C01E; packetization-mode=1;
> sprop-parameter-sets=Z0LAHppzgUBf8sIAAAMAAgAAAwBhHixc8A==,aM4yyA==
> a=framesize:96 640-360
> m=audio 0 RTP/AVP 97
> b=AS:100
> a=rtpmap:97 mpeg4-generic/48000/2
> a=control:trackID=65537
> a=fmtp:97 profile-level-id=41; config=1190; streamType=5;
> mode=AAC-hbr; objectType=64; sizeLength=13; indexLength=3;
> indexDeltaLength=3
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



From ribs at acm.org  Fri Oct 31 03:07:44 2008
From: ribs at acm.org (Larry Edelstein)
Date: Thu, 30 Oct 2008 20:07:44 -0700
Subject: [ragel-users] access variable in expression?
Message-ID: <2021f8b20810302007r7907f7f7w9781161da9952c28@mail.gmail.com>

Am I able to use the value of a variable as an expression, and if so, how?

I am trying to parse a language like this:

number = digit+ >start_capture_number_of_names
%end_capture_number_of_names '\n';
name = ^[\n]* '\n';
main := number name{number_of_names}

where number_of_names is the number I captured earlier.

Can I do it this way, or do I need to iterate using actions and the
statements defined in 3.4 of the manual?

Larry Edelstein
San Francisco, CA
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.colm.net/pipermail/ragel-users/attachments/20081030/8b7c0306/attachment-0001.html>

From thurston at complang.org  Fri Oct 31 06:17:31 2008
From: thurston at complang.org (Adrian Thurston)
Date: Fri, 31 Oct 2008 02:17:31 -0400
Subject: [ragel-users] access variable in expression?
In-Reply-To: <2021f8b20810302007r7907f7f7w9781161da9952c28@mail.gmail.com>
References: <2021f8b20810302007r7907f7f7w9781161da9952c28@mail.gmail.com>
Message-ID: <490AA2FB.2050304@complang.org>

Hi Larry,

Two options: you can use a separate machine instantiation to count items 
and jump back to the main machine when the number of items has been 
consumed like you suggest. The alternative is to use conditions if you 
need the counting to be done in a reusable machine definition. These are 
semantic tests that can be used to check a count. See section 6.5.

Cheers,
  Adrian

Larry Edelstein wrote:
> Am I able to use the value of a variable as an expression, and if so, how?
> 
> I am trying to parse a language like this:
> 
> number = digit+ >start_capture_number_of_names 
> %end_capture_number_of_names '\n';
> name = ^[\n]* '\n';
> main := number name{number_of_names}
> 
> where number_of_names is the number I captured earlier.  
> 
> Can I do it this way, or do I need to iterate using actions and the 
> statements defined in 3.4 of the manual?
> 
> Larry Edelstein
> San Francisco, CA
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> ragel-users mailing list
> ragel-users at complang.org
> http://www.complang.org/mailman/listinfo/ragel-users



