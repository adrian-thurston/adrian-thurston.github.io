<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [ragel-users] ragel and encodings
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:ragel-users%40colm.net?Subject=Re%3A%20%5Bragel-users%5D%20ragel%20and%20encodings&In-Reply-To=%3Cc713a0460905211151w637193e8u3b71c5c112753271%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="002723.html">
   <LINK REL="Next"  HREF="002726.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[ragel-users] ragel and encodings</H1>
    <B>Wil Macaulay</B> 
    <A HREF="mailto:ragel-users%40colm.net?Subject=Re%3A%20%5Bragel-users%5D%20ragel%20and%20encodings&In-Reply-To=%3Cc713a0460905211151w637193e8u3b71c5c112753271%40mail.gmail.com%3E"
       TITLE="[ragel-users] ragel and encodings">wil.macaulay at gmail.com
       </A><BR>
    <I>Thu May 21 18:51:31 UTC 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002723.html">[ragel-users] ragel and encodings
</A></li>
        <LI>Next message: <A HREF="002726.html">[ragel-users] ragel and encodings
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2724">[ date ]</a>
              <a href="thread.html#2724">[ thread ]</a>
              <a href="subject.html#2724">[ subject ]</a>
              <a href="author.html#2724">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Sorry - I was inaccurate in my previous reply (should have refreshed
my memory first by looking at
the code).  On the Mac, the native encoding is Unicode  - that's the
conceptual basis for the NSString class. There are convenience
functions for accessing the underlying
character buffer as unichar - 16 bits unsigned.   So my first step is
to convert the raw file to an NSString
as Unicode, then access the character buffer and sent that to my
parser.  This requires my ragel file to use:

#UniChar type is 16 bits unsigned
	
	alphtype unsigned short;

Keywords all fall into the standard ASCII charset - anything that is
outside the ascii character set,
for me, is only interesting in the context of literals (quoted strings
and the like).  This means that I can
write my FSM in the normal fashion.

Hope this helps

wil



On Thu, May 21, 2009 at 1:48 PM, Robert Lemmen &lt;<A HREF="http://www.colm.net/cgi-bin/mailman/listinfo/ragel-users">robertle at semistable.com</A>&gt; wrote:
&gt;<i> On Thu, May 21, 2009 at 11:34:35AM -0400, Wil Macaulay wrote:
</I>&gt;&gt;<i> Depends on your platform, but my approach to this problem (on the Mac)
</I>&gt;&gt;<i> was to detect
</I>&gt;&gt;<i> the encoding, and convert to UTF-8 before parsing. I also converted
</I>&gt;&gt;<i> line-endings (\r\n -&gt; \n)
</I>&gt;&gt;<i> and ensured a newline at the end of the data at the same time.
</I>&gt;<i>
</I>&gt;<i> how do you handle utf-8 in your ragel code? do you use a single-byte
</I>&gt;<i> alphtype and then handle the utf-8 sequences manually?
</I>&gt;<i>
</I>&gt;<i> cu  robert
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Robert Lemmen                               <A HREF="http://www.semistable.com">http://www.semistable.com</A>
</I>&gt;<i>
</I>&gt;<i> -----BEGIN PGP SIGNATURE-----
</I>&gt;<i> Version: GnuPG v1.4.9 (GNU/Linux)
</I>&gt;<i>
</I>&gt;<i> iD8DBQFKFZPkS6AOchRbaWYRAjClAKCy0w4KQNUOxyeA/0l1RUWQyZQKmwCeM3o7
</I>&gt;<i> /CvWvDgAdAJYGDy2VEUBkuo=
</I>&gt;<i> =xX1k
</I>&gt;<i> -----END PGP SIGNATURE-----
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> ragel-users mailing list
</I>&gt;<i> <A HREF="http://www.colm.net/cgi-bin/mailman/listinfo/ragel-users">ragel-users at complang.org</A>
</I>&gt;<i> <A HREF="http://www.complang.org/mailman/listinfo/ragel-users">http://www.complang.org/mailman/listinfo/ragel-users</A>
</I>&gt;<i>
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002723.html">[ragel-users] ragel and encodings
</A></li>
	<LI>Next message: <A HREF="002726.html">[ragel-users] ragel and encodings
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2724">[ date ]</a>
              <a href="thread.html#2724">[ thread ]</a>
              <a href="subject.html#2724">[ subject ]</a>
              <a href="author.html#2724">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.colm.net/cgi-bin/mailman/listinfo/ragel-users">More information about the ragel-users
mailing list</a><br>
</body></html>
