<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;3.2//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;charset=iso-8859-1&quot;&gt;<br>
&lt;META&nbsp;NAME=&quot;Generator&quot;&nbsp;CONTENT=&quot;MS&nbsp;Exchange&nbsp;Server&nbsp;version&nbsp;6.5.7654.12&quot;&gt;<br>
&lt;TITLE&gt;RE:&nbsp;[ragel-users]&nbsp;Parsing&nbsp;a&nbsp;template&nbsp;language&lt;/TITLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
&lt;!--&nbsp;Converted&nbsp;from&nbsp;text/plain&nbsp;format&nbsp;--&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;I'm&nbsp;actually&nbsp;working&nbsp;on&nbsp;a&nbsp;similar&nbsp;sounding&nbsp;task.&nbsp;&lt;BR&gt;<br>
&lt;BR&gt;<br>
Try&nbsp;the&nbsp;strong&nbsp;subtraction&nbsp;operator&lt;BR&gt;<br>
Untested:&lt;BR&gt;<br>
&lt;BR&gt;<br>
main&nbsp;:=&nbsp;|*&lt;BR&gt;<br>
&nbsp;&nbsp;'[['&nbsp;lower+&nbsp;']]'&nbsp;=&gt;&nbsp;action&lt;BR&gt;<br>
&nbsp;&nbsp;(&nbsp;any*&nbsp;--&nbsp;'[['&nbsp;)&nbsp;=&gt;&nbsp;action&lt;BR&gt;<br>
*|;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
(&nbsp;any*&nbsp;--&nbsp;'[['&nbsp;)&nbsp;will&nbsp;match&nbsp;the&nbsp;longest&nbsp;possible&nbsp;string&nbsp;that&nbsp;doesn't&nbsp;have&nbsp;'[['&nbsp;as&nbsp;a&nbsp;substring.&lt;BR&gt;<br>
&lt;BR&gt;<br>
-----Original&nbsp;Message-----&lt;BR&gt;<br>
From:&nbsp;ragel-users-bounces@complang.org&nbsp;on&nbsp;behalf&nbsp;of&nbsp;Tobias&nbsp;Lütke&lt;BR&gt;<br>
Sent:&nbsp;Tue&nbsp;7/27/2010&nbsp;6:54&nbsp;PM&lt;BR&gt;<br>
To:&nbsp;ragel-users@complang.org&lt;BR&gt;<br>
Subject:&nbsp;Re:&nbsp;[ragel-users]&nbsp;Parsing&nbsp;a&nbsp;template&nbsp;language&lt;BR&gt;<br>
&lt;BR&gt;<br>
Depends&nbsp;on&nbsp;the&nbsp;answers&nbsp;in&nbsp;this&nbsp;thread&nbsp;I&nbsp;suppose&nbsp;:-)&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
On&nbsp;Tue,&nbsp;Jul&nbsp;27,&nbsp;2010&nbsp;at&nbsp;3:42&nbsp;AM,&nbsp;Magnus&nbsp;Holm&nbsp;&lt;judofyr@gmail.com&gt;&nbsp;wrote:&lt;BR&gt;<br>
&gt;&nbsp;(A&nbsp;little&nbsp;off-topic,&nbsp;but&nbsp;whatever:&lt;BR&gt;<br>
&gt;&lt;BR&gt;<br>
&gt;&nbsp;So&nbsp;Liquid&nbsp;will&nbsp;finally&nbsp;get&nbsp;a&nbsp;proper&nbsp;parser?&nbsp;:-))&lt;BR&gt;<br>
&gt;&lt;BR&gt;<br>
&gt;&nbsp;//&nbsp;Magnus&nbsp;Holm&lt;BR&gt;<br>
&gt;&lt;BR&gt;<br>
&gt;&lt;BR&gt;<br>
&gt;&lt;BR&gt;<br>
&gt;&nbsp;On&nbsp;Tue,&nbsp;Jul&nbsp;27,&nbsp;2010&nbsp;at&nbsp;03:15,&nbsp;Tobias&nbsp;Lütke&nbsp;&lt;tobi@leetsoft.com&gt;&nbsp;wrote:&lt;BR&gt;<br>
&gt;&gt;&nbsp;I've&nbsp;been&nbsp;working&nbsp;on&nbsp;a&nbsp;parser&nbsp;for&nbsp;simple&nbsp;template&nbsp;language.&nbsp;I'm&nbsp;using&nbsp;Ragel.&lt;BR&gt;<br>
&gt;&gt;&lt;BR&gt;<br>
&gt;&gt;&nbsp;The&nbsp;requirements&nbsp;are&nbsp;modest.&nbsp;I'm&nbsp;trying&nbsp;to&nbsp;find&nbsp;[[tags]]&nbsp;that&nbsp;can&nbsp;be&lt;BR&gt;<br>
&gt;&gt;&nbsp;embedded&nbsp;anywhere&nbsp;in&nbsp;the&nbsp;input&nbsp;string.&lt;BR&gt;<br>
&gt;&gt;&lt;BR&gt;<br>
&gt;&gt;&nbsp;I'm&nbsp;trying&nbsp;to&nbsp;parse&nbsp;a&nbsp;simple&nbsp;template&nbsp;language,&nbsp;something&nbsp;that&nbsp;can&lt;BR&gt;<br>
&gt;&gt;&nbsp;have&nbsp;tags&nbsp;such&nbsp;as&nbsp;{{foo}}&nbsp;embedded&nbsp;within&nbsp;HTML.&nbsp;I&nbsp;tried&nbsp;several&lt;BR&gt;<br>
&gt;&gt;&nbsp;approaches&nbsp;to&nbsp;parse&nbsp;this&nbsp;but&nbsp;had&nbsp;to&nbsp;resort&nbsp;to&nbsp;using&nbsp;a&nbsp;Ragel&nbsp;scanner&lt;BR&gt;<br>
&gt;&gt;&nbsp;and&nbsp;use&nbsp;the&nbsp;inefficient&nbsp;approach&nbsp;of&nbsp;only&nbsp;matching&nbsp;a&nbsp;single&nbsp;character&lt;BR&gt;<br>
&gt;&gt;&nbsp;as&nbsp;a&nbsp;&quot;catch&nbsp;all&quot;.&nbsp;I&nbsp;feel&nbsp;this&nbsp;is&nbsp;the&nbsp;wrong&nbsp;way&nbsp;to&nbsp;go&nbsp;about&nbsp;this.&nbsp;I'm&lt;BR&gt;<br>
&gt;&gt;&nbsp;essentially&nbsp;abusing&nbsp;the&nbsp;longest-match&nbsp;bias&nbsp;of&nbsp;the&nbsp;scanner&nbsp;to&nbsp;implement&lt;BR&gt;<br>
&gt;&gt;&nbsp;my&nbsp;default&nbsp;rule&nbsp;(&nbsp;it&nbsp;can&nbsp;only&nbsp;be&nbsp;1&nbsp;char&nbsp;long,&nbsp;so&nbsp;it&nbsp;should&nbsp;always&nbsp;be&lt;BR&gt;<br>
&gt;&gt;&nbsp;the&nbsp;last&nbsp;resort&nbsp;).&lt;BR&gt;<br>
&gt;&gt;&lt;BR&gt;<br>
&gt;&gt;&nbsp;%%{&lt;BR&gt;<br>
&gt;&gt;&lt;BR&gt;<br>
&gt;&gt;&nbsp; machine&nbsp;parser;&lt;BR&gt;<br>
&gt;&gt;&lt;BR&gt;<br>
&gt;&gt;&nbsp; action&nbsp;start&nbsp; &nbsp; &nbsp; {&nbsp;tokstart&nbsp;=&nbsp;p;&nbsp;}&lt;BR&gt;<br>
&gt;&gt;&nbsp; action&nbsp;on_tag&nbsp; &nbsp; &nbsp; {&nbsp;results&nbsp;&lt;&lt;&nbsp;[:tag,&nbsp;data[tokstart..p]]&nbsp;}&lt;BR&gt;<br>
&gt;&gt;&nbsp; action&nbsp;on_static&nbsp; {&nbsp;results&nbsp;&lt;&lt;&nbsp;[:static,&nbsp;data[p..p]]&nbsp;}&lt;BR&gt;<br>
&gt;&gt;&lt;BR&gt;<br>
&gt;&gt;&nbsp; tag&nbsp; =&nbsp;('[['&nbsp;lower+&nbsp;']]')&nbsp;&gt;start&nbsp;@on_tag;&lt;BR&gt;<br>
&gt;&gt;&lt;BR&gt;<br>
&gt;&gt;&nbsp; main&nbsp;:=&nbsp;|*&lt;BR&gt;<br>
&gt;&gt;&nbsp; &nbsp; tag;&lt;BR&gt;<br>
&gt;&gt;&nbsp; &nbsp; any&nbsp; &nbsp; &nbsp; =&gt;&nbsp;on_static;&lt;BR&gt;<br>
&gt;&gt;&nbsp; *|;&lt;BR&gt;<br>
&gt;&gt;&lt;BR&gt;<br>
&gt;&gt;&nbsp;}%%&lt;BR&gt;<br>
&gt;&gt;&lt;BR&gt;<br>
&gt;&gt;&nbsp;(&nbsp;actions&nbsp;written&nbsp;in&nbsp;ruby,&nbsp;but&nbsp;should&nbsp;be&nbsp;easy&nbsp;to&nbsp;understand&nbsp;).&lt;BR&gt;<br>
&gt;&gt;&lt;BR&gt;<br>
&gt;&gt;&nbsp;How&nbsp;would&nbsp;you&nbsp;go&nbsp;about&nbsp;writing&nbsp;a&nbsp;parser&nbsp;for&nbsp;such&nbsp;a&nbsp;simple&nbsp;language?&nbsp;Is&lt;BR&gt;<br>
&gt;&gt;&nbsp;Ragel&nbsp;maybe&nbsp;not&nbsp;the&nbsp;right&nbsp;tool?&nbsp;It&nbsp;seems&nbsp;you&nbsp;have&nbsp;to&nbsp;fight&nbsp;Ragel&nbsp;tooth&lt;BR&gt;<br>
&gt;&gt;&nbsp;and&nbsp;nails&nbsp;if&nbsp;the&nbsp;syntax&nbsp;is&nbsp;unpredictable&nbsp;such&nbsp;as&nbsp;this.&lt;BR&gt;<br>
&gt;&gt;&lt;BR&gt;<br>
&gt;&gt;&lt;BR&gt;<br>
&gt;&gt;&nbsp;Regards&lt;BR&gt;<br>
&gt;&gt;&nbsp;--&nbsp;tobi&lt;BR&gt;<br>
&gt;&gt;&lt;BR&gt;<br>
&gt;&gt;&nbsp;_______________________________________________&lt;BR&gt;<br>
&gt;&gt;&nbsp;ragel-users&nbsp;mailing&nbsp;list&lt;BR&gt;<br>
&gt;&gt;&nbsp;ragel-users@complang.org&lt;BR&gt;<br>
&gt;&gt;&nbsp;&lt;A&nbsp;HREF=&quot;http://www.complang.org/mailman/listinfo/ragel-users&quot;&gt;http://www.complang.org/mailman/listinfo/ragel-users&lt;/A&gt;&lt;BR&gt;<br>
&gt;&gt;&lt;BR&gt;<br>
&gt;&lt;BR&gt;<br>
&gt;&nbsp;_______________________________________________&lt;BR&gt;<br>
&gt;&nbsp;ragel-users&nbsp;mailing&nbsp;list&lt;BR&gt;<br>
&gt;&nbsp;ragel-users@complang.org&lt;BR&gt;<br>
&gt;&nbsp;&lt;A&nbsp;HREF=&quot;http://www.complang.org/mailman/listinfo/ragel-users&quot;&gt;http://www.complang.org/mailman/listinfo/ragel-users&lt;/A&gt;&lt;BR&gt;<br>
&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
_______________________________________________&lt;BR&gt;<br>
ragel-users&nbsp;mailing&nbsp;list&lt;BR&gt;<br>
ragel-users@complang.org&lt;BR&gt;<br>
&lt;A&nbsp;HREF=&quot;http://www.complang.org/mailman/listinfo/ragel-users&quot;&gt;http://www.complang.org/mailman/listinfo/ragel-users&lt;/A&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;
</tt>
